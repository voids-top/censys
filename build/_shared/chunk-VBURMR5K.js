import{a as gt}from"/censys/build/_shared/chunk-LCN4BXNE.js";import{b as R}from"/censys/build/_shared/chunk-4KKS33MW.js";import{b as lt,h as ct,q as pt,t as ht,u as mt,v as yt}from"/censys/build/_shared/chunk-IUMSQHOS.js";import{a as ot,b as l}from"/censys/build/_shared/chunk-LOKTUJJ3.js";import{A as st,B as A,c as k,g as at,h as W}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{b as nt}from"/censys/build/_shared/chunk-426SZY5O.js";import{h as L,j as it}from"/censys/build/_shared/chunk-6EMU7K4F.js";import{c as et}from"/censys/build/_shared/chunk-ST66DGSY.js";import{b as rt}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{A as p,D as tt,Ka as B,Ma as F,Ya as H,Za as G,_a as U,ga as O,ha as P,x as j,z as v}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as $}from"/censys/build/_shared/chunk-44DVAK2X.js";import{b as T}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as K}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as y}from"/censys/build/_shared/chunk-2TWE7TSA.js";var d=y(K(),1);var I=y(K(),1);var m={historicalTimeline:"dQAF5",entitlementState:"Oe1TL",loadingState:"whBuG",emptyState:"be62j",filterMessage:"GGxBi",errorMessage:"_0AlDa",errorActions:"R1-FS",extensionTooltip:"Ad-Os"};var e=y(T(),1);function dt({limit:r}){let{accessState:o}=(0,I.useContext)(et),a=(0,I.useContext)($),n=(0,I.useMemo)(()=>kt({accessState:o,env:a,limit:r}),[o,a,r]);return(0,e.jsx)(k,{iconName:n.iconName,iconMode:n.iconMode,title:n.title,children:n.message})}function kt({accessState:r,env:o,limit:a}){let n={iconName:"lock-star",iconMode:"line",title:"Upgrade to unlock additional history.",message:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p,{children:"To view more data, you must upgrade to a higher tier."}),(0,e.jsx)("div",{className:m.errorActions,children:A()})]})};if(!r&&!o)return n;switch(nt(r)){case 3:n.message=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:m.errorMessage,children:[(0,e.jsxs)(p,{children:["You have access to"," ",(0,e.jsxs)(p,{variant:v.DEFAULT_SEMIBOLD,children:[a," days"]})," ","of history on the Enterprise tier."]}),(0,e.jsx)(p,{children:"Contact us to upgrade and unlock additional history."})]}),(0,e.jsxs)("div",{className:m.errorActions,children:[(0,e.jsx)(W,{}),A(o)]})]});break;case 2:n.message=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:m.errorMessage,children:[(0,e.jsxs)(p,{children:["You have access to"," ",(0,e.jsxs)(p,{variant:v.DEFAULT_SEMIBOLD,children:[a," days"]})," ","of history on the Starter tier."]}),(0,e.jsx)(p,{children:"Contact us to upgrade and unlock additional history."})]}),(0,e.jsxs)("div",{className:m.errorActions,children:[(0,e.jsx)(W,{}),A(o)]})]});break;case 0:n.message=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(p,{children:["You have access to"," ",(0,e.jsxs)(p,{variant:v.DEFAULT_SEMIBOLD,children:[a," days"]})," ","of history on the Free tier."]}),(0,e.jsxs)("div",{className:m.errorActions,children:[(0,e.jsx)(at,{}),A(o)]})]});break;case 1:n.message=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p,{children:"Switch to your Organization account."}),(0,e.jsx)(st,{})]});break;default:break}return n}var Y={loadingState:"Jaeb7",pulse:"MTRc7",svgContainer:"Jnr2-"};var t=y(T(),1);function b({height:r="tall"}){return(0,t.jsx)("div",{className:Y.loadingState,children:(0,t.jsx)("div",{className:Y.svgContainer,children:r==="short"?bt:Rt})})}var Rt=(0,t.jsxs)("svg",{viewBox:"0 0 1156 550",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[(0,t.jsx)("rect",{width:"100%",height:"100%",fill:l.SURFACE_BG_CARD_1}),(0,t.jsxs)("g",{stroke:l.SURFACE_BG_PAGE_0,strokeWidth:"1",children:[(0,t.jsx)("line",{x1:"200",y1:"22",x2:"200",y2:"532"}),(0,t.jsx)("line",{x1:"342.33",y1:"22",x2:"342.33",y2:"532"}),(0,t.jsx)("line",{x1:"484.67",y1:"22",x2:"484.67",y2:"532"}),(0,t.jsx)("line",{x1:"627.00",y1:"22",x2:"627.00",y2:"532"}),(0,t.jsx)("line",{x1:"769.33",y1:"22",x2:"769.33",y2:"532"}),(0,t.jsx)("line",{x1:"911.67",y1:"22",x2:"911.67",y2:"532"}),(0,t.jsx)("line",{x1:"1054.00",y1:"22",x2:"1054.00",y2:"532"})]}),(0,t.jsxs)("g",{stroke:l.SURFACE_BG_PAGE_0,strokeWidth:"1",children:[(0,t.jsx)("line",{x1:"200",y1:"22.00",x2:"1132",y2:"22.00"}),(0,t.jsx)("line",{x1:"200",y1:"78.67",x2:"1132",y2:"78.67"}),(0,t.jsx)("line",{x1:"200",y1:"135.33",x2:"1132",y2:"135.33"}),(0,t.jsx)("line",{x1:"200",y1:"192.00",x2:"1132",y2:"192.00"}),(0,t.jsx)("line",{x1:"200",y1:"248.67",x2:"1132",y2:"248.67"}),(0,t.jsx)("line",{x1:"200",y1:"305.33",x2:"1132",y2:"305.33"}),(0,t.jsx)("line",{x1:"200",y1:"362.00",x2:"1132",y2:"362.00"}),(0,t.jsx)("line",{x1:"200",y1:"418.67",x2:"1132",y2:"418.67"}),(0,t.jsx)("line",{x1:"200",y1:"475.33",x2:"1132",y2:"475.33"}),(0,t.jsx)("line",{x1:"200",y1:"532.00",x2:"1132",y2:"532.00"})]}),(0,t.jsxs)("g",{fill:l.BORDERLINE_SECONDARY,children:[(0,t.jsx)("rect",{x:"1030.87",y:"16.00",width:"100",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"945.47",y:"72.67",width:"90",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"858.29",y:"129.33",width:"60",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"924.12",y:"129.33",width:"90",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"753.32",y:"186.00",width:"45",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"735.53",y:"242.67",width:"190",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"673.26",y:"299.33",width:"50",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"728.41",y:"299.33",width:"100",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"457.98",y:"356.00",width:"230",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"351.23",y:"412.67",width:"80",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"315.65",y:"469.33",width:"110",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"248.04",y:"526.00",width:"70",height:"12",rx:"6"})]}),(0,t.jsxs)("g",{fill:l.BORDERLINE_SECONDARY,children:[(0,t.jsx)("rect",{x:"32",y:"16.00",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"72.67",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"129.33",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"186.00",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"242.67",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"299.33",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"356.00",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"412.67",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"469.33",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"526.00",width:"160",height:"12",rx:"6"})]})]}),bt=(0,t.jsxs)("svg",{viewBox:"0 0 1156 150",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[(0,t.jsx)("rect",{width:"100%",height:"100%",fill:l.SURFACE_BG_CARD_1}),(0,t.jsxs)("g",{stroke:l.SURFACE_BG_PAGE_0,strokeWidth:"1",children:[(0,t.jsx)("line",{x1:"200",y1:"22",x2:"200",y2:"150"}),(0,t.jsx)("line",{x1:"342.33",y1:"22",x2:"342.33",y2:"150"}),(0,t.jsx)("line",{x1:"484.67",y1:"22",x2:"484.67",y2:"150"}),(0,t.jsx)("line",{x1:"627.00",y1:"22",x2:"627.00",y2:"150"}),(0,t.jsx)("line",{x1:"769.33",y1:"22",x2:"769.33",y2:"150"}),(0,t.jsx)("line",{x1:"911.67",y1:"22",x2:"911.67",y2:"150"}),(0,t.jsx)("line",{x1:"1054.00",y1:"22",x2:"1054.00",y2:"150"})]}),(0,t.jsxs)("g",{stroke:l.SURFACE_BG_PAGE_0,strokeWidth:"1",children:[(0,t.jsx)("line",{x1:"200",y1:"22.00",x2:"1132",y2:"22.00"}),(0,t.jsx)("line",{x1:"200",y1:"78.67",x2:"1132",y2:"78.67"}),(0,t.jsx)("line",{x1:"200",y1:"135.33",x2:"1132",y2:"135.33"})]}),(0,t.jsxs)("g",{fill:l.BORDERLINE_SECONDARY,children:[(0,t.jsx)("rect",{x:"1030.87",y:"16.00",width:"100",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"945.47",y:"72.67",width:"90",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"858.29",y:"129.33",width:"60",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"924.12",y:"129.33",width:"90",height:"12",rx:"6"})]}),(0,t.jsxs)("g",{fill:l.BORDERLINE_SECONDARY,children:[(0,t.jsx)("rect",{x:"32",y:"16.00",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"72.67",width:"160",height:"12",rx:"6"}),(0,t.jsx)("rect",{x:"32",y:"129.33",width:"160",height:"12",rx:"6"})]})]});var g={content:"_8yb9i",title:"dYN59",subtitle:"A2Gbp",dateRow:"fWBhW",observed:"ZtViV",date:"xQAEM"};var h=y(T(),1);function V({title:r,subtitle:o,startDate:a,endDate:n}){return(0,h.jsx)(R,{children:(0,h.jsxs)("div",{className:g.content,children:[(0,h.jsx)(p,{className:g.title,variant:v.DEFAULT_SEMIBOLD,children:r}),o&&(0,h.jsx)(p,{className:g.subtitle,children:o}),a&&(0,h.jsxs)("div",{className:g.dateRow,children:[(0,h.jsx)("div",{className:g.observed,children:"First Observed:"}),(0,h.jsxs)(p,{className:g.date,children:[(0,h.jsx)(B,{timestamp:a}),(0,h.jsx)(U,{variant:H.PIPE,spacing:G.SM}),(0,h.jsx)(F,{timestamp:a})]})]}),n&&(0,h.jsxs)("div",{className:g.dateRow,children:[(0,h.jsx)("div",{className:g.observed,children:"Last Observed:"}),(0,h.jsxs)(p,{className:g.date,children:[(0,h.jsx)(B,{timestamp:n}),(0,h.jsx)(U,{variant:H.PIPE,spacing:G.SM}),(0,h.jsx)(F,{timestamp:n})]})]})]})})}var X=y(T(),1);function Z({children:r,className:o}){return(0,X.jsx)(R,{children:(0,X.jsx)(p,{variant:v.SMALL,className:j(g.content,o),children:r})})}var z={DEFAULT:1,UNSELECTED:.3};var Mt=6*60*60*1e3,_t=12*60*60*1e3,Ot=24*60*60*1e3;function Pt(r){return new Intl.DateTimeFormat(r,{month:"short",day:"2-digit",timeZone:"UTC"}).format}function Bt(r){return new Intl.DateTimeFormat(r,{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC",timeZoneName:"short"}).format}function Tt(r,o){return r.toZonedDateTimeISO("UTC").until(o.toZonedDateTimeISO("UTC"),{smallestUnit:"days"}).days+1}function ut(r,o,a){let n=L(r),x=L(o),u=Pt(a);return!n||!x?u:Tt(n,x)<=4?Bt(a):u}function ft(r,o){let a=L(r),n=L(o);if(!a||!n)return;let x=a.epochMilliseconds,u=n.epochMilliseconds,D=Tt(a,n),f=[];if(D<=2){let c=x;for(;c<u;)f.push(new Date(c)),c+=Mt}else if(D<=4){let c=x;for(;c<u;)f.push(new Date(c)),c+=_t}else if(D<=14){let c=x;for(;c<u;)f.push(new Date(c)),c+=Ot}else{let c=(u-x)/13;for(let S=0;S<13;S++){let N=x+c*S;f.push(new Date(N))}}return f}function Et(r,o){return o?{host:r.host.map(a=>({...a,opacity:a.name===o?z.DEFAULT:z.UNSELECTED}))}:r}var i=y(T(),1),Ft=[ot.VIZ1];function Ht({timelineData:r,historicalRangesStart:o,historicalRangesEnd:a,colors:n=Ft,isLoading:x=!1,loadingHeight:u="tall",historicalRangeLimit:D,onTimelineClick:f,selectedEntryName:c=null,error:S}){let N=(0,d.useRef)(null),J=tt(),M=!!f,_=(0,d.useMemo)(()=>Et(r,c),[r,c]),Q=(0,d.useMemo)(()=>ct(_),[_]),w=(0,d.useMemo)(()=>{let s=L(a)||Temporal.Now.instant(),E=it(s),C=Temporal.Now.instant();return Temporal.Instant.compare(E,C)===1&&(E=C),E.toString()},[a]),St=(0,d.useMemo)(()=>ut(o,w,J),[o,w,J]),vt=(0,d.useMemo)(()=>ft(o,w),[o,w]),Lt=rt(),Dt=(0,d.useMemo)(()=>Q.map(s=>{let E=gt(s.name,30,!0),Nt=(M&&c?s.name===c:!0)?1:.3;return{name:s.name,displayName:E,subtitle:s.subtitle,opacity:Nt}}),[Q,M,c]),wt=(0,d.useMemo)(()=>{let s=r?.host||[],E=new Set(s.map(C=>C.name));return Math.max(E.size*40,120)},[r]),Ct=(0,d.useCallback)(s=>{!s||!M||f?.(s)},[f]),At=!r.host||r.host.length===0,It=!!S?.entitlement,q=!!S?.filter;return x||!Lt?(0,i.jsx)("div",{className:m.loadingState,children:(0,i.jsx)(b,{height:u})}):It?(0,i.jsx)("div",{className:m.entitlementState,children:(0,i.jsx)(dt,{limit:D})}):At?(0,i.jsxs)(i.Fragment,{children:[q?(0,i.jsx)("div",{className:m.filterMessage,children:(0,i.jsx)(P,{variant:O.CAUTION,children:S.filter})}):null,(0,i.jsx)("div",{className:m.emptyState,children:(0,i.jsx)(k,{iconName:"bar-chart-horizontal",iconMode:"fill",title:"There are no results to display",children:"Try adjusting your filters and try again."})})]}):(0,i.jsxs)(i.Fragment,{children:[q?(0,i.jsx)("div",{className:m.filterMessage,children:(0,i.jsx)(P,{variant:O.CAUTION,children:S.filter})}):null,(0,i.jsx)("div",{className:m.historicalTimeline,children:(0,i.jsx)(lt,{onClick:Ct,children:(0,i.jsxs)("div",{ref:N,style:{height:wt},children:[(0,i.jsxs)(pt,{ref:N,data:_,colors:n,lineThickness:10,axis:{bottom:{showGridLines:!0,strokeWidth:.5,strokeDasharray:"3,3",textAnchor:"start",tickFontSize:12,strokeColor:l.TEXT_DISABLED,tickColor:l.TEXT_PRIMARY,tickFormat:St,tickValues:vt}},startDate:o,endDate:w,margin:{top:20,right:20,bottom:40,left:200},border:{right:{strokeColor:l.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"},left:{strokeColor:l.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"},bottom:{strokeColor:l.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"},top:{strokeColor:l.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"}},children:[(0,i.jsx)(yt,{range:Dt,strokeColor:l.BORDERLINE_SECONDARY,textColor:l.TEXT_PRIMARY,selectedColor:l.FEEDBACK_INFO_HOVER}),(0,i.jsx)(ht,{render:({x:s,height:E})=>(0,i.jsx)("line",{x1:s,x2:s,y1:0,y2:E,stroke:l.TEXT_PLACEHOLDER,strokeDasharray:"3,3"})})]}),(0,i.jsx)(mt,{render:({data:s})=>s?s.tooltipString?(0,i.jsx)(Z,{children:s.tooltipString}):s.type==="extension"?(0,i.jsx)(Z,{className:m.extensionTooltip,children:"Estimated range. History data is updated periodically."}):(0,i.jsx)(V,{title:s.name,subtitle:s.subtitle,startDate:s.startDate,endDate:s.endDate}):(0,i.jsx)(i.Fragment,{}),offsetY:10})]})})})]})}export{b as a,Ht as b};
