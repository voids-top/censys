import{a as We,b as ze}from"/censys/build/_shared/chunk-6HSN5L3Z.js";import{a as Qe}from"/censys/build/_shared/chunk-OOWGGRVL.js";import{a as Ve}from"/censys/build/_shared/chunk-YPQMKHAL.js";import{a as P}from"/censys/build/_shared/chunk-Y3T57EQU.js";import{a as qe}from"/censys/build/_shared/chunk-4NXR4FZK.js";import{b as $}from"/censys/build/_shared/chunk-H7Q3B5O5.js";import{a as He}from"/censys/build/_shared/chunk-WW7MKZVD.js";import{b as we}from"/censys/build/_shared/chunk-RLL7RAJO.js";import{b as xe}from"/censys/build/_shared/chunk-BXMBML5J.js";import{j as ve}from"/censys/build/_shared/chunk-B5UNN2SO.js";import{b as Le}from"/censys/build/_shared/chunk-EMHGEENV.js";import{b as De,c as z,d as ke}from"/censys/build/_shared/chunk-IRHQADG7.js";import{d as Pe,e as Ue}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{a as I}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{b as k}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{e as D,h as Me,j as Re}from"/censys/build/_shared/chunk-ST66DGSY.js";import{a as N}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{$ as ge,A as t,B as he,E as Oe,F as fe,G as ye,W as Ne,X as Ie,Xa as Se,Y as be,Z as _e,ab as F,bb as le,fb as Ae,hb as Fe,x as Te,y as v,z as S}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as ue}from"/censys/build/_shared/chunk-44DVAK2X.js";import{C as Ee,p as pe,q as Ce}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as c}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as X}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as i}from"/censys/build/_shared/chunk-2TWE7TSA.js";var T=i(X(),1);var J=i(X(),1);var U=i(c(),1);function Ye({collectionMaxSize:e}){return(0,U.jsx)(P,{title:"Collection Details",iconName:"collections",children:(0,U.jsxs)(t,{children:["Monitor your search queries with Collections to get continuous updates on new results and track changes. Collections can hold up to"," ",(0,U.jsx)($,{value:e})," results. Learn how to"," ",(0,U.jsx)(I,{href:"https://docs.censys.com/docs/platform-collections#/",isExternal:!0,children:"use and create collections"}),"."]})})}var K={container:"_2OcIe",header:"JpMny",description:"oTAxI",collectionQuery:"ScCAi",sizeEstimator:"tcxjG"};var E={COLLECTION_NAME:"collectionName",COLLECTION_DESCRIPTION:"collectionDescription",COLLECTION_QUERY:"q",COLLECTION_CATEGORY:"collectionCategory",COLLECTION_ID:"collectionId",SHARED_WITH_ORG:"sharedWithOrg",EMAIL_ALERT_ENABLED:"emailAlertEnabled"},Be="Enter valid query here...",Ge="Enter valid query or use natural language...",o={ESTIMATE_COLLECTION_SIZE:{QUERY_FIELD_NAME:"query",QUERY_FIELD_SCHEMA:N.string({error:e=>e.input===void 0?"A query is required":void 0}).min(1,{error:"A query is required"})},COLLECTION_FORM:{NAMES:E,SCHEMAS:{[E.COLLECTION_NAME]:N.string({error:e=>e.input===void 0?"A collection name is required.":void 0}).min(1,{error:"A collection name is required."}).max(100,{error:"Collection name must be less than 100 characters."}),[E.COLLECTION_DESCRIPTION]:N.string().max(500,{error:"Collection description must be less than 500 characters."}),[E.COLLECTION_QUERY]:N.string({error:e=>e.input===void 0?"A collection query is required.":void 0}).min(1,{error:"A collection query is required."}),[E.COLLECTION_CATEGORY]:N.string({error:e=>e.input===void 0?"A collection category is required.":void 0}).min(1,{error:"A collection category is required."}),[E.COLLECTION_ID]:N.optional(N.string()),[E.SHARED_WITH_ORG]:N.enum(["on","off"]).optional(),[E.EMAIL_ALERT_ENABLED]:N.enum(["true","false"]).optional()},INITIAL_VALUES:{[E.COLLECTION_NAME]:"",[E.COLLECTION_DESCRIPTION]:"",[E.COLLECTION_QUERY]:"",[E.COLLECTION_CATEGORY]:"",[E.SHARED_WITH_ORG]:"off",[E.EMAIL_ALERT_ENABLED]:"true"}}};var n=i(c(),1),mo=We.map(e=>({label:ke(e),value:e})),j=({onBlur:e,onChange:l,onValueChange:p,errors:r,fieldValues:a,queryProps:y,collectionMaxSize:L})=>{let _=Re(),{initialQuery:g,collectionEstimatedSize:s,collectionEstimatedSizeError:h,collectionEstimatedSizeLoading:Q,handleEstimateQuerySize:V,handleQueryChange:Y,handleIsQueryValid:B}=y,ae=(0,J.useCallback)(O=>{p(o.COLLECTION_FORM.NAMES.COLLECTION_CATEGORY,O)},[p]),G=(0,J.useCallback)(O=>{Y(O.target.value)},[Y]),Z=(0,J.useCallback)(()=>{V(a.q)},[V,a.q]),R=r.q||h,x=Q?"One moment while we estimate the query size...":s!==null?(0,n.jsxs)("span",{"aria-live":"polite",children:["Accepted. Size estimator of results:"," ",(0,n.jsx)($,{value:s})]}):void 0;return(0,n.jsxs)("div",{className:K.container,"data-testid":"collection-details",children:[(0,n.jsx)(Ye,{collectionMaxSize:L}),(0,n.jsx)(F,{label:"Collection Name",labelFor:"collection-name",errorText:r.collectionName,required:!0,children:(0,n.jsx)(Oe,{name:o.COLLECTION_FORM.NAMES.COLLECTION_NAME,value:a.collectionName,isValid:!r.collectionName,id:"collection-name",type:"text",isFullWidth:!0,onBlur:e,onChange:l,autoComplete:"off",placeholder:"Enter collection name here...","data-testid":"collection-name-input"})}),(0,n.jsx)(F,{label:"Collection Category",labelFor:"collection-category",description:"Add more context for your team to understand what kind of collection you are monitoring.",errorText:r.collectionCategory,required:!0,children:(0,n.jsx)(ye,{defaultValue:a.collectionCategory,name:o.COLLECTION_FORM.NAMES.COLLECTION_CATEGORY,options:mo,onValueChange:ae,"data-testid":"collection-category-select"})}),(0,n.jsx)(F,{label:"Collection Query",labelFor:"collection-query",required:!0,hintText:x,errorText:!x&&R&&(0,n.jsx)("span",{"aria-live":"polite",children:R}),children:(0,n.jsx)("div",{className:K.collectionQuery,children:(0,n.jsx)(ve,{id:"collection-query",name:o.COLLECTION_FORM.NAMES.COLLECTION_QUERY,inputLabel:"Collection Query",initialValue:g,placeholder:_?Ge:Be,onChange:G,rightContainerSlot:({query:O,isValid:re})=>(0,n.jsx)(ge,{type:"button",variant:he.TERTIARY,className:K.sizeEstimator,isLoading:Q,disabled:!!R||!O||!re,onClick:Z,children:ze.SIZE_ESTIMATOR}),onIsValidChange:B})})}),(0,n.jsx)(F,{label:"Description",labelFor:"collection-description",description:"Note: In lieu of a description, the query syntax will be used.",errorText:r.collectionDescription,children:(0,n.jsx)(fe,{name:o.COLLECTION_FORM.NAMES.COLLECTION_DESCRIPTION,id:"collection-description",isValid:!r.collectionDescription,isFullWidth:!0,onBlur:e,onChange:l,value:a.collectionDescription,placeholder:"Optional text to provide context describing your collection.","data-testid":"collection-description-input"})})]})};var Ze=i(X(),1);var ee={container:"_7OzZN",sharedCollectionContainer:"a4WzL",sharedCollectionLabel:"kV3-a"};var m=i(c(),1),oe=({onValueChange:e,fieldValues:l,hasSharingCapability:p,currentPlan:r})=>{let a=k("ACCOUNTS_SITE_URL"),y=(0,Ze.useContext)(ue),L=Ue(y),_=r==="Free"?`${a}/settings/billing/plan`:L,g=r==="Enterprise"?"Collections can be shared with members of your organization. They cannot be shared with users outside of your organization.":"Collections that belong to Free or Starter users cannot be shared. Enterprise users can share collections with other users in their organization.";return(0,m.jsxs)("div",{className:ee.container,"data-testid":"collection-collaborators",children:[(0,m.jsx)(P,{title:"Collaborators (Optional)",iconName:"collaborators",children:(0,m.jsx)(t,{children:g})}),p?(0,m.jsx)(F,{children:(0,m.jsxs)(Ae,{"data-testid":"collection-collaborators-radio-buttons",name:o.COLLECTION_FORM.NAMES.SHARED_WITH_ORG,value:l[o.COLLECTION_FORM.NAMES.SHARED_WITH_ORG],"aria-label":o.COLLECTION_FORM.NAMES.SHARED_WITH_ORG,onValueChange:s=>{e(o.COLLECTION_FORM.NAMES.SHARED_WITH_ORG,s)},children:[(0,m.jsx)(le,{label:"My Collection (Default, private)",value:"off","aria-label":"My Collection"},"my-collection"),(0,m.jsx)("div",{className:ee.sharedCollectionContainer,children:(0,m.jsx)(le,{label:(0,m.jsxs)("div",{className:Te(ee.sharedCollectionLabel),children:[(0,m.jsx)("span",{children:"Shared Collection"}),(0,m.jsx)(v,{"aria-hidden":!0,name:"group",mode:"line",size:"xl"})]}),value:"on","aria-label":"Shared Collection"},"shared-with-org")})]})}):(0,m.jsxs)(t,{children:[(0,m.jsx)(I,{href:_,isExternal:!0,children:"Upgrade your plan"})," ","to share collections."]})]})};var te=i(X(),1);var f={container:"UhZDW",alertsSection:"_6Duur",label:"U5-gN",alerts:"zwQep",bold:"UCWzv",webhookConfigured:"-uDTV",webhookLink:"V1Mrf",linkContent:"_85yq8",emailPreferencesContainer:"Li2Df",emailPreferencesContent:"Y3wAD"};var A=i(c(),1),Xe=({collection:e,onEmailSettingChange:l})=>{let r=D()?.email,a=Ee(),y=Le(),[L,_]=(0,te.useState)(e?.email_alert_enabled??!0),g=(0,te.useCallback)(s=>{if(_(s),e?.collection_id){let h=new FormData;h.append(z.COLLECTION_ID,e.collection_id),h.append(z.EMAIL_ALERT_ENABLED,s.toString()),h.append(z.FETCHER_KEY,De),h.append(z.CSRF,y),a.submit(h,{method:"post"})}else l&&l(s.toString())},[e?.collection_id,a,l,y]);return(0,A.jsxs)("div",{className:f.emailPreferencesContainer,children:[(0,A.jsx)(t,{variant:S.H3,children:"Email Preferences"}),(0,A.jsxs)("div",{className:f.emailPreferencesContent,children:[(0,A.jsxs)(t,{children:["All digest emails are sent to:"," ",(0,A.jsx)(t,{variant:S.DEFAULT_SEMIBOLD,children:r}),"."]}),(0,A.jsx)(Fe,{name:o.COLLECTION_FORM.NAMES.EMAIL_ALERT_ENABLED,labelPosition:"right",label:"Weekly Collections Digest",checked:L,onCheckedChange:g})]})]})};var u=i(c(),1);function $e({hasWebhookCapability:e,isFreePlan:l,webhook:p}){let r=k("ACCOUNTS_SITE_URL"),a=p&&qe(p.name);return(0,u.jsxs)("div",{className:f.alertsSection,children:[(0,u.jsx)(t,{variant:S.H3,children:"Webhooks"}),e&&(0,u.jsxs)(t,{"data-testid":"collection-notifications-manage-webhooks",children:["Manage your webhooks in"," ",(0,u.jsxs)(I,{size:"md",href:"/settings/webhooks",className:f.bold,children:["Settings ",">"," Alerts & Notifications ",">"," Webhooks"]}),"."]}),e&&a&&(0,u.jsxs)("div",{"data-testid":"collection-notifications-webhook-configured",className:f.webhookConfigured,children:[(0,u.jsx)(t,{children:"Webhook applied to this Collection:"}),(0,u.jsx)(I,{size:"md",href:`/settings/webhooks/${a}`,isExternal:!0,className:f.webhookLink,children:(0,u.jsxs)("div",{className:f.linkContent,children:[(0,u.jsx)(v,{name:"webhook",mode:"line",size:"lg"}),p.display_name||"Unnamed Webhook"]})})]}),!l&&!e&&(0,u.jsx)(t,{"data-testid":"collection-notifications-non-admin",children:"You do not have access. Contact your admin to set up webhooks."}),l&&(0,u.jsxs)(t,{"data-testid":"collection-notifications-free-plan",children:["Ready to create webhooks?"," ",(0,u.jsx)(I,{size:"md",href:`${r}/settings/plan`,isExternal:!0,children:"Upgrade"})," ","to a Starter account."]})]})}var b=i(c(),1);function ie({collection:e,hasWebhookCapability:l,isFreePlan:p,webhook:r,onEmailSettingChange:a}){let y=k("SUPPORT_SITE_URL"),L=D(),_=Me("collection-emails"),g=L?.userId===e?.created_by,s=_&&(!e||g),h=s?(0,b.jsxs)(t,{children:["Choose the best channel to monitor collection changes and automate your workflows. Customize your"," ",(0,b.jsx)(I,{href:`${y}/docs/platform-collection-emails#/`,isExternal:!0,className:f.bold,children:"email preferences"})," ","to receive convenient daily or weekly digests. You can also set up"," ",(0,b.jsx)(t,{variant:S.DEFAULT_SEMIBOLD,children:"webhooks"})," ","to receive instant, automated updates that integrate directly with external systems like ticketing or SOAR tools."]}):(0,b.jsx)(t,{children:"Use webhooks to receive automated updates whenever assets are added to or removed from your collections. This lets you send Censys data directly to other applications so you can monitor events and automate workflows."});return(0,b.jsxs)("div",{className:f.container,children:[(0,b.jsx)(P,{title:"Notifications (Optional)",iconName:"notifications",children:h}),s&&(0,b.jsx)(Xe,{collection:e,onEmailSettingChange:a}),(0,b.jsx)($e,{hasWebhookCapability:l,isFreePlan:p,webhook:r})]})}var Ke={title:"LZ4Gk",shared:"GDqUp"};var q=i(c(),1),se=({collection:e})=>e?(0,q.jsxs)("div",{className:Ke.title,children:[(0,q.jsxs)(t,{variant:S.H2,children:["Update ",e.name]}),(0,q.jsx)(Qe,{collection:e})]}):"Create New Collection";var M={tab:"_8DeC6",tabContent:"_6RUBM",tooltip:"xNcsN",lockIcon:"_6lt-0",tabFiller:"U0f8L"};var d=i(c(),1),Co=({existingCollection:e,formKey:l,hasSharingCapability:p,hasWebhookCapability:r,...a})=>{let[y,L]=(0,T.useState)(),_=Ce(),{isLoading:g,errorMessage:s,status:h}=we(l),[Q,V]=(0,T.useState)(!1),Y=Pe(),B=D(),ae=B?.currentPlanType==="Free",[G]=pe(),Z=G.get("query")||e?.query||o.COLLECTION_FORM.INITIAL_VALUES.q;(0,T.useEffect)(()=>{L(s)},[s]);let{handleBlur:R,handleChange:x,handleValueChange:O,handleSubmit:re,isValid:Je,isDirty:je,formState:H}=xe(o.COLLECTION_FORM.SCHEMAS,{[o.COLLECTION_FORM.NAMES.COLLECTION_CATEGORY]:e?.category||o.COLLECTION_FORM.INITIAL_VALUES.collectionCategory,[o.COLLECTION_FORM.NAMES.COLLECTION_DESCRIPTION]:e?.description||o.COLLECTION_FORM.INITIAL_VALUES.collectionDescription,[o.COLLECTION_FORM.NAMES.COLLECTION_NAME]:e?.name||o.COLLECTION_FORM.INITIAL_VALUES.collectionName,[o.COLLECTION_FORM.NAMES.COLLECTION_QUERY]:Z,[o.COLLECTION_FORM.NAMES.COLLECTION_ID]:e?.collection_id||"",[o.COLLECTION_FORM.NAMES.SHARED_WITH_ORG]:e?.shared_with_org?"on":"off",[o.COLLECTION_FORM.NAMES.EMAIL_ALERT_ENABLED]:e?.email_alert_enabled?.toString()||o.COLLECTION_FORM.INITIAL_VALUES.emailAlertEnabled},l,_),{clear:ce,handleEstimateCollectionSize:me,size:eo,errorMessage:de,loading:oo}=Ve(),to=(0,T.useCallback)(C=>{L(void 0),me(C)},[me]),io=(0,T.useCallback)(C=>{ce(),L(void 0),O(o.COLLECTION_FORM.NAMES.COLLECTION_QUERY,C)},[ce,O]);(0,T.useEffect)(()=>{h==="HAS_SUCCESS"&&Y("/collections")},[h]),(0,T.useEffect)(()=>{L(s)},[s]);let ao=Je&&Q&&!!H.values.q&&!y&&!de,w=(0,T.useMemo)(()=>[{id:"details",label:"Collection Details",component:(0,d.jsx)(j,{...a,onBlur:R,onChange:x,onValueChange:O,errors:H.errors,fieldValues:H.values,queryProps:{initialQuery:Z,collectionEstimatedSize:eo,collectionEstimatedSizeError:de,collectionEstimatedSizeLoading:oo,handleEstimateQuerySize:to,handleQueryChange:io,handleIsQueryValid:V}})},{id:"collaborators",label:"Collaborators",isLocked:!p,lockedMessage:"Upgrade to unlock",component:(0,d.jsx)(oe,{hasSharingCapability:p,currentPlan:B?.currentPlanType,fieldValues:H.values,onValueChange:O})},{id:"notifications",label:"Notifications",component:(0,d.jsx)(ie,{hasWebhookCapability:r,isFreePlan:ae,webhook:e?.webhook,collection:e,onEmailSettingChange:W=>O(o.COLLECTION_FORM.NAMES.EMAIL_ALERT_ENABLED,W)})}],[a,H.errors,R,x,O,e]),ne=G.get("tab"),ro=ne&&w.some(C=>C.id===ne)?ne:w[0].id,[no,lo]=(0,T.useState)(ro);return(0,d.jsxs)(He,{cancelFallbackUrl:"/collections",onSubmit:C=>{L(void 0),re(C)},errorMessage:y,title:(0,d.jsx)(se,{collection:e}),submitButtonTextLoading:e?"Saving...":"Creating...",submitButtonText:e?"Save":"Create New Collection",submitButtonIcon:e?void 0:"add",isLoading:g,isDirty:je,isValid:ao,children:[e?.collection_id&&(0,d.jsx)("input",{type:"hidden",name:o.COLLECTION_FORM.NAMES.COLLECTION_ID}),(0,d.jsxs)(Ne,{orientation:"vertical",value:no||w[0].id,onValueChange:lo,children:[(0,d.jsxs)(Ie,{className:M.tabs,children:[w.map(({id:C,label:W,isLocked:so,lockedMessage:co})=>(0,d.jsxs)(be,{value:C,className:M.tab,children:[W," ",so&&(0,d.jsx)(Se,{content:co,side:"right",triggerClassName:M.tooltip,children:(0,d.jsx)(v,{"aria-hidden":!0,name:"lock-star",mode:"line",size:"md",className:M.lockIcon})})]},C)),(0,d.jsx)("div",{className:M.tabFiller})]}),w.map(({id:C,component:W})=>(0,d.jsx)(_e,{value:C,className:M.tabContent,children:W},C))]})]})};export{Co as a};
