import{a as oe,i as ae,j as ie,l as k,m as ne}from"/censys/build/_shared/chunk-LAGC572J.js";import{b}from"/censys/build/_shared/chunk-AARCMGAD.js";import{a as se}from"/censys/build/_shared/chunk-NAHO4RKJ.js";import{b as te,e as re}from"/censys/build/_shared/chunk-DXLA43JS.js";import{c as ee}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as j,d as g}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{a as X,b as Y}from"/censys/build/_shared/chunk-SZRPTSUZ.js";import{a as q}from"/censys/build/_shared/chunk-AEM63NKL.js";import{c as G,d as K,i as Q,k as Z}from"/censys/build/_shared/chunk-IO4OV3HV.js";import{a as w}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as J}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{a as W}from"/censys/build/_shared/chunk-M5RKE22T.js";import{f as z}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{A as v,da as I,ua as B,wa as O,xa as F,z as D}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as u}from"/censys/build/_shared/chunk-F5K75D4K.js";import{g as $}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as p}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as V}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as m}from"/censys/build/_shared/chunk-2TWE7TSA.js";var C=m(V(),1);var A=m(V(),1);var H={container:"nphuy",ip:"apoUv",cardHeaderContent:"_5xwlU",noMargin:"YdqcL",dnsText:"YBVJJ"};var l=m(p(),1);function R({historyLimitDays:e,hit:t,baseURL:r}){let{ip:o,dns:a}=t,n=k(),c=(0,A.useMemo)(()=>{let f=G(t);return!f||Z(f,e)?void 0:f},[e,t]),d=(0,A.useMemo)(()=>`${r}${c?`?at_time=${encodeURIComponent(ne(c))}`:""}`,[r,c]),{t:h}=u(),{iconName:y,description:T}=(0,A.useMemo)(()=>Y(t.hardware),[t]);return(0,l.jsxs)("div",{className:H.container,children:[(0,l.jsx)(X,{assetType:"host",size:"md",iconName:y,description:T}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:H.cardHeaderContent,children:[(0,l.jsx)(J,{state:n,href:d,title:h("View Details",{displayName:o}),variant:"nav",size:"lg",children:(0,l.jsx)("div",{className:H.ip,children:o})}),(0,l.jsx)(W,{variant:"dot"}),(0,l.jsx)(v,{className:H.noMargin,variant:D.H5,children:h("Host")})]}),a?.reverse_dns?.names&&a.reverse_dns.names.length>0&&(0,l.jsx)(v,{className:H.dnsText,children:a?.reverse_dns?.names[0]})]})]})}var ce={locationValue:"KUSQD"};var i=m(p(),1);function _({location:e,autonomous_system:t,operating_system:r,hardware:o}){let{t:a}=u(),n=o?b(o,!0):null,c=r?b(r,!0):null,d=t?(0,i.jsx)(Te,{asn:t}):null,h=e?(0,i.jsx)(Le,{location:e}):null;return(0,i.jsx)("div",{children:(0,i.jsxs)(j,{children:[n?(0,i.jsx)(g,{label:a("Hardware"),content:n}):null,c?(0,i.jsx)(g,{label:a("OS"),content:c}):null,d?(0,i.jsx)(g,{label:a("Network (AS)"),content:d}):null,h?(0,i.jsx)(g,{label:a("Location"),content:(0,i.jsxs)("span",{className:ce.locationValue,children:[h,e?.country_code&&(0,i.jsx)(q,{size:"sm",countryCode:e.country_code})]})}):null]})})}function Te({asn:e}){return!e.name||!e.asn?null:(0,i.jsxs)(v,{children:[e.name," (",e.asn,")"]})}function Le({location:e}){let t=e?.province?.toLowerCase()===e?.city?.toLowerCase();return(0,i.jsxs)(v,{children:[e.city,!t&&e.province?", ":" ",!t&&e.province?`${e.province} `:"","(",e.country_code?.toUpperCase(),")"]})}var x=m(p(),1);function E({hit:{service_count:e,services:t=[]},baseURL:r,shouldShowCves:o,shouldShowThreats:a}){let{t:n}=u(),c=I(e||t.length);return c?(0,x.jsx)(ae,{title:`${n("Services")} (${c})`,children:(0,x.jsx)(oe,{services:t,baseURL:r,shouldShowCves:o,shouldShowThreats:a,maxVisibleServices:20})}):null}var le=m(V(),1);function me(e,t){if(!t)return[];let r=new Map;for(let o of t)if(o.software?.length)for(let a of o.software){let n=b(a,!0);if(!n)continue;let c=`${e}#${K(o)}`,d={label:n,href:c};r.has(n)||r.set(n,d)}return Array.from(r.values())}var pe=m(p(),1);function P({hit:e,baseURL:t}){let{t:r}=u(),o=(0,le.useMemo)(()=>me(t,e.services),[t,e.services]);return o.length?(0,pe.jsx)(ie,{title:r("Software"),tags:o,maxVisibleTags:10}):null}var S={cardBody:"HeEGH",cardBodyContent:"_9VJbz",tagsLists:"_9hmIa",screenshots:"t5I5o",labelOverview:"nEiB1"};function de(e){return Array.from(new Set([...e.labels.map(t=>t.value).filter(w),...e.services.flatMap(t=>t.labels).map(t=>t.value).filter(w)])).sort()}function fe(e){return Array.from(new Set(e.services.flatMap(t=>t.threats).map(t=>t.name).filter(w))).sort()}var s=m(p(),1);function Ce({collectionIdParam:e="id",historyLimitDays:t,hit:r,children:o,screenshots:a}){let[n,c,d]=z([5,19,11]),h=c||d,y=!!n,T=!!h,f=$(),L=f[e]?`/collections/${f[e]}/hosts/${r.ip}`:`/hosts/${r.ip}`,ue=f[e]?`/collections/${f[e]}/results`:"/censys",he=k(),M=(0,C.useMemo)(()=>Q(r),[r]),Se=(0,C.useMemo)(()=>re(r.services.flatMap(He=>He.vulns)),[r]),U=(0,C.useMemo)(()=>de(r),[r]),N=(0,C.useMemo)(()=>fe(r),[r]),ve=y&&M>0||T&&N?.length>0||U.length>0;return(0,s.jsx)("div",{className:S.cardOuterContainer,"data-testid":"hostDetailsCard",children:(0,s.jsxs)(F,{variant:B.INTERACTIVE,header:(0,s.jsx)(R,{hit:r,baseURL:L,historyLimitDays:t}),headerPadding:O.NONE,children:[(0,s.jsxs)("div",{className:S.cardBody,children:[ve?(0,s.jsxs)("div",{className:S.labelOverview,children:[T&&N?.length>0&&(0,s.jsx)(ee,{baseURL:`${L}/threats`,threats:N}),y&&M>0&&(0,s.jsx)(te,{count:M,severity:Se,state:he,to:`${L}/cves`}),(0,s.jsx)(se,{baseURL:ue,labels:U,resourceType:"host"})]}):null,(0,s.jsxs)("div",{className:S.cardBodyContent,children:[(0,s.jsx)(_,{...r}),(0,s.jsxs)("div",{className:S.tagsLists,children:[(0,s.jsx)(E,{hit:r,baseURL:`${L}?isCollapsed=true`,shouldShowCves:y,shouldShowThreats:T}),(0,s.jsx)(P,{hit:r,baseURL:`${L}?isCollapsed=true`})]}),(0,s.jsx)("div",{className:S.screenshots,children:a})]})]}),o]})})}export{Ce as a};
