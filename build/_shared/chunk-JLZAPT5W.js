import{a as o}from"/censys/build/_shared/chunk-WK35ORSL.js";import{d as n}from"/censys/build/_shared/chunk-KMD3IRPL.js";var T=(i=>(i.CHROME="chrome",i.EDGE="edge",i.FIREFOX="firefox",i.SAFARI="safari",i))(T||{});function H(t,r){return t?.subject?.common_name&&t.subject.common_name.length>0?t.subject.common_name[0]:t?.subject_dn?t?.subject_dn:r}function I(t,r,s,e){if(r===n.Certificate_CertificateType.LEAF){if(t)return"Self-Signed";if(s)return"Trusted";if(e)return"Previously Trusted"}else if(r===n.Certificate_CertificateType.INTERMEDIATE){if(s)return"Trusted Intermediate";if(e)return"Historical Intermediate"}else if(r===n.Certificate_CertificateType.ROOT){if(s)return"Trusted Root";if(e)return"Historical Root"}else if(r===n.Certificate_CertificateType.UNKNOWN&&t)return"Self-Signed";return"Untrusted"}var _=new Set(["Trusted","Trusted Intermediate","Trusted Root"]);function u(t,r,s,e){let i=I(t,r,s,e);return{status:i,isTrusted:_.has(i)}}var U=/^[a-fA-F0-9]{64}$/;function p(t){return typeof t!="string"?!1:U.test(t)}function S(t){let r=t instanceof Date?t:new Date(t);return Date.now()>r.getTime()}var c=t=>t.replace(/(..)(?=..)/g,"$1:\u200B");function m(t){if(t.length===0)return;let r=t.flatMap(e=>{let i=e?.parsed?.signature?.self_signed;return[e?.validation?.chrome,e?.validation?.microsoft,e?.validation?.nss,e?.validation?.apple].filter(o).map(a=>{let E=a.type,l=a.is_valid,d=a.ever_valid,{isTrusted:g,status:D}=u(i,E,l,d);return{isTrusted:g,status:D}})}),s=r.find(({status:e})=>e!=="Trusted")?.status||"Trusted";return{aggregatedStatus:r.every(e=>e.isTrusted)?"All Trusted":r.some(e=>e.isTrusted)?"Partially Trusted":"No Trust",isTrusted:r.every(e=>e.isTrusted),status:s}}export{T as a,H as b,u as c,p as d,S as e,c as f,m as g};
