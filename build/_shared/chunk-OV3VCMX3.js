import{a as p}from"/censys/build/_shared/chunk-WK35ORSL.js";import{u as a,v as i,x as l}from"/censys/build/_shared/chunk-VQ4M4AGG.js";function w(e,t){let o=e.reduce((n,r)=>{let c=u(r,t),s={confidence:r.confidence||0,label:c,cpe:r.cpe,product:r.product,vendor:r.vendor},d=n.get(r.product);return(!d||s.confidence>d.confidence)&&n.set(r.product,s),n},new Map);return Array.from(o.values())}function u(e,t){let o=t?e.vendor.trim():"",n=e.product.trim(),r=e.version.trim();return[!(o&&n.toLowerCase().startsWith(o.toLowerCase()))&&o?o:"",n,r].filter(p).join(" ").replaceAll("_"," ").replaceAll(/\b\w/g,d=>d.toUpperCase())}function y(e,t,o){return o&&e.cpe?i({kind:0,field:`${t}.cpe`,value:e.cpe}):e.vendor&&!e.product?i(a({kind:0,field:`${t}.vendor`,value:e.vendor})):e.product&&!e.vendor?i(a({kind:0,field:`${t}.product`,value:e.product})):i({kind:5,field:t,content:l(a({kind:0,field:"vendor",value:e.vendor}),a({kind:0,field:"product",value:e.product}),"and",!1)})}export{w as a,u as b,y as c};
