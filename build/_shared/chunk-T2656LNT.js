import{a as ve}from"/censys/build/_shared/chunk-5UXD3MLV.js";import{a as Te}from"/censys/build/_shared/chunk-BJQIOMMT.js";import{a as fe,b as ye}from"/censys/build/_shared/chunk-GKHDVOYG.js";import{b as ue}from"/censys/build/_shared/chunk-NYMTOB6M.js";import{d as he}from"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as de,d as _}from"/censys/build/_shared/chunk-53UREJP4.js";import{a as ce}from"/censys/build/_shared/chunk-IJLDI467.js";import{a as le}from"/censys/build/_shared/chunk-437XWWKH.js";import{c as M}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as R}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{k as me,l as pe}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import{a as W}from"/censys/build/_shared/chunk-EZHABQF2.js";import{f as G}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{b as oe}from"/censys/build/_shared/chunk-HNL4CPAB.js";import{h as O}from"/censys/build/_shared/chunk-D5QEORL2.js";import{A as se,u as Q,v as ie,x as ne}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{A as n,B as E,Ca as te,Ha as V,_ as Z,aa as K,da as j,nb as re,ta as J,va as ee,wa as ae,y as U,z as d}from"/censys/build/_shared/chunk-GALQBYYN.js";import{p as w}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as F,c as f}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as c}from"/censys/build/_shared/chunk-2QEWK57A.js";var L=c(F(),1);var S=c(F(),1);var y={threatDetailTable:"sK0vZ",nameListContent:"ifkRC",rowLabel:"xyOlM",primaryName:"xG-AY",altNames:"lGjmH"};var i=c(f(),1);function we({threat:e}){let o=(0,S.useMemo)(()=>{let t=e.malware?.primary_name??"",l=e.malware?.all_names?.filter(v=>v!==t)??[];return{primaryName:t,altNames:l}},[e.malware]),r=(0,S.useMemo)(()=>e.actors.map(t=>({primaryName:t.primary_name??"",altNames:t.all_names?.filter(l=>l!==t.primary_name)??[]})),[e.actors]);return(0,i.jsxs)(de,{className:y.threatDetailTable,children:[o.primaryName&&(0,i.jsx)(_,{label:(0,i.jsx)(k,{children:R("Name",o.altNames.length)}),content:(0,i.jsxs)("div",{className:y.nameListContent,children:[(0,i.jsx)(n,{className:y.primaryName,children:o.primaryName}),o.altNames.length>0&&(0,i.jsxs)(n,{className:y.altNames,variant:d.SMALL,children:["(aka ",o.altNames.join(", "),")"]})]})}),e.type&&(0,i.jsx)(_,{label:(0,i.jsx)(k,{children:R("Type",e.type.length)}),content:e.type.map(ge).join(", ")}),e.tactic&&(0,i.jsx)(_,{label:(0,i.jsx)(k,{children:R("Tactic",e.tactic.length)}),content:e.tactic.map(ge).join(", ")}),r.length>0&&(0,i.jsx)(Te,{label:(0,i.jsx)(k,{children:R("Actor",r.length)}),items:r,textOverride:{expand:"Show more",collapse:"Show less"},listComponent:t=>(0,i.jsxs)("div",{className:y.nameListContent,children:[(0,i.jsx)(n,{className:y.primaryName,children:t.primaryName}),t.altNames.length>0&&(0,i.jsxs)(n,{className:y.altNames,variant:d.SMALL,children:["(aka ",t.altNames.join(", "),")"]})]})}),e.details?.campaign_theme&&(0,i.jsx)(_,{label:(0,i.jsx)(k,{children:"Campaign"}),content:e.details.campaign_theme}),e.confidence&&(0,i.jsx)(_,{label:(0,i.jsx)(k,{children:"Confidence"}),content:(0,i.jsxs)(n,{children:[(0,i.jsx)(Z,{value:((e.confidence??0)*100).toFixed(0)}),"%"]})})]})}function k({children:e}){return(0,i.jsx)(n,{className:y.rowLabel,variant:d.SMALL,children:e})}function ge(e){return e.toLowerCase().replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase())}var q=(0,S.memo)(we);var Ne="https://malpedia.caad.fkie.fraunhofer.de/details/";var s={cardHeader:"_4quOz",cardHeaderDetails:"_4RDn7",cardHeaderDetailsTitle:"dgNs-",cardIconWrapper:"DbwyG",cardHeaderActions:"eMgGj",sectionHeader:"l7cnc",cardBody:"XGGqb",cardGroup:"UZVQC",groupSection:"MyDBR",linkList:"Ryhmk",relatedLink:"Yc6qB",readMoreButton:"B91Pu"};var H=c(f(),1);function b({to:e,iconName:o,label:r}){return(0,H.jsx)(te,{asChild:!0,children:(0,H.jsxs)(oe,{to:e,children:[(0,H.jsx)(U,{name:o,mode:"line"}),r]})})}var a=c(f(),1);function _e({children:e,description:o,threat:r,addedAt:t,subHeader:l,baseRoute:v}){let{t:m}=M(),D=pe(),P=O("threat-detections"),[I]=G([20]),[A]=w(),x=(0,L.useRef)(null),$=(0,L.useMemo)(()=>se(r.name??""),[r.name]),B=me({query:$,source:"threat"});if(!r.name)return null;let g=r.name,p=r.id,De=ie(ne(Q({kind:0,field:"host.services.threats.name",value:r.name}),Q({kind:0,field:"web.threats.name",value:r.name}),"or",!1)),X=r.malware?.malpedia_id?[{label:`${r.malware.primary_name} at Malpedia`,href:`${Ne}${r.malware.malpedia_id}`}]:[],Ae=(0,L.useMemo)(()=>{let N=A.toString()?`?${A}`:"",T=[{type:"label",label:m("Actions")},{type:"custom",content:(0,a.jsx)(b,{to:`/threats/${p}`,iconName:"bug",label:m("Go to threat page")})}];return D&&T.push({type:"custom",content:(0,a.jsx)(b,{to:B,iconName:"stack",label:m("Add threat to collection")})}),P&&I&&(T.push({type:"separator"}),T.push({type:"custom",content:(0,a.jsx)(b,{to:`${v}/data${N}`,iconName:"file-list-2",label:m("See raw evidence data")})})),T},[p,D,P,B]);return(0,a.jsxs)(ae,{headerPadding:ee.NONE,id:g,tabIndex:-1,"aria-label":g,"aria-describedby":`${p}_description`,variant:J.INTERACTIVE,"data-testid":`threat-detail-card-${p}`,header:(0,a.jsxs)("div",{className:s.cardHeader,children:[(0,a.jsx)(fe,{}),(0,a.jsxs)("div",{className:s.cardHeaderDetails,children:[(0,a.jsxs)("div",{className:s.cardHeaderDetailsTitle,children:[(0,a.jsx)(n,{variant:d.DEFAULT_NUMERAL,children:g}),he(t)?(0,a.jsx)(ye,{}):null]}),l]}),(0,a.jsxs)("div",{className:s.cardHeaderActions,children:[(0,a.jsx)(V,{align:"end",trigger:(0,a.jsx)(K,{iconRight:"arrow-drop-down",iconRightMode:"line",variant:E.DEFAULT,"aria-label":m("More options"),children:m("More Actions")}),items:Ae}),(0,a.jsx)(le,{link:{to:De},button:{variant:E.DEFAULT},children:m("View All Threat Assets")})]})]}),children:[(0,a.jsxs)("div",{className:s.cardBody,children:[(0,a.jsxs)("div",{className:s.cardGroup,children:[(0,a.jsx)(n,{className:s.sectionHeader,variant:d.H4,children:m("Properties")}),(0,a.jsx)("div",{ref:x,children:(0,a.jsx)(q,{threat:r})})]}),(0,a.jsxs)("div",{className:s.cardGroup,children:[!!o&&(0,a.jsxs)("div",{className:s.groupSection,children:[(0,a.jsx)(n,{className:s.sectionHeader,variant:d.H4,id:`${p}_description_header`,children:m("Threat Description")}),(0,a.jsx)(ue,{lineClamp:4,parentRef:x,button:(N,T)=>(0,a.jsx)(K,{onClick:T,variant:E.SECONDARY,iconRightMode:"line",iconRight:N?"arrow-up-s":"arrow-down-s",className:s.readMoreButton,"aria-controls":`${p}_description`,"aria-expanded":N,children:m(N?"Read less":"Read more")}),children:(0,a.jsx)(n,{id:`${p}_description`,"aria-labelledby":`${p}_description_header`,children:o})})]}),X.length>0&&(0,a.jsxs)("div",{className:s.groupSection,children:[(0,a.jsx)(n,{className:s.sectionHeader,variant:d.H4,id:`${p}_related_links_header`,children:m("Related Links")}),(0,a.jsx)("ul",{className:s.linkList,"aria-labelledby":`${p}_related_links_header`,children:X.map(({label:N,href:T})=>(0,a.jsx)("li",{children:(0,a.jsx)(W,{className:s.relatedLink,href:T,isExternal:!0,showExternalIcon:!0,children:N})},T))})]})]})]}),e]})}var ke=(0,L.memo)(_e);var Ce=c(F(),1);var Y={item:"bK7Wu",serviceTitle:"v1MaN"};var Le=c(F(),1);var C={popoverContent:"z0CSK",dismissButton:"KWvgn",evidenceHeader:"gYI0Q",container:"Au61L",evidence:"OxA00",fallbackMessage:"K1vKW"};function be(e){let o="",r=Array.isArray(e?.evidence)?e.evidence:[];for(let t of r)if(!t.negative&&t.data_path){let l=t.data_path.replace(/^endpoints\./,"");t.exists===!0?o+=`${l}: *`:t.exists===!1?o+=`not ${l}: *`:t.found_value&&(o+=`${l}: ${String(t.found_value)}`),o+=`
`}return o.trim()}var h=c(f(),1);function z({threat:e,baseRoute:o}){let{t:r}=M(),[t]=w(),l=t.toString()?`?${t}`:"",v=(0,Le.useMemo)(()=>be(e),[e]);return(0,h.jsx)("div",{children:(0,h.jsxs)(re,{trigger:(0,h.jsx)(ve,{children:r("See Evidence")}),contentProps:{align:"end"},customClassNames:{contentWrapper:C.popoverContent,dismissButton:C.dismissButton},isDismissible:!0,children:[(0,h.jsxs)("div",{className:C.evidenceHeader,children:[(0,h.jsx)(n,{variant:d.H5,children:r("Threat Evidence")}),(0,h.jsxs)(W,{href:`${o}/data${l}`,children:[(0,h.jsx)(U,{name:"file-list-2",mode:"line"})," ",r("See raw evidence data")]})]}),v?(0,h.jsx)("div",{className:C.container,children:(0,h.jsx)("pre",{children:(0,h.jsx)("code",{className:C.evidence,children:v})})}):(0,h.jsx)(n,{variant:d.SMALL,className:C.fallbackMessage,children:r("Evidence is not available")})]})})}var u=c(f(),1);function Pe({threat:e,baseRoute:o,title:r,timestamp:t,actionLinks:l,testId:v,ariaLabel:m}){let{t:D}=M(),[P]=w(),I=O("threat-detections"),[A]=G([20]);if(!e?.id)return null;let x=(0,Ce.useMemo)(()=>{let $=P.toString(),B=$?`?${$}`:"",g=[{type:"label",label:D("Actions")},...l.map(p=>({type:"custom",content:(0,u.jsx)(b,{to:p.to,iconName:p.iconName,label:p.label})}))];return I&&A&&(g.push({type:"separator"}),g.push({type:"custom",content:(0,u.jsx)(b,{to:`${o}/data${B}`,iconName:"file-list-2",label:D("See raw evidence data")})})),g},[l,I,A,P,o,D]);return(0,u.jsxs)("div",{role:"group",className:Y.item,"aria-label":m,"data-testid":v,children:[(0,u.jsx)(n,{className:Y.serviceTitle,variant:d.DEFAULT_SEMIBOLD,as:"span",children:r}),t&&(0,u.jsx)("div",{"aria-label":`Scan time: ${t}`,children:(0,u.jsx)(ce,{labelText:"Last scanned",timestamp:t})}),I&&A&&(0,u.jsx)(z,{threat:e,baseRoute:o}),(0,u.jsx)(V,{align:"end",trigger:(0,u.jsx)(j,{iconName:"more-2",iconMode:"line",variant:E.GHOST,"aria-label":"More options"}),items:x})]})}export{ke as a,Pe as b};
