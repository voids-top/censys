import{a as f}from"/censys/build/_shared/chunk-WK35ORSL.js";import{v as i,w as c,y as u}from"/censys/build/_shared/chunk-KMD3IRPL.js";function S(e,t){let o=e.reduce((n,r)=>{let a=p(r,t),d={confidence:r.confidence||0,label:a,cpe:r.cpe,product:r.product,vendor:r.vendor},s=n.get(r.product);return(!s||d.confidence>s.confidence)&&n.set(r.product,d),n},new Map);return Array.from(o.values())}function p(e,t){let o=t?e.vendor.trim():"",n=e.product.trim(),r=e.version.trim();return[o,n!==o?n:"",r].filter(f).join(" ").replaceAll("_"," ").replaceAll(/\b\w/g,d=>d.toUpperCase())}function w(e,t,o){return o?c({kind:0,field:`${t}.cpe`,value:e.cpe}):e.vendor&&!e.product?c(i({kind:0,field:`${t}.vendor`,value:e.vendor})):e.product&&!e.vendor?c(i({kind:0,field:`${t}.product`,value:e.product})):c({kind:5,field:t,content:u(i({kind:0,field:"vendor",value:e.vendor}),i({kind:0,field:"product",value:e.product}),"and",!1)})}export{S as a,w as b};
