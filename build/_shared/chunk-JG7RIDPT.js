import{a as to,b as no,c as qe,d as oo,e as ro}from"/censys/build/_shared/chunk-RVNR7NXG.js";import{a as yt,b as Oe,c as ht,d as je}from"/censys/build/_shared/chunk-5DIHBHL2.js";import{a as eo}from"/censys/build/_shared/chunk-TVSZBFAR.js";import{a as Qn}from"/censys/build/_shared/chunk-GKOF6QGC.js";import{a as Jn}from"/censys/build/_shared/chunk-J22KWXE5.js";import{a as Bn}from"/censys/build/_shared/chunk-BVX6X5MK.js";import{a as Gn}from"/censys/build/_shared/chunk-62I4RDM3.js";import{a as Kn,b as J}from"/censys/build/_shared/chunk-DPQLMYXH.js";import{a as Xn}from"/censys/build/_shared/chunk-3IID2F3B.js";import{a as jn,b as qn,e as Ke}from"/censys/build/_shared/chunk-ZDOHYF7S.js";import{a as Zn}from"/censys/build/_shared/chunk-P6URTM7C.js";import{c as zn,e as Fn,g as St,h as ft,i as Vn,j as $n}from"/censys/build/_shared/chunk-TUFJ6JAI.js";import{b as Wn}from"/censys/build/_shared/chunk-GMNB7RSU.js";import{a as Yn}from"/censys/build/_shared/chunk-SNE5KUVT.js";import{a as Xe,b as de,d as Se}from"/censys/build/_shared/chunk-AIDQO3P6.js";import{a as qo}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as Ze}from"/censys/build/_shared/chunk-LQXVLPA4.js";import{a as hn,b as gn,e as Mn}from"/censys/build/_shared/chunk-AVESHRFL.js";import{a as xn,b as dt,c as Hn,d as Pn,e as Dn}from"/censys/build/_shared/chunk-MBWLTMZZ.js";import{a as In}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{c as Tn,j as Nn,l as Ln,m as kn,n as On}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import{a as ln,b as cn}from"/censys/build/_shared/chunk-RAMDI2JB.js";import{e as Me}from"/censys/build/_shared/chunk-FSKKJDZY.js";import{C as _n,b as En,d as bn,j as Rn}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{a as We}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as pt}from"/censys/build/_shared/chunk-HG7D3PDC.js";import{c as jt}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as Un}from"/censys/build/_shared/chunk-Q3AERUF4.js";import{a as wn}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as V}from"/censys/build/_shared/chunk-2G5R6E4Q.js";import{j as Cn}from"/censys/build/_shared/chunk-HLRAT4GD.js";import{a as te}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{b as fn,d as yn,f as ke}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{e as mn,f as un,h as pn,j as dn,k as Sn}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as qt}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{A as An,v as vn,w as pe}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{A as b,B as k,C as ie,E as Jt,Ma as De,Na as ut,P as Qt,Pa as sn,R as en,S as tn,T as nn,Ta as Ye,aa as Ee,ba as on,da as rn,ua as mt,va as an,y as se,z as ge}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{d as c}from"/censys/build/_shared/chunk-6URBRDCL.js";import{C as Kt,a as Yt,c as Wt,d as ct,g as Ge,k as Zt,m as Xt,p as Le}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as ae,c as M}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as C}from"/censys/build/_shared/chunk-2QEWK57A.js";var Z=C(ae(),1);var ao=C(ae(),1);var I={hostDetailsLocationItems:"_54H4t",hostDetailsLocationTable:"-XqVm",hostDetailsLocationMapWrapper:"j8CmB",hostDetailsLocationContent:"OhWSL",hostDetailsLocationMap:"pCZQo",hostDetailsLocationFlag:"MDudf",hostDetailsLocationText:"_3xA8V",flagIconContainer:"HdL5p",multipleItemDetail:"_52VKz",itemLocationLine:"PbwMM",iconButton:"sf5Lf",autonomousSystem:"qe6HO"};var y=C(M(),1);function gt({host:e}){let{location:n,coordinates:o,whois:a,countryCode:i,latitude:p,longitude:u}=Kn(e),l=fn("MAPS_API_KEY"),f=(0,ao.useMemo)(()=>!p||!u||!l?null:`https://www.google.com/maps/embed/v1/place?key=${l}&q=${p},${u}&zoom=5`,[p,u]),d=e.autonomous_system,g=d&&d.asn&&d.bgp_prefix&&d.country_code&&d.name;return(0,y.jsxs)("div",{className:se(I.hostDetailsLocation),children:[(0,y.jsx)(qe,{iconName:"map-pin-user",children:"Network and Geolocation"}),(0,y.jsxs)("div",{className:I.hostDetailsLocationItems,children:[(0,y.jsx)("div",{className:I.hostDetailsLocationTable,children:(0,y.jsxs)(Xe,{children:[(0,y.jsx)(Se,{label:"WHOIS Network",content:(0,y.jsxs)("div",{className:I.multipleItemDetail,children:[(0,y.jsx)(de,{text:a.network.name&&J(e.presence_unset||[],["host.whois.network"],(0,y.jsx)(te,{variant:"ghost",href:pe({kind:0,field:"host.whois.network.name",value:a.network.name}),children:a.network.name}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!0)}),a.network.handle&&(0,y.jsx)(de,{text:J(e.presence_unset||[],["host.whois.network"],(0,y.jsx)(te,{variant:"ghost",href:pe({kind:0,field:"host.whois.network.handle",value:a.network.handle}),children:a.network.handle}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!1)})]})}),(0,y.jsx)(Se,{label:"WHOIS Organization",content:(0,y.jsxs)("div",{className:I.multipleItemDetail,children:[(0,y.jsx)(de,{text:a.organization.name&&J(e.presence_unset||[],["host.whois.organization"],(0,y.jsx)(te,{variant:"ghost",href:pe({kind:0,field:"host.whois.organization.name",value:a.organization.name}),children:a.organization.name}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!0)}),a.organization.address&&(0,y.jsx)(de,{text:J(e.presence_unset||[],["host.whois.organization"],(0,y.jsx)(te,{variant:"ghost",href:pe({kind:0,field:"host.whois.organization.address",value:a.organization.address}),children:a.organization.address}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!1)}),a.organization.handle&&(0,y.jsx)(de,{text:J(e.presence_unset||[],["host.whois.organization"],(0,y.jsx)(te,{variant:"ghost",href:pe({kind:0,field:"host.whois.organization.handle",value:a.organization.handle}),children:a.organization.handle}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!1)})]})}),(0,y.jsx)(Se,{label:"Autonomous System",content:g&&(0,y.jsxs)("div",{className:I.multipleItemDetail,children:[d.bgp_prefix&&(0,y.jsx)(de,{text:J(e.presence_unset||[],["host.autonomous_system.bgp_prefix"],(0,y.jsx)(te,{variant:"ghost",href:pe({kind:0,field:"host.autonomous_system.bgp_prefix",value:d.bgp_prefix}),children:d.bgp_prefix}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!0)}),d.name&&(0,y.jsx)(de,{text:J(e.presence_unset||[],["host.autonomous_system.name"],(0,y.jsxs)(te,{variant:"ghost",href:pe({kind:0,field:"host.autonomous_system.name",value:d.name}),children:["via ",d.name]}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!1)}),d.country_code&&d.asn&&(0,y.jsx)(de,{text:J(e.presence_unset||[],["host.autonomous_system.country_code","host.autonomous_system.asn"],(0,y.jsxs)(te,{variant:"ghost",href:pe({kind:0,field:"host.autonomous_system.asn",value:d.asn}),children:[d.country_code," (AS",d.asn,")"]}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!1)})]})})]})}),(0,y.jsxs)("div",{className:I.hostDetailsLocationMapWrapper,children:[f&&(0,y.jsx)("iframe",{className:I.hostDetailsLocationMap,title:"Google Map View",src:f,allowFullScreen:!0,credentialless:""}),(0,y.jsxs)("div",{className:I.hostDetailsLocationContent,children:[i&&(0,y.jsx)("div",{className:I.hostDetailsLocationFlag,children:J(e.presence_unset||[],["host.location","host.location.city","host.location.country","host.location.country_code"],(0,y.jsx)(Un,{"aria-hidden":!0,countryCode:i}),(0,y.jsx)(V,{iconClassName:I.iconButton}),!1)}),n&&(0,y.jsx)(k,{children:J(e.presence_unset||[],["host.location","host.location.city","host.location.country","host.location.country_code"],n,(0,y.jsx)(V,{iconClassName:I.iconButton}))}),o&&(0,y.jsx)(k,{className:I.hostDetailsLocationText,children:J(e.presence_unset||[],["host.location.coordinates","host.location.coordinates.latitude","host.location.coordinates.longitude"],o,(0,y.jsx)(V,{iconClassName:I.iconButton}))})]})]})]})]})}var Ie=C(ae(),1);var Q={hostDetailsSummary:"_1lxtH",detailTableContent:"_3Jmse",expandableList:"YnSLt",listWrapper:"_3xnF3",listElementWrapper:"chPAX",iconButton:"ZnXpj",disable:"uGO1E",lockButton:"Il2vm",listControlButton:"aUf46"};function so(e,n,o,a){let{dns:i,services:p,operating_system:u}=e,l=i?.reverse_dns?.names?.[0],f={label:u?.product?eo(u):void 0,isLocked:e.presence_unset.includes("host.operating_system.product")},d=e.presence_unset.includes("host.dns.names")?[{label:void 0,isLocked:!0}]:(i?.names??[]).length===0?[{label:void 0,isLocked:!1}]:i?.names?.map(h=>({label:h,isLocked:!1}))||[],g=p?.filter(We).map(h=>({label:St(h),isLocked:!1,href:ft(h,o,a),hasThreats:h.threats?.some(N=>N.name?.trim()!=="")??!1,hasCves:!!h.vulns?.length,cveSeverity:Ke(h.vulns)}));for(let h of n)g.push({label:St(h),isLocked:!0,href:ft(h,o,a)});return{reverseDns:l,operatingSystem:f,serviceTags:g,forwardDnsNames:d}}var H=C(M(),1),er={expandableList:Q.expandableList,listWrapper:Q.listWrapper,listElementWrapper:Q.listElementWrapper,listControlButton:Q.listControlButton};function Et({baseLink:e,host:n,lockedServices:o}){let a=(0,Ie.useRef)(null),[i]=Le(),{reverseDns:p,operatingSystem:u,serviceTags:l,forwardDnsNames:f}=(0,Ie.useMemo)(()=>{let E=new URLSearchParams(i);return so(n,o,e,E.toString())},[n,o,e,i]),d=(0,Ie.useCallback)(()=>{a.current&&Jn(a.current,{behavior:"auto"})},[a]),[g,h]=ke([5,11]),N=!!g,A=!!h;return(0,H.jsxs)("div",{className:Q.hostDetailsSummary,children:[(0,H.jsx)(qe,{iconName:"file-list-2",children:"Summary"}),(0,H.jsxs)(Xe,{children:[(0,H.jsx)(Se,{label:"Reverse DNS",content:n.presence_unset.includes("host.dns.reverse_dns.names")?(0,H.jsx)(V,{iconClassName:Q.iconButton}):p}),(0,H.jsx)(Se,{label:"Forward DNS",content:n.dns?.names&&(0,H.jsx)(Zn,{ref:a,customClassNames:er,data:f.map(E=>E.isLocked?(0,H.jsx)(V,{iconClassName:Q.iconButton}):E.label),maxVisibleRows:8,onCollapse:d,renderListElement:E=>(0,H.jsx)(k,{children:E})})}),(0,H.jsx)(Se,{label:"OS",content:u.isLocked?(0,H.jsx)(V,{iconClassName:Q.iconButton}):u.label}),(0,H.jsx)(Se,{label:`${l.length} Total ${wn("Service",l.length)}`,content:(0,H.jsx)(Xn,{tagSize:"md",tags:l.map(E=>({...E,label:(0,H.jsx)(k,{className:E.isLocked?Q.disable:"",children:E.label}),contentRight:E.isLocked&&(0,H.jsx)(V,{iconClassName:se(Q.iconButton,Q.lockButton)}),contentLeft:(0,H.jsxs)(H.Fragment,{children:[N&&E.hasCves&&E.cveSeverity&&(0,H.jsx)(jn,{size:"md","aria-label":"Censys found a CVE on this service.",severity:E.cveSeverity}),A&&E.hasThreats&&(0,H.jsx)(Yn,{size:"md","aria-label":"Censys found a threat on this service."})]})})),maxVisibleRows:20})})]})]})}var Zo=C(ae(),1);var he=C(ae(),1);var tt=C(ae(),1);var K={container:"EpuZd",stepList:"_41TnA",analysisStep:"FFhE2",header:"cGlz7",title:"_96-BC",lightText:"_5hF8z",pendingIcon:"cZpUF",runningIcon:"H053t",spin:"LKOtE",successIcon:"W6sQS",errorIcon:"_7-HhM"};var Je=(i=>(i.PENDING="pending",i.RUNNING="running",i.SUCCESS="success",i.ERROR="error",i))(Je||{}),Qe=(a=>(a.HOST_PROFILER="host_profiler",a.SERVICE_ANALYSIS="service_orchestrator",a.MASTER_SUMMARIZER="master_summarizer",a))(Qe||{});var Te=c.string().optional(),le=c.object({}),tr=le.extend({type:c.literal("connection"),message:c.string()}),nr=le.extend({type:c.literal("route_error"),message:c.string()}),or=le.extend({type:c.literal("node_start"),timestamp:Te,node:c.string(),message:c.string()}),rr=le.extend({type:c.literal("node_complete"),timestamp:Te,node:c.string(),message:c.string(),duration_ms:c.number().nullable().optional()}),ar=le.extend({type:c.literal("sub_agent_start"),timestamp:Te,parent_node:c.string(),agent:c.string(),message:c.string(),service_info:c.record(c.unknown()).nullable().optional()}),sr=le.extend({type:c.literal("sub_agent_complete"),timestamp:Te,parent_node:c.string(),agent:c.string(),message:c.string(),success:c.boolean(),duration_ms:c.number().nullable().optional()}),ir=le.extend({type:c.literal("task_list"),timestamp:Te,node:c.string(),message:c.string(),tasks:c.array(c.string())}),lr=le.extend({type:c.literal("token"),timestamp:Te,node:c.string(),content:c.string(),metadata:c.record(c.unknown()).nullable().optional()}),cr=le.extend({type:c.literal("error"),timestamp:Te,node:c.string(),agent:c.string().nullable().optional(),message:c.string(),error_details:c.string()}),mr=le.extend({type:c.literal("complete"),timestamp:Te,message:c.string(),final_response:c.record(c.string(),c.unknown()),agent_outputs:c.record(c.string(),c.string()),total_duration_ms:c.number().nullable().optional(),run_id:c.string().nullable().optional()}),vt=c.discriminatedUnion("type",[tr,nr,or,rr,ar,sr,ir,lr,cr,mr]),Tt=c.object({error:c.string().nullable(),events:c.array(vt),status:c.nativeEnum(Je)}),ur=c.object({["service_orchestrator"]:Tt,["host_profiler"]:Tt,["master_summarizer"]:Tt.extend({durationMs:c.number().nullable(),summary:c.string().nullable(),verboseSummary:c.record(c.string(),c.string()).nullable()})}),pr=c.object({unhandledEvents:c.array(vt)}),vs=c.object({agentState:ur,error:c.string().nullable(),finishedAt:c.string().nullable(),totalDurationMs:c.number().nullable(),meta:pr,runId:c.string().nullable()}),lo=c.object({events:c.array(c.unknown())});function co(e){try{let n;typeof e=="string"?n=JSON.parse(e):n=e;let o=vt.safeParse(n);return o.success?o.data:null}catch{return null}}var At={error:null,events:[],status:"pending"},Ct={agentState:{["service_orchestrator"]:{...At},["host_profiler"]:{...At},["master_summarizer"]:{...At,durationMs:null,summary:null,verboseSummary:null}},error:null,finishedAt:null,totalDurationMs:null,meta:{unhandledEvents:[]},runId:null};function uo(e,n){let o=Sr(n);switch(n.type){case"sub_agent_start":case"node_start":return o?xe(e,n,o,{status:"running"}):e;case"node_complete":case"sub_agent_complete":return o?xe(e,n,o,{status:"success"}):e;case"complete":{let a={...e,finishedAt:n.timestamp||new Date().toISOString(),runId:n.run_id??null,totalDurationMs:n.total_duration_ms??null};return"summary"in n.final_response&&typeof n.final_response.summary=="string"?xe(a,n,"master_summarizer",{status:"success",summary:n.final_response.summary,verboseSummary:n.agent_outputs}):xe(a,n,"master_summarizer",{status:"error",error:"The Compass service returned the final response in an unexpected format."})}case"route_error":return o?xe(e,n,o,{error:n.message,status:"error"}):{...e,error:n.message};case"error":return o?xe(e,n,o,{error:n.error_details,status:"success"}):{...e,error:n.error_details};case"connection":case"token":default:return yr(e,n)}return e}function Sr(e){return"node"in e?mo(e.node):"agent"in e?mo(e.agent):null}var fr=new Set(Object.values(Qe));function mo(e){return fr.has(e)?e:null}function xe(e,n,o,a){return{...e,agentState:{...e.agentState,[o]:{...e.agentState[o],...a,events:[...e.agentState[o].events,n]}}}}var yr=(e,n)=>({...e,meta:{...e.meta,unhandledEvents:[...e.meta.unhandledEvents,n]}}),j={firstError:({error:e,agentState:n})=>e??Object.values(n).reduce((o,a)=>o??a.error,null),getAgentState:({agentState:e})=>e,getCompletionTimestamp:({finishedAt:e})=>e,getRunId:({runId:e})=>e,getSimpleSummary:({agentState:e})=>e["master_summarizer"].summary,getVerboseSummary:({agentState:e})=>e["master_summarizer"].verboseSummary};var bt=(i=>(i.COORDINATE_ANALYSIS="coordinate-analysis",i.HOST_PROFILE="host-profile",i.ANALYZE_SERVICES="analyze-services",i.SUMMARIZE="summarize",i))(bt||{});var Rt=e=>e===2||e===3;function So(e){let n=j.firstError(e)!==null,o=j.getAgentState(e),a=Nt(o["host_profiler"].status),i=Nt(o["service_orchestrator"].status),p=Nt(o["master_summarizer"].status);p===3&&!o["master_summarizer"].summary&&(p=1),p!==0&&(a=a===2?2:3,i=i===2?2:3);let u={["coordinate-analysis"]:po(a,i),["host-profile"]:a,["analyze-services"]:i,["summarize"]:p},l=Object.values(u).reduce((f,d)=>Rt(d)?f+1:f,0);return{steps:u,hasError:n,overallStatus:n?2:Math.max(1,po(...Object.values(u))),totalComplete:l}}function Nt(e){switch(e){case"error":return 2;case"success":return 3;case"running":return 1;case"pending":default:return 0}}function po(...e){return e.every(n=>n===3)?3:e.some(n=>n===1)?1:Math.min(...e)}var U=C(M(),1),et="progress-accordion",hr={["coordinate-analysis"]:"Coordinating analysis",["host-profile"]:"Building host profile",["analyze-services"]:"Analyzing services...",["summarize"]:"Building final summary"},_t=Object.values(bt),fo={[2]:{icon:"close-circle-fill",className:K.errorIcon,size:"sm"},[0]:{icon:"time-fill",className:se(K.pendingIcon,K.lightText),size:"sm"},[1]:{icon:"loader-4-fill",className:K.runningIcon,size:"sm"},[3]:{icon:"checkbox-circle-fill",className:K.successIcon,size:"sm"}};function Lt({analysis:e,hasConnectionError:n,isAccordionOpen:o,onSetAccordionOpen:a}){let i=(0,tt.useCallback)(l=>{a(l===et)},[a]),p=(0,tt.useMemo)(()=>So(e),[e]),u=p.overallStatus;return n&&u!==3&&(u=2),(0,U.jsx)(an,{"data-testid":"summary-analysis-progress",className:K.container,headerPadding:mt.NONE,bodyPadding:mt.NONE,children:(0,U.jsxs)(xn,{type:"single",collapsible:!0,value:o?et:"",onValueChange:i,children:[(0,U.jsx)(dt,{value:et,children:(0,U.jsxs)(Hn,{className:K.header,children:[(0,U.jsxs)(k,{className:se(K.title,p.totalComplete!==_t.length&&K.lightText),children:[(0,U.jsx)(ge,{...fo[u]}),"Generation progress (",p.totalComplete,"/",_t.length,")"]}),(0,U.jsx)("span",{children:(0,U.jsx)(Pn,{asChild:!0,children:(0,U.jsx)(rn,{iconName:o?"arrow-up-s":"arrow-down-s",iconMode:"line",size:on.SMALL,variant:ie.GHOST,"aria-label":o?"Collapse":"Expand",className:K.accordionTrigger})})})]})}),(0,U.jsx)(dt,{value:et,children:(0,U.jsx)(Dn,{className:K.subAgentsContainer,children:(0,U.jsx)("ul",{className:K.stepList,children:_t.map(l=>(0,U.jsx)("li",{children:(0,U.jsxs)("span",{className:K.title,children:[(0,U.jsx)(ge,{...fo[p.steps[l]]}),(0,U.jsx)(k,{className:se(!Rt(p.steps[l])&&K.lightText),children:hr[l]})]})},l))})})})]})})}var yo={errorDetails:"AjIvC"};var we=C(M(),1);function Ue({className:e,error:n}){return(0,we.jsxs)(bn,{className:e,title:"Analysis Error",iconName:"error-warning",iconMode:"line",children:["Unfortunately, the summarizer encountered a fatal error. Please regenerate the summary.",(0,we.jsx)("div",{className:yo.errorDetails,children:(0,we.jsxs)(k,{variant:b.DEFAULT_SOURCE,children:["Error details: ",n]})})]})}var at=C(ae(),1);function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},Re.apply(this,arguments)}var gr=["children","options"];var ho=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce((e,n)=>(e[n.toLowerCase()]=n,e),{class:"className",for:"htmlFor"}),go={amp:"&",apos:"'",gt:">",lt:"<",nbsp:"\xA0",quot:"\u201C"},Er=["style","script","pre"],Tr=["src","href","data","formAction","srcDoc","action"],vr=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,Ar=/mailto:/i,Cr=/\n{2,}$/,Eo=/^(\s*>[\s\S]*?)(?=\n\n|$)/,Nr=/^ *> ?/gm,br=/^(?:\[!([^\]]*)\]\n)?([\s\S]*)/,Rr=/^ {2,}\n/,_r=/^(?:( *[-*_])){3,} *(?:\n *)+\n/,To=/^(?: {1,3})?(`{3,}|~{3,}) *(\S+)? *([^\n]*?)?\n([\s\S]*?)(?:\1\n?|$)/,vo=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,Lr=/^(`+)((?:\\`|(?!\1)`|[^`])+)\1/,kr=/^(?:\n *)*\n/,Or=/\r\n?/g,Ir=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,xr=/^\[\^([^\]]+)]/,Hr=/\f/g,Pr=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,Dr=/^\s*?\[(x|\s)\]/,Ao=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Co=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,No=/^([^\n]+)\n *(=|-){3,} *\n/,kt=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,Mr=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,bo=/^<!--[\s\S]*?(?:-->)/,wr=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,Ot=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,Ur=/^\{.*\}$/,Br=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,zr=/^<([^ >]+@[^ >]+)>/,Fr=/^<([^ >]+:\/[^ >]+)>/,Vr=/-([a-z])?/gi,Ro=/^(\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,$r=/^[^\n]+(?:  \n|\n{2,})/,Gr=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,Yr=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,Wr=/^\[([^\]]*)\] ?\[([^\]]*)\]/,Zr=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,Xr=/\t/g,Kr=/(^ *\||\| *$)/g,jr=/^ *:-+: *$/,qr=/^ *:-+ *$/,Jr=/^ *-+: *$/,st="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|\\\\\\1|[\\s\\S])+?)",Qr=RegExp(`^([*_])\\1${st}\\1\\1(?!\\1)`),ea=RegExp(`^([*_])${st}\\1(?!\\1)`),ta=RegExp(`^(==)${st}\\1`),na=RegExp(`^(~~)${st}\\1`),oa=/^(:[a-zA-Z0-9-_]+:)/,ra=/^\\([^0-9A-Za-z\s])/,aa=/\\([^0-9A-Za-z\s])/g,sa=/^[\s\S](?:(?!  \n|[0-9]\.|http)[^=*_~\-\n:<`\\\[!])*/,ia=/^\n+/,la=/^([ \t]*)/,ca=/(?:^|\n)( *)$/,Dt="(?:\\d+\\.)",Mt="(?:[*+-])";function Oo(e){return"( *)("+(e===1?Dt:Mt)+") +"}var Io=Oo(1),xo=Oo(2);function Ho(e){return RegExp("^"+(e===1?Io:xo))}var ma=Ho(1),ua=Ho(2);function Po(e){return RegExp("^"+(e===1?Io:xo)+"[^\\n]*(?:\\n(?!\\1"+(e===1?Dt:Mt)+" )[^\\n]*)*(\\n|$)","gm")}var pa=Po(1),da=Po(2);function Do(e){let n=e===1?Dt:Mt;return RegExp("^( *)("+n+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+n+" (?!"+n+" ))\\n*|\\s*\\n*$)")}var Mo=Do(1),wo=Do(2);function _o(e,n){let o=n===1,a=o?Mo:wo,i=o?pa:da,p=o?ma:ua;return{t:u=>p.test(u),o:He(function(u,l){let f=ca.exec(l.prevCapture);return f&&(l.list||!l.inline&&!l.simple)?a.exec(u=f[1]+u):null}),i:1,u(u,l,f){let d=o?+u[2]:void 0,g=u[0].replace(Cr,`
`).match(i),h=!1;return{items:g.map(function(N,A){let E=p.exec(N)[0].length,X=RegExp("^ {1,"+E+"}","gm"),O=N.replace(X,"").replace(p,""),t=A===g.length-1,s=O.indexOf(`

`)!==-1||t&&h;h=s;let r=f.inline,m=f.list,S;f.list=!0,s?(f.inline=!1,S=ze(O)+`

`):(f.inline=!0,S=ze(O));let T=l(S,f);return f.inline=r,f.list=m,T}),ordered:o,start:d}},l:(u,l,f)=>e(u.ordered?"ol":"ul",{key:f.key,start:u.type==="20"?u.start:void 0},u.items.map(function(d,g){return e("li",{key:g},l(d,f))}))}}var Sa=RegExp(`^\\[((?:\\[[^\\[\\]]*(?:\\[[^\\[\\]]*\\][^\\[\\]]*)*\\]|[^\\[\\]])*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['"]([\\s\\S]*?)['"])?\\s*\\)`),fa=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/;function ze(e){let n=e.length;for(;n>0&&e[n-1]<=" ";)n--;return e.slice(0,n)}function ot(e,n){return e.startsWith(n)}function ya(e,n,o){if(Array.isArray(o)){for(let a=0;a<o.length;a++)if(ot(e,o[a]))return!0;return!1}return o(e,n)}function Be(e){return e.replace(/[ÀÁÂÃÄÅàáâãäåæÆ]/g,"a").replace(/[çÇ]/g,"c").replace(/[ðÐ]/g,"d").replace(/[ÈÉÊËéèêë]/g,"e").replace(/[ÏïÎîÍíÌì]/g,"i").replace(/[Ññ]/g,"n").replace(/[øØœŒÕõÔôÓóÒò]/g,"o").replace(/[ÜüÛûÚúÙù]/g,"u").replace(/[ŸÿÝý]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function ha(e){return Jr.test(e)?"right":jr.test(e)?"center":qr.test(e)?"left":null}function Lo(e,n,o,a){let i=o.inTable;o.inTable=!0;let p=[[]],u="";function l(){if(!u)return;let f=p[p.length-1];f.push.apply(f,n(u,o)),u=""}return e.trim().split(/(`[^`]*`|\\\||\|)/).filter(Boolean).forEach((f,d,g)=>{f.trim()==="|"&&(l(),a)?d!==0&&d!==g.length-1&&p.push([]):u+=f}),l(),o.inTable=i,p}function ga(e,n,o){o.inline=!0;let a=e[2]?e[2].replace(Kr,"").split("|").map(ha):[],i=e[3]?function(u,l,f){return u.trim().split(`
`).map(function(d){return Lo(d,l,f,!0)})}(e[3],n,o):[],p=Lo(e[1],n,o,!!i.length);return o.inline=!1,i.length?{align:a,cells:i,header:p,type:"25"}:{children:p,type:"21"}}function ko(e,n){return e.align[n]==null?{}:{textAlign:e.align[n]}}function He(e){return e.inline=1,e}function ve(e){return He(function(n,o){return o.inline?e.exec(n):null})}function Ae(e){return He(function(n,o){return o.inline||o.simple?e.exec(n):null})}function fe(e){return function(n,o){return o.inline||o.simple?null:e.exec(n)}}function nt(e){return He(function(n){return e.exec(n)})}var Ea=/(javascript|vbscript|data(?!:image)):/i;function Ta(e){try{let n=decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"");if(Ea.test(n))return null}catch{return null}return e}function ce(e){return e&&e.replace(aa,"$1")}function rt(e,n,o){let a=o.inline||!1,i=o.simple||!1;o.inline=!0,o.simple=!0;let p=e(n,o);return o.inline=a,o.simple=i,p}function va(e,n,o){let a=o.inline||!1,i=o.simple||!1;o.inline=!1,o.simple=!0;let p=e(n,o);return o.inline=a,o.simple=i,p}function Aa(e,n,o){let a=o.inline||!1;o.inline=!1;let i=e(n,o);return o.inline=a,i}var It=(e,n,o)=>({children:rt(n,e[2],o)});function xt(){return{}}function Ht(){return null}function Ca(...e){return e.filter(Boolean).join(" ")}function Pt(e,n,o){let a=e,i=n.split(".");for(;i.length&&(a=a[i[0]],a!==void 0);)i.shift();return a||o}function Na(e="",n={}){n.overrides=n.overrides||{},n.namedCodesToUnicode=n.namedCodesToUnicode?Re({},go,n.namedCodesToUnicode):go;let o=n.slugify||Be,a=n.sanitizer||Ta,i=n.createElement||at.createElement,p=[Eo,To,vo,n.enforceAtxHeadings?Co:Ao,No,Ro,Mo,wo],u=[...p,$r,kt,bo,Ot];function l(t,s,...r){let m=Pt(n.overrides,t+".props",{});return i(function(S,T){let _=Pt(T,S);return _?typeof _=="function"||typeof _=="object"&&"render"in _?_:Pt(T,S+".component",S):S}(t,n.overrides),Re({},s,m,{className:Ca(s?.className,m.className)||void 0}),...r)}function f(t){t=t.replace(Pr,"");let s=!1;n.forceInline?s=!0:n.forceBlock||(s=Zr.test(t)===!1);let r=E(A(s?t:ze(t).replace(ia,"")+`

`,{inline:s}));for(;typeof r[r.length-1]=="string"&&!r[r.length-1].trim();)r.pop();if(n.wrapper===null)return r;let m=n.wrapper||(s?"span":"div"),S;if(r.length>1||n.forceWrapper)S=r;else{if(r.length===1)return S=r[0],typeof S=="string"?l("span",{key:"outer"},S):S;S=null}return i(m,{key:"outer"},S)}function d(t,s){if(!s||!s.trim())return null;let r=s.match(vr);return r?r.reduce(function(m,S){let T=S.indexOf("=");if(T!==-1){let _=function(L){return L.indexOf("-")!==-1&&L.match(wr)===null&&(L=L.replace(Vr,function(q,F){return F.toUpperCase()})),L}(S.slice(0,T)).trim(),B=function(L){let q=L[0];return(q==='"'||q==="'")&&L.length>=2&&L[L.length-1]===q?L.slice(1,-1):L}(S.slice(T+1).trim()),z=ho[_]||_;if(z==="ref")return m;let G=m[z]=function(L,q,F,Fe){return q==="style"?function(me){let x=[],ue="",Ne=!1,Ve=!1,it="";if(!me)return x;for(let be=0;be<me.length;be++){let re=me[be];if(re!=='"'&&re!=="'"||Ne||(Ve?re===it&&(Ve=!1,it=""):(Ve=!0,it=re)),re==="("&&ue.endsWith("url")?Ne=!0:re===")"&&Ne&&(Ne=!1),re!==";"||Ve||Ne)ue+=re;else{let _e=ue.trim();if(_e){let lt=_e.indexOf(":");if(lt>0){let Ko=_e.slice(0,lt).trim(),jo=_e.slice(lt+1).trim();x.push([Ko,jo])}}ue=""}}let $e=ue.trim();if($e){let be=$e.indexOf(":");if(be>0){let re=$e.slice(0,be).trim(),_e=$e.slice(be+1).trim();x.push([re,_e])}}return x}(F).reduce(function(me,[x,ue]){return me[x.replace(/(-[a-z])/g,Ne=>Ne[1].toUpperCase())]=Fe(ue,L,x),me},{}):Tr.indexOf(q)!==-1?Fe(ce(F),L,q):(F.match(Ur)&&(F=ce(F.slice(1,F.length-1))),F==="true"||F!=="false"&&F)}(t,_,B,a);typeof G=="string"&&(kt.test(G)||Ot.test(G))&&(m[z]=f(G.trim()))}else S!=="style"&&(m[ho[S]||S]=!0);return m},{}):null}let g=[],h={},N={0:{t:[">"],o:fe(Eo),i:1,u(t,s,r){let[,m,S]=t[0].replace(Nr,"").match(br);return{alert:m,children:s(S,r)}},l(t,s,r){let m={key:r.key};return t.alert&&(m.className="markdown-alert-"+o(t.alert.toLowerCase(),Be),t.children.unshift({attrs:{},children:[{type:"27",text:t.alert}],noInnerParse:!0,type:"11",tag:"header"})),l("blockquote",m,s(t.children,r))}},1:{o:nt(Rr),i:1,u:xt,l:(t,s,r)=>l("br",{key:r.key})},2:{t:t=>{let s=t[0];return s==="-"||s==="*"||s==="_"},o:fe(_r),i:1,u:xt,l:(t,s,r)=>l("hr",{key:r.key})},3:{t:["    "],o:fe(vo),i:0,u:t=>({lang:void 0,text:ce(ze(t[0].replace(/^ {4}/gm,"")))}),l:(t,s,r)=>l("pre",{key:r.key},l("code",Re({},t.attrs,{className:t.lang?"lang-"+t.lang:""}),t.text))},4:{t:["```","~~~"],o:fe(To),i:0,u:t=>({attrs:d("code",t[3]||""),lang:t[2]||void 0,text:t[4],type:"3"})},5:{t:["`"],o:Ae(Lr),i:3,u:t=>({text:ce(t[2])}),l:(t,s,r)=>l("code",{key:r.key},t.text)},6:{t:["[^"],o:fe(Ir),i:0,u:t=>(g.push({footnote:t[2],identifier:t[1]}),{}),l:Ht},7:{t:["[^"],o:ve(xr),i:1,u:t=>({target:"#"+o(t[1],Be),text:t[1]}),l:(t,s,r)=>l("a",{key:r.key,href:a(t.target,"a","href")},l("sup",{key:r.key},t.text))},8:{t:["[ ]","[x]"],o:ve(Dr),i:1,u:t=>({completed:t[1].toLowerCase()==="x"}),l:(t,s,r)=>l("input",{checked:t.completed,key:r.key,readOnly:!0,type:"checkbox"})},9:{t:["#"],o:fe(n.enforceAtxHeadings?Co:Ao),i:1,u:(t,s,r)=>({children:rt(s,t[2],r),id:o(t[2],Be),level:t[1].length}),l:(t,s,r)=>l("h"+t.level,{id:t.id,key:r.key},s(t.children,r))},10:{o:fe(No),i:0,u:(t,s,r)=>({children:rt(s,t[1],r),level:t[2]==="="?1:2,type:"9"})},11:{t:["<"],o:nt(kt),i:1,u(t,s,r){let[,m]=t[3].match(la),S=RegExp("^"+m,"gm"),T=t[3].replace(S,""),_=(B=T,u.some(F=>F.test(B))?Aa:rt);var B;let z=t[1].toLowerCase(),G=Er.indexOf(z)!==-1,L=(G?z:t[1]).trim(),q={attrs:d(L,t[2]),noInnerParse:G,tag:L};if(r.inAnchor=r.inAnchor||z==="a",G)q.text=t[3];else{let F=r.inHTML;r.inHTML=!0,q.children=_(s,T,r),r.inHTML=F}return r.inAnchor=!1,q},l:(t,s,r)=>l(t.tag,Re({key:r.key},t.attrs),t.text||(t.children?s(t.children,r):""))},13:{t:["<"],o:nt(Ot),i:1,u(t){let s=t[1].trim();return{attrs:d(s,t[2]||""),tag:s}},l:(t,s,r)=>l(t.tag,Re({},t.attrs,{key:r.key}))},12:{t:["<!--"],o:nt(bo),i:1,u:()=>({}),l:Ht},14:{t:["!["],o:Ae(fa),i:1,u:t=>({alt:ce(t[1]),target:ce(t[2]),title:ce(t[3])}),l:(t,s,r)=>l("img",{key:r.key,alt:t.alt||void 0,title:t.title||void 0,src:a(t.target,"img","src")})},15:{t:["["],o:ve(Sa),i:3,u:(t,s,r)=>({children:va(s,t[1],r),target:ce(t[2]),title:ce(t[3])}),l:(t,s,r)=>l("a",{key:r.key,href:a(t.target,"a","href"),title:t.title},s(t.children,r))},16:{t:["<"],o:ve(Fr),i:0,u:t=>({children:[{text:t[1],type:"27"}],target:t[1],type:"15"})},17:{t:(t,s)=>!s.inAnchor&&!n.disableAutoLink&&(ot(t,"http://")||ot(t,"https://")),o:ve(Br),i:0,u:t=>({children:[{text:t[1],type:"27"}],target:t[1],title:void 0,type:"15"})},18:{t:["<"],o:ve(zr),i:0,u(t){let s=t[1],r=t[1];return Ar.test(r)||(r="mailto:"+r),{children:[{text:s.replace("mailto:",""),type:"27"}],target:r,type:"15"}}},20:_o(l,1),33:_o(l,2),19:{o:fe(kr),i:3,u:xt,l:()=>`
`},21:{o:He(function(t,s){if(s.inline||s.simple||s.inHTML&&t.indexOf(`

`)===-1&&s.prevCapture.indexOf(`

`)===-1)return null;let r="";t.split(`
`).every(S=>(S+=`
`,!p.some(T=>T.test(S))&&(r+=S,!!S.trim())));let m=ze(r);return m===""?null:[r,,m]}),i:3,u:It,l:(t,s,r)=>l("p",{key:r.key},s(t.children,r))},22:{t:["["],o:ve(Gr),i:0,u:t=>(h[t[1]]={target:t[2],title:t[4]},{}),l:Ht},23:{t:["!["],o:Ae(Yr),i:0,u:t=>({alt:t[1]?ce(t[1]):void 0,ref:t[2]}),l:(t,s,r)=>h[t.ref]?l("img",{key:r.key,alt:t.alt,src:a(h[t.ref].target,"img","src"),title:h[t.ref].title}):null},24:{t:t=>t[0]==="["&&t.indexOf("](")===-1,o:ve(Wr),i:0,u:(t,s,r)=>({children:s(t[1],r),fallbackChildren:t[0],ref:t[2]}),l:(t,s,r)=>h[t.ref]?l("a",{key:r.key,href:a(h[t.ref].target,"a","href"),title:h[t.ref].title},s(t.children,r)):l("span",{key:r.key},t.fallbackChildren)},25:{t:["|"],o:fe(Ro),i:1,u:ga,l(t,s,r){let m=t;return l("table",{key:r.key},l("thead",null,l("tr",null,m.header.map(function(S,T){return l("th",{key:T,style:ko(m,T)},s(S,r))}))),l("tbody",null,m.cells.map(function(S,T){return l("tr",{key:T},S.map(function(_,B){return l("td",{key:B,style:ko(m,B)},s(_,r))}))})))}},27:{o:He(function(t,s){let r;return ot(t,":")&&(r=oa.exec(t)),r||sa.exec(t)}),i:4,u(t){let s=t[0];return{text:s.indexOf("&")===-1?s:s.replace(Mr,(r,m)=>n.namedCodesToUnicode[m]||r)}},l:t=>t.text},28:{t:["**","__"],o:Ae(Qr),i:2,u:(t,s,r)=>({children:s(t[2],r)}),l:(t,s,r)=>l("strong",{key:r.key},s(t.children,r))},29:{t:t=>{let s=t[0];return(s==="*"||s==="_")&&t[1]!==s},o:Ae(ea),i:3,u:(t,s,r)=>({children:s(t[2],r)}),l:(t,s,r)=>l("em",{key:r.key},s(t.children,r))},30:{t:["\\"],o:Ae(ra),i:1,u:t=>({text:t[1],type:"27"})},31:{t:["=="],o:Ae(ta),i:3,u:It,l:(t,s,r)=>l("mark",{key:r.key},s(t.children,r))},32:{t:["~~"],o:Ae(na),i:3,u:It,l:(t,s,r)=>l("del",{key:r.key},s(t.children,r))}};n.disableParsingRawHTML===!0&&(delete N[11],delete N[13]);let A=function(t){var s=Object.keys(t);function r(m,S){var T=[];if(S.prevCapture=S.prevCapture||"",m.trim())for(;m;)for(var _=0;_<s.length;){var B=s[_],z=t[B];if(!z.t||ya(m,S,z.t)){var G=z.o(m,S);if(G&&G[0]){m=m.substring(G[0].length);var L=z.u(G,r,S);S.prevCapture+=G[0],L.type||(L.type=B),T.push(L);break}_++}else _++}return S.prevCapture="",T}return s.sort(function(m,S){return t[m].i-t[S].i||(m<S?-1:1)}),function(m,S){return r(function(T){return T.replace(Or,`
`).replace(Hr,"").replace(Xr,"    ")}(m),S)}}(N),E=(X=function(t,s){return function(r,m,S){let T=t[r.type].l;return s?s(()=>T(r,m,S),r,m,S):T(r,m,S)}}(N,n.renderRule),function t(s,r={}){if(Array.isArray(s)){let m=r.key,S=[],T=!1;for(let _=0;_<s.length;_++){r.key=_;let B=t(s[_],r),z=typeof B=="string";z&&T?S[S.length-1]+=B:B!==null&&S.push(B),T=z}return r.key=m,S}return X(s,t,r)});var X;let O=f(e);return g.length?l("div",null,O,l("footer",{key:"footer"},g.map(function(t){return l("div",{id:o(t.identifier,Be),key:t.identifier},t.identifier,E(A(t.footnote,{inline:!0})))}))):O}var wt=e=>{let{children:n="",options:o}=e,a=function(i,p){if(i==null)return{};var u,l,f={},d=Object.keys(i);for(l=0;l<d.length;l++)p.indexOf(u=d[l])>=0||(f[u]=i[u]);return f}(e,gr);return at.cloneElement(Na(n,o),a)};var Fo=C(ae(),1);var W=C(ae(),1);var Y={feedbackContainer:"X3Tok",feedbackTitle:"yh8BK",thumbsContainer:"_6fFww",thumbsButton:"BX5yk",commentContainer:"bidRg",thumbsIndicator:"L-umb",selectedThumb:"-GTCc",selectedThumbText:"J7pMP",commentActions:"FFqbP",submitButton:"MXRRX",feedbackError:"Y2zgh",feedbackSuccess:"RRu3J",successIcon:"RiPE2",successText:"XyEgq"};var P=C(M(),1);function Ut({runId:e,className:n}){let[o,a]=(0,W.useState)(null),[i,p]=(0,W.useState)(!1),[u,l]=(0,W.useState)(""),[f,d]=(0,W.useState)(!1),[g,h]=(0,W.useState)(null),N=cn(),A=Kt();(0,W.useEffect)(()=>{e&&(a(null),p(!1),l(""),d(!1),h(null))},[e]);let E=(0,W.useCallback)(m=>{a(m),p(!0),h(null)},[]),X=(0,W.useCallback)(()=>{E(1)},[E]),O=(0,W.useCallback)(()=>{E(0)},[E]),t=(0,W.useCallback)(m=>{l(m.target.value)},[]),s=(0,W.useCallback)(()=>{if(!e||o===null)return;h(null);let m=new FormData;m.set("csrf",N),m.set("runId",e),m.set("score",o.toString()),u.trim()&&m.set("comment",u.trim()),A.submit(m,{method:"POST",action:"/api/summary/feedback"})},[e,o,u,A,N]),r=(0,W.useCallback)(()=>{p(!1),a(null),l(""),h(null)},[]);return(0,W.useEffect)(()=>{if(A.state==="idle"&&A.data){let m=A.data;"feedback_id"in m&&m.feedback_id?(d(!0),p(!1),h(null)):"success"in m&&m.success===!1?h(m.message||"Failed to submit feedback. Please try again."):"error"in m&&typeof m.error=="string"&&h(m.error)}},[A.state,A.data]),e?(0,P.jsxs)("div",{className:se(Y.feedbackContainer,n),children:[(0,P.jsx)(k,{variant:b.H6,className:Y.feedbackTitle,children:"Was this summary helpful?"}),f?(0,P.jsxs)("div",{className:Y.feedbackSuccess,children:[(0,P.jsx)(ge,{name:"checkbox-circle",mode:"fill",className:Y.successIcon,size:"sm"}),(0,P.jsx)(k,{variant:b.SMALL,className:Y.successText,children:"Thank you for your feedback!"})]}):(0,P.jsxs)(P.Fragment,{children:[i?(0,P.jsxs)("div",{className:Y.commentContainer,children:[(0,P.jsxs)("div",{className:Y.thumbsIndicator,children:[(0,P.jsx)(ge,{name:o===1?"thumb-up":"thumb-down",mode:"fill",className:Y.selectedThumb,size:"sm"}),(0,P.jsx)(k,{variant:b.SMALL,className:Y.selectedThumbText,children:o===1?"Thumbs up":"Thumbs down"})]}),(0,P.jsx)(Jt,{placeholder:"Tell us more about your experience (optional)",value:u,onChange:t,disabled:A.state!=="idle",isFullWidth:!0,rows:3}),(0,P.jsxs)("div",{className:Y.commentActions,children:[(0,P.jsx)(Ee,{variant:ie.DEFAULT,onClick:s,disabled:A.state!=="idle",className:Y.submitButton,children:A.state!=="idle"?"Submitting...":"Submit"}),(0,P.jsx)(Ee,{variant:ie.GHOST,onClick:r,disabled:A.state!=="idle",children:"Cancel"})]})]}):(0,P.jsxs)("div",{className:Y.thumbsContainer,children:[(0,P.jsx)(Ee,{variant:ie.GHOST,iconLeft:"thumb-up",onClick:X,className:Y.thumbsButton,disabled:A.state!=="idle",children:"Yes"}),(0,P.jsx)(Ee,{variant:ie.GHOST,iconLeft:"thumb-down",onClick:O,className:Y.thumbsButton,disabled:A.state!=="idle",children:"No"})]}),g&&(0,P.jsx)(k,{variant:b.SMALL,className:Y.feedbackError,children:g})]})]}):null}var $={container:"Is1p3",summaryResult:"_0clWk",skeleton:"sdAkQ",verboseOutput:"PVq68",error:"EaB4R",errorDetails:"_9f8px",markdownList:"hsyit",markdownListItem:"_-57N-",markdownContent:"XuTCl",markdownHeading:"CjdNa"};var ye=C(M(),1),Uo=[300,280,290,300,310,150],ba=Uo.toReversed();function Bo(){return(0,ye.jsxs)("div",{className:$.skeleton,children:[(0,ye.jsx)(Me,{variant:b.H1,color:"heading",width:200}),Uo.map((e,n)=>(0,ye.jsx)("div",{className:$.skeletonItem,children:(0,ye.jsx)(Me,{variant:b.DEFAULT,width:e})},`skeleton-row-${n}`)),(0,ye.jsx)(Me,{variant:b.H1,color:"heading",width:180}),ba.map((e,n)=>(0,ye.jsx)("div",{children:(0,ye.jsx)(Me,{variant:b.DEFAULT,width:e})},`skeleton-row-${n}`))]})}var D=C(M(),1),ne=(e={})=>({component:k,props:e}),Ra={h1:ne({className:$.markdownHeading,variant:b.H1}),h2:ne({className:$.markdownHeading,variant:b.H2}),h3:ne({className:$.markdownHeading,variant:b.H3}),h4:ne({className:$.markdownHeading,variant:b.H4}),h5:ne({className:$.markdownHeading,variant:b.H5}),h6:ne({className:$.markdownHeading,variant:b.H6}),ul:{component:e=>(0,D.jsx)("ul",{...e,className:$.markdownList})},ol:{component:e=>(0,D.jsx)("ol",{...e,className:$.markdownList})},li:{component:({children:e,...n})=>(0,D.jsx)("li",{...n,className:$.markdownListItem,children:(0,D.jsx)(k,{children:e})})},strong:ne({variant:b.DEFAULT_SEMIBOLD}),em:ne({variant:b.DEFAULT_ITALICS}),p:ne(),code:ne({variant:b.DEFAULT_SOURCE}),pre:ne({variant:b.SMALL_SOURCE})},zo={disableAutoLink:!0,overrides:Ra};function Bt({analysis:e}){let[n,o]=(0,Fo.useState)("simple"),a=Sn(),i=j.getRunId(e),p=j.getSimpleSummary(e),u=j.getVerboseSummary(e),l=j.firstError(e),f=!!p,d;return l?d=(0,D.jsx)(Ue,{error:l}):n==="simple"?p===null?d=(0,D.jsx)(k,{children:"Failed to load simple summary."}):d=(0,D.jsx)(wt,{options:zo,children:p}):u===null?d=(0,D.jsx)(k,{children:"Failed to load verbose summary."}):d=(0,D.jsx)("div",{className:$.verboseOutput,children:Object.entries(u).map(([g,h])=>(0,D.jsxs)("div",{className:$.agent,children:[(0,D.jsx)(k,{variant:b.H1,children:g}),(0,D.jsx)(wt,{options:zo,children:h})]},g))}),(0,D.jsxs)("div",{className:$.container,children:[!l&&(0,D.jsxs)(je,{children:[(0,D.jsx)(ht,{id:`analysis-${"simple"}`,isActive:n==="simple",onClick:()=>o("simple"),children:"Simple"}),(0,D.jsx)(ht,{id:`analysis-${"verbose"}`,isActive:n==="verbose",onClick:()=>o("verbose"),children:"Verbose"})]}),(0,D.jsx)("div",{className:$.summaryResult,"data-testid":"summary-result",children:f||l?d:(0,D.jsx)(Bo,{})}),a&&f&&(0,D.jsx)(Ut,{runId:i})]})}var zt="summarize-host-label";var Vo="app/hosts/summary/";var Ce={content:"DOoBk",container:"puhDD",titleContainer:"faFxK",title:"j3W-U",subtitle:"R2K3c",body:"qZoIt",accordionTrigger:"bjT2Y",accordionIcon:"VJg97",accordionContent:"eE-SY",subAgentsContainer:"_1zy7r",submitButton:"R71Ho",clearButton:"hbjPR"};var Ft={analysis:null,events:[],error:null,connectionState:"disconnected",isAccordionOpen:!1,isPopoverOpen:!1},La=new Set(["error","route_error","complete"]);function Go(e,n){switch(n.type){case"reset":return Ft;case"clear-analysis":return{...e,analysis:null,error:null,connectionState:"disconnected"};case"load-analysis":return{...e,analysis:n.payload,error:null,connectionState:"disconnected"};case"new-analysis":return{...e,analysis:Ct,error:null,connectionState:"connecting",isAccordionOpen:!0};case"set-is-accordion-open":return{...e,isAccordionOpen:n.payload};case"set-is-popover-open":return{...e,isPopoverOpen:n.payload};case"set-connection-established":return{...e,connectionState:n.payload};case"error":return{...e,error:n.payload};case"receive-event":{let o=co(n.payload),a=o&&La.has(o.type)?"disconnected":"connected";return o===null?{...e,connectionState:a,error:"Failed to validate stream event format",events:[...e.events,n.payload]}:{...e,connectionState:a,events:[...e.events,n.payload],analysis:uo(e.analysis??Ct,o)}}default:return e}}var Pe={firstError:({error:e,analysis:n})=>e??(n&&j.firstError(n)),getAgentState:({analysis:e})=>e&&j.getAgentState(e),getCompletionTimestamp:({analysis:e})=>e&&j.getCompletionTimestamp(e),getRunId:({analysis:e})=>e&&j.getRunId(e),getAnalysis:({analysis:e})=>e,hasReceivedAnyEvents:({events:e})=>e.length>0,isConnected:({connectionState:e})=>e==="connected",isConnecting:({connectionState:e})=>e==="connecting",isDisconnected:({connectionState:e})=>e==="disconnected",isAccordionOpen:({isAccordionOpen:e})=>e,isPopoverOpen:({isPopoverOpen:e})=>e};var oe=C(ae(),1);function Yo({isDisconnected:e,onError:n,onReceiveEvent:o,onTimeout:a,streamUrl:i}){let p=(0,oe.useRef)(n),u=(0,oe.useRef)(o),l=(0,oe.useRef)(a);(0,oe.useEffect)(()=>{p.current=n,u.current=o,l.current=a},[n,o]),(0,oe.useEffect)(()=>{if(e||!i)return;let f=!0,d=new EventSource(i),g;function h(){g=setTimeout(()=>{l.current(),N()},1e4)}function N(){f=!1,clearTimeout(g),d.removeEventListener("error",E),d.removeEventListener("message",A),d.close()}function A(X){clearTimeout(g),f&&(u.current(X),h())}function E(){clearTimeout(g),f&&(p.current(),N())}return d.addEventListener("message",A),d.addEventListener("error",E),h(),N},[e,i])}var ka={events:[]};function Wo(e,n){let o=`${Vo}${n??"free"}/${e}`,[a,i]=(0,oe.useReducer)(Go,Ft);return(0,oe.useEffect)(()=>{i({type:"reset"});let p=hn(o,lo,ka);if(p.events.length>0)for(let u of p.events)i({type:"receive-event",payload:u})},[o]),(0,oe.useEffect)(()=>{a.analysis&&j.getSimpleSummary(a.analysis)&&gn(o,{events:a.events})},[a.analysis,o]),[a,i]}var w=C(M(),1);function Vt({hostIp:e,className:n}){let o=un(),[a,i]=Wo(e,o?.organizationId),p=Pe.isDisconnected(a),u=Pe.isConnected(a),l=Pe.getAnalysis(a),f=Pe.getCompletionTimestamp(a),d=(0,he.useMemo)(()=>{let O=`/api/asset/summary/${e}?t=${Date.now()}`;return o?.organizationId&&(O=`${O}&org=${o.organizationId}`),O},[e,o?.organizationId]),g=(0,he.useCallback)(O=>{i({type:"receive-event",payload:O.data})},[]),h=(0,he.useCallback)(()=>{i({type:"set-connection-established",payload:"disconnected"}),i({type:"error",payload:"Error establishing connection to server"})},[]),N=(0,he.useCallback)(()=>{i({type:"set-connection-established",payload:"disconnected"}),i({type:"error",payload:"Connection timeout - please try again"})},[]);Yo({isDisconnected:p,streamUrl:d,onError:h,onReceiveEvent:g,onTimeout:N});let A=(0,he.useCallback)(O=>{i({type:"set-is-popover-open",payload:O}),!a.analysis&&O&&i({type:"new-analysis"})},[a]),E=(0,he.useCallback)(()=>{i({type:"new-analysis"})},[]),X=(0,he.useCallback)(O=>{i({type:"set-is-accordion-open",payload:O})},[]);return(0,w.jsxs)(Qt,{open:a.isPopoverOpen,onOpenChange:A,children:[(0,w.jsx)(Ye,{content:"Summarize Host with AI",tabIndex:-1,children:(0,w.jsx)(en,{asChild:!0,children:(0,w.jsx)(Ee,{"data-testid":"summarize-host",variant:ie.DEFAULT,iconLeft:"sparkling-2",iconLeftMode:"fill",className:n,children:"Summarize Host"})})}),(0,w.jsx)(tn,{children:(0,w.jsx)(nn,{className:Ce.content,"aria-labelledby":zt,align:"end",children:(0,w.jsxs)("div",{className:Ce.container,"data-testid":"summary-popover",children:[(0,w.jsxs)("header",{children:[(0,w.jsxs)("div",{className:Ce.titleContainer,children:[(0,w.jsx)(k,{id:zt,variant:b.H1,className:Ce.title,children:"Host Summary"}),(0,w.jsx)(Ee,{variant:ie.DEFAULT,iconLeft:"reset-left",iconLeftMode:"line",onClick:E,className:Ce.clearButton,disabled:!p,children:"Regenerate"})]}),(0,w.jsxs)("div",{className:Ce.subtitle,children:[u&&(0,w.jsx)(k,{variant:b.H5,children:"Generating..."}),!u&&!!f&&(0,w.jsx)(Ze,{labelText:"Generated",variant:"long",timestamp:f})]})]}),(0,w.jsxs)("section",{className:Ce.body,children:[!!l&&(0,w.jsx)(Lt,{analysis:l,hasConnectionError:a.error!==null,isAccordionOpen:Pe.isAccordionOpen(a),isConnectionEstablished:u,onSetAccordionOpen:X}),a.error?(0,w.jsx)(Ue,{error:a.error}):!!l&&(0,w.jsx)(Bt,{analysis:l})]})]})})})]})}var ee={overviewHeaderContainer:"_7pK9h",contentTop:"_3lb1q",section:"Tstol",textIcon:"_3lmsn",historicalTag:"nLQ1e",contentBottom:"U6LgS",tagsSection:"KoaXW",contentRow:"Pdkf2",tagsIcon:"HIwAN",breadcrumbHeader:"qLo7u",breadcrumbSeparator:"gIJY9",trailLink:"_0w1UJ",scanBtn:"tDRqP"};var R=C(M(),1);function $t({baseRoute:e,cveCount:n,cveSeverity:o,ip:a,isLatest:i,isTruncated:p,tags:u,lastUpdatedAt:l,threats:f}){let[d]=ke([10]),g=pn("compass-ai-summary"),h=dn(),[N]=Le(),A=Wt(),E=Ge(),X=E.collectionId?`/collections/${E.collectionId}/results`:"/censys",O=(0,Zo.useMemo)(()=>{let m=new URLSearchParams(N);return m.delete("at_time"),`${A.pathname}?${m.toString()}`},[N,A]),t=N.toString(),s=`${t?`?${t}`:""}`,r=!i&&!!N.get("at_time");return(0,R.jsxs)("div",{className:ee.overviewHeaderContainer,children:[(0,R.jsxs)("div",{className:ee.contentTop,children:[(0,R.jsxs)("div",{className:ee.section,children:[p&&(0,R.jsx)(Ye,{content:"Truncated",children:(0,R.jsx)(ge,{size:"md",name:"eye-off",mode:"line",className:ee.textIcon,"data-testid":"truncated-icon","aria-hidden":!0})}),(0,R.jsx)(ro,{children:a}),(0,R.jsx)(pt,{variant:"dot"}),(0,R.jsx)(oo,{assetType:"host"}),r&&(0,R.jsx)(sn,{className:ee.historicalTag,size:"sm",children:"Historical"})]}),(0,R.jsxs)("div",{className:ee.section,children:[(0,R.jsx)(Rn,{assetId:a,assetType:"host",investigationName:`${a} Host Investigation`}),d&&(0,R.jsx)(Mn,{entityId:a,rescanResourceType:"UNKNOWN_HOST",className:ee.scanBtn,scanTime:l}),g&&h&&(0,R.jsx)(Vt,{hostIp:a,className:ee.summarizeBtn})]})]}),(0,R.jsxs)("div",{className:ee.contentBottom,children:[(0,R.jsxs)("div",{className:ee.tagsSection,children:[n>0&&(0,R.jsx)(qn,{count:n,severity:o,to:`${e}/cves${s}`}),f?.length>0&&(0,R.jsx)(Wn,{baseURL:`${e}/threats${s}`,threats:f}),u&&u.length>0&&(0,R.jsx)(Qn,{baseURL:X,labels:u,resourceType:"host"})]}),l&&(0,R.jsxs)("div",{className:ee.contentRow,children:[(0,R.jsx)(Ze,{timestamp:l}),r&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(pt,{variant:"line--vertical",spacing:6}),(0,R.jsx)(te,{href:O,"aria-label":"Link to latest",children:"See Latest"})]})]})]})]})}var Gt={summaryLayout:"_9rY0X",errorWrapper:"YYWsZ"};var xa=C(qo(),1),v=C(M(),1),nc=({data:e})=>[{title:e?.id?`${e.id} - Host Summary`:"Censys"}];function Xo({children:e,id:n,slots:o={},collectionId:a,collectionName:i}){let{t:p}=jt(),u=n.toLowerCase(),l=Cn({collectionsLabel:p("Collections"),collectionName:i,fallback:[{pathName:p("Search")}]}),f=vn({kind:0,field:"host.ip",value:u});return(0,v.jsx)(kn,{initialQuery:f,breadcrumbs:l,slots:{searchHeader:i?(0,v.jsx)(Nn,{breadcrumbs:l,placeholder:p("Search within",{name:i}),collectionId:a,children:(0,v.jsx)(On,{})}):(0,v.jsx)(Ln,{breadcrumbs:l}),header:o.pageHeader,navTabs:o.pageNavTabs},children:e})}function Ia(){let[e,n]=Le(),{atTime:o,cveDetails:a,host:i,servicesRawData:p,id:u,isLatest:l,capabilities:f,collection:d,flashMessage:g,lockedServices:h,csrf:N,threatDetails:A}=Bn(),E=An(),[X,O]=ke([11,13]),t=`/hosts/${u}`,s="/hosts/:id";d&&(t=`/collections/${d.collection_id}${t}`,s=`/collections/:collectionId${s}`);let r=!!ct(`${t}/cves/*`),m=!!ct(`${t}/threats/*`),S=(0,Z.useMemo)(()=>({collection:d,cveDetails:a,host:i,servicesRawData:p,lockedServices:h,threatDetails:A}),[i,d,a,p,h,A]),T=(0,Z.useMemo)(()=>e.get("isCollapsed")===void 0||e.get("isCollapsed")==="true",[e]),_=(0,Z.useCallback)(()=>{let x=new URLSearchParams(e);x.set("isCollapsed",(!T).toString()),n(x,{state:E})},[T,e,E]),B=(0,Z.useMemo)(()=>Array.from(new Set([...i.labels.map(x=>x.value)||[],...i.services.flatMap(x=>x.labels.map(ue=>ue.value))||[]])),[i]),z=(0,Z.useMemo)(()=>Array.from(new Set(i.services.flatMap(x=>x.threats).map(x=>x.name).filter(We))).sort(),[i]),G=!!i?.labels?.some(x=>x.value.toLowerCase()==="truncated"),L=(0,Z.useMemo)(()=>Vn(i),[i]),q=(0,Z.useMemo)(()=>$n(i),[i]),F=(0,Z.useMemo)(()=>Ke(i.services.flatMap(x=>x.vulns)),[i]),[Fe,me]=(0,Z.useState)(g!==null);return(0,Z.useEffect)(()=>{g&&me(!0)},[g]),(0,v.jsx)(yn,{value:f,children:(0,v.jsx)(ln,{token:N,children:(0,v.jsx)(Xo,{id:u,slots:{pageHeader:(0,v.jsx)(to,{assetType:"host",header:(0,v.jsx)($t,{baseRoute:t,cveCount:f[5]?L:0,cveSeverity:F,ip:u,isLatest:l,isTruncated:G,tags:B,lastUpdatedAt:zn(i,o)||void 0,threats:X?z:[]}),isCollapsed:T,toggle:_,children:(0,v.jsxs)("div",{className:Gt.summaryLayout,children:[(0,v.jsx)(Et,{baseLink:t,host:i,lockedServices:h}),(0,v.jsx)(gt,{host:i})]})}),pageNavTabs:(0,v.jsxs)(je,{children:[(0,v.jsx)(Oe,{id:"services",to:t,children:"Services"}),(0,v.jsx)(Oe,{id:"eventHistory",routePattern:`${s}/events/*`,to:`${t}/events`,children:"Event History"}),(0,v.jsx)(Oe,{id:"cves",routePattern:`${s}/cves/*`,to:`${t}/cves`,children:(0,v.jsxs)(yt,{children:["CVEs"," ",(0,v.jsx)(ut,{count:L,variant:r?De.SYSTEM:De.NEUTRAL})]})}),X&&(0,v.jsx)(Oe,{id:"threats",routePattern:`${s}/threats/*`,to:`${t}/threats`,prefetch:"none",children:(0,v.jsxs)(yt,{children:["Threats"," ",(0,v.jsx)(ut,{count:q,variant:m?De.SYSTEM:De.NEUTRAL})]})}),(0,v.jsx)(no,{canViewCenseye:O,targetRoute:t,routePattern:s}),(0,v.jsx)(Oe,{id:"rawData",routePattern:`${s}/data/*`,to:`${t}/data/table`,prefetch:"none",children:"Raw Data"})]})},collectionId:d?.collection_id,collectionName:d?.name,children:(0,v.jsxs)(Tn,{children:[(0,v.jsx)(Xt,{context:S}),g&&Fe&&(0,v.jsx)(_n,{onDismiss:()=>{me(!1)}})]})})})})}function oc(){let e=Zt(),n=Ge(),o=mn(),a=En(o),i=(0,Z.useContext)(qt);return(0,v.jsx)(Xo,{id:n.id||"",children:(0,v.jsx)("div",{className:Gt.errorWrapper,children:Yt(e)&&Fn(e.data)?(0,v.jsx)(Gn,{errorCode:e.data.code,orgState:a,env:i}):(0,v.jsx)(In,{error:e})})})}export{nc as a,Ia as b,oc as c};
