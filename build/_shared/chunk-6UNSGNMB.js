import{a as O}from"/censys/build/_shared/chunk-37QSTPVF.js";import{b as $}from"/censys/build/_shared/chunk-PTKV34J3.js";import{a as I}from"/censys/build/_shared/chunk-5HUKVACE.js";import{a as U,d as h}from"/censys/build/_shared/chunk-AIDQO3P6.js";import{a as w}from"/censys/build/_shared/chunk-ZKAH2G64.js";import{a as f}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as x}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{v as D,w as B,y as G}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{A as m,B as o,C as v,Ta as _,_ as M,aa as E,ba as C,sa as H,ua as P,va as S}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as k,c as L}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as c}from"/censys/build/_shared/chunk-2QEWK57A.js";var g=c(k(),1);var u=c(k(),1);var d={threatDetailTable:"sK0vZ",nameListContent:"ifkRC",rowLabel:"xyOlM",primaryName:"xG-AY",altNames:"lGjmH"};var e=c(L(),1);function W({threat:r}){let n=(0,u.useMemo)(()=>{let l=r.malware?.primary_name??"",p=r.malware?.all_names?.filter(N=>N!==l)??[];return{primaryName:l,altNames:p}},[r.malware]),i=(0,u.useMemo)(()=>r.actors.map(l=>({primaryName:l.primary_name??"",altNames:l.all_names?.filter(p=>p!==l.primary_name)??[]})),[r.actors]);return(0,e.jsxs)(U,{className:d.threatDetailTable,children:[n.primaryName&&(0,e.jsx)(h,{label:(0,e.jsx)(y,{children:f("Name",n.altNames.length)}),content:(0,e.jsxs)("div",{className:d.nameListContent,children:[(0,e.jsx)(o,{className:d.primaryName,children:n.primaryName}),n.altNames.length>0&&(0,e.jsxs)(o,{className:d.altNames,variant:m.SMALL,children:["(aka ",n.altNames.join(", "),")"]})]})}),r.type&&(0,e.jsx)(h,{label:(0,e.jsx)(y,{children:f("Type",r.type.length)}),content:r.type.map(V).join(", ")}),r.tactic&&(0,e.jsx)(h,{label:(0,e.jsx)(y,{children:f("Tactic",r.tactic.length)}),content:r.tactic.map(V).join(", ")}),i.length>0&&(0,e.jsx)(I,{label:(0,e.jsx)(y,{children:f("Actor",i.length)}),items:i,textOverride:{expand:"Show more",collapse:"Show less"},listComponent:l=>(0,e.jsxs)("div",{className:d.nameListContent,children:[(0,e.jsx)(o,{className:d.primaryName,children:l.primaryName}),l.altNames.length>0&&(0,e.jsxs)(o,{className:d.altNames,variant:m.SMALL,children:["(aka ",l.altNames.join(", "),")"]})]})}),r.details?.campaign_theme&&(0,e.jsx)(h,{label:(0,e.jsx)(y,{children:"Campaign"}),content:r.details.campaign_theme}),r.confidence&&(0,e.jsx)(h,{label:(0,e.jsx)(y,{children:"Confidence"}),content:(0,e.jsxs)(o,{children:[(0,e.jsx)(M,{value:((r.confidence??0)*100).toFixed(0)}),"%"]})})]})}function y({children:r}){return(0,e.jsx)(o,{className:d.rowLabel,variant:m.SMALL,children:r})}function V(r){return r.toLowerCase().replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}var R=(0,u.memo)(W);var z="https://malpedia.caad.fkie.fraunhofer.de/details/";var t={cardHeader:"_4quOz",cardHeaderDetails:"_4RDn7",cardIconWrapper:"DbwyG",cardHeaderActions:"eMgGj",sectionHeader:"l7cnc",cardBody:"XGGqb",cardGroup:"UZVQC",groupSection:"MyDBR",linkList:"Ryhmk",relatedLink:"Yc6qB",readMoreButton:"B91Pu"};var a=c(L(),1);function j({children:r,description:n,threat:i,subHeader:l}){let p=(0,g.useRef)(null);if(!i.name)return null;let N=i.name,s=i.id,F=B(G(D({kind:0,field:"host.services.threats.name",value:i.name}),D({kind:0,field:"web.threats.name",value:i.name}),"or",!1)),A=i.malware?.malpedia_id?[{label:`${i.malware.primary_name} at Malpedia`,href:`${z}${i.malware.malpedia_id}`}]:[];return(0,a.jsxs)(S,{headerPadding:P.NONE,id:N,tabIndex:-1,"aria-label":N,"aria-describedby":`${s}_description`,variant:H.INTERACTIVE,"data-testid":`threat-detail-card-${s}`,header:(0,a.jsxs)("div",{className:t.cardHeader,children:[(0,a.jsx)(O,{}),(0,a.jsxs)("div",{className:t.cardHeaderDetails,children:[(0,a.jsx)(o,{variant:m.DEFAULT_NUMERAL,children:N}),l]}),(0,a.jsxs)("div",{className:t.cardHeaderActions,children:[(0,a.jsx)(_,{content:"Go to threat details",children:(0,a.jsx)(w,{iconButton:{iconName:"arrow-right",iconMode:"line",size:C.LARGE,variant:v.DEFAULT,["aria-label"]:"Go to threat details"},link:{to:`/threats/${s}`}})}),(0,a.jsx)(_,{content:"Search for assets with this threat",children:(0,a.jsx)(w,{iconButton:{iconName:"search",iconMode:"line",size:C.LARGE,variant:v.DEFAULT,["aria-label"]:"Search for assets with this threat"},link:{to:F}})})]})]}),children:[(0,a.jsxs)("div",{className:t.cardBody,children:[(0,a.jsxs)("div",{className:t.cardGroup,children:[(0,a.jsx)(o,{className:t.sectionHeader,variant:m.H4,children:"Properties"}),(0,a.jsx)("div",{ref:p,children:(0,a.jsx)(R,{threat:i})})]}),(0,a.jsxs)("div",{className:t.cardGroup,children:[!!n&&(0,a.jsxs)("div",{className:t.groupSection,children:[(0,a.jsx)(o,{className:t.sectionHeader,variant:m.H4,id:`${s}_description_header`,children:"Threat Description"}),(0,a.jsx)($,{lineClamp:4,parentRef:p,button:(T,b)=>(0,a.jsx)(E,{onClick:b,variant:v.SECONDARY,iconRightMode:"line",iconRight:T?"arrow-up-s":"arrow-down-s",className:t.readMoreButton,"aria-controls":`${s}_description`,"aria-expanded":T,children:T?"Read less":"Read more"}),children:(0,a.jsx)(o,{id:`${s}_description`,"aria-labelledby":`${s}_description_header`,children:n})})]}),A.length>0&&(0,a.jsxs)("div",{className:t.groupSection,children:[(0,a.jsx)(o,{className:t.sectionHeader,variant:m.H4,id:`${s}_related_links_header`,children:"Related Links"}),(0,a.jsx)("ul",{className:t.linkList,"aria-labelledby":`${s}_related_links_header`,children:A.map(({label:T,href:b})=>(0,a.jsx)("li",{children:(0,a.jsx)(x,{className:t.relatedLink,href:b,isExternal:!0,showExternalIcon:!0,children:T})},b))})]})]})]}),r]})}var ya=(0,g.memo)(j);export{ya as a};
