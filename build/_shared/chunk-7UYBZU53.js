import{a as Gr}from"/censys/build/_shared/chunk-LEUHO63S.js";import{a as No}from"/censys/build/_shared/chunk-BDYR2V52.js";import{a as qr}from"/censys/build/_shared/chunk-P2Z7XMJZ.js";import{a as Wr}from"/censys/build/_shared/chunk-6X4NEB7P.js";import{a as Qr}from"/censys/build/_shared/chunk-ZXCJZMF4.js";import{a as Vr}from"/censys/build/_shared/chunk-22LTVVVT.js";import{b as Le,c as Ir,d as Or,e as Ur,f as Mr,g as Pe,h as zr,k as Ne,l as $r}from"/censys/build/_shared/chunk-LAGC572J.js";import{a as Br}from"/censys/build/_shared/chunk-NAHO4RKJ.js";import{a as Hr}from"/censys/build/_shared/chunk-LCN4BXNE.js";import{a as xr}from"/censys/build/_shared/chunk-4533AUAX.js";import{a as Dr,c as Fe,d as ie,e as Ke}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{b as Nr}from"/censys/build/_shared/chunk-XMNCU3E4.js";import{d as kr}from"/censys/build/_shared/chunk-Y2IQJ4EL.js";import{a as _r}from"/censys/build/_shared/chunk-SZRPTSUZ.js";import{a as Lr}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as Pr}from"/censys/build/_shared/chunk-OFRBI5JW.js";import{a as wr}from"/censys/build/_shared/chunk-QGDPKSYE.js";import{d as Ar}from"/censys/build/_shared/chunk-IO4OV3HV.js";import{a as Po}from"/censys/build/_shared/chunk-IC5AY47K.js";import{d as nr,e as lr,t as Rr}from"/censys/build/_shared/chunk-B5UNN2SO.js";import{a as dr}from"/censys/build/_shared/chunk-7C4UGOB7.js";import{e as Re,f as pr}from"/censys/build/_shared/chunk-IRHQADG7.js";import{a as Jt}from"/censys/build/_shared/chunk-FP2KPINM.js";import{b as tr,g as rr}from"/censys/build/_shared/chunk-VKYVKQW2.js";import{b as ur,c as qe,d as hr,e as k}from"/censys/build/_shared/chunk-OQUAXVLV.js";import{a as Fr}from"/censys/build/_shared/chunk-BWODHJE6.js";import{A as Ye,C as br,D as Tr,b as mr,c as fr,d as gr,e as Ge,f as Sr,g as Qe}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{f as yr,q as vr}from"/censys/build/_shared/chunk-MB47ZWHU.js";import{a as er}from"/censys/build/_shared/chunk-WK35ORSL.js";import{b as cr,q as Cr,r as Er}from"/censys/build/_shared/chunk-426SZY5O.js";import{a as A}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{a as V}from"/censys/build/_shared/chunk-M5RKE22T.js";import{d as Zt,k as Xt}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{e as Ce,h as Kt}from"/censys/build/_shared/chunk-ST66DGSY.js";import{B as ar,H as be,I as ir,J as Te,a as Nt,k as jt,m as or,n as Ve,o as sr,p as Ee,x as We}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{$ as G,$a as Yt,A as y,B as O,E as At,K as kt,M as wt,N as Dt,O as xt,P as Ht,Qa as Vt,Ra as Wt,W as It,X as Ot,Xa as qt,Y as Ut,Ya as Gt,Z as Mt,_ as zt,_a as Qt,aa as Be,ca as $e,ea as ve,ua as Bt,x as Se,xa as $t,y as ye,z as v}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as F}from"/censys/build/_shared/chunk-F5K75D4K.js";import{c as _t}from"/censys/build/_shared/chunk-44DVAK2X.js";import{C as Pt,a as vt,c as J,g as Ct,i as Et,j as bt,k as Tt,l as Rt,p as j,r as Ft,z as Lt}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as p}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as $}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as c}from"/censys/build/_shared/chunk-2TWE7TSA.js";var le={["host"]:[],["certificate"]:[],["web"]:[]};var pe=c($(),1);var _e=c($(),1);var Ze={sidebar:"_6BA67",sidebarContent:"_9-GNN"};var Xe=c(p(),1);function ce({children:e,className:r,...s}){let o=(0,_e.useRef)(null);return(0,_e.useEffect)(()=>{let t=()=>{if(!o.current)return;let a=o.current.getBoundingClientRect();o.current.style.setProperty("--sidebar-top-position",`${a.top}px`)},i=new ResizeObserver(t);return o.current&&i.observe(o.current),t(),()=>{i.disconnect()}},[]),(0,Xe.jsx)("aside",{ref:o,className:Se(Ze.sidebar,r),...s,children:(0,Xe.jsx)("div",{className:Ze.sidebarContent,children:e})})}var Ae={skeletonFilterCategory:"xBuHn",category:"vQGbz",filter:"OneKU"};var W=c(p(),1);function ee({items:e=3}){return(0,W.jsxs)("div",{className:Ae.skeletonFilterCategory,children:[(0,W.jsxs)("div",{className:Ae.category,children:[(0,W.jsx)(ye,{icon:"arrow-down-s-line",size:"sm"}),(0,W.jsx)(k,{variant:v.H5,color:"heading",width:100})]}),Array.from(Array(e).keys()).map((r,s)=>(0,W.jsxs)("div",{className:Ae.filter,children:[(0,W.jsx)(k,{width:100}),(0,W.jsx)(k,{variant:v.SMALL,width:25,color:"secondary"})]},s))]})}var Je={skeletonFilterSidebar:"Erl6u",skeletonContent:"_4sYK9"};var I=c(p(),1);function te({isEmpty:e}){return(0,I.jsx)(ce,{className:Je.skeletonFilterSidebar,children:!e&&(0,I.jsxs)("div",{role:"menu","aria-busy":!0,className:Je.skeletonContent,children:[(0,I.jsx)(ee,{}),(0,I.jsx)(V,{variant:"line--horizontal",size:"100%"}),(0,I.jsx)(ee,{items:4}),(0,I.jsx)(V,{variant:"line--horizontal",size:"100%"}),(0,I.jsx)(ee,{items:5}),(0,I.jsx)(V,{variant:"line--horizontal",size:"100%"}),(0,I.jsx)(ee,{})]})})}var N={card:"UFC99",header:"_9P5QI",assetDetails:"cIoWU",headerText:"-RtEs",cardBody:"q39jD",labels:"c0uoO",columns:"-bzy-",detailRows:"X3IvY",detailRow:"By-re",label:"wfw-2",services:"_0FM1c",divider:"_3W6oC"};var h=c(p(),1);function K(){return(0,h.jsx)(ur,{className:N.card,header:(0,h.jsxs)("div",{className:N.header,children:[(0,h.jsxs)("div",{className:N.assetDetails,children:[(0,h.jsx)(hr,{size:50,shape:"round"}),(0,h.jsxs)("div",{className:N.headerText,children:[(0,h.jsx)(k,{variant:v.SMALL_NUMERAL,width:200}),(0,h.jsx)(V,{variant:"dot",inheritColor:!0}),(0,h.jsx)(k,{variant:v.H5,width:100,color:"secondary"})]})]}),(0,h.jsx)(k,{width:160})]}),children:(0,h.jsxs)("div",{className:N.cardBody,children:[(0,h.jsx)("div",{className:N.labels,children:Array.from({length:3}).map((e,r)=>(0,h.jsx)(qe,{},r))}),(0,h.jsxs)("div",{className:N.columns,children:[(0,h.jsxs)("div",{className:N.detailRows,children:[(0,h.jsx)(je,{width:120}),(0,h.jsx)(je,{width:100}),(0,h.jsx)(je,{width:150})]}),(0,h.jsxs)("div",{className:N.services,children:[(0,h.jsx)(k,{variant:v.SMALL,width:100,color:"secondary"}),(0,h.jsx)("div",{className:N.labels,children:Array.from({length:2}).map((e,r)=>(0,h.jsx)(qe,{size:"small",width:60},r))})]})]}),(0,h.jsx)(V,{className:N.divider,variant:"line--horizontal",size:"100%",inheritColor:!0}),(0,h.jsxs)("div",{className:N.detailRow,children:[(0,h.jsx)("div",{className:N.label,children:(0,h.jsx)(k,{width:120,color:"secondary"})}),(0,h.jsx)(k,{width:90})]})]})})}var je=({width:e})=>(0,h.jsxs)("div",{className:N.detailRow,children:[(0,h.jsx)("div",{className:N.label,children:(0,h.jsx)(k,{variant:v.SMALL,color:"secondary",width:e-10})}),(0,h.jsx)(k,{width:e})]});var ke={resultsContainer:"A6s6D",resultsText:"_1Qurq",resultCards:"umhsr"};var _=c(p(),1);function de(){let{t:e}=F();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(te,{}),(0,_.jsxs)("div",{className:ke.resultsContainer,children:[(0,_.jsx)("div",{className:ke.resultsText,children:(0,_.jsx)(y,{children:e("Searching every corner of the internet...")})}),(0,_.jsxs)("div",{className:ke.resultCards,"data-testid":"search-loading",children:[(0,_.jsx)(K,{}),(0,_.jsx)(K,{}),(0,_.jsx)(K,{}),(0,_.jsx)(K,{})]})]})]})}var Yr={contentWrapper:"HAjRM"};var Kr="field",Zr="num_buckets",Xr="50";function Jr(e,r,s,o){let t=`?q=${s}&${Kr}=${e}&${Zr}=${Xr}`,i="report";r(o?`/collections/${o}/${i}/data/table${t}`:`/censys/${i}/data/table${t}`)}function we(e,r){return Te(e)?or[e].filter(o=>r.has(be(o))):[]}var De=c(p(),1);function jr({filters:e,dataSets:r,applyFilter:s,viewAggregation:o}){let t=Ve.every(a=>!e[a]?.buckets?.length),i=a=>{let n=we(a,r),d=n.length===1?n[0]:a;return e[a]?.buckets.length?(0,De.jsx)(Wr,{onApplyFilter:s,onViewAggregation:ir(a)||d!==a?o:void 0,field:a,buckets:e[a].buckets,title:sr[a]},a):null};return(0,De.jsx)(ce,{"aria-label":"Select a filter to narrow down your results",children:!t&&(0,De.jsx)("div",{className:Yr.contentWrapper,children:Ve.map(i)})})}var et=c(p(),1);function tt({queryDataSets:e}){let{q:r,submitSearch:s}=Ee(),[o]=j(),t=pr(),i=gr(),a=dr(()=>{let g=[["q",((new URL(window.location.href)).searchParams.get("q") || "").trim()],["data_sets",e.join(",")]];return t?.collection_id&&g.push(["collection_id",t.collection_id]),`/api/filters?${new URLSearchParams(g).toString()}`},[r,t?.collection_id,JSON.stringify(e)]),n=(0,pe.useMemo)(()=>new Set(e),[e]),d=(0,pe.useCallback)((g,P,H)=>{let D;if(Array.isArray(g)){if(g.length===0)return;let f=g.filter(Y=>n.has(jt.DataSet.DATA_SET_UNSPECIFIED)||n.has(be(Y))),B=f.reduce((Y,se)=>ar(Y,We({kind:0,field:se,value:P}),"or",!1),"");if(f.length===0)return;let X=f.length>1;s({q:H?X?`not (${B})`:`not ${B}`:X?`(${B})`:B});return}if(g==="type"){let f;switch(P){case"cert":f="cert.fingerprint_sha256";break;case"web":f="web.port";break;case"host":default:f="host.ip";break}D={field:f,kind:1,value:"*",escape:!1}}else D={kind:0,field:g,value:P};let z=We(D);s({q:H?`not ${z}`:z})},[s,n]),E=(0,pe.useCallback)(g=>{if(Te(g)){let P=we(g,n);if(P.length===1)g=P[0];else return}Jr(g,i,o.get("q")??"",t?.collection_id)},[i,o,t?.collection_id,n]);return a.state===0||a.state===2?(0,et.jsx)(te,{isEmpty:a.state===2}):(0,et.jsx)(jr,{applyFilter:d,dataSets:n,filters:a.data.filters,viewAggregation:E})}var ht=c($(),1);var C=c($(),1);var R={triggerButton:"hriuJ",popoverContent:"dsZgd",form:"_1B4oX",header:"m9HEb",headerTitle:"EmNXP",headerDescription:"AO9L-",searchContainer:"e0ERz",tabContent:"-jN9M",fieldList:"dzVuX",fieldItem:"qo6aT",fieldLabel:"b53yN",fieldPath:"oJPmy",emptyState:"nfSai",footer:"ZYFDT",footerActions:"PE5G4",tabs:"Bf-A3",selectedCount:"h64Iz",selectedCountNumber:"BN34x",footerLeft:"dAFyw",clearButton:"GAlbU"};var eo=["host.location.country","host.dns.reverse_dns.names","host.services.transport_protocol","host.hardware.product","host.hardware.vendor","host.services.banner","host.hardware.type","host.dns.names","host.location.postal_code","host.location.continent","host.location.timezone","host.location.coordinates.latitude","host.location.coordinates.longitude","host.autonomous_system.bgp_prefix","host.whois.network.name","host.whois.network.cidrs","host.whois.network.handle"],to=["cert.fingerprint_sha256","cert.parsed.subject_dn","cert.parsed.subject.common_name","cert.parsed.validity_period.not_before","cert.parsed.validity_period.not_after","cert.parsed.signature.self_signed","cert.validation.chrome.is_valid","cert.validation.chrome.ever_valid","cert.fingerprint_sha1","cert.fingerprint_md5","cert.parsed.subject_key_info.key_algorithm.name","cert.parsed.serial_number","cert.parsed.serial_number_hex","cert.validation.nss.is_valid","cert.validation.nss.ever_valid","cert.validation.microsoft.is_valid","cert.validation.microsoft.ever_valid","cert.validation.apple.is_valid","cert.validation.apple.ever_valid"],ro=["web.endpoints.http.html_title","web.endpoints.path","web.tls.version_selected","web.tls.cipher_selected","web.tls.fingerprint_sha256","web.scan_time"];function oo(e,r){if(!r.trim())return e;let s=r.toLowerCase();return e.filter(o=>o.toLowerCase().includes(s))}function so(e){switch(e){case"host":return eo;case"certificate":return to;case"web":return ro}}var l=c(p(),1),rt=["host","certificate","web"];function Ao({field:e,isSelected:r,onToggle:s}){let o=(0,C.useCallback)(t=>{typeof t=="boolean"&&s(e)},[e,s]);return(0,l.jsxs)("div",{className:R.fieldItem,"data-selected":r,children:[(0,l.jsx)(Yt,{id:`search-field-${e}`,checked:r,onCheckedChange:o,"aria-label":`Check this to add ${e}`}),(0,l.jsx)("label",{htmlFor:`search-field-${e}`,className:R.fieldLabel,children:(0,l.jsx)(y,{className:R.fieldPath,children:e})})]})}function ko({assetType:e,selectedFields:r,initialSelectedFields:s,searchQuery:o,onToggleField:t}){let i=(0,C.useMemo)(()=>so(e),[e]),{t:a}=F(),n=(0,C.useMemo)(()=>oo(i,o).sort((E,g)=>{let P=s.includes(E),H=s.includes(g);return P&&!H?-1:!P&&H?1:0}),[i,o,s]);return n.length===0?(0,l.jsx)("div",{className:R.emptyState,children:(0,l.jsx)(y,{variant:v.DEFAULT,children:a("No fields match your search")})}):(0,l.jsx)("div",{className:R.fieldList,role:"group","aria-label":`${e} fields`,children:n.map(d=>(0,l.jsx)(Ao,{field:d,isSelected:r.includes(d),onToggle:t},d))})}function xe({initialConfig:e=le}){let r=Pt(),s=bt(),[o,t]=(0,C.useState)(!1),[i,a]=(0,C.useState)("host"),[n,d]=(0,C.useState)(""),[E,g]=(0,C.useState)(e),[P,H]=(0,C.useState)(e),D=(0,C.useRef)(!1),z=e!==E,{t:f}=F(),B=(0,C.useCallback)(u=>{switch(u){case"host":return f("Hosts");case"certificate":return f("Certificates");case"web":return f("Web Properties")}},[f]);(0,C.useEffect)(()=>{g(e)},[e]),(0,C.useEffect)(()=>{D.current&&r.state==="idle"&&r.data&&(D.current=!1,s.revalidate())},[r.state,r.data,s]);let X=(0,C.useCallback)(u=>{d(u.target.value)},[]),Y=(0,C.useCallback)(u=>{g(ae=>{let ze=ae[i],Fo=ze.includes(u);return{...ae,[i]:Fo?ze.filter(Lo=>Lo!==u):[...ze,u]}})},[i]),se=(0,C.useCallback)(()=>{g(u=>({...u,[i]:[]}))},[i]),q=(0,C.useCallback)(()=>{g(u=>({...u,["host"]:[],["certificate"]:[],["web"]:[]}))},[]),yt=[E["host"].length>0,E["certificate"].length>0,E["web"].length>0].filter(Boolean).length>=2,Co=(0,C.useCallback)(u=>{u.preventDefault(),D.current=!0,lr("personalizedFieldsVersion",Date.now()),r.submit(u.currentTarget),t(!1)},[r]),Eo=(0,C.useCallback)(u=>{t(u),u?H(e):(d(""),g(e))},[e]),fe=E["host"].length+E["certificate"].length+E["web"].length,ge=E[i].length,bo=z&&fe>0,To=ge>0,Ro=(0,C.useCallback)(u=>{u.preventDefault(),setTimeout(()=>{document.querySelector('[id^="search-field-"]')?.focus()},0)},[]);return(0,l.jsxs)(kt,{open:o,onOpenChange:Eo,children:[(0,l.jsx)(wt,{asChild:!0,children:(0,l.jsxs)(G,{variant:O.DEFAULT,iconLeft:"user-settings",iconLeftMode:"line",className:R.triggerButton,"aria-label":f("Personalize search result cards"),children:[f("Personalize Results"),fe>0&&(0,l.jsxs)(l.Fragment,{children:[" ","(",(0,l.jsx)(ve,{value:fe}),")"]})]})}),(0,l.jsx)(Dt,{children:(0,l.jsx)(xt,{className:R.popoverContent,align:"end",sideOffset:8,"aria-label":f("Personalized fields configuration"),onOpenAutoFocus:Ro,children:(0,l.jsxs)(r.Form,{method:"POST",action:"/api/personalizedSearchFields",onSubmit:Co,className:R.form,children:[rt.map(u=>E[u].map(ae=>(0,l.jsx)("input",{type:"hidden",name:u,value:ae},ae))),(0,l.jsxs)("div",{className:R.header,children:[(0,l.jsxs)("div",{className:R.headerTitle,children:[(0,l.jsx)(y,{variant:v.H4,as:"span",children:f("Personalize Results")}),(0,l.jsx)("div",{className:R.headerDescription,children:(0,l.jsx)(y,{variant:v.SMALL,as:"span",children:f("Select data fields to highlight in your search results. Personalized fields are not search filters.")})})]}),(0,l.jsx)(Ht,{asChild:!0,children:(0,l.jsx)($e,{iconName:"close",iconMode:"line",size:Be.MEDIUM,variant:O.GHOST,"aria-label":f("Close")})})]}),(0,l.jsx)("div",{className:R.searchContainer,children:(0,l.jsx)(At,{placeholder:`${f("Search fields")}...`,value:n,onChange:X,isFullWidth:!0,"aria-label":f("Search fields"),contentLeft:(0,l.jsx)(ye,{name:"search",mode:"line"}),contentRight:n&&(0,l.jsx)($e,{"aria-label":f("Clear"),iconName:"close",iconMode:"line",size:Be.SMALL,variant:O.GHOST,onClick:()=>d("")})})}),(0,l.jsxs)(It,{value:i,onValueChange:u=>a(u),className:R.tabs,children:[(0,l.jsx)(Ot,{children:rt.map(u=>(0,l.jsxs)(Ut,{value:u,children:[B(u),E[u].length>0&&(0,l.jsxs)(l.Fragment,{children:[" ",(0,l.jsx)(Wt,{count:E[u].length,variant:Vt.SYSTEM})]})]},u))}),rt.map(u=>(0,l.jsx)(Mt,{value:u,className:R.tabContent,children:(0,l.jsx)(ko,{assetType:u,selectedFields:E[u],initialSelectedFields:P[u],searchQuery:n,onToggleField:Y})},u))]}),(0,l.jsxs)("div",{className:R.footer,children:[(0,l.jsxs)("div",{className:R.footerLeft,children:[ge>0&&(0,l.jsxs)(y,{variant:v.SMALL,className:R.selectedCount,children:[(0,l.jsx)("span",{className:R.selectedCountNumber,children:(0,l.jsx)(ve,{value:ge})})," ",f("selected",{count:ge})]}),To&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Qt,{variant:Gt.DOT}),(0,l.jsx)(G,{type:"button",variant:O.TERTIARY,size:zt.SMALL,onClick:se,"aria-label":f("Clear all selections for this tab"),className:R.clearButton,children:f("Clear")})]})]}),(0,l.jsxs)("div",{className:R.footerActions,children:[yt&&(0,l.jsx)(G,{type:"button",variant:O.TERTIARY,onClick:q,"aria-label":f("Clear selections for all tabs"),children:f("Clear All")}),(0,l.jsx)("div",{className:R.saveButton,children:(0,l.jsxs)(G,{type:"submit",variant:O.PRIMARY,"aria-label":f("Save personalized fields"),disabled:!z,children:[f("Save"),bo&&(0,l.jsxs)(l.Fragment,{children:[" ","(",(0,l.jsx)(ve,{value:fe}),")"]})]})})]})]})]})})})]})}var x={container:"ta2rr",headerContainer:"sxKxd",header:"_8Ls-2",headerText:"_6kUYA",dividerLine:"FEjTq",fieldList:"jj0k2",fieldItem:"gcy-g",fieldValue:"sO9wI",serviceTagsContainer:"ioLlY"};function He(e,r){if(r.length===0)return e;if(e==null)return;let[s,...o]=r;if(Array.isArray(e)){let t=e.map(i=>He(i,r)).filter(i=>i!==void 0).flatMap(i=>Array.isArray(i)?i:[i]);return t.length>0?t:void 0}if(typeof e=="object"&&s!==void 0)return He(e[s],o)}function ot(e){return e.includes(".services.")}function ao(e){return e.match(/\.services\.(.+)$/)?.[1]??""}function st(e,r){let s=r.split("."),o=s[0],t=o==="host"||o==="cert"||o==="web"?s.slice(1):s;return He(e,t)}function wo(e){return e==null||e===""}function Ie(e){if(wo(e))return null;if(Array.isArray(e)){let r=e.flatMap(o=>{let t=Ie(o);return t!==null?[t]:[]}),s=[...new Set(r)];return s.length>0?s.join(", "):null}return typeof e=="boolean"?e?"Yes":"No":typeof e=="object"?JSON.stringify(e):String(e)}function io(e,r,s){let o=new Map;for(let t of e){let i=st(t,r),a=Ie(i);if(a===null)continue;let n=o.get(a);n?n.count+=1:o.set(a,{count:1,href:`${s}#${Ar(t)}`})}return Array.from(o.entries()).map(([t,{count:i,href:a}])=>{let n=Hr(t,50);return{href:a,label:i>1?`${n} (${i})`:n}})}var no=new Set(["host.services.screenshots.handle","host.services.endpoints.screenshots.handle","web.endpoints.screenshots.handle"]);function at(e){return e.some(r=>no.has(r))}function it(e){return no.has(e)}function lo(e){let r=e,s=[];return Array.isArray(r.services)&&r.services.forEach(o=>{o?.protocol&&s.push(...yr(o,{includeDescription:!0,port:o.port}))}),Array.isArray(r.endpoints)&&r.endpoints.forEach(o=>{s.push(...vr(o))}),s}var S=c(p(),1),co=5;function re({personalizedFields:e,rawData:r,baseURL:s,services:o}){let{t}=F(),i=e.filter(a=>!it(a));return i.length===0?null:(0,S.jsxs)("div",{className:x.container,children:[(0,S.jsx)("div",{className:x.headerContainer,children:(0,S.jsxs)(y,{className:x.header,variant:v.H5,as:"span",children:[(0,S.jsx)(Jt,{icon:"user-settings-line",iconLabel:"Personalized Fields",content:"Fields you've chosen to display on all search result cards."}),(0,S.jsx)("span",{className:x.headerText,children:t("Personalized Fields")}),(0,S.jsx)("span",{className:x.dividerLine})]})}),(0,S.jsx)("dl",{className:x.fieldList,children:i.map(a=>(0,S.jsx)(Do,{field:a,value:st(r,a),baseURL:s,services:ot(a)?o:void 0,servicePropertyPath:ot(a)?ao(a):void 0},a))})]})}function Do({field:e,value:r,baseURL:s,services:o,servicePropertyPath:t}){if(o&&o.length>0&&t&&s){let i=io(o,t,s);if(i.length===0)return(0,S.jsxs)("div",{className:x.fieldItem,children:[(0,S.jsx)("dt",{children:(0,S.jsx)(Fe,{children:e})}),(0,S.jsx)("dd",{children:(0,S.jsx)(Ke,{})})]});let a=Math.max(0,i.length-co);return(0,S.jsxs)("div",{className:x.fieldItem,children:[(0,S.jsx)("dt",{children:(0,S.jsx)(Fe,{children:e})}),(0,S.jsx)("dd",{className:x.serviceTagsContainer,children:(0,S.jsx)(xr,{tags:i,maxVisibleRows:co,expandTextOverride:a>0?`+${a} more`:"",collapseTextOverride:"Show less",hasWrappingTrigger:!0})})]})}return(0,S.jsxs)("div",{className:x.fieldItem,children:[(0,S.jsx)("dt",{children:(0,S.jsx)(Fe,{children:e})}),(0,S.jsx)("dd",{children:(0,S.jsx)(xo,{value:r})})]})}function xo({value:e}){let r=Ie(e);return r===null?(0,S.jsx)(Ke,{}):(0,S.jsx)(y,{variant:v.SMALL_SOURCE,className:x.fieldValue,children:r})}var mo=c($(),1);var po={container:"mKJAu"};var nt=c(p(),1),Ho=200;function me({personalizedFields:e,rawData:r}){let s=at(e),o=(0,mo.useMemo)(()=>s?lo(r):[],[s,r]);return!s||o.length===0?null:(0,nt.jsx)("div",{className:po.container,children:(0,nt.jsx)(kr,{screenshots:o,width:Ho})})}var Q={resultTips:"gg5cP",headline:"_4juzy",tipList:"kBc-8",source:"ZnvKT"};var b=c(p(),1);function lt(){let{t:e}=F();return(0,b.jsxs)("div",{className:Q.resultTips,"data-testid":"empty-results",children:[(0,b.jsx)(y,{className:Q.headline,variant:v.H1_SUB_HEADLINE,children:e("Your query returned no results.")}),(0,b.jsx)(y,{variant:v.DEFAULT_SEMIBOLD,children:e("Quick tips:")}),(0,b.jsxs)("ul",{className:Q.tipList,children:[(0,b.jsxs)("li",{children:[(0,b.jsxs)(y,{children:[e("Try searching using a")," ",(0,b.jsx)(y,{className:Q.source,variant:v.DEFAULT_SOURCE,children:e("key:value")})," ",e("pair. The")," "]}),(0,b.jsx)(A,{href:"/home/definitions",title:"View Data Definitions",children:e("Data Definitions")})," ",(0,b.jsx)(y,{children:e("page provides a list of keys.")})]}),(0,b.jsx)("li",{children:(0,b.jsxs)(y,{children:[e("Don't know the value? Use a wildcard")," ",(0,b.jsx)(y,{className:Q.source,variant:v.DEFAULT_SOURCE,children:"(*)"})," ",e("instead to return hosts that have any value for the field.")]})}),(0,b.jsx)("li",{children:(0,b.jsxs)(y,{children:[e("Use the exact operator")," ",(0,b.jsx)(y,{className:Q.source,variant:v.DEFAULT_SOURCE,children:"="})," ",e("to restrict results to exact matches.")]})})]}),(0,b.jsx)(y,{variant:v.DEFAULT_SEMIBOLD,children:e("For more information:")}),(0,b.jsx)("ul",{className:Q.tipList,children:(0,b.jsxs)("li",{children:[(0,b.jsx)(y,{children:e("Read the")})," ",(0,b.jsx)(A,{href:"https://docs.censys.com/docs/censys-query-language#/",isExternal:!0,children:e("Introduction to Censys Query Language")})," ",(0,b.jsx)(y,{children:e("for information on writing queries.")})]})})]})}var ct=c(p(),1);function uo(){let e=J();return Pe(e.pathname)?(0,ct.jsx)(qr,{}):(0,ct.jsx)(lt,{})}var Oe={searchResults:"pd2r0",resultsContainer:"W63L-",resultCards:"rAnPY"};var fo=c($(),1);var ho={paginationContainer:"hG1k9"};var oe=c(p(),1);function dt({nextCursor:e,pageLimitMessage:r,previousCursor:s,onCursorChange:o}){let{t}=F(),i=Rr(),a=(0,fo.useCallback)(d=>()=>{i(),o(d||void 0)},[o,i]),n=(0,oe.jsx)(G,{onClick:a(e),disabled:!e||!!r,variant:O.DEFAULT,iconRight:r?"lock-star":"arrow-right-s",iconRightMode:"line",type:"submit",value:e?.toString(),name:"cursor",children:t("Next")});return(0,oe.jsxs)("div",{className:ho.paginationContainer,children:[(0,oe.jsx)(G,{onClick:a(s),disabled:!s,variant:O.DEFAULT,iconLeft:"arrow-left-s",iconLeftMode:"line",type:"submit",value:s?.toString(),name:"cursor",children:t("Previous")}),r!==null?(0,oe.jsx)(qt,{content:r,children:n}):n]})}var Z={cardHeaderContainer:"KidRo",cardHeaderContent:"ZW9k0",cardHeaderContentLeft:"lJbkl",displayNameContent:"SMBE7",displayName:"qnT0K",cardHeaderContentRight:"rv7Bo"};var w=c(p(),1);function pt({hit:{fingerprint_sha256:e,parsed:r,modified_at:s},baseURL:o}){let t=tr(r,e),i=$r(),{t:a}=F();return(0,w.jsxs)("div",{className:Z.cardHeaderContainer,children:[(0,w.jsx)(_r,{assetType:"certificate",size:"md"}),(0,w.jsxs)("div",{className:Z.cardHeaderContent,children:[(0,w.jsxs)("div",{className:Z.cardHeaderContentLeft,children:[(0,w.jsx)("div",{className:Z.displayNameContent,children:(0,w.jsx)(A,{state:i,href:o,title:a("View Details",{displayName:t}),variant:"nav",size:"lg",children:(0,w.jsx)("span",{className:Z.displayName,children:t})})}),(0,w.jsx)(V,{variant:"dot"}),(0,w.jsx)(y,{variant:v.H5,children:a("Certificate")})]}),(0,w.jsx)("div",{className:Z.cardHeaderContentRight,children:s&&(0,w.jsx)(Pr,{timestamp:s.toString()})})]})]})}var So=c($(),1);var go={tableContainer:"elFe6"};var U=c(p(),1);function mt(e){let{t:r}=F(),{parsed:s,names:o}=e,t=(0,So.useMemo)(()=>rr([e])?.aggregatedStatus,[e]);return(0,U.jsx)("div",{className:go.tableContainer,children:(0,U.jsxs)(Dr,{children:[(0,U.jsx)(ie,{label:r("Issuer"),content:s?.issuer_dn}),(0,U.jsx)(ie,{label:r("Validity Period"),content:(0,U.jsx)(Gr,{before:s?.validity_period?.not_before,after:s?.validity_period?.not_after})}),(0,U.jsx)(ie,{label:r("Browser Trust"),content:t&&(0,U.jsx)(Nr,{aggregatedStatus:t})}),(0,U.jsx)(ie,{label:r("All Names"),content:o&&o.join(" ")})]})})}var Ue={cardBodyContent:"rlZPP",labelOverview:"VYjDV"};var M=c(p(),1);function ut({hit:e,labels:r,children:s}){let o=Ct(),t=o.id?`/collections/${o.id}/certificates/${e.fingerprint_sha256}`:`/certificates/${e.fingerprint_sha256}`,i=o.id?`/collections/${o.id}/results`:"/censys",a=r.length>0;return(0,M.jsx)("div",{"data-testid":"cert-details-card",children:(0,M.jsxs)($t,{variant:Bt.INTERACTIVE,header:(0,M.jsx)(pt,{hit:e,baseURL:t}),children:[(0,M.jsxs)("div",{className:Ue.cardBody,children:[a?(0,M.jsx)("div",{className:Ue.labelOverview,children:(0,M.jsx)(Br,{baseURL:i,labels:r,resourceType:"certificate"})}):null,(0,M.jsx)("div",{className:Ue.cardBodyContent,children:(0,M.jsx)(mt,{...e})})]}),s]})})}var T=c(p(),1);function Io(e,r,s,o,t,i,a){if(e.web?.web){let n=Mr(e.web),d=`${n?.hostname}:${n?.port}`;return n&&(0,T.jsxs)(Vr,{hit:n,screenshots:a&&(0,T.jsx)(me,{personalizedFields:i["web"],rawData:e.web.web}),children:[a&&(0,T.jsx)(re,{personalizedFields:i["web"],rawData:e.web.web,baseURL:`/web/${d}`}),(0,T.jsx)(Le,{listKey:d,highlights:e.highlights,hasHighlightEntitlement:s})]},d)}else if(e.certificate){let n=Or(e.certificate);return n&&(0,T.jsxs)(ut,{hit:n,labels:e.certificate.labels,children:[a&&(0,T.jsx)(re,{personalizedFields:i["certificate"],rawData:e.certificate.certificate,baseURL:`/certificates/${n.fingerprint_sha256}`}),(0,T.jsx)(Le,{listKey:n.fingerprint_sha256,highlights:e.highlights,hasHighlightEntitlement:s})]},n.fingerprint_sha256)}else if(e.host?.host){let n=Ur(e.host),d=t?`/collections/${t}/hosts/${n?.ip}`:`/hosts/${n?.ip}`;return n&&(0,T.jsxs)(Qr,{hit:n,historyLimitDays:o,screenshots:a&&(0,T.jsx)(me,{personalizedFields:i["host"],rawData:e.host.host}),children:[a&&(0,T.jsx)(re,{personalizedFields:i["host"],rawData:e.host.host,baseURL:d,services:n.services}),(0,T.jsx)(Le,{listKey:e.host.host.ip,highlights:e.highlights,hasHighlightEntitlement:s,services:n.services,ip:n.ip})]},e.host.host.ip)}return null}function ft({historyLimitDays:e,pageLimitMessage:r,q:s,results:o,hasHighlightEntitlement:t,personalizedFieldsConfig:i}){let[a,n]=j(),d=J(),E=Pe(d.pathname),P=Re(d.pathname)?.collection_id??null,H=Ce()?.currentPlanType==="Enterprise",D=!!o.hits?.length,z=D||!E,f=D&&H,B=Kt("personalized-fields"),X=(0,ht.useCallback)(q=>{q?a.set("cursor",q):a.delete("cursor"),n(a)},[a,n]),Y=(0,ht.useCallback)(()=>{if(o.hits){let q=o.hits.map(zr);try{Er(`CensysSearch_${Temporal.Now.instant().toString().split(".")[0]}`,Cr(q.filter(er)))}catch{}}},[o.hits]),se=o.hits?.length?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:Oe.resultCards,children:o.hits.map(q=>Io(q,s,t,e,P,i,B))}),(0,T.jsx)(dt,{pageLimitMessage:r,nextCursor:o.next_page_token||null,previousCursor:o.previous_page_token||null,onCursorChange:X})]}):(0,T.jsx)(uo,{});return(0,T.jsx)("div",{className:Oe.searchResults,children:(0,T.jsxs)("div",{className:Oe.resultsContainer,children:[z&&(0,T.jsx)(Ir,{actions:B&&(0,T.jsx)(xe,{initialConfig:i}),currentPageSize:o.hits?.length||0,durationMs:o.query_duration_millis||0,onDownloadCsv:f?Y:void 0,totalHits:o.total_hits||0}),se]})})}var vo=c($(),1);var yo=c($(),1);var m=c(p(),1);function Uo({error:e,env:r,accessState:s,searchParams:o}){let t=zo(e,r,s,o);return(0,m.jsx)(fr,{"data-testid":`error_${String(e.code)}`,iconName:t.iconName,iconMode:t.iconMode,title:t.title,children:t.message})}var Mo=e=>Xt(e)&&e.code===170004&&"minSku"in e&&typeof e.minSku<"u";function zo(e,r,s,o){let{t}=F(),i=cr(s);switch(e.code){case 100001:let a;switch(i){case 0:a={title:t("You do not have enough credits to run this search."),message:(0,m.jsx)(Qe,{})};break;case 1:a={title:t("You do not have enough credits on your Free account to run this search."),message:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:t("Switch to your Organization account.")}),(0,m.jsx)(Ye,{})]})};break;case 2:a={title:t("You do not have enough credits to run this search."),message:(0,m.jsx)(Qe,{})};break;case 3:a={title:t("You do not have enough credits to run this search."),message:(0,m.jsx)("span",{children:t("Contact your Censys Sales Representative.")})};break}return{iconName:"emotion-sad",iconMode:"line",title:a.title,message:a.message};case 17e4:return{iconName:"timer-flash",title:t("Query Timeout"),message:t("Try again or optimize your query.")};case 170005:case 100007:return{iconName:"error-warning",title:t("Your query is invalid"),message:(0,m.jsxs)("div",{children:[t("Please refer to the")," ",(0,m.jsx)(A,{href:"https://docs.censys.com/docs/censys-query-language#/",isExternal:!0,children:t("Censys Query Language documentation")})," ",t("for information on writing queries.")]})};case 170002:{let n=new URLSearchParams(o);n.delete("cursor");let d;switch(i){case 0:{s?d={title:t("The Free tier includes one page of results"),message:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("span",{children:[(0,m.jsx)(A,{href:Sr(r),isExternal:!0,children:t("Upgrade")})," ",t("to the Starter or Enterprise tier to view more results")]}),(0,m.jsxs)("span",{children:[t("Return to the")," ",(0,m.jsx)(A,{href:`.?${n.toString()}`,children:t("First page")})," ",t("Of results")]})]})}:d={title:"Unregistered users may only view one page of results",message:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:"Register and move up to the Starter or Enterprise tier to view more results"}),(0,m.jsx)(mr,{})]})};break}case 1:d={title:t("The Free tier includes one page of results"),message:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:t("Switch to your Organization account to view additional results")}),(0,m.jsx)(Ye,{})]})};break;case 2:d={title:t("The Starter tier includes five pages of results"),message:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("span",{children:[(0,m.jsx)(A,{href:Ge(r),isExternal:!0,children:t("Upgrade")})," ",t("to the Enterprise tier to view more results")]}),(0,m.jsxs)("span",{children:[t("Return to the")," ",(0,m.jsx)(A,{href:`.?${n.toString()}`,children:t("First page")})," ",t("Of results")]})]})};break;case 3:d={title:t("The Enterprise tier includes unlimited pages of results"),message:(0,m.jsx)("span",{children:t("Contact your Censys Sales Representative.")})};break}return{iconName:"lock-star",title:d.title,message:d.message}}case 170003:return{iconName:"lock-star",title:t("Advanced queries unavailable in your current tier"),message:(0,m.jsxs)("div",{children:[t("Access this feature with a")," ",(0,m.jsx)(A,{href:`${r.ACCOUNTS_SITE_URL}/settings/plan`,isExternal:!0,children:t("Starter")})," ",t("or")," ",(0,m.jsx)(A,{href:Ge(r),isExternal:!0,children:t("Enterprise")})," ",t("Tier Organization")]})};case 170004:return br({accessState:s,env:r,minSku:Mo(e)?e.minSku:void 0});default:return Tr(e.code,{accessState:s,env:r})}}var gt=(0,yo.memo)(Uo);var Me={container:"giZC4",errorWrapper:"xLLK1"};var ue=c(p(),1);function he(e){let r=Rt(),s=e.error??r,o=vt(s)?s.data:s,t=Ne(o),i=!t&&o?.results?.errors?.length>0,a=Ce(),n=(0,vo.useContext)(_t),[d]=j();return t||i?(0,ue.jsx)("div",{className:Se(Me.container,Me.errorWrapper),children:(0,ue.jsx)(gt,{error:i?{code:100007}:o,env:n,accessState:a,searchParams:d})}):(0,ue.jsx)("div",{className:Me.container,children:(0,ue.jsx)(Fr,{error:o})})}var St={resultsWrapper:"WWWTn",filterResults:"dyI0L",searchBar:"_8gc8j"};var qo=c(No(),1),Go=c(Po(),1),L=c(p(),1);function Bo(e){let r=e.headers.get("X-Remix-Redirect");return r!==null?(window.location.assign(r),new Promise(()=>{})):e.json()}var $o=async({request:e,serverLoader:r})=>{let s=await r(),o=new URL(e.url),{origin:t,searchParams:i}=o,a=new URLSearchParams(i),n=a.get("q")||"",d=Re(o.pathname);a.set("q",n.trim());let E=d?`${a}&collection_id=${d.collection_id}`:`${a}`,g=nr("personalizedFieldsVersion",Nt.number(),0),P=g?`&_pfv=${g}`:"",H=`${E}${P}`,D=fetch(`${t}/api/search?${H}&_data=${encodeURIComponent("routes/api.search")}`,{headers:new Headers([["Accept","application/json"]]),signal:e.signal});return Ft({capabilities:s.capabilities,hasHighlightEntitlement:s.hasHighlightEntitlement,historyLimitDays:s.historyLimitDays,data:D.then(Bo).then(z=>Lr(z))})};$o.hydrate=!0;var bl=()=>[{title:"Censys Search Results"}];function Vo(){let e=Et(),r=J(),{capabilities:s,data:o,hasHighlightEntitlement:t,historyLimitDays:i}=Lt(),{q:a,submitSearch:n}=Ee();return e.state!=="idle"&&e.location.pathname===r.pathname?(0,L.jsx)(Wo,{}):(0,L.jsx)(Zt,{value:s,children:(0,L.jsx)("div",{className:St.resultsWrapper,children:(0,L.jsx)(wr,{errorElement:(0,L.jsx)(he,{}),fallback:(0,L.jsx)(de,{}),resolve:o,children:d=>{let E=Ne(d),g=!E&&d.results?.errors?.length>0;return E||g?(0,L.jsx)(he,{error:d}):(0,L.jsxs)(L.Fragment,{children:[d.results.total_hits>0&&(0,L.jsx)(tt,{queryDataSets:d.results.query_datasets}),(0,L.jsx)(ft,{historyLimitDays:i,pageLimitMessage:d.pageLimitMessage,q:a,results:d.results,submitSearch:n,hasHighlightEntitlement:t,personalizedFieldsConfig:d.personalizedFieldsConfig??le})]})}})})})}function Wo(){return(0,L.jsx)("div",{className:St.resultsWrapper,children:(0,L.jsx)(de,{})})}function Tl(){let e=Tt();return(0,L.jsx)(he,{error:e})}export{$o as a,bl as b,Vo as c,Wo as d,Tl as e};
