import{a as dt}from"/censys/build/_shared/chunk-JMHEUJZA.js";import{a as ut}from"/censys/build/_shared/chunk-GMNB7RSU.js";import{a as nt,b as st,c as at,d as lt,e as ct}from"/censys/build/_shared/chunk-MBWLTMZZ.js";import{c as B}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as mt}from"/censys/build/_shared/chunk-XSZMCSJH.js";import{a as pt}from"/censys/build/_shared/chunk-Q3AERUF4.js";import{a as rt}from"/censys/build/_shared/chunk-2G5R6E4Q.js";import{k as U}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{$ as et,A as w,B as P,C as O,Qa as M,Ta as it,aa as ot,ba as v,da as L,y as W,z as q}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as S,c as p}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as i}from"/censys/build/_shared/chunk-2QEWK57A.js";var y=i(S(),1);var G=i(S(),1);var h=i(S(),1);var d={container:"ZCQwt",label:"jFlVw",labelText:"I-0y-",italicizedLabel:"cVPEr",bucketInfo:"jyCGI",buttons:"BsLmf",count:"eZU4t",categoryHeader:"eQVGI",iconButton:"zP-dt",hoverable:"r773X",clickable:"sDcWp",icon:"B25f1",disabled:"ZYXTI"};var u=i(p(),1),bt=()=>(0,h.useCallback)(t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),t.currentTarget.click(),t.currentTarget.focus())},[]),St=/^\s+$/,Ot=t=>t==="",Pt=t=>St.test(t),vt=new Intl.NumberFormat("en-US",{notation:"compact"}),Lt=({label:t,onAddFilter:e,onRemoveFilter:o,isLocked:n=!1})=>{let r=(0,h.useCallback)(a=>{a.stopPropagation(),e?.(t)},[e,t]),m=(0,h.useCallback)(a=>{a.stopPropagation(),o?.(t)},[o,t]);return(0,u.jsxs)(u.Fragment,{children:[e&&(0,u.jsx)(L,{className:d.iconButton,variant:O.TERTIARY,iconName:"add-circle",iconMode:"line",onClick:n?void 0:r,"data-testid":"add-filter-button",size:v.LARGE,"aria-label":"Search for results with this value"}),o&&(0,u.jsx)(L,{className:d.iconButton,variant:O.TERTIARY,iconName:"indeterminate-circle",iconMode:"line",onClick:n?void 0:m,"data-testid":"remove-filter-button",size:v.LARGE,"aria-label":"Search with this value excluded"})]})};function f({count:t,icon:e,label:o,numberFormatter:n=vt,onAddFilter:r,onRemoveFilter:m,slots:a,slotProps:F,isLocked:c=!1,testId:E}){let x=!!r||!!m,T=a?.count||P,_=a?.label||P,I=a?.actions||Lt,D=bt(),{ariaLabel:R,formattedLabel:$,isEmptyOrWhitespace:V}=(0,h.useMemo)(()=>{let g=Ot(o),b=Pt(o),s,N;return g?(s="<empty>",N="Empty"):b?(s=`<whitespace{${o.length}}>`,N=`${o.length} whitespace characters`):(s=o,N=o),{ariaLabel:N,isEmptyOrWhitespace:g||b,formattedLabel:s}},[o]),Y=(0,u.jsx)("div",{className:d.buttons,children:c?(0,u.jsx)(rt,{iconClassName:d.icon}):(x||a?.actions)&&(0,u.jsx)(I,{...F?.actions,label:o,onAddFilter:r,onRemoveFilter:m,isLocked:c})}),C=!a?.actions&&!c&&r,K=(0,h.useCallback)(g=>{C&&(g.stopPropagation(),r?.(o))},[C,r,o]);return(0,u.jsxs)("li",{className:W(d.container,x&&d.hoverable,C&&!c&&d.clickable),role:"menuitem","aria-label":R,tabIndex:0,onClick:K,onKeyDown:D,"data-testid":E,children:[(0,u.jsxs)("span",{className:d.label,children:[e,(0,u.jsx)(_,{...F?.label,className:W(d.labelText,V&&d.italicizedLabel,c&&d.disabled),children:$})]}),(0,u.jsxs)("span",{className:d.bucketInfo,children:[(0,u.jsx)(T,{...F?.count,className:d.count,variant:w.SMALL,children:n.format(t)}),Y]})]})}var yt=i(p(),1),At={cert:"Certificates",host:"Hosts",web:"Web Properties"};function ft({label:t,onAddFilter:e,onRemoveFilter:o,isLocked:n,...r}){let{t:m}=B(),a=At?.[t]||"Unknown",F=(0,G.useCallback)(()=>{e?.(t)},[t,e]),c=(0,G.useCallback)(()=>{o?.(t)},[t,o]);return(0,yt.jsx)(f,{...r,onAddFilter:e&&F,onRemoveFilter:o&&c,label:m(a),isLocked:n})}var X=i(p(),1);function Qt({children:t}){return(0,X.jsx)(dt,{size:M.SMALL,children:t})}var Et={label:Qt};function Ft(t){let e={...Et,...t.slots};return(0,X.jsx)(f,{...t,slots:e})}var J=i(S(),1);var Z=i(p(),1);function gt({count:t,label:e,onAddFilter:o,onRemoveFilter:n,isLocked:r,...m}){let a=mt(e),F=(0,J.useCallback)(()=>{o?.(e)},[o,e]),c=(0,J.useCallback)(()=>{n?.(e)},[n,e]);return(0,Z.jsx)(f,{...m,count:t,label:e,icon:(0,Z.jsx)(pt,{countryCode:a}),onAddFilter:F,onRemoveFilter:c,isLocked:r})}var A=i(S(),1);var ht=i(S(),1),xt=()=>{},z=(0,ht.createContext)({onApplyFilter:xt});var kt=i(p(),1);function j({fields:t,isLocked:e,onAddFilter:o,onRemoveFilter:n,...r}){let{onApplyFilter:m}=(0,A.useContext)(z),a=(0,A.useCallback)(c=>{m(t,c,!1)},[t,m]),F=(0,A.useCallback)(c=>{m(t,c,!0)},[t,m]);return(0,kt.jsx)(f,{...r,onAddFilter:o&&a,onRemoveFilter:n&&F,isLocked:e,testId:`${t.join("-")}-${r.label}`})}var Tt=i(p(),1);function It({children:t}){return(0,Tt.jsx)(ut,{size:M.SMALL,children:t})}var H={label:It};var Q=i(p(),1),Rt={option:Ft},Nt={"host.services.labels.value":Rt,"host.location.country":{option:gt},type:{option:ft},...Object.fromEntries(Object.entries(U).map(([t,e])=>[t,{option:o=>(0,Q.jsx)(j,{...o,fields:e})}])),"threats.name":{option:t=>(0,Q.jsx)(j,{...t,slots:H,fields:U["threats.name"]})},"host.services.threats.name":{option:t=>(0,Q.jsx)(f,{...t,slots:{...H,...t.slots}})},"web.threats.name":{option:t=>(0,Q.jsx)(f,{...t,slots:{...H,...t.slots}})}};function tt(t){return Nt?.[t]}var k={list:"eZ-pK",listControl:"_1YGpE",headerTitle:"UwQ48",expandCollapseButton:"rIOV9",listContent:"GzJy7",slideDown:"_1mY6T",slideUp:"_3-nog"};var l=i(p(),1),Ct=5;function Bt({buckets:t,field:e,title:o,onApplyFilter:n,onViewAggregation:r,slots:m,slotProps:a}){let F=(0,y.useId)(),c=(0,y.useId)(),[E,x]=(0,y.useState)(e),[T,_]=(0,y.useState)(!1),I=!!E,D=tt(e)?.option||f,R=(0,y.useMemo)(()=>T?t:t.slice(0,Ct),[t,T]),$=(0,y.useCallback)(s=>{n(e,s,!1)},[n,e]),V=(0,y.useCallback)(s=>{n(e,s,!0)},[n,e]),Y=(0,y.useCallback)(()=>{_(s=>!s)},[]),C=(0,y.useMemo)(()=>r?s=>{s.stopPropagation(),r(e)}:void 0,[r]),K=(0,y.useMemo)(()=>({onApplyFilter:n,onViewAggregation:r}),[n,r]),g=`View all results for ${o} in the Report Builder`,{t:b}=B();return(0,l.jsx)(nt,{className:k.categoryContainer,collapsible:!0,type:"single",onValueChange:x,value:E,children:(0,l.jsxs)(st,{value:e,children:[(0,l.jsx)(at,{asChild:!0,children:(0,l.jsx)(lt,{asChild:!0,children:(0,l.jsxs)("div",{className:k.listControl,"aria-label":`${I?"Collapse":"Expand"} all ${o}`,children:[(0,l.jsxs)(P,{className:k.headerTitle,id:F,variant:w.H5,children:[(0,l.jsx)(q,{"aria-hidden":!0,size:"2xl",icon:I?"arrow-drop-down-line":"arrow-drop-right-line"}),b(o)]}),C&&(0,l.jsx)(it,{content:g,children:(0,l.jsx)(L,{"aria-label":g,iconName:"bar-chart-horizontal",iconMode:"fill",onClick:C,variant:O.SECONDARY,size:v.SMALL})})]})})}),(0,l.jsxs)(ct,{className:k.listContent,children:[(0,l.jsx)(z.Provider,{value:K,children:(0,l.jsx)("ol",{className:k.list,role:"menu",id:c,"aria-description":`Top ${R.length} ${o}`,children:R.map(s=>(0,l.jsx)(D,{count:s.count,label:s.key,isLocked:s.isLocked,onAddFilter:$,onRemoveFilter:V,testId:`${e}-${s.key}`,slots:m,slotProps:a},s.key))})}),t.length>Ct&&(0,l.jsxs)(ot,{className:k.expandCollapseButton,"aria-controls":c,onClick:Y,variant:O.TERTIARY,size:et.SMALL,children:[b(T?"Less":"More")," ",(0,l.jsx)(q,{"aria-hidden":!0,size:"md",icon:T?"arrow-up-s-line":"arrow-down-s-line"})]})]})]})})}export{Bt as a};
