import{a as Ze}from"/censys/build/_shared/chunk-7OUAFXOD.js";import{a as Qe,b as je,c as O,d as qe,e as Je,f as et}from"/censys/build/_shared/chunk-NVOUF2X3.js";import{a as Ge}from"/censys/build/_shared/chunk-XVMBDR2S.js";import{a as Xe}from"/censys/build/_shared/chunk-23KJ32CX.js";import{a as Fe,b as Ke}from"/censys/build/_shared/chunk-3IV5MLJ3.js";import{a as Ve,c as Ye}from"/censys/build/_shared/chunk-AARCMGAD.js";import{a as Oe}from"/censys/build/_shared/chunk-NAHO4RKJ.js";import{a as ze}from"/censys/build/_shared/chunk-ZD7QYARS.js";import{a as Ue}from"/censys/build/_shared/chunk-4533AUAX.js";import{b as Be,e as Me}from"/censys/build/_shared/chunk-DXLA43JS.js";import{c as ke}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as M,d as L}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{a as we}from"/censys/build/_shared/chunk-YTHNDA7O.js";import{b as Ne}from"/censys/build/_shared/chunk-XMNCU3E4.js";import{a as G,b as W,d as $e}from"/censys/build/_shared/chunk-DT7XMIXP.js";import{a as xe}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as He}from"/censys/build/_shared/chunk-OFRBI5JW.js";import{a as gt}from"/censys/build/_shared/chunk-IC5AY47K.js";import{c as Te,l as be,p as Ie,q as Ee,r as We,s as Le}from"/censys/build/_shared/chunk-B5UNN2SO.js";import{a as pe}from"/censys/build/_shared/chunk-EMHGEENV.js";import{g as ye}from"/censys/build/_shared/chunk-IRHQADG7.js";import{g as Se}from"/censys/build/_shared/chunk-VKYVKQW2.js";import{a as Re}from"/censys/build/_shared/chunk-BWODHJE6.js";import{j as _e}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{i as Ce,k as Ae,l as De,m as Pe}from"/censys/build/_shared/chunk-MB47ZWHU.js";import{a as C}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as he}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{a as ge}from"/censys/build/_shared/chunk-M5RKE22T.js";import{d as de,f as D,k as fe}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{e as k,f as ue,h as U}from"/censys/build/_shared/chunk-ST66DGSY.js";import{D as ve,z as B}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{A as $,Qa as w,Ra as X,Xa as le,x as N,z as ce}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as K}from"/censys/build/_shared/chunk-F5K75D4K.js";import{c as me}from"/censys/build/_shared/chunk-44DVAK2X.js";import{a as ae,d as z,g as se,k as ie,m as ne,p as E}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as u}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as H}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as p}from"/censys/build/_shared/chunk-2TWE7TSA.js";var A=p(H(),1);var Q=p(H(),1);var tt={detailsCertInfo:"Fjh16"};function rt(t){let{cert:e}=t,r=e?[e]:[],o=Se(r),n=[],s=[];r.forEach(h=>{h&&(n.push(h.parsed?.subject_dn),s.push(h.parsed?.issuer_dn))});let m=new Set(n.filter(C)),c=new Set(s.filter(C)),T=m.size>=1?m.values().next().value:void 0,f=c.size>=1?c.values().next().value:void 0;return{browserTrust:o,subjectDn:T,issuerDn:f}}var S=p(u(),1);function j({webAggregate:t}){let{browserTrust:e,subjectDn:r,issuerDn:o}=(0,Q.useMemo)(()=>rt(t),[t]),n=(0,Q.useMemo)(()=>e||r||o,[e,r,o]);return(0,S.jsxs)("div",{className:N(tt.detailsCertInfo),children:[(0,S.jsx)(O,{iconName:"award",children:"Certificate Information"}),n?(0,S.jsxs)(M,{children:[(0,S.jsx)(L,{label:"Browser Trust",content:e&&(0,S.jsx)(Ne,{aggregatedStatus:e.aggregatedStatus})}),(0,S.jsx)(L,{label:"Subject DN",content:r}),(0,S.jsx)(L,{label:"Issuer DN",content:o})]}):(0,S.jsx)($,{variant:ce.DEFAULT_ITALICS,children:"No Certificate Information Found"})]})}var Z=p(H(),1);var q={detailsSummary:"d4DeX",whiteText:"WbU8l"};var st=p(u(),1);function ot(t,e,r){let{endpoints:o=[]}=t;return{serviceTags:o.map(s=>{let{port:m,endpoint_type:c,path:T}=s,f,h="",P=Ae(s);if(P)f=(0,st.jsx)(Ke,{application:P});else{let{truncatedLabel:R,tooltipContent:I}=ze(m,c,T);h=I,f=R}let _=Pe(s);return{label:f,href:`${e}${r?`?${r}`:""}#${_}`,id:_,tooltip:h}}).filter(C)}}function at(t){return`${t} ${t>1?"Total ":""}${xe("Endpoint",t)}`}var d=p(u(),1);function J({baseLink:t,webAggregate:e}){let[r]=D([0]),[o]=E(),n=Ve(e.software,!0),{serviceTags:s}=(0,Z.useMemo)(()=>{let c=new URLSearchParams(o);return ot(e,t,c.toString())},[e,t,o]),m=(0,Z.useMemo)(()=>s.slice(0,20),[s]);return(0,d.jsxs)("div",{className:N(q.detailsSummary),children:[(0,d.jsx)(O,{iconName:"file-list-2",children:"Summary"}),(0,d.jsxs)(M,{children:[(0,d.jsx)(Ge,{label:"Software",items:n,listComponent:c=>(0,d.jsx)(le,{content:(0,d.jsxs)($,{className:q.whiteText,children:["Search Censys for web properties ",(0,d.jsx)("br",{})," with this software"," ",r?"CPE":"version"]}),children:(0,d.jsx)(he,{variant:"ghost",href:Ye(c,"web.software",r),children:c.label})})}),(0,d.jsx)(L,{label:at(s.length),content:m.length>0&&(0,d.jsx)(Ue,{tags:m,maxVisibleRows:m.length,tagSize:"md"})})]})]})}var te=p(H(),1);var nt="app/web-summary-chat-cache";function mt(t,e,r,o,n){return`/web:${t}/port:${e}/atTime:${r}/userId:${o}/orgId:${n||"none"}`}function pt(t,e,r){return`Provide a 2-3 sentence summary of the web property ${t}:${e}${r?` as it appeared at ${r} UTC`:""}.`}var ct=p(u(),1);function ee({hostname:t,port:e,atTime:r}){let o=ue(),n=k(),s=r&&n?.userId?mt(t,e,r,n.userId,o?.organizationId):void 0;return(0,ct.jsx)(et,{localStorageKey:nt,cacheKey:s,prompt:pt(t,e,r),source:"web-summarizer",dataPendoId:be.WEB_SUMMARY_CHAT_PIVOT_BUTTON,tooltipText:"Summarize Web Property with AI",children:"Summarize Web Property"})}var v={overviewHeaderContainer:"wy57t",contentTop:"kExPA",popoverContainer:"C3Ima",contentTopItems:"BmuFm",actions:"gWs4O",assetType:"tvUiK",contentBottom:"_2amWn",tagsSection:"aCvGp",tagsIcon:"Tkzpf",portText:"rQDWv"};function lt(t){let e=t?.cert?.fingerprint_sha256,r=[];return e&&r.push({sectionName:"Related Certificates",links:[{linkText:"With the same certificate used in scan",linkIcon:"award",linkTo:B({field:"cert.fingerprint_sha256",value:e,kind:0})},{linkText:"With the same host name",linkIcon:"computer",linkTo:B({field:"cert.names",value:t.hostname,kind:0})}]}),r.push({sectionName:"Related Web Properties",links:[{linkText:"With the same host name",linkIcon:"computer",linkTo:B({field:"web.hostname",value:t.hostname,kind:0})}]}),r}var i=p(u(),1),At={popover:v.popoverContainer};function re({baseRoute:t,webAggregate:e,hasScanData:r}){let o=se(),[n]=E(),s=n.toString(),m=lt(e),[c]=D([5]),T=e.scan_time,f=[...e.labels].map(y=>y.value).sort(),h=o.collectionId?`/collections/${o.collectionId}/results`:"/censys",P=`${e.hostname}:${e.port}`,_=(0,te.useMemo)(()=>Me(e.vulns),[e.vulns]),R=c&&e.vulns.length>0,I=(0,te.useMemo)(()=>e.threats.map(y=>y.name).filter(C),[e.threats]),[l,g]=D([19,11]),F=l||g,V=U("web-property-summary-chat-pivot");return(0,i.jsxs)("div",{className:v.overviewHeaderContainer,children:[(0,i.jsxs)("div",{className:v.contentTop,children:[(0,i.jsxs)("div",{className:v.contentTopItems,children:[(0,i.jsx)(Je,{children:(0,i.jsx)(Fe,{hostname:e.hostname,port:e.port,customClassNames:{port:v.portText}})}),(0,i.jsx)(ge,{variant:"dot"}),(0,i.jsx)("div",{className:v.assetType,children:(0,i.jsx)(qe,{assetType:"web"})})]}),(0,i.jsxs)("div",{className:v.actions,children:[(0,i.jsx)(_e,{assetId:P,assetType:"web",investigationName:`${e.hostname} Web Investigation`}),r&&(0,i.jsx)(Ze,{pivots:m,customClassNames:At}),V&&(0,i.jsx)(ee,{hostname:e.hostname,port:e.port,atTime:T?.toString()})]})]}),(0,i.jsxs)("div",{className:v.contentBottom,children:[(0,i.jsxs)("div",{className:v.tagsSection,children:[R&&(0,i.jsx)(Be,{count:e.vulns.length,severity:_,to:`${t}/cves${s?`?${s}`:""}`}),F&&I?.length>0&&(0,i.jsx)(ke,{baseURL:`${t}/threats`,threats:I}),f.length>0&&(0,i.jsx)(Oe,{baseURL:h,labels:f,resourceType:"web"})]}),T&&(0,i.jsx)(He,{timestamp:T.toString()})]})]})}var ut="details-list",dt="cves",ft="raw-data",ht="threats";var oe={summaryLayout:"_8Wr8D",errorWrapper:"_2YogW"};var Pt=p(gt(),1),a=p(u(),1),Co=({data:t})=>{let e;return t&&t.webAggregate&&(e=Ce(t.webAggregate)),[{title:e?`${e} - Web Property Summary`:"Censys"}]};function Tt({children:t,webAggregate:e,collectionId:r,collectionName:o,slots:n={}}){let{t:s}=K(),m=ye({collectionsLabel:s("Collections"),collectionName:o,fallback:[{pathName:s("Search")}]}),c=e?De(e):"";return(0,a.jsx)(We,{initialQuery:c,breadcrumbs:m,slots:{searchHeader:o?(0,a.jsx)(Ie,{breadcrumbs:m,placeholder:s("Search within",{name:o}),collectionId:r,children:(0,a.jsx)(Le,{})}):(0,a.jsx)(Ee,{breadcrumbs:m}),header:n.pageHeader,navTabs:n.pageNavTabs},children:t})}function Dt(){let t=ve(),[e,r]=E(),{webAggregate:o,id:n,capabilities:s,collection:m,cveDetails:c,endpointsRawData:T,tlsDetailsRawData:f,threatDetails:h,csrf:P}=we(),_=U("web-property-improvements"),[R,I]=D([11,13]),l=`/web/${n}`,g="/web/:id";m&&(l=`/collections/${m.collection_id}${l}`,g=`/collections/:collectionId${g}`);let F=!!z(`${l}/cves/*`),V=!!z(`${l}/threats/*`),y=(0,A.useMemo)(()=>{let b=!!o?.endpoints?.length;return{webAggregate:o,hasScanData:b,endpointsRawData:T,tlsDetailsRawData:f,cveDetails:c,threatDetails:h,targetRoute:l}},[o,T,f,c,h,l]),Y=(0,A.useMemo)(()=>{let b=e.get("isCollapsed");return b===void 0||b==="true"},[e]),St=(0,A.useCallback)(()=>{r(b=>(b.set("isCollapsed",(!Y).toString()),b),{state:t})},[Y,t]),vt=(0,A.useMemo)(()=>new Set(o.threats.map(b=>b.name).filter(C)).size,[o]),{t:x}=K();return(0,a.jsx)(pe,{token:P,children:(0,a.jsx)(de,{value:s,children:(0,a.jsx)(Tt,{webAggregate:o,slots:{pageHeader:(0,a.jsx)(Qe,{assetType:"web",header:(0,a.jsx)(re,{baseRoute:l,webAggregate:o,hasScanData:y.hasScanData}),isCollapsed:Y||!y.hasScanData,toggle:St,shouldShowControls:y.hasScanData,children:(0,a.jsxs)("div",{className:oe.summaryLayout,children:[(0,a.jsx)(J,{baseLink:l,webAggregate:o}),(0,a.jsx)(j,{webAggregate:o})]})}),pageNavTabs:y.hasScanData&&(0,a.jsxs)($e,{children:[(0,a.jsx)(W,{id:ut,to:l,prefetch:"intent",children:x("HTTP and Application Details")}),(0,a.jsxs)(W,{id:dt,to:`${l}/cves`,prefetch:"intent",routePattern:`${g}/cves/*`,children:[(0,a.jsx)(G,{children:x("CVEs")}),(0,a.jsx)(X,{count:o.vulns.length,variant:F?w.SYSTEM:w.NEUTRAL})]}),R&&(0,a.jsxs)(W,{id:ht,routePattern:`${g}/threats/*`,to:`${l}/threats`,prefetch:"none",children:[(0,a.jsx)(G,{children:x("Threats")}),(0,a.jsx)(X,{count:vt,variant:V?w.SYSTEM:w.NEUTRAL})]}),(0,a.jsx)(je,{canViewCenseye:I,targetRoute:l,routePattern:g}),_&&(0,a.jsx)(W,{id:"relatedAssets",routePattern:`${g}/related-assets`,to:`${l}/related-assets`,prefetch:"none",children:x("Related Assets")}),(0,a.jsx)(W,{id:ft,routePattern:`${g}/data/*`,to:`${l}/data/table`,prefetch:"none",children:x("Raw Data")})]})},collectionId:m?.collection_id,collectionName:m?.name,children:(0,a.jsx)(Te,{children:(0,a.jsx)(ne,{context:y})})})})})}function Ao(){let t=ie(),e=k(),r=(0,A.useContext)(me);return(0,a.jsx)(Tt,{children:(0,a.jsx)("div",{className:oe.errorWrapper,children:ae(t)&&fe(t.data)?(0,a.jsx)(Xe,{accessState:e,error:t.data,env:r}):(0,a.jsx)(Re,{error:t})})})}export{Co as a,Dt as b,Ao as c};
