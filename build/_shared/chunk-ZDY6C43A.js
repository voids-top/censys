import{a as zt,b as qt}from"/censys/build/_shared/chunk-BCFPRQGQ.js";import{b as Jt}from"/censys/build/_shared/chunk-UWRUBCCK.js";import{a as Yt}from"/censys/build/_shared/chunk-FWMMBP3Z.js";import{a as Ut}from"/censys/build/_shared/chunk-5PS6SCVZ.js";import{a as wt}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{b as Bt}from"/censys/build/_shared/chunk-RAMDI2JB.js";import{a as Ne}from"/censys/build/_shared/chunk-CJIEOTRC.js";import{q as Kt,r as be,v as Dt}from"/censys/build/_shared/chunk-HUE44QRB.js";import{a as Vt}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{g as xt}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import{a as kt}from"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as ge}from"/censys/build/_shared/chunk-EZHABQF2.js";import{k as Wt}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{m as B,o as z}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{$ as V,A as u,B as v,C as le,D as Lt,E as Ce,T as he,U as _e,V as Q,W as I,Ya as qe,Za as N,_a as Ae,aa as P,cb as It,da as ze,fa as Se,ga as ve,ka as Mt,la as Ft,na as Pt,ta as Ht,wa as Rt,x as Y,y as X,z as C}from"/censys/build/_shared/chunk-GALQBYYN.js";import{d as S}from"/censys/build/_shared/chunk-6URBRDCL.js";import{a as vt,c as At,k as gt,p as bt,q as Nt}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as F,c as s}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as a}from"/censys/build/_shared/chunk-2QEWK57A.js";var Gt=a(F(),1);var Zt=a(s(),1);function Je({errorCode:e}){let o=(0,Gt.useMemo)(()=>Mo(e),[e]);return(0,Zt.jsx)(Kt,{"data-testid":`error_code_${String(e)}`,iconName:o.iconName,iconMode:o.iconMode,title:o.title,children:o.message})}function Mo(e){switch(e){case 130008:return{iconName:"alert",title:"Error loading Webhooks, please try again"};case 130007:return{iconName:"alert",title:"Webhook not found"};case 130004:return{iconName:"alert",title:"Error creating Webhook, please try again"};case 130005:return{iconName:"alert",title:"Error updating Webhook, please try again"};case 130006:return{iconName:"alert",title:"Error deleting Webhook, please try again"};case 130008:return{iconName:"alert",title:"Error loading Webhooks, please try again"};default:return Dt(e)}}var Xt={errorWrapper:"AEWNv"};var Le=a(s(),1);function $t(){let e=gt();return(0,Le.jsx)("div",{className:Xt.errorWrapper,children:vt(e)&&Wt(e.data)?(0,Le.jsx)(Je,{errorCode:e.data.code}):(0,Le.jsx)(wt,{error:e})})}var q=a(F(),1);var ie={headersContainer:"ZwFkT",nameCell:"retwP",headerName:"RdMWJ",headerContent:"M3BMZ"};var H=a(s(),1);function Me({headers:e,className:o}){return(0,H.jsxs)("div",{className:Y(ie.headersContainer,o),children:[(0,H.jsx)(u,{variant:C.H5,children:"Headers"}),e?(0,H.jsx)("table",{children:(0,H.jsx)("tbody",{children:e.map((t,r)=>(0,H.jsxs)("tr",{children:[(0,H.jsx)("td",{className:ie.nameCell,children:(0,H.jsx)(u,{variant:C.SMALL,className:Y(ie.headerName,ie.headerContent),children:t.key})}),(0,H.jsx)("td",{children:(0,H.jsx)(u,{className:ie.headerContent,children:t.value})})]},r))})}):(0,H.jsx)("pre",{children:"No headers"})]})}var jt=a(F(),1);var pe={container:"j5PLl",body:"T8OJa",pre:"Ce-x0"};var Ge=a(s(),1),Qt=(e,o="")=>{if(!e)return o;if(typeof e=="string")try{let t=JSON.parse(e),r=JSON.stringify(t,null,2);return(0,Ge.jsx)("pre",{className:pe.pre,children:r})}catch{return(0,Ge.jsx)("pre",{className:pe.pre,children:e})}try{return JSON.stringify(e,null,2)}catch{return o}};var Te=a(s(),1);function Fe({label:e,content:o,fallbackText:t="",className:r}){let i=(0,jt.useMemo)(()=>Qt(o,t),[o,t]);return(0,Te.jsxs)("div",{className:Y(pe.container,r),children:[(0,Te.jsx)(u,{variant:C.H5,children:e}),(0,Te.jsx)(u,{variant:C.SMALL_SOURCE,className:pe.body,"data-testid":"content",children:i})]})}var x={testWebhookContainer:"vNdkE",tabsContent:"_4QGh1",tabsList:"vDxuC",responseTrigger:"Wa4Ea",padding:"o5Fot"};var f=a(s(),1);function Ze({statusCode:e,requestHeaders:o,requestBody:t,responseHeaders:r,responseBody:i,responseError:p}){return(0,f.jsx)("div",{className:x.testWebhookContainer,children:(0,f.jsxs)(he,{defaultValue:"request",children:[(0,f.jsxs)(_e,{className:x.tabsList,children:[(0,f.jsx)(Q,{value:"request",children:"Request"}),(0,f.jsx)(Q,{value:"response",children:(0,f.jsxs)("div",{className:x.responseTrigger,children:["Response",(0,f.jsx)(Yt,{statusCode:e})]})})]}),(0,f.jsxs)(I,{value:"request",className:x.tabsContent,children:[(0,f.jsx)(Me,{headers:o,className:x.padding}),(0,f.jsx)(Fe,{label:"Body",content:t,fallbackText:"No Body",className:x.padding})]}),(0,f.jsx)(I,{value:"response",className:x.tabsContent,children:p?(0,f.jsx)(ve,{variant:Se.ERROR,children:p}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Me,{headers:r,className:x.padding}),(0,f.jsx)(Fe,{label:"Body",content:i,fallbackText:"No Body",className:x.padding})]})})]})})}var Pe={modalContent:"-fh46",modalHeader:"q-YOg",errorMessage:"_09tvn"};var Fo="new-webhook-form",He="test-webhook-form",Po="edit-webhook-form",Re="/settings/webhooks",eo="?sort=CreatedAt&direction=DESC";var to=[{label:"Custom",value:"CUSTOM"},{label:"Slack",value:"SLACK"},{label:"Microsoft Teams",value:"TEAMS"}],te={SLACK:`{
  "event_type": "{{.EventType}}",
  "timestamp": "{{.Timestamp}}",
  "collection_id": "{{.CollectionId}}",
  "collection_name": "{{.CollectionName}}",
  "org_id": "{{.OrganizationId}}",
  "query": "{{.CollectionQuery}}",
  "asset_id": "{{.AssetId}}",
  "asset_type": "{{.AssetType}}",
  "url": "https://platform.censys.io/collections/{{.CollectionId}}?org={{.OrganizationId}}",
  "evidence": "{{.AssetType}} {{.AssetId}} was {{.EventVerb}} to the collection on {{.Timestamp}} because it matched the collection query."
}`,TEAMS:`{
  "@type": "MessageCard",
  "@context": "http://schema.org/extensions",
  "summary": "New Notification",
  "themeColor": "0076D7",
  "title": "Asset {{.EventVerb}} Collection",
  "text": "{{.AssetType}} {{.AssetId}} was {{.EventVerb}} collection {{.CollectionId}} on {{.Timestamp}} based on the collection query.",
  "sections": [
    {
      "activityTitle": "",
      "facts": [
        {
          "name": "Collection Id",
          "value": "{{.CollectionId}}"
        },
        {
          "name": "Collection Name",
          "value": "{{.CollectionName}}"
        }
      ],
      "markdown": true
    }
  ],
  "potentialAction": [
    {
      "@type": "OpenUri",
      "name": "Learn More",
      "targets": [
        {
          "os": "default",
          "uri": "https://platform.censys.io/collections/{{.CollectionId}}?org={{.OrganizationId}}"
        }
      ]
    }
  ]
}`},{WEBHOOK_EVENT_TYPE_UNRECOGNIZED:ha,UNRECOGNIZED_ENUM_KEY:_a,...Ho}=B.WebhookEventType;var W={WEBHOOK_NAME:"webhookName",URL:"url",PAYLOAD_TEMPLATE:"payloadTemplate",ASSET_TYPE:"assetType",...Ho},l={WEBHOOK_FORM:{NAMES:W,SCHEMAS:{[W.WEBHOOK_NAME]:S.string({required_error:"A Webhook name is required."}).min(1,{message:"A Webhook name is required."}).max(100,{message:"Webhook name must be less than 100 characters."}),[W.URL]:S.string().min(1,{message:"A URL is required."}).url({message:"Must be a valid URL."}),[B.WebhookEventType.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET]:S.enum(["on","off"]),[B.WebhookEventType.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET]:S.enum(["on","off"]),[W.PAYLOAD_TEMPLATE]:S.optional(S.string()),[W.ASSET_TYPE]:S.enum([z.AssetEvent_AssetType.HOST,z.AssetEvent_AssetType.CERT,z.AssetEvent_AssetType.WEB])},INITIAL_VALUES:{[W.WEBHOOK_NAME]:"",[W.URL]:"",[B.WebhookEventType.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET]:"on",[B.WebhookEventType.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET]:"on",[W.PAYLOAD_TEMPLATE]:te.SLACK,[W.ASSET_TYPE]:z.AssetEvent_AssetType.CERT}}};var R=a(s(),1);function Ie({submitTestWebhook:e,formState:o,currentPayloadTemplate:t,headers:r,selectedCollections:i,totalIsValid:p,fetcherState:E,testWebhookResponse:m,csrf:c}){let[n,d]=(0,q.useState)(!1),[_,h]=(0,q.useState)(),K=(0,q.useCallback)(ce=>{let Ee=i.map(Oe=>Oe.value),D=JSON.stringify(Object.values(r)),we=JSON.stringify(Ee),Ue={...ce,headers:D,collectionIds:we,payloadTemplate:t,fetcherKey:He,csrf:c};e(Ue,{method:"POST"})},[e,r,i,t,c]);(0,q.useEffect)(()=>{(m?.response||m?.errorMessage)&&(d(!0),m?.errorMessage?h(m.errorMessage):h(void 0))},[m?.response,m?.errorMessage]);let ye=(0,q.useCallback)(()=>{d(!1),h(void 0)},[]),xe=(0,q.useCallback)(()=>{h(void 0)},[]);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(P,{"data-testid":"test-webhook-button",onClick:ce=>{ce.preventDefault(),K({...o.values,payloadTemplate:t})},value:He,disabled:!p,isLoading:E==="loading"||E==="submitting",type:"button",variant:v.SECONDARY,children:"Test Webhook"}),(0,R.jsx)(Pt,{open:n,onOpenChange:ye,size:Mt.LARGE,header:(0,R.jsx)(u,{variant:C.H2,className:Pe.modalHeader,children:"Test Webhook Response"}),headerBorder:Ft.NONE,children:(0,R.jsxs)("div",{className:Pe.modalContent,children:[_&&(0,R.jsx)("div",{className:Pe.errorMessage,children:(0,R.jsx)(ve,{title:_,variant:Se.ERROR,onDismiss:xe})}),m?.response&&(0,R.jsx)(Ze,{statusCode:m.response.status_code,requestBody:m.response.request?.body,requestHeaders:m.response.request?.headers,responseBody:m.response.response?.body,responseHeaders:m.response.response?.headers,responseError:m.response.error})]})})]})}var T=a(F(),1);var oe=a(F(),1);function oo(e=[]){let[o,t]=(0,oe.useState)(e.map((c,n)=>n)),[r,i]=(0,oe.useState)(e.reduce((c,n,d)=>(c[d]={key:n.name,value:n.value},c),{})),p=(0,oe.useCallback)(()=>{t(c=>{let n=c[c.length-1]??-1;return[...c,n+1]})},[]),E=(0,oe.useCallback)(c=>{t(n=>n.filter(d=>d!==c)),i(n=>{let d={...n};return delete d[c],d})},[]),m=(0,oe.useCallback)((c,n,d,_)=>{i(h=>({...h,[c]:{key:n,value:d,error:_}}))},[]);return{headerIndices:o,headers:r,addHeaderIndex:p,removeHeaderIndex:E,onHeaderChange:m}}var de=a(F(),1);var ao=a(F(),1);var L={selectedCollectionsContainer:"vIWYk",selectedCollectionRow:"wUN-b",collectionLink:"raAXM",collectionLabel:"rZmyC",removed:"ikoLK",removedLabel:"Yp9wf",removeButton:"YCqA0"};var ae=a(s(),1);function ro({collection:e,onUndoRemove:o}){let t=(0,ao.useCallback)(()=>{o(e)},[e,o]);return(0,ae.jsxs)("div",{className:L.selectedCollectionRow,children:[(0,ae.jsxs)(u,{className:Y(L.removed,L.collectionLabel),children:[(0,ae.jsx)(X,{name:"stack",mode:"line",size:"md"}),(0,ae.jsx)("span",{className:L.removedLabel,children:e.label})]}),(0,ae.jsx)(P,{onClick:t,iconLeft:"arrow-go-back",iconLeftMode:"line",className:L.removeButton,variant:v.GHOST,size:V.SMALL,type:"button",children:"Undo"})]})}var no=a(F(),1);var re=a(s(),1);function so({collection:e,onRemove:o}){let t=(0,no.useCallback)(()=>{o(e)},[e,o]);return(0,re.jsxs)("div",{className:L.selectedCollectionRow,children:[(0,re.jsx)(ge,{href:`/collections/${e.value}`,className:L.collectionLink,isExternal:!0,children:(0,re.jsxs)("div",{className:L.collectionLabel,children:[(0,re.jsx)(X,{name:"stack",mode:"line",size:"md"}),e.label]})}),(0,re.jsx)(P,{onClick:t,iconLeft:"delete-bin",iconLeftMode:"line",className:L.removeButton,variant:v.ALERT,size:V.SMALL,type:"button",children:"Remove"})]})}var j=a(s(),1);function $e({collectionsOptions:e,selectedCollections:o,onCollectionsChange:t}){let[r,i]=(0,de.useState)([]),p=(0,de.useCallback)(n=>{let d=e.find(_=>_.value===n);d&&t([...o,d])},[e,t,o]),E=(0,de.useCallback)(n=>{i([...r,n]),t(o.filter(d=>d.value!==n.value))},[o,t,r]),m=(0,de.useCallback)(n=>{i(r.filter(d=>d.value!==n.value)),p(n.value)},[r,p]),c=o.length>0||r.length>0;return(0,j.jsxs)("div",{children:[(0,j.jsx)(N,{label:"Collections",children:(0,j.jsx)(Ce,{name:"collectionIds",options:e,onValueChange:p,value:"",valueProps:{placeholder:"Select a collection to add"}})}),c&&(0,j.jsxs)("div",{className:L.selectedCollectionsContainer,children:[o.map(n=>(0,j.jsx)(so,{collection:n,onRemove:E},n.value)),r.map(n=>(0,j.jsx)(ro,{collection:n,onUndoRemove:m},n.value))]})]})}var lo={eventTypesContainer:"_92kTG"};var me=a(s(),1);function Xe({formState:e,eventTypesValid:o,handleValueChange:t}){return(0,me.jsx)(N,{label:"Event Types",required:!0,errorText:e.errors[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET]||e.errors[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET]||!o?"Please select at least one event type":void 0,children:(0,me.jsxs)("div",{className:lo.eventTypesContainer,children:[(0,me.jsx)(qe,{id:"assets-added",label:"Assets Added","aria-label":"Assets Added",name:l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET,checked:e.values[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET]==="on",onCheckedChange:r=>{t(l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET,r?"on":"off")}}),(0,me.jsx)(qe,{id:"assets-removed",label:"Assets Removed","aria-label":"Assets Removed",name:l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET,checked:e.values[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET]==="on",onCheckedChange:r=>{t(l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET,r?"on":"off")}})]})})}var Qe=a(s(),1);function je({formState:e,handleBlur:o,handleChange:t}){return(0,Qe.jsx)(N,{label:"Webhook Name",required:!0,labelFor:"webhook-name",errorText:e.errors[l.WEBHOOK_FORM.NAMES.WEBHOOK_NAME],children:(0,Qe.jsx)(le,{id:"webhook-name",name:l.WEBHOOK_FORM.NAMES.WEBHOOK_NAME,isFullWidth:!0,autoComplete:"off",onBlur:o,onChange:t,value:e.values[l.WEBHOOK_FORM.NAMES.WEBHOOK_NAME]})})}var io=a(F(),1),J=a(s(),1);function Be({copyable:e,onCopy:o,...t}){let[r,i]=(0,io.useState)(!1);return(0,J.jsx)(le,{...t,type:r?"text":"password",contentLeft:(0,J.jsx)(X,{name:"lock",mode:"line"}),contentRight:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ze,{iconName:r?"eye":"eye-off",iconMode:"line",variant:v.GHOST,onClick:()=>i(p=>!p),disabled:t.disabled,type:"button","aria-label":r?"Hide password":"Show password"}),e&&(0,J.jsx)(ze,{iconName:"file-copy",iconMode:"line",variant:v.GHOST,onClick:o,disabled:t.disabled,type:"button","aria-label":"Copy password"})]})})}var et=a(s(),1);function tt({formState:e,handleBlur:o,handleChange:t}){return(0,et.jsx)(N,{label:"URL",required:!0,labelFor:"webhook-url",errorText:e.errors[l.WEBHOOK_FORM.NAMES.URL],children:(0,et.jsx)(Be,{name:l.WEBHOOK_FORM.NAMES.URL,id:"webhook-url",isFullWidth:!0,autoComplete:"off",onBlur:o,onChange:t,value:e.values[l.WEBHOOK_FORM.NAMES.URL]})})}var ot=a(F(),1);var A={payloadTemplateContainer:"UjO5l",header:"S7KvM",description:"EgqWu",payloadTemplateButtons:"XH8ES",templateCard:"LCMKT",selected:"ugeTU",contentContainer:"mNJjF",icon:"_3-A0I",titleContainer:"pSUTU",customizeLink:"sY000",linkContent:"moij6"};var b=a(s(),1);function We({isSelected:e,iconName:o,title:t,secondaryTitle:r,description:i,onClick:p}){return(0,b.jsx)(Rt,{variant:Ht.INTERACTIVE,className:Y(A.templateCard,e?A.selected:""),onClick:p,children:(0,b.jsxs)("div",{className:A.contentContainer,children:[o&&(0,b.jsx)(zt,{iconName:o,className:A.icon}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:A.titleContainer,children:[(0,b.jsx)(u,{variant:C.DEFAULT_SEMIBOLD,className:A.templateCardTitle,children:t}),r&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Vt,{variant:"line--vertical",size:16}),(0,b.jsx)(u,{children:r})]})]}),(0,b.jsx)(u,{variant:C.SMALL,className:A.description,children:i})]})]})})}var M=a(s(),1);function rt({selectedPayloadTemplate:e,onPayloadTemplateChange:o}){let t=be(),i=`${At().pathname}?tab=${"template"}`,p=(0,ot.useCallback)(c=>{o(c)},[o]),E=(0,ot.useCallback)(()=>{p("CUSTOM"),t(i)},[p,i,t]),m=e==="CUSTOM"?"Edit your custom template":`Customize your ${kt(e.toLowerCase())} template`;return(0,M.jsxs)("div",{className:A.payloadTemplateContainer,children:[(0,M.jsxs)("div",{className:A.header,children:[(0,M.jsx)(u,{children:"Payload Template (Optional)"}),(0,M.jsx)(u,{variant:C.SMALL,className:A.description,children:"Select an optional payload template. The payload template defines the structure and content of the data sent to your webhook URL when a collection event occurs."})]}),(0,M.jsxs)("div",{className:A.payloadTemplateButtons,children:[(0,M.jsx)(We,{isSelected:e==="SLACK",iconName:"slack",title:"Slack",description:"Send real-time alerts from a Censys collection to a Slack channel or direct message.",onClick:()=>p("SLACK")}),(0,M.jsx)(We,{isSelected:e==="TEAMS",iconName:"teams",title:"Teams",secondaryTitle:"Microsoft",description:"Send real-time alerts from a Censys collection to a selected team in Microsoft Teams.",onClick:()=>p("TEAMS")}),(0,M.jsx)(We,{isSelected:e==="CUSTOM",title:"Custom",description:"Customize your own payload template.",onClick:E})]}),(0,M.jsx)(ge,{href:i,className:A.customizeLink,children:(0,M.jsxs)("span",{className:A.linkContent,children:[m,(0,M.jsx)(X,{name:"arrow-right",mode:"line"})]})})]})}var po={fieldsContainer:"CHZ8p"};var G=a(s(),1);function nt({formState:e,handleBlur:o,handleChange:t,availableCollectionOptions:r,selectedCollections:i,onCollectionsChange:p,eventTypesValid:E,handleValueChange:m,selectedPayloadTemplate:c,onPayloadTemplateChange:n}){return(0,G.jsx)(I,{value:"configuration",children:(0,G.jsxs)("div",{className:po.fieldsContainer,children:[(0,G.jsx)(je,{formState:e,handleBlur:o,handleChange:t}),(0,G.jsx)(tt,{formState:e,handleBlur:o,handleChange:t}),(0,G.jsx)($e,{collectionsOptions:r,onCollectionsChange:p,selectedCollections:i}),(0,G.jsx)(Xe,{formState:e,eventTypesValid:E,handleValueChange:m}),(0,G.jsx)(rt,{selectedPayloadTemplate:c,onPayloadTemplateChange:n})]})})}var w=a(F(),1);var Ke={headerInputContainer:"wqOey",removeButton:"Z7hSs",header:"IxqQl"};var Z=a(s(),1);function st({index:e,initialKey:o,initialValue:t,onRemove:r,onChange:i,disabled:p}){let[E,m]=(0,w.useState)(o),c=(0,w.useMemo)(()=>E?"":"Header Name is required",[E]),[n,d]=(0,w.useState)(t),_=(0,w.useMemo)(()=>n?"":"Value is required",[n]);(0,w.useEffect)(()=>{i(e,E,n,!E||!n)},[E,n,e,i]);let h=(0,w.useCallback)(()=>{Ne(n)},[n]);return(0,Z.jsxs)("div",{className:Ke.headerInputContainer,children:[(0,Z.jsxs)(u,{variant:C.H5,className:Ke.header,children:["Header ",e+1]}),(0,Z.jsx)(N,{label:"Header Name",required:!0,labelFor:`header-name-${e}`,errorText:c,children:(0,Z.jsx)(le,{id:`header-name-${e}`,isFullWidth:!0,value:E,onChange:K=>m(K.target.value),disabled:p})}),(0,Z.jsx)(N,{label:"Value",required:!0,labelFor:`header-value-${e}`,errorText:_,children:(0,Z.jsx)(Be,{id:`header-value-${e}`,isFullWidth:!0,copyable:!0,onCopy:h,onChange:K=>d(K.target.value),value:n,disabled:p})}),(0,Z.jsx)(P,{onClick:()=>r(e),iconLeft:"delete-bin",iconLeftMode:"line",className:Ke.removeButton,variant:v.ALERT,size:V.SMALL,type:"button",disabled:p,children:"Remove"})]})}var De={headersContainer:"N2ntk",headersContent:"_6bDkT",addHeaderButton:"f1WmR"};var ee=a(s(),1);function lt({headers:e,onHeaderChange:o,headerIndices:t,addHeaderIndex:r,removeHeaderIndex:i}){return(0,ee.jsx)(I,{value:"headers",children:(0,ee.jsxs)("div",{className:De.headersContainer,children:[(0,ee.jsx)(u,{children:"Optional Custom Header"}),t.length>0&&(0,ee.jsx)("div",{className:De.headersContent,children:t.map(p=>(0,ee.jsx)(st,{index:p,initialKey:e[p]?.key,initialValue:e[p]?.value,onRemove:i,onChange:o},p))}),(0,ee.jsx)(P,{iconLeft:"add",iconLeftMode:"fill",variant:v.GHOST,className:De.addHeaderButton,onClick:r,size:V.SMALL,type:"button",children:"Add Header"})]})})}var Ve=a(F(),1);var k={payload:"H0BXZ",assetTypeGroup:"PqMbY",payloadTemplateExampleContainer:"VBdbs",title:"Xt3FK",payloadLabel:"_8RA1t",accordionHeader:"_1VSgu",payloadTemplateInputArea:"cgMLr",formButton:"CV0-c"};var O=a(s(),1);function it({formState:e,handleValueChange:o,handleBlur:t,handleChange:r,payloadTemplateExample:i,setPayloadTemplateExample:p,currentPayloadTemplate:E}){let m=(0,Ve.useCallback)(d=>{p(d),d==="CUSTOM"&&o(l.WEBHOOK_FORM.NAMES.PAYLOAD_TEMPLATE,E)},[o]),c=(0,Ve.useCallback)(()=>{Ne(E)},[E]),n=(0,Ve.useCallback)(d=>{i==="CUSTOM"&&t(d)},[t,i]);return(0,O.jsx)(I,{value:"template",children:(0,O.jsxs)("div",{className:k.payloadTemplateExampleContainer,children:[(0,O.jsxs)("div",{className:k.payloadLabel,children:[(0,O.jsx)(u,{className:k.title,children:"Customize Your Webhook Payload"}),(0,O.jsxs)(u,{variant:C.SMALL,children:["Use the ",(0,O.jsx)("strong",{children:"Custom"})," option to define your own webhook payload structure using available template variables. This gives you full control over the data sent to your endpoint."]}),(0,O.jsxs)(u,{variant:C.SMALL,children:["Need a starting point? Select one of our predefined formats for"," ",(0,O.jsx)("strong",{children:"Slack"})," or ",(0,O.jsx)("strong",{children:"Microsoft Teams"}),", then switch back to ",(0,O.jsx)("strong",{children:"Custom"})," to tailor it to your needs."]})]}),(0,O.jsxs)("div",{className:k.payload,children:[(0,O.jsx)(Ce,{"aria-label":"Payload Template",name:"payload-template-example",options:to,onValueChange:m,defaultValue:i,valueProps:{placeholder:"Select payload template"}}),(0,O.jsxs)(It,{className:k.assetTypeGroup,name:"assetType",value:e.values.assetType,onValueChange:d=>o(W.ASSET_TYPE,d),"aria-label":"Asset Type",children:[(0,O.jsx)(Ae,{wrapperClassName:k.radio,label:"Certificate",value:z.AssetEvent_AssetType.CERT,"aria-label":"Certificate"}),(0,O.jsx)(Ae,{wrapperClassName:k.radio,label:"Host",value:z.AssetEvent_AssetType.HOST,"aria-label":"Host"}),(0,O.jsx)(Ae,{wrapperClassName:k.radio,label:"Web Property",value:z.AssetEvent_AssetType.WEB,"aria-label":"Web Property"})]})]}),(0,O.jsx)(N,{errorText:e.errors[l.WEBHOOK_FORM.NAMES.PAYLOAD_TEMPLATE],children:(0,O.jsx)(Lt,{className:k.payloadTemplateInputArea,name:l.WEBHOOK_FORM.NAMES.PAYLOAD_TEMPLATE,"data-testid":"payload-template-input-area",id:"payload-template",isFullWidth:!0,autoComplete:"off",onBlur:n,onChange:r,rows:12,value:E,spellCheck:!1,disabled:i!=="CUSTOM"})}),(0,O.jsx)(P,{className:k.formButton,size:V.SMALL,variant:v.DEFAULT,onClick:c,"data-testid":"copy-payload-template-button",type:"button","aria-label":"Copy payload template",iconLeft:"clipboard",iconLeftMode:"line",children:"Copy"})]})})}var pt={container:"PoSvv",tabs:"_0Fxhy",tabContent:"C6mwy"};var mo=S.union([S.string(),S.instanceof(File)]).nullable(),ln=S.any().refine(e=>e instanceof FormData,{message:"Value must be instanceof FormData"}).transform(e=>{let o=[];for(let t of e.keys()){let r=e.getAll(t);r.length&&(r.length===1?o.push([t,r[0]]):o.push([t,r]))}return S.array(S.tuple([S.string(),mo.or(mo.array())])).transform(t=>Object.fromEntries(t)).parse(o)});function ne(e){return e.replace(/\s+/g,"").trim()}var co=e=>{if(e?.payload_template){if(ne(e.payload_template)===ne(te.TEAMS))return"TEAMS";if(ne(e.payload_template)===ne(te.SLACK))return"SLACK"}return"CUSTOM"},Eo=({isDirty:e,selectedCollections:o,existingWebhook:t,headers:r,currentPayloadTemplate:i,existingPayloadTemplate:p})=>{let E=o.map(_=>_.value),m=JSON.stringify(E),c=Object.values(r).map(_=>({name:_.key,value:_.value})),n=JSON.stringify(c),d=i!==void 0&&p!==void 0&&ne(i)!==ne(p);return e||m!==JSON.stringify(t?.collection_ids)||n!==JSON.stringify(t?.headers??[])||d},dt=({formValues:e})=>e[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET]==="on"||e[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET]==="on",uo=({formValues:e,headers:o})=>{let t=dt({formValues:e}),r=e[l.WEBHOOK_FORM.NAMES.WEBHOOK_NAME],i=e[l.WEBHOOK_FORM.NAMES.URL];return Boolean(r&&i&&Object.values(o).every(p=>!p.error)&&t)};var g=a(s(),1);function To({title:e,formKey:o,existingWebhook:t,collections:r,submitTestWebhook:i,testWebhookResponse:p,fetcherState:E,initialCollectionId:m,additionalTabs:c=[],initialTab:n="configuration"}){let[d,_]=(0,T.useState)(n),[h,K]=(0,T.useState)("SLACK"),[ye,xe]=bt(),ce=Bt();(0,T.useEffect)(()=>{let y=ye.get("tab");y&&(_(y),xe(ue=>{let se=new URLSearchParams(ue);return se.delete("tab"),se}))},[ye]);let Ee=(0,T.useMemo)(()=>xt(r),[r]),[D,we]=(0,T.useState)(Ee.filter(y=>t?.collection_ids?.includes(y.value)||m&&y.value===m)),[Ue,Oe]=(0,T.useState)(),{isLoading:yo,errorMessage:mt,status:ct}=Jt(o),Et=(0,T.useCallback)(()=>Oe(void 0),[]),{headerIndices:Oo,headers:$,addHeaderIndex:fo,removeHeaderIndex:Co,onHeaderChange:ho}=oo(t?.headers),ut=(0,T.useMemo)(()=>co(t),[t]);(0,T.useEffect)(()=>{t&&K(ut)},[t,ut]);let Tt=Nt(),Ye=be(),yt=(0,T.useCallback)(y=>{let ue=D.map(No=>No.value),se=JSON.stringify(Object.values($)),bo=JSON.stringify(ue);return{...y,headers:se,collectionIds:bo,payloadTemplate:h!=="CUSTOM"?te[h]:y[l.WEBHOOK_FORM.NAMES.PAYLOAD_TEMPLATE]}},[$,D,h]),_o=(0,T.useCallback)((y,ue)=>{let se=yt(y);Tt(se,ue)},[yt,Tt]),So=(0,T.useMemo)(()=>Ee.filter(y=>!D.includes(y)),[Ee,D]),{handleBlur:Ot,handleChange:ft,handleValueChange:Ct,handleSubmit:vo,isDirty:ht,formState:U}=Ut(l.WEBHOOK_FORM.SCHEMAS,{[l.WEBHOOK_FORM.NAMES.WEBHOOK_NAME]:t?.display_name||l.WEBHOOK_FORM.INITIAL_VALUES.webhookName,[l.WEBHOOK_FORM.NAMES.URL]:t?.webhook_url||l.WEBHOOK_FORM.INITIAL_VALUES.url,[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET]:t&&(t.event_types.includes(B.WebhookEventType.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET)?"on":"off")||l.WEBHOOK_FORM.INITIAL_VALUES.WEBHOOK_EVENT_TYPE_COLLECTION_ADD_ASSET,[l.WEBHOOK_FORM.NAMES.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET]:t&&(t.event_types.includes(B.WebhookEventType.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET)?"on":"off")||l.WEBHOOK_FORM.INITIAL_VALUES.WEBHOOK_EVENT_TYPE_COLLECTION_REMOVE_ASSET,[l.WEBHOOK_FORM.NAMES.PAYLOAD_TEMPLATE]:t&&t.payload_template?t.payload_template:l.WEBHOOK_FORM.INITIAL_VALUES.payloadTemplate,[l.WEBHOOK_FORM.NAMES.ASSET_TYPE]:l.WEBHOOK_FORM.INITIAL_VALUES.assetType},o,_o),Ao=(0,T.useMemo)(()=>dt({formValues:U.values}),[U.values]),_t=(0,T.useMemo)(()=>uo({formValues:U.values,headers:$}),[$,U.values]),fe=(0,T.useMemo)(()=>h==="CUSTOM"?U.values[l.WEBHOOK_FORM.NAMES.PAYLOAD_TEMPLATE]:te[h],[U.values,h]),St=(0,T.useMemo)(()=>{if(t?.payload_template)return t.payload_template},[t?.payload_template]),go=(0,T.useMemo)(()=>Eo({isDirty:ht,selectedCollections:D,existingWebhook:t,headers:$,currentPayloadTemplate:fe,existingPayloadTemplate:St}),[ht,D,t,$,fe,St]);return(0,T.useEffect)(()=>{ct==="HAS_SUCCESS"&&Ye(t?Re:`${Re}${eo}`)},[ct,Ye,t]),(0,T.useEffect)(()=>{Oe(mt)},[mt]),(0,g.jsx)(qt,{cancelFallbackUrl:Re,onSubmit:y=>{Et(),vo(y)},errorMessage:Ue,title:e||"Create Webhook",submitButtonTextLoading:t?"Saving...":"Creating...",submitButtonText:t?"Save Webhook":"Create Webhook",isLoading:yo,isDirty:go,isValid:_t,hideContainer:!0,dismissError:Et,additionalActions:(0,g.jsx)(Ie,{submitTestWebhook:i,formState:U,currentPayloadTemplate:fe,headers:$,selectedCollections:D,totalIsValid:_t,fetcherState:E,testWebhookResponse:p,csrf:ce}),children:(0,g.jsxs)(he,{value:d,onValueChange:_,className:pt.tabs,children:[(0,g.jsxs)(_e,{children:[c.map(y=>(0,g.jsx)(Q,{value:y.value,children:y.label},y.value)),(0,g.jsx)(Q,{value:"configuration",children:"Configuration"}),(0,g.jsx)(Q,{value:"template",children:"Payload Template"}),(0,g.jsx)(Q,{value:"headers",children:"Custom Headers"})]}),c.map(y=>(0,g.jsx)(I,{value:y.value,children:y.content},y.value)),(0,g.jsxs)("div",{className:pt.tabContent,children:[(0,g.jsx)(nt,{formState:U,handleBlur:Ot,handleChange:ft,availableCollectionOptions:So,selectedCollections:D,onCollectionsChange:we,eventTypesValid:Ao,handleValueChange:Ct,selectedPayloadTemplate:h,onPayloadTemplateChange:K}),(0,g.jsx)(it,{formState:U,handleBlur:Ot,handleChange:ft,handleValueChange:Ct,payloadTemplateExample:h,setPayloadTemplateExample:K,currentPayloadTemplate:fe}),(0,g.jsx)(lt,{headers:$,onHeaderChange:ho,headerIndices:Oo,addHeaderIndex:fo,removeHeaderIndex:Co})]})]})})}export{Fo as a,He as b,Po as c,$t as d,Me as e,Fe as f,To as g};
