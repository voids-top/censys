import{a as ne}from"/censys/build/_shared/chunk-GILMQYNZ.js";import{b as We}from"/censys/build/_shared/chunk-FVSYCD2X.js";import{a as qe}from"/censys/build/_shared/chunk-ZD7QYARS.js";import{a as Ke,b as je}from"/censys/build/_shared/chunk-USPKPH7G.js";import{a as Be}from"/censys/build/_shared/chunk-3W2VQNCA.js";import{a as ze}from"/censys/build/_shared/chunk-JC22C2KM.js";import{a as D,c as Me,e as Oe,m as Ve,n as $e}from"/censys/build/_shared/chunk-6D64NL5L.js";import{a as Le}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as kt}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as Fe}from"/censys/build/_shared/chunk-IJLDI467.js";import{a as Ie}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{B as we,q as Ae,s as ke,z as Ue}from"/censys/build/_shared/chunk-HUE44QRB.js";import{a as He}from"/censys/build/_shared/chunk-437XWWKH.js";import{b as Ge}from"/censys/build/_shared/chunk-WJEUPJRQ.js";import{a as M}from"/censys/build/_shared/chunk-EZHABQF2.js";import{b as xe}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{e as Q}from"/censys/build/_shared/chunk-D5QEORL2.js";import{A as p,B as L,Pa as Ne,Qa as X,Ra as J,Va as _e,Ya as De,a as K,aa as be,c as j,e as B,f as P,h as q,k as I,l as W,m as F,wa as Re,y as Ce,z as C}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as z}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{a as ye,g as $,k as Pe,p as x}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as _,c as v}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as c}from"/censys/build/_shared/chunk-2QEWK57A.js";var y=c(_(),1);var Xe=c(_(),1);var G={eventHistoryTimeline:"EU-qS",timestampCell:"vdP2z",linkCell:"_69ZHf",detailCell:"aqnP-",checkboxCell:"rhz16",timestamp:"zru5h",emptyState:"kaCVu"};var T=c(v(),1);function ae({events:e,selectedEventTimestamps:t,onSelectedEventTimestampsChange:o,latestEventTime:r,slots:{DetailLinkComponent:a,DescriptionComponent:n}}){let s=(0,Xe.useCallback)(i=>m=>{let f=i.eventTime;m?t.length<2?o(d=>[...d,f.toString()]):o(d=>[d[1],f.toString()]):o(d=>d.filter(u=>u!==f.toString()))},[t,o]);return e.length===0?(0,T.jsx)(Ae,{className:G.emptyState,title:"No events matching the selected filters were found.",iconName:"calendar-event"}):(0,T.jsx)("div",{role:"grid",className:G.eventHistoryTimeline,children:e.map((i,m)=>{let f=Ht(i,t),d=`${i.eventTime}-label`;return(0,T.jsxs)("div",{role:"row","data-testid":"timeline-event","aria-selected":f,children:[(0,T.jsx)("div",{role:"gridcell",className:G.checkboxCell,"aria-label":"Select event for comparison",children:(0,T.jsx)(De,{"data-testid":"event-timestamp-checkbox","aria-label":"","aria-labelledby":d,checked:f,onCheckedChange:s(i)})}),(0,T.jsx)("div",{role:"gridcell",className:G.timestampCell,children:(0,T.jsx)(Fe,{id:d,timestamp:i.eventTime.toString(),className:G.timestamp,variant:"short",includeTooltip:!1})}),(0,T.jsx)("div",{role:"gridcell",className:G.linkCell,children:(0,T.jsx)(a,{event:i,isLatest:m===0,latestEventTime:r})}),(0,T.jsx)("div",{role:"gridcell",className:G.detailCell,children:(0,T.jsx)(n,{event:i})})]},i.eventTime.toString())})})}function Ht(e,t){return t.includes(e.eventTime.toString())}var te=c(_(),1);var H=c(_(),1);var Qe=c(_(),1);var Ye=c(v(),1),Ut="Separator",Je="horizontal",wt=["horizontal","vertical"],Ze=Qe.forwardRef((e,t)=>{let{decorative:o,orientation:r=Je,...a}=e,n=It(r)?r:Je,i=o?{role:"none"}:{"aria-orientation":n==="vertical"?n:void 0,role:"separator"};return(0,Ye.jsx)(P.div,{"data-orientation":n,...i,...a,ref:t})});Ze.displayName=Ut;function It(e){return wt.includes(e)}var et=Ze;var h=c(_(),1);var tt=c(_(),1);var ot=c(v(),1),rt="Toggle",ie=tt.forwardRef((e,t)=>{let{pressed:o,defaultPressed:r,onPressedChange:a,...n}=e,[s,i]=B({prop:o,onChange:a,defaultProp:r??!1,caller:rt});return(0,ot.jsx)(P.button,{type:"button","aria-pressed":s,"data-state":s?"on":"off","data-disabled":e.disabled?"":void 0,...n,ref:t,onClick:K(e.onClick,()=>{e.disabled||i(!s)})})});ie.displayName=rt;var g=c(v(),1),A="ToggleGroup",[at,se]=j(A,[I]),it=I(),le=h.default.forwardRef((e,t)=>{let{type:o,...r}=e;if(o==="single")return(0,g.jsx)(Ft,{...r,ref:t});if(o==="multiple")return(0,g.jsx)(Mt,{...r,ref:t});throw new Error(`Missing prop \`type\` expected on \`${A}\``)});le.displayName=A;var[st,lt]=at(A),Ft=h.default.forwardRef((e,t)=>{let{value:o,defaultValue:r,onValueChange:a=()=>{},...n}=e,[s,i]=B({prop:o,defaultProp:r??"",onChange:a,caller:A});return(0,g.jsx)(st,{scope:e.__scopeToggleGroup,type:"single",value:h.default.useMemo(()=>s?[s]:[],[s]),onItemActivate:i,onItemDeactivate:h.default.useCallback(()=>i(""),[i]),children:(0,g.jsx)(ct,{...n,ref:t})})}),Mt=h.default.forwardRef((e,t)=>{let{value:o,defaultValue:r,onValueChange:a=()=>{},...n}=e,[s,i]=B({prop:o,defaultProp:r??[],onChange:a,caller:A}),m=h.default.useCallback(d=>i((u=[])=>[...u,d]),[i]),f=h.default.useCallback(d=>i((u=[])=>u.filter(U=>U!==d)),[i]);return(0,g.jsx)(st,{scope:e.__scopeToggleGroup,type:"multiple",value:s,onItemActivate:m,onItemDeactivate:f,children:(0,g.jsx)(ct,{...n,ref:t})})});le.displayName=A;var[Ot,Vt]=at(A),ct=h.default.forwardRef((e,t)=>{let{__scopeToggleGroup:o,disabled:r=!1,rovingFocus:a=!0,orientation:n,dir:s,loop:i=!0,...m}=e,f=it(o),d=q(s),u={role:"group",dir:d,...m};return(0,g.jsx)(Ot,{scope:o,rovingFocus:a,disabled:r,children:a?(0,g.jsx)(W,{asChild:!0,...f,orientation:n,dir:d,loop:i,children:(0,g.jsx)(P.div,{...u,ref:t})}):(0,g.jsx)(P.div,{...u,ref:t})})}),Y="ToggleGroupItem",pt=h.default.forwardRef((e,t)=>{let o=lt(Y,e.__scopeToggleGroup),r=Vt(Y,e.__scopeToggleGroup),a=it(e.__scopeToggleGroup),n=o.value.includes(e.value),s=r.disabled||e.disabled,i={...e,pressed:n,disabled:s},m=h.default.useRef(null);return r.rovingFocus?(0,g.jsx)(F,{asChild:!0,...a,focusable:!s,active:n,ref:m,children:(0,g.jsx)(nt,{...i,ref:t})}):(0,g.jsx)(nt,{...i,ref:t})});pt.displayName=Y;var nt=h.default.forwardRef((e,t)=>{let{__scopeToggleGroup:o,value:r,...a}=e,n=lt(Y,o),s={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},i=n.type==="single"?s:void 0;return(0,g.jsx)(ie,{...i,...a,ref:t,onPressedChange:m=>{m?n.onItemActivate(r):n.onItemDeactivate(r)}})}),mt=le,dt=pt;var S=c(v(),1),ce="Toolbar",[zt,xo]=j(ce,[I,se]),pe=I(),vt=se(),[Kt,ut]=zt(ce),ft=H.forwardRef((e,t)=>{let{__scopeToolbar:o,orientation:r="horizontal",dir:a,loop:n=!0,...s}=e,i=pe(o),m=q(a);return(0,S.jsx)(Kt,{scope:o,orientation:r,dir:m,children:(0,S.jsx)(W,{asChild:!0,...i,orientation:r,dir:m,loop:n,children:(0,S.jsx)(P.div,{role:"toolbar","aria-orientation":r,dir:m,...s,ref:t})})})});ft.displayName=ce;var gt="ToolbarSeparator",jt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=ut(gt,o);return(0,S.jsx)(et,{orientation:a.orientation==="horizontal"?"vertical":"horizontal",...r,ref:t})});jt.displayName=gt;var qt="ToolbarButton",me=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=pe(o);return(0,S.jsx)(F,{asChild:!0,...a,focusable:!e.disabled,children:(0,S.jsx)(P.button,{type:"button",...r,ref:t})})});me.displayName=qt;var Wt="ToolbarLink",Xt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=pe(o);return(0,S.jsx)(F,{asChild:!0,...a,focusable:!0,children:(0,S.jsx)(P.a,{...r,ref:t,onKeyDown:K(e.onKeyDown,n=>{n.key===" "&&n.currentTarget.click()})})})});Xt.displayName=Wt;var Tt="ToolbarToggleGroup",Jt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=ut(Tt,o),n=vt(o);return(0,S.jsx)(mt,{"data-orientation":a.orientation,dir:a.dir,...n,...r,ref:t,rovingFocus:!1})});Jt.displayName=Tt;var Qt="ToolbarToggleItem",Yt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=vt(o),n={__scopeToolbar:e.__scopeToolbar};return(0,S.jsx)(me,{asChild:!0,...n,children:(0,S.jsx)(dt,{...a,...r,ref:t})})});Yt.displayName=Qt;var Et=ft;var ht=me;var St={actionBar:"Ru0yn"};var Z=c(v(),1);function de({children:e,actions:t,ariaLabel:o}){return(0,Z.jsxs)(Et,{className:St.actionBar,"aria-label":o,children:[e,t.map((r,a)=>(0,Z.jsx)(ht,{asChild:!0,children:r},a))]})}var ve={AT_TIME_A:"at_time_a",AT_TIME_B:"at_time_b"},ue=2;var ee={compareBar:"_4v6Ji",selectedEvents:"we0eO",tooltipContent:"UpU5l"};var b=c(v(),1);function fe({selectedTimestamps:e,setSelectedTimestamps:t}){let o=$(),[r]=x(),a=(0,te.useCallback)(()=>{t([])},[t]),n=(0,te.useMemo)(()=>{let s=new URLSearchParams(r);return s.set(ve.AT_TIME_A,e[0]),s.set(ve.AT_TIME_B,e[1]),`${o.collectionId?`/collections/${o.collectionId}/hosts/${o.id}/events/compare`:`/hosts/${o.id}/events/compare`}?${s.toString()}`},[o.collectionId,o.id,e,r]);return e.length===0?null:(0,b.jsx)(de,{ariaLabel:"Action bar for comparing two events",actions:[(0,b.jsxs)("div",{className:ee.compareBar,children:[(0,b.jsxs)("div",{className:ee.selectedEvents,"data-testid":"events-selected-timestamps",children:[(0,b.jsx)(Ne,{count:e.length}),(0,b.jsx)(p,{children:` of ${ue} Selected`})]}),(0,b.jsx)(_e,{content:"Select 2 events to compare",contentClassName:ee.tooltipContent,children:(0,b.jsx)(He,{button:{variant:L.PRIMARY,disabled:e.length!==ue},link:{to:n,isExternal:!0},children:"Compare"})}),e.length>0&&(0,b.jsx)(Ke,{onClick:a})]})]})}var yt=c(_(),1);var O={container:"CToH1",datePickerContainer:"_5lCC9",inlineAlert:"OkFtJ",icon:"XPzPi",viewChangesText:"VRQcU"};var k=c(v(),1);function ge({startDate:e="",endDate:t="",minDate:o}){let[r,a]=x(),n=(0,yt.useCallback)((s,i)=>{let m=new URLSearchParams(r);m.set("start",s),m.set("end",i),a(m)},[r,a]);return(0,k.jsxs)("div",{className:O.container,children:[(0,k.jsx)("div",{className:O.datePickerContainer,children:(0,k.jsx)(je,{startDate:e,endDate:t,minDate:o,onApply:n})}),(0,k.jsxs)("div",{className:O.inlineAlert,children:[(0,k.jsx)(Ce,{name:"lightbulb",mode:"line",className:O.icon}),(0,k.jsx)(p,{"data-testid":"event-date-picker-form-inline-alert",children:"Select two events to compare."})]})]})}var Te={detailLink:"_1bmvh",textSecondary:"EiTdG",pill:"eBKf7"};var V=c(v(),1);function Ee({event:e,isLatest:t,latestEventTime:o}){let[r]=x(),{id:a}=$(),n=r.get("at_time"),s=!!r.get("start"),i=e.eventTime?.toString(),m=o?.toString(),f=n&&n!==i||!n&&m!==i,d=n&&i===n||!n&&m===i,u=a,U=t&&!s?`/hosts/${u}`:`/hosts/${u}?at_time=${i}`;return(0,V.jsxs)("div",{className:Te.detailLink,children:[f&&(0,V.jsx)(M,{href:U,children:"View historical host"}),d&&(0,V.jsx)(p,{className:Te.textSecondary,children:"Currently viewing"})]})}var R={negativeScan:"PDFU5",negativeScanContainer:"-Tean",pill:"WgN9L"};function Pt(e){if(e?.scan){let{port:t,protocol:o,transportProtocol:r}=e.scan;return`${t}/${We.TransportProtocol[r]}/${o}`}return"Unknown"}function Ct(e){if(e.scan){let{port:t,endpointType:o,path:r}=e.scan;return qe(t,o,r).fullLabel}return"Unknown"}function bt(e){return e?.scan?.isSuccess??!1}var l=c(v(),1);function he({event:e}){let t={serviceScanned:e.serviceScanned,locationUpdated:e.locationUpdated,forwardDnsResolved:e.forwardDnsResolved,reverseDnsResolved:e.reverseDnsResolved,whoisUpdated:e.whoisUpdated,routeUpdated:e.routeUpdated,endpointScanned:e.endpointScanned,jarmScanned:e.jarmScanned};if(t.serviceScanned){let o=!bt(t.serviceScanned);return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.serviceScanned}),(0,l.jsxs)("div",{className:o?R.negativeScanContainer:"",children:[(0,l.jsx)(p,{className:o?R.negativeScan:"",children:Pt(t.serviceScanned)}),o&&(0,l.jsx)(J,{size:"sm",variant:X.FEEDBACK_NEGATIVE_DEFAULT,className:R.pill,children:"Not Observed"})]})]})}if(t.locationUpdated)return(0,l.jsx)(p,{variant:C.H5,children:D.locationUpdated});if(t.forwardDnsResolved)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.forwardDnsResolved}),(0,l.jsx)(p,{children:t.forwardDnsResolved?.name})]});if(t.reverseDnsResolved)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.reverseDnsResolved}),(0,l.jsx)(p,{children:(t.reverseDnsResolved?.names||[]).join(", ")})]});if(t.whoisUpdated)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.whoisUpdated}),(0,l.jsx)(p,{children:t.whoisUpdated?.whois?.network?.name})]});if(t.routeUpdated)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.routeUpdated}),(0,l.jsx)(p,{children:t.routeUpdated.route?.name})]});if(t.endpointScanned){let o=!t.endpointScanned?.scan?.isSuccess;return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.endpointScanned}),(0,l.jsxs)("div",{className:o?R.negativeScanContainer:"",children:[(0,l.jsx)(p,{className:o?R.negativeScan:"",children:Ct(t.endpointScanned)}),o&&(0,l.jsx)(J,{size:"sm",variant:X.FEEDBACK_NEGATIVE_DEFAULT,className:R.pill,children:"Not Observed"})]})]})}if(t.jarmScanned){let o=!t.jarmScanned?.scan?.isSuccess;return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.jarmScanned}),(0,l.jsxs)("div",{className:o?R.negativeScanContainer:"",children:[(0,l.jsx)(p,{className:o?R.negativeScan:"",children:t.jarmScanned?.scan?.fingerprint}),o&&(0,l.jsx)(J,{size:"sm",variant:X.FEEDBACK_NEGATIVE_DEFAULT,className:R.pill,children:"Not Observed"})]})]})}return(0,l.jsx)(p,{variant:C.H5,children:"Event with No Details"})}var Rt=c(_(),1);var N=c(v(),1);function Se(){let e=Q(),t=Ge(e),o=xe("ACCOUNTS_SITE_URL"),r=(0,Rt.useContext)(z),a=ke(r),n=null;switch(t){case 1:n=(0,N.jsxs)(p,{children:["The Free tier does not include viewing asset history."," ",(0,N.jsx)(we,{buttonVariant:L.GHOST})," to your Organization account to view additional history."]});break;case 2:n=(0,N.jsxs)(p,{children:["The Starter tier includes one week of asset history."," ",(0,N.jsx)(M,{href:a,isExternal:!0,children:"Upgrade"})," ","to the Enterprise tier to view additional history."]});break;case 3:n=(0,N.jsx)(p,{children:"The Enterprise tier includes six months of asset history. Contact your Sales Representative to get access to extended history."});break;case 0:default:n=(0,N.jsxs)(p,{children:["The Free tier does not include viewing asset history."," ",(0,N.jsx)(M,{href:`${o}/settings/plan`,isExternal:!0,shouldOmitOrg:!1,children:"Upgrade"})," ","to the Starter or Enterprise tier to view asset history."]})}return(0,N.jsx)(ne,{content:n})}var oe={events:"vwbn6",emptyState:"_6FFEn",loadMoreButton:"s6GYb"};function Nt(e,t){let o={};for(let r of e){let a=r.eventTime.toString();o[a]=r}for(let r of t){let a=r.eventTime.toString();o[a]=r}return Object.values(o)}var to=c(kt(),1),E=c(v(),1);function eo(){let{events:e,scannedTo:t,hasEventsBeyondEntitlement:o,host:r}=Be(),[a,n]=(0,y.useState)(e),[s,i]=(0,y.useState)(t),[m,f]=(0,y.useState)(o),d=Ue(),[u]=x(),[U,re]=(0,y.useState)([]),_t=u.get("at_time"),Dt=Me(r,_t)?.toString(),xt=(0,y.useCallback)(()=>{if(s){let w=new URLSearchParams(u);w.set("scannedTo",s.toString()),d.load(`./?index&${w}`)}},[s,d.load,u]);return(0,y.useEffect)(()=>{n(e),i(t),re([]),f(o)},[e,t,o]),(0,y.useEffect)(()=>{if(d.data){let{events:w,scannedTo:Gt}=Le(d.data);n(At=>Nt(At,w)),i(Gt),f(d.data.hasEventsBeyondEntitlement)}},[d.data]),(0,E.jsxs)("div",{"data-testid":"host-timeline-events",className:oe.events,children:[(0,E.jsx)("div",{children:(0,E.jsx)(ge,{startDate:u.get("start")||"",endDate:u.get("end")||""})}),(0,E.jsx)(Re,{children:(0,E.jsx)(ae,{events:a,selectedEventTimestamps:U,onSelectedEventTimestampsChange:re,latestEventTime:Dt,slots:{DetailLinkComponent:Ee,DescriptionComponent:he}})}),s&&!m&&(0,E.jsx)(be,{className:oe.loadMoreButton,variant:L.DEFAULT,onClick:xt,isLoading:d.state==="loading",children:"Load More"}),m&&(0,E.jsx)(Se,{}),(0,E.jsx)(fe,{selectedTimestamps:U,setSelectedTimestamps:w=>re(w)})]})}function ln(e){let{currentParams:t,nextParams:o,currentUrl:r,nextUrl:a}=e;if(t.id!==o.id)return!0;let n=r.searchParams,s=a.searchParams;return Ve(n,s)||n.get("event_time")!==s.get("event_time")?!1:$e(e)}function cn(){let e=Pe(),t=Q(),o=(0,y.useContext)(z);return(0,E.jsx)("div",{className:oe.emptyState,children:ye(e)&&Oe(e.data)?(0,E.jsx)(ze,{accessState:t,errorCode:e.data.code,env:o}):(0,E.jsx)(Ie,{error:e})})}export{eo as a,ln as b,cn as c};
