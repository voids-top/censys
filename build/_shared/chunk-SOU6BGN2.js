import{a as ue,b as Le}from"/censys/build/_shared/chunk-6HSN5L3Z.js";import{a as Te}from"/censys/build/_shared/chunk-MKHNE654.js";import{a as Oe}from"/censys/build/_shared/chunk-PSJYO5QU.js";import{b as pe}from"/censys/build/_shared/chunk-UWRUBCCK.js";import{b as Y}from"/censys/build/_shared/chunk-DDZX7K4F.js";import{a as Ee}from"/censys/build/_shared/chunk-5PS6SCVZ.js";import{g as ce}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import{e as me}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{f as Ce,g as de}from"/censys/build/_shared/chunk-HLRAT4GD.js";import{a as H}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{j as re}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{g as se}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{A as l,B as r,C as $,D as K,E as j,F as ee,U as oe,V as te,W as ae,X as ie,Xa as y,Ya as P,aa as ne,ab as le,z as J}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{d as O}from"/censys/build/_shared/chunk-6URBRDCL.js";import{p as X,q as Z}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as W,c as T}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as m}from"/censys/build/_shared/chunk-2QEWK57A.js";var n=m(W(),1);var a={hr:"VHA-p",collectionDetailsContainer:"WOqJf",titleGroup:"Q2431",sharedCollectionContainer:"_5PADR",sharedCollectionLabel:"_5Rca0",alertsSection:"BlLCr",label:"BOX5U",alerts:"_875aA",collectionQuery:"BbsEh",sizeEstimator:"JBvCW"};var s={COLLECTION_NAME:"collectionName",COLLECTION_DESCRIPTION:"collectionDescription",COLLECTION_QUERY:"q",COLLECTION_CATEGORY:"collectionCategory",COLLECTION_ID:"collectionId",SHARED_WITH_ORG:"sharedWithOrg"},Ne="Enter valid query here...",Ie="Enter valid query or use natural language...",e={ESTIMATE_COLLECTION_SIZE:{QUERY_FIELD_NAME:"query",QUERY_FIELD_SCHEMA:O.string({required_error:"A query is required"}).min(1,{message:"A query is required"})},COLLECTION_FORM:{NAMES:s,SCHEMAS:{[s.COLLECTION_NAME]:O.string({required_error:"A collection name is required."}).min(1,{message:"A collection name is required."}).max(100,{message:"Collection name must be less than 100 characters."}),[s.COLLECTION_DESCRIPTION]:O.string().max(500,{message:"Collection description must be less than 500 characters."}),[s.COLLECTION_QUERY]:O.string({required_error:"A collection query is required."}).min(1,{message:"A collection query is required."}),[s.COLLECTION_CATEGORY]:O.string(),[s.COLLECTION_ID]:O.optional(O.string()),[s.SHARED_WITH_ORG]:O.enum(["on","off"]).optional()},INITIAL_VALUES:{[s.COLLECTION_NAME]:"",[s.COLLECTION_DESCRIPTION]:"",[s.COLLECTION_QUERY]:"",[s.COLLECTION_CATEGORY]:se.Category.CATEGORY_UNSPECIFIED,[s.SHARED_WITH_ORG]:"off"}}};var i=m(T(),1),he=({onValueChange:t,fieldValues:N,hasSharingCapability:p})=>(0,i.jsxs)("div",{className:a.collectionDetailsContainer,"data-testid":"collection-collaborators",children:[(0,i.jsxs)("div",{className:a.titleGroup,children:[(0,i.jsx)(r,{variant:l.H2,children:"Collaborators (Optional)"}),(0,i.jsx)(r,{variant:l.DEFAULT,children:"Collections can be shared with your entire organization, allowing other members to view the collection. You can only share a collection within your active organization, not across all organizations you belong to. The default is My Collection, and only you can see it."})]}),p&&(0,i.jsx)(y,{children:(0,i.jsxs)(le,{name:e.COLLECTION_FORM.NAMES.SHARED_WITH_ORG,value:N[e.COLLECTION_FORM.NAMES.SHARED_WITH_ORG],"aria-label":e.COLLECTION_FORM.NAMES.SHARED_WITH_ORG,onValueChange:d=>{t(e.COLLECTION_FORM.NAMES.SHARED_WITH_ORG,d)},children:[(0,i.jsx)(P,{label:"My Collection",value:"off","aria-label":"My Collection"},"my-collection"),(0,i.jsx)("div",{className:a.sharedCollectionContainer,children:(0,i.jsx)(P,{label:(0,i.jsxs)("div",{className:a.sharedCollectionLabel,children:[(0,i.jsx)(J,{"aria-hidden":!0,name:"group",mode:"line",size:"xl"}),(0,i.jsx)("span",{children:"Shared Collection"})]}),value:"on","aria-label":"Shared Collection"},"shared-with-org")})]})}),!p&&(0,i.jsx)(r,{variant:l.DEFAULT,children:"You do not have access. Contact your admin to set up sharing."})]});var Q=m(W(),1);var o=m(T(),1),Me=ue.map(t=>({label:de(t),value:t})),ye=({onBlur:t,onChange:N,onValueChange:p,errors:d,fieldValues:u,queryProps:f})=>{let I=re(),{initialQuery:U,collectionEstimatedSize:F,collectionEstimatedSizeError:_,collectionEstimatedSizeLoading:A,handleEstimateQuerySize:R,handleQueryChange:v,handleIsQueryValid:V}=f,k=(0,Q.useCallback)(h=>{p(e.COLLECTION_FORM.NAMES.COLLECTION_CATEGORY,h)},[p]),M=(0,Q.useCallback)(h=>{v(h.target.value)},[v]),D=(0,Q.useCallback)(()=>{R(u.q)},[R,u.q]),g=d.q||_,L=A?"One moment while we estimate the query size...":F!==null?(0,o.jsxs)("span",{className:a.accepted,"aria-live":"polite",children:["Accepted. Size estimator of results:"," ",(0,o.jsx)(Y,{value:F})]}):void 0;return(0,o.jsxs)("div",{className:a.collectionDetailsContainer,"data-testid":"collection-details",children:[(0,o.jsxs)("div",{className:a.titleGroup,children:[(0,o.jsx)(r,{variant:l.H2,children:"Collection Details"}),(0,o.jsxs)(r,{variant:l.DEFAULT,children:["Use collections to monitor search queries, receive continuous updates on new results, and track changes. Collections have a"," ",(0,o.jsx)(Y,{value:Ce}),"-result maximum. ",(0,o.jsx)("br",{})," Reference the documentation for detailed information on how to"," ",(0,o.jsx)(H,{href:"https://docs.censys.com/docs/platform-collections#/",isExternal:!0,children:"use and create collections"}),"."]})]}),(0,o.jsx)(y,{label:"Collection Name",labelFor:"collection-name",errorText:d.collectionName,required:!0,children:(0,o.jsx)(K,{name:e.COLLECTION_FORM.NAMES.COLLECTION_NAME,value:u.collectionName,isValid:!d.collectionName,id:"collection-name",type:"text",isFullWidth:!0,onBlur:t,onChange:N,autoComplete:"off",placeholder:"Enter collection name here...","data-testid":"collection-name-input"})}),(0,o.jsx)(y,{label:"Collection Query",labelFor:"collection-query",required:!0,hintText:L,errorText:!L&&g&&(0,o.jsx)("span",{"aria-live":"polite",children:g}),children:(0,o.jsx)("div",{className:a.collectionQuery,children:(0,o.jsx)(ce,{id:"collection-query",name:e.COLLECTION_FORM.NAMES.COLLECTION_QUERY,inputLabel:"Collection Query",initialValue:U,placeholder:I?Ie:Ne,onChange:M,rightContainerSlot:({query:h,isValid:z})=>(0,o.jsx)(ne,{type:"button",className:a.sizeEstimator,variant:$.TERTIARY,isLoading:A,disabled:!!g||!h||!z,onClick:D,children:Le.SIZE_ESTIMATOR}),onIsValidChange:V})})}),(0,o.jsx)("div",{className:a.hr}),(0,o.jsx)(y,{label:"Description",labelFor:"collection-description",description:"Note: In lieu of a description, the query syntax will be used.",errorText:d.collectionDescription,children:(0,o.jsx)(j,{name:e.COLLECTION_FORM.NAMES.COLLECTION_DESCRIPTION,id:"collection-description",isValid:!d.collectionDescription,isFullWidth:!0,onBlur:t,onChange:N,value:u.collectionDescription,placeholder:"Optional text to provide context describing your collection.","data-testid":"collection-description-input"})}),(0,o.jsx)(y,{label:"Collection Category",labelFor:"collection-category",description:"Add more context for your team to understand what kind of collection you are monitoring.",errorText:d.collectionCategory,children:(0,o.jsx)(ee,{defaultValue:u.collectionCategory,name:e.COLLECTION_FORM.NAMES.COLLECTION_CATEGORY,options:Me,onValueChange:k,"data-testid":"collection-category-select"})})]})};var E=m(T(),1),_e=({hasWebhookCapability:t})=>(0,E.jsxs)("div",{className:a.collectionDetailsContainer,children:[(0,E.jsxs)("div",{className:a.titleGroup,children:[(0,E.jsx)(r,{variant:l.H2,children:"Notifications (Optional)"}),(0,E.jsx)(r,{variant:l.DEFAULT,children:"Collections webhooks provide organizations the ability to receive updates when new assets are added or removed from their collection. Webhooks deliver Censys data to various applications, enabling users to monitor events and take action as needed."})]}),(0,E.jsxs)("div",{className:a.alertsSection,children:[t&&(0,E.jsxs)(r,{variant:l.DEFAULT,"data-testid":"collection-notifications-manage-webhooks",children:["Manage your collection webhooks in"," ",(0,E.jsx)(H,{size:"md",href:"/settings/webhooks",children:"Settings"}),"."]}),!t&&(0,E.jsx)(r,{variant:l.DEFAULT,"data-testid":"collection-notifications-no-webhooks",children:"You do not have access. Contact your admin to set up webhooks."})]})]});var S={tabContainer:"TmbTD",tab:"_8DeC6",tabContent:"_6RUBM",tabFiller:"U0f8L"};var c=m(T(),1),De=({existingCollection:t,formKey:N,hasSharingCapability:p,hasWebhookCapability:d,...u})=>{let[f,I]=(0,n.useState)(),U=Z(),{isLoading:F,errorMessage:_,status:A}=pe(N),[R,v]=(0,n.useState)(!1),V=me(),[k]=X(),M=k.get("query")||t?.query||e.COLLECTION_FORM.INITIAL_VALUES.q;(0,n.useEffect)(()=>{I(_)},[_]);let{handleBlur:D,handleChange:g,handleValueChange:L,handleSubmit:h,isValid:z,isDirty:ge,formState:b}=Ee(e.COLLECTION_FORM.SCHEMAS,{[e.COLLECTION_FORM.NAMES.COLLECTION_CATEGORY]:t?.category||e.COLLECTION_FORM.INITIAL_VALUES.collectionCategory,[e.COLLECTION_FORM.NAMES.COLLECTION_DESCRIPTION]:t?.description||e.COLLECTION_FORM.INITIAL_VALUES.collectionDescription,[e.COLLECTION_FORM.NAMES.COLLECTION_NAME]:t?.name||e.COLLECTION_FORM.INITIAL_VALUES.collectionName,[e.COLLECTION_FORM.NAMES.COLLECTION_QUERY]:M,[e.COLLECTION_FORM.NAMES.COLLECTION_ID]:t?.collection_id||"",[e.COLLECTION_FORM.NAMES.SHARED_WITH_ORG]:t?.shared_with_org?"on":"off"},N,U),{clear:G,handleEstimateCollectionSize:w,size:Se,errorMessage:B,loading:Ae}=Te(),be=(0,n.useCallback)(C=>{I(void 0),w(C)},[w]),fe=(0,n.useCallback)(C=>{G(),I(void 0),L(e.COLLECTION_FORM.NAMES.COLLECTION_QUERY,C)},[G,L]);(0,n.useEffect)(()=>{A==="HAS_SUCCESS"&&V("/collections")},[A]),(0,n.useEffect)(()=>{I(_)},[_]);let Fe=z&&R&&!!b.values.q&&!f&&!B,q=(0,n.useMemo)(()=>[{id:"collection-details",label:"Collection Details",component:(0,c.jsx)(ye,{...u,onBlur:D,onChange:g,onValueChange:L,errors:b.errors,fieldValues:b.values,queryProps:{initialQuery:M,collectionEstimatedSize:Se,collectionEstimatedSizeError:B,collectionEstimatedSizeLoading:Ae,handleEstimateQuerySize:be,handleQueryChange:fe,handleIsQueryValid:v}})},...p?[{id:"collection-collaborators",label:"Collaborators",component:(0,c.jsx)(he,{hasSharingCapability:p,fieldValues:b.values,onValueChange:L})}]:[],{id:"collection-notifications",label:"Notifications",component:(0,c.jsx)(_e,{hasWebhookCapability:d})}],[u,b.errors,D,g,L]),[Re,ve]=(0,n.useState)(q[0].id);return(0,c.jsxs)(Oe,{cancelFallbackUrl:"/collections",onSubmit:C=>{I(void 0),h(C)},errorMessage:f,title:t?`Update ${t.name}`:"Create Collection",submitButtonTextLoading:t?"Updating...":"Creating...",submitButtonText:t?"Update":"Create",isLoading:F,isDirty:ge,isValid:Fe,children:[t?.collection_id&&(0,c.jsx)("input",{type:"hidden",name:e.COLLECTION_FORM.NAMES.COLLECTION_ID}),(0,c.jsxs)(oe,{orientation:"vertical",value:Re||q[0].id,onValueChange:ve,className:S.tabContainer,children:[(0,c.jsxs)(te,{className:S.tabs,children:[q.map(({id:C,label:x})=>(0,c.jsx)(ae,{value:C,className:S.tab,children:x},C)),(0,c.jsx)("div",{className:S.tabFiller})]}),q.map(({id:C,component:x})=>(0,c.jsx)(ie,{value:C,className:S.tabContent,children:x},C))]})]})};export{De as a};
