import{a as D}from"/censys/build/_shared/chunk-6UNSGNMB.js";import{a as V}from"/censys/build/_shared/chunk-PLG22QRR.js";import{b as M}from"/censys/build/_shared/chunk-CUDHDFMO.js";import{a as F}from"/censys/build/_shared/chunk-OSJU6MWK.js";import{a as _}from"/censys/build/_shared/chunk-62I4RDM3.js";import{a as P}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{e as w,h as I}from"/censys/build/_shared/chunk-TUFJ6JAI.js";import{a as B}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as k}from"/censys/build/_shared/chunk-LQXVLPA4.js";import{a as R}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{b as C}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{a as N}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{e as A}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as x}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{v as S,w as L,y as U}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{A as m,B as s,C as g,_ as E,ba as v}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as b,k as $}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as z,c as f}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as p}from"/censys/build/_shared/chunk-2QEWK57A.js";var y=p(z(),1);var h={item:"bK7Wu",group:"tP9De",row:"xDiCv"};var o=p(f(),1);function H({service:t,threat:e,baseRoute:n}){if(!e?.id||!t?.port||!t?.protocol)return null;let d=L(U(S({kind:0,field:"host.services.threats.id",value:e.id}),S({kind:5,field:"host.services",content:`port = ${t.port} and protocol = ${t.protocol}`}),"and",!1));return(0,o.jsx)(F,{as:"li",actions:[{label:"Go to service",icon:"arrow-right",href:`${I(t,n)}`,buttonVariant:g.DEFAULT,size:v.LARGE},{label:"Search for threat on service",icon:"search",href:d,buttonVariant:g.DEFAULT,size:v.LARGE}],contentOption:{side:"right",align:"center",sideOffset:-90},className:h.item,children:(0,o.jsxs)("div",{role:"group",className:h.group,"aria-label":`Threat details for service with protocol ${t.protocol} and port ${t.port}`,"data-testid":`threat-detail-item-${e.id}-${t.ip}-${t.port}`,children:[(0,o.jsx)("div",{className:h.row,children:(0,o.jsxs)(s,{variant:m.H3,as:"span",children:[t.protocol," ",t.port," /"," ",M.TransportProtocol[t.transport_protocol]]})}),(0,o.jsxs)("div",{className:h.row,role:"group",children:[t.scan_time&&(0,o.jsx)("div",{"aria-label":`Scan time: ${t.scan_time}`,children:(0,o.jsx)(k,{labelText:null,timestamp:t.scan_time})}),(0,o.jsx)(s,{variant:m.DEFAULT,as:"span",id:`${e.id}_confidence`,children:"Confidence"}),(0,o.jsxs)(s,{children:[(0,o.jsx)(E,{value:((e.confidence??0)*100).toFixed(0)}),"%"]})]})]})})}var u={threatsLayout:"Kux5l",serviceList:"f-D5Q"};var Q=p(B(),1),r=p(f(),1),Dt=P("Host Threats","routes/hosts.$id");function G(){let{collection:t,host:e,threatDetails:n}=V(),d=`/hosts/${e.ip}`;t&&(d=`/collections/${t.collection_id}${d}`);let T=(0,y.useMemo)(()=>{let c=new Map;for(let i of e.services)if(i.threats)for(let a of i.threats){let l=c.get(a.id);l?l[1].push(i):c.set(a.id,[a,[i]])}return Array.from(c.entries()).sort()},[e,n]);return(0,r.jsxs)("div",{className:u.threatsLayout,children:[T.length===0&&(0,r.jsx)(s,{children:"We haven't found any publicly accessible services with Threat(s) on this host or the host is on our blocklist."}),T.length>0&&T.map(([c,[i,a]])=>(0,r.jsx)(D,{description:n?.[i.id]?.description,threat:i,subHeader:a.length>0?(0,r.jsxs)(s,{variant:m.H5,children:[a.length," ",N("service",a.length)]}):null,children:(0,r.jsxs)("div",{children:[(0,r.jsxs)(s,{className:u.sectionHeader,variant:m.H4,children:["Services (",a.length,")"]}),(0,r.jsx)("ul",{className:u.serviceList,children:a.map(l=>(0,r.jsx)(H,{service:l,threat:i,baseRoute:d},`${l.ip}-${l.port}`))})]})},c))]})}function Ht(){let t=$(),e=C(A()),n=(0,y.useContext)(x);return(0,r.jsx)("div",{"data-testid":"host-threats-error",children:b(t)&&w(t.data)?(0,r.jsx)(_,{errorCode:t.data.code,orgState:e,env:n}):(0,r.jsx)(R,{error:t})})}export{Dt as a,G as b,Ht as c};
