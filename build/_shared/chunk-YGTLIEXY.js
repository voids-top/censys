import{a as De}from"/censys/build/_shared/chunk-5C77OQL6.js";import{a as Le,b as Me,c as $,d as Ae,e as Ee}from"/censys/build/_shared/chunk-JG6RDZZZ.js";import{b as g,d as xe}from"/censys/build/_shared/chunk-YP7RGGRG.js";import{a as Re}from"/censys/build/_shared/chunk-QA66J4VQ.js";import{a as Pe}from"/censys/build/_shared/chunk-FMRIG57S.js";import{d as _e}from"/censys/build/_shared/chunk-XZRXZMJK.js";import{a as Se}from"/censys/build/_shared/chunk-GC3JNZCU.js";import{a as ge}from"/censys/build/_shared/chunk-3W2VQNCA.js";import{a as Ne,d as S}from"/censys/build/_shared/chunk-53UREJP4.js";import{a as je}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as ke}from"/censys/build/_shared/chunk-IJLDI467.js";import{a as z}from"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as be}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{c as de,l as he,n as Ce,o as Te,p as ve}from"/censys/build/_shared/chunk-22JANVKU.js";import{a as oe}from"/censys/build/_shared/chunk-RAMDI2JB.js";import{a as ye}from"/censys/build/_shared/chunk-CJIEOTRC.js";import{e as me}from"/censys/build/_shared/chunk-HUE44QRB.js";import{a as ue}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{a as pe}from"/censys/build/_shared/chunk-437XWWKH.js";import{c as A}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{f as fe}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import{c as j}from"/censys/build/_shared/chunk-2RV3CGNA.js";import{d as ae,f as ne,k as se}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{e as U}from"/censys/build/_shared/chunk-D5QEORL2.js";import{u as E,v as x,x as ce,z as le}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{$ as D,A as R,B as b,Va as ie,aa as F,da as re,y as te}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as ee}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{d as Y}from"/censys/build/_shared/chunk-6URBRDCL.js";import{a as K,g as P,k as Z,m as q,p as J}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as V,c as y}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d}from"/censys/build/_shared/chunk-2QEWK57A.js";var k=d(V(),1);var T=d(V(),1);var B=d(V(),1);var He={switch:"ONlcc"};var H=d(y(),1);function O({leftText:e,rightText:r,checked:t,initialState:a=!0,onToggle:i,leftClassName:n,rightClassName:m,isDisabled:u}){let[p,_]=(0,B.useState)(t!==void 0?t:a),v=t!==void 0,s=v?t:p,f=(0,B.useCallback)(()=>{v||_(M=>!M),i&&i(!s)},[v,s,i]),N=s,C=!s;return(0,H.jsxs)("div",{className:He.switch,children:[(0,H.jsx)(F,{role:"checkbox",type:"button",variant:b.GHOST,size:D.SMALL,onClick:!N&&!u?f:()=>{},"aria-checked":N,"aria-label":e,className:n,disabled:u,children:e}),(0,H.jsx)(F,{role:"checkbox",type:"button",variant:b.GHOST,size:D.SMALL,onClick:!C&&!u?f:()=>{},"aria-checked":C,"aria-label":r,className:m,disabled:u,children:r})]})}var ze=Y.object({before:j,after:j});function we(e){return ze.safeParse(e).success}function Ie(e){let r=Number(e.after.epochMilliseconds-e.before.epochMilliseconds),t=Math.floor(r/1e3),a=Math.floor(t/(24*3600)),i=Math.floor(t%(24*3600)/3600).toString().padStart(0,"2"),n=Math.floor(t%3600/60).toString().padStart(2,"0"),m=(t%60).toString().padStart(2,"0");return`(${a} days, ${i}:${n}:${m})`}var L={detailSummary:"-WBYu",validityRow:"Ig2mb",detailTableContent:"_4SHUM",switchContainer:"tDKw6",copyButton:"xoM-E"};function Ue(e){let r=e.certificate?.parsed?.subject_dn||z,t=e.certificate?.parsed?.issuer_dn||z,a={before:e.certificate?.parsed?.validity_period?.not_before,after:e.certificate?.parsed?.validity_period?.not_after},i=e.certificate?.fingerprint_sha256,n=e.certificate?.fingerprint_sha1,m=e.certificate?.parsed?.serial_number,u=e.certificate?.parsed?.serial_number_hex?`0x${e.certificate.parsed.serial_number_hex}`:void 0,p=e.certificate?.names?e.certificate?.names.join(" "):void 0;return{subjectDN:r,issuerDN:t,serialNumberDecimal:m,serialNumberHex:u,validityPeriod:a,fingerprintSha256:i,fingerprintSha1:n,names:p}}var c=d(y(),1);function W({cert:e}){let[r,t]=(0,T.useState)(!0),[a,i]=(0,T.useState)(!0),{t:n}=A(),{subjectDN:m,issuerDN:u,validityPeriod:p,names:_,serialNumberValue:v,fingerprintValue:s}=(0,T.useMemo)(()=>{let{fingerprintSha256:C,fingerprintSha1:M,serialNumberDecimal:I,serialNumberHex:Ve,...Fe}=Ue(e);return{fingerprintValue:a?C:M,serialNumberValue:r?Ve:I,...Fe}},[r,a,e]),f=(0,T.useMemo)(()=>{if(we(p))return Ie(p)},[p]),N=(0,T.useCallback)(async()=>{typeof s=="string"&&await ye(s)},[s]);return(0,c.jsxs)("div",{className:L.detailSummary,children:[(0,c.jsx)($,{iconName:"file-list-2",children:n("Summary")}),(0,c.jsxs)(Ne,{children:[(0,c.jsx)(S,{label:n("Subject DN"),content:m}),(0,c.jsx)(S,{label:n("Issuer DN"),content:u}),(0,c.jsx)(S,{label:n("Serial Number"),content:(0,c.jsxs)("div",{className:L.switchContainer,children:[(0,c.jsx)(O,{leftText:"Hex",rightText:"Decimal",onToggle:t}),(0,c.jsx)(R,{children:v})]})}),(0,c.jsx)(S,{label:n("Validity Period"),content:(0,c.jsxs)("div",{className:L.validityRow,children:[(0,c.jsx)(Re,{...p}),f!==void 0&&(0,c.jsx)(R,{children:f})]})}),(0,c.jsx)(S,{label:n("Fingerprint"),content:s&&(0,c.jsxs)("div",{className:L.switchContainer,children:[(0,c.jsx)(O,{leftText:"SHA-256",rightText:"SHA-1",onToggle:i}),(0,c.jsx)(R,{title:s,children:s.slice(0,7)}),(0,c.jsx)(re,{onClick:N,className:L.copyButton,iconName:"file-copy-2",iconMode:"line","aria-label":"Copy Fingerprint to Clipboard",variant:b.DEFAULT})]})}),(0,c.jsx)(S,{label:n("All Names"),content:_})]})]})}var $e={detail:"NQjLT"};var w=d(y(),1);function X({cert:e}){let r=P(),t=r.collectionId?`/collections/${r.collectionId}/certificates/${r.id}`:`/certificates/${r.id}`;return(0,w.jsxs)("div",{className:$e.detail,children:[(0,w.jsx)($,{iconName:"shield-check",children:"Trust and Revocation"}),(0,w.jsx)(_e,{baseURL:t,browsers:["chrome","edge","firefox","safari"],cert:e})]})}var h={overviewHeaderContainer:"D0O1R",contentTop:"Wtsqk",popoverContainer:"zPBwT",contentTopItems:"Bd0Kk",textIcon:"X0ZmS",whiteText:"vZ0EJ",contentBottom:"xEoBy",tagsSection:"DZhKW",tagsIcon:"ElJtF",link:"dOjsp"};function Ge(e){let{certificate:r}=e,t=new Set;if(r?.parsed?.subject?.common_name?.forEach(i=>{i&&i.trim().length>0&&t.add(i.trim())}),r?.parsed?.extensions?.subject_alt_name?.dns_names?.forEach(i=>{i&&i.trim().length>0&&t.add(i)}),t.size===0)return!1;let a=Array.from(t).sort();return x({field:"cert.names",values:a,kind:4})}function Be(e){let r=[],{certificate:t}=e;if(t?.parsed){let a=Ge(e),i={sectionName:"Related Certificates",links:[]};t.spki_subject_fingerprint_sha256&&i.links.push({linkText:"With the same identity (key + subject)",linkIcon:"admin",linkTo:x({field:"cert.spki_subject_fingerprint_sha256",value:t.spki_subject_fingerprint_sha256,kind:0})}),t.parsed?.subject_key_info?.fingerprint_sha256&&i.links.push({linkText:"With the same public key",linkIcon:"key",linkTo:x({field:"cert.parsed.subject_key_info.fingerprint_sha256",value:t.parsed.subject_key_info.fingerprint_sha256,kind:0})}),t.parsed?.serial_number&&i.links.push({linkText:"With the same serial number",linkIcon:"barcode",linkTo:x({field:"cert.parsed.serial_number",value:t.parsed.serial_number,kind:0})}),a&&a.length<100&&i.links.push({linkText:"With the same names",linkIcon:"price-tag-2",linkTo:a}),i.links.length>0&&r.push(i)}return t?.tbs_no_ct_fingerprint_sha256&&r.push({sectionName:"Certificate Transparency",links:[{linkText:"Associated Pre-certificates",linkIcon:"megaphone",linkTo:`/censys?q=${encodeURIComponent(ce(E({field:"cert.tbs_no_ct_fingerprint_sha256",value:t.tbs_no_ct_fingerprint_sha256,kind:0}),E({field:"cert.precert",value:!0,kind:0}),"and",!1))}`}]}),t?.fingerprint_sha256&&r.push({sectionName:"What's Using This Certificate?",links:[{linkText:"Hosts",linkIcon:"computer",linkTo:x({field:"host.services.tls.fingerprint_sha256",value:t.fingerprint_sha256,kind:0})}]}),r}var l=d(y(),1),Ze={popover:h.popoverContainer};function Q({cert:e}){let r=U(),t=Be(e),a=P(),i=a.collectionId?`/collections/${a.collectionId}/results`:"/censys",n=e.certificate?.fingerprint_sha256;return(0,l.jsxs)("div",{className:h.overviewHeaderContainer,children:[(0,l.jsxs)("div",{className:h.contentTop,children:[(0,l.jsxs)("div",{className:h.contentTopItems,children:[e?.labels?.find(m=>m?.toLowerCase()==="precert")&&(0,l.jsx)(ie,{content:(0,l.jsxs)(R,{className:h.whiteText,children:["Associated ",(0,l.jsx)("br",{}),"Pre-certificate"]}),children:(0,l.jsx)(te,{size:"md",name:"megaphone",mode:"line",className:h.textIcon,"data-testid":"associated-pre-cert-icon","aria-hidden":!0})}),(0,l.jsx)(Ee,{children:e.displayName}),(0,l.jsx)(ue,{variant:"dot"}),(0,l.jsx)(Ae,{assetType:"certificate"})]}),(0,l.jsxs)("div",{className:h.contentTopItems,children:[n&&(0,l.jsx)(me,{assetId:n,assetType:"cert",investigationName:`${e.displayName} Certificate Investigation`}),!!r&&(0,l.jsx)(pe,{link:{to:`/certificates/${e?.certificate?.fingerprint_sha256}/pem/raw`,download:!0,reloadDocument:!0},button:{variant:b.DEFAULT,size:D.MEDIUM},children:"Download PEM"}),(0,l.jsx)(De,{pivots:t,customClassNames:Ze})]})]}),(0,l.jsxs)("div",{className:h.contentBottom,children:[e?.labels&&e.labels.length>0&&(0,l.jsx)("div",{className:h.tagsSection,children:(0,l.jsx)(Pe,{baseURL:i,labels:e.labels,resourceType:"certificate"})}),e?.certificate?.modified_at&&(0,l.jsx)(ke,{timestamp:e?.certificate?.modified_at?.toString()})]})]})}var G={errorWrapper:"Tsnma",summaryLayout:"R-XDs"};var Je=d(je(),1),o=d(y(),1),Lr=({data:e})=>{let r=null;return e&&(r=e?.cert.certificate?.parsed?.subject_dn||e.cert.displayName),[{title:r?`${r} - Cert Summary`:"Censys"}]};function Oe({children:e,id:r,slots:t={},collectionId:a,collectionName:i}){let{t:n}=A(),m=fe({collectionsLabel:n("Collections"),collectionName:i,fallback:[{pathName:n("Search")}]}),u=E({kind:0,field:"cert.fingerprint_sha256",value:r});return(0,o.jsx)(Te,{initialQuery:u,breadcrumbs:m,slots:{searchHeader:i?(0,o.jsx)(he,{breadcrumbs:m,placeholder:n("Search within",{name:i}),collectionId:a,children:(0,o.jsx)(ve,{})}):(0,o.jsx)(Ce,{breadcrumbs:m}),header:t.pageHeader,navTabs:t.pageNavTabs},children:e})}function qe(){let[e,r]=J(),{capabilities:t,cert:a,id:i,collection:n,hasCertificateHistoryAccess:m,csrf:u}=ge(),{t:p}=A(),_=le(),[v]=ne([13]),s=`/certificates/${i}`,f="/certificates/:id";n&&(s=`/collections/${n.collection_id}${s}`,f=`/collections/:collectionId${f}`);let N=(0,k.useMemo)(()=>({cert:a}),[a]),C=(0,k.useMemo)(()=>e.get("isCollapsed")===void 0||e.get("isCollapsed")==="true",[e]),M=(0,k.useCallback)(()=>{let I=new URLSearchParams(e);I.set("isCollapsed",(!C).toString()),r(I,{state:_})},[e,C,_]);return(0,o.jsx)(oe,{token:u,children:(0,o.jsx)(ae,{value:t,children:(0,o.jsx)(Oe,{id:i,slots:{pageHeader:(0,o.jsx)(Le,{assetType:"certificate",header:(0,o.jsx)(Q,{cert:a}),isCollapsed:C,toggle:M,children:(0,o.jsxs)("div",{className:G.summaryLayout,children:[(0,o.jsx)(W,{cert:a}),(0,o.jsx)(X,{cert:a})]})}),pageNavTabs:(0,o.jsxs)(xe,{children:[(0,o.jsx)(g,{id:"certificate",to:s,children:p("Certificate")}),(0,o.jsx)(g,{id:"trust",to:`${s}/trust/${"chrome"}`,routePattern:`${f}/trust/:browser`,prefetch:"intent",children:p("Trust")}),(0,o.jsx)(g,{id:"zlint",to:`${s}/zlint`,prefetch:"intent",children:p("ZLint")}),(0,o.jsx)(g,{id:"transparency",to:`${s}/transparency`,prefetch:"intent",children:p("Certificate Transparency")}),m&&(0,o.jsx)(g,{id:"history",to:`${s}/history`,routePattern:`${f}/history/*`,prefetch:"none",children:p("Timeline")}),(0,o.jsx)(Me,{canViewCenseye:v,targetRoute:s,routePattern:f}),(0,o.jsx)(g,{id:"rawData",to:`${s}/data/table`,routePattern:`${f}/data/*`,prefetch:"none",children:p("Raw Data")})]})},collectionId:n?.collection_id,collectionName:n?.name,children:(0,o.jsx)(de,{children:(0,o.jsx)(q,{context:N})})})})})}function Mr(){let e=Z(),r=P(),t=U(),a=(0,k.useContext)(ee);return(0,o.jsx)(Oe,{id:r.id||"",children:(0,o.jsx)("div",{className:G.errorWrapper,children:K(e)&&se(e.data)?(0,o.jsx)(Se,{accessState:t,errorCode:e.data.code,env:a}):(0,o.jsx)(be,{error:e})})})}export{Lr as a,qe as b,Mr as c};
