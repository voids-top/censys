import{a as st,b as lt,c as pt,d as ct,e as mt,f as dt}from"/censys/build/_shared/chunk-AMGYEDYD.js";import{a as nt}from"/censys/build/_shared/chunk-PLG22QRR.js";import{a as ae,c as it}from"/censys/build/_shared/chunk-J5TBCVJG.js";import{a as Q}from"/censys/build/_shared/chunk-A5VOBBX2.js";import{a as C}from"/censys/build/_shared/chunk-SCNM5ZBT.js";import{a as oe,c as Ze}from"/censys/build/_shared/chunk-PTKV34J3.js";import{a as rt,b as ot}from"/censys/build/_shared/chunk-SRUDFCT7.js";import{a as et}from"/censys/build/_shared/chunk-GKOF6QGC.js";import{a as tt}from"/censys/build/_shared/chunk-5HUKVACE.js";import{b as at}from"/censys/build/_shared/chunk-GFDCBQTR.js";import{b as R}from"/censys/build/_shared/chunk-CUDHDFMO.js";import{a as We}from"/censys/build/_shared/chunk-62I4RDM3.js";import{a as Ke}from"/censys/build/_shared/chunk-ZN6GT6EF.js";import{a as Qe}from"/censys/build/_shared/chunk-3IID2F3B.js";import{c as qe,d as Je}from"/censys/build/_shared/chunk-ZDOHYF7S.js";import{d as Be,e as ze}from"/censys/build/_shared/chunk-TUFJ6JAI.js";import{a as je}from"/censys/build/_shared/chunk-MB2LZLPU.js";import{b as Ye}from"/censys/build/_shared/chunk-GMNB7RSU.js";import{a as N,d as i}from"/censys/build/_shared/chunk-AIDQO3P6.js";import{f as Ue}from"/censys/build/_shared/chunk-S2IH2R6L.js";import{a as Fe}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{a as we}from"/censys/build/_shared/chunk-WMKH6XX3.js";import{b as Ge}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{a as Y}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as re}from"/censys/build/_shared/chunk-HG7D3PDC.js";import{a as $e}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as Ve}from"/censys/build/_shared/chunk-2G5R6E4Q.js";import{a as Xe}from"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as n}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{f as U}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{e as Ie}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as Oe}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{w as s}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{A as g,B as c,Qa as ke,Ta as te,_ as j,sa as be,ua as xe,va as Me,y as F,z as D}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as Le,g as De,k as Re,p as He}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as k,c as S}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as l}from"/censys/build/_shared/chunk-2QEWK57A.js";var W=l(k(),1);var ee=l(k(),1);var ft=l(k(),1);var w={contentList:"Ncgc6",textWithLink:"LId9f",whiteText:"Hzua3",softwareTableWrapper:"RXsB-",externalSoftwareLink:"Imk3h"};var E=l(S(),1),vr=e=>e.replaceAll(":*","");function ne({software:e}){let[t]=U([0]),r=(0,ft.useMemo)(()=>{if(!e)return null;let a=e.filter(_=>!!_.cpe&&_.product);return rt(a,!0)},[e]);return r&&r.length>0?(0,E.jsx)("div",{className:w.softwareTableWrapper,children:(0,E.jsx)(N,{children:(0,E.jsx)(tt,{label:(0,E.jsx)(c,{variant:g.H4,children:"Software"}),items:r,listComponent:a=>(0,E.jsxs)(c,{className:w.textWithLink,children:[(0,E.jsx)(te,{content:(0,E.jsxs)(c,{className:w.whiteText,children:["Search Censys for hosts ",(0,E.jsx)("br",{})," with this software"," ",t?"CPE":"version"]}),children:(0,E.jsx)(n,{href:ot(a,"host.services.software",t),variant:"ghost",children:a.label})}),(0,E.jsx)(te,{content:(0,E.jsxs)(c,{className:w.whiteText,children:["Search CPE catalog ",(0,E.jsx)("br",{})," for this software"]}),children:(0,E.jsx)(n,{href:`https://nvd.nist.gov/products/cpe/search/results?namingFormat=2.3&keyword=${vr(a.cpe)}`,isExternal:!0,"aria-label":"Search CPE catalog for this software",className:w.externalSoftwareLink,children:(0,E.jsx)(D,{size:"md",name:"external-link","aria-hidden":!0})})})]})})})}):null}var _t=l(k(),1);var ie={container:"iBEIg",label:"Lpzhk"};var I=l(S(),1),gr=20;function se({cveRoute:e,vulns:t}){let r=(0,_t.useMemo)(()=>[...t].sort(Je),[t]);return(0,I.jsxs)("div",{className:ie.container,children:[(0,I.jsxs)(c,{className:ie.label,variant:g.H4,children:["CVEs (",(0,I.jsx)(j,{value:t.length}),")"]}),(0,I.jsx)(Qe,{tagSize:"md",tags:r.map(a=>({href:`${e}#${a.id}`,label:(0,I.jsx)(qe,{cve:a})})),maxVisibleRows:gr})]})}var Z=l(k(),1);var Er=e=>new Uint8Array(e.match(/.{1,2}/g)?.map(t=>parseInt(t,16))||[]),ht=(e,t=16,r=".")=>{if(!e||e.length===0)return"";typeof e=="string"&&(e=Er(e.replace(/[\s\n]/g,""))),t=Math.min(e.length,t);let a=[];for(let _=0;_<e.length;_+=t){let T=e.slice(_,_+t),L=_.toString(16).padStart(8,"0").toUpperCase(),O=Array.from(T,M=>M.toString(16).toUpperCase().padStart(2,"0")),p=t*2+t-1,y=O.join(" ").padEnd(p," "),x=Array.from(T,M=>M>=32&&M<127?String.fromCharCode(M):r).join("").padEnd(t," ");a.push(`${L}: ${y} | ${x} |`)}return a.join(`
`)};function Tt(e){return Array.from(e).map(t=>t.charCodeAt(0).toString(16).padStart(2,"0")).join("")}var St=e=>{if(!e)return"";e.length%2===1&&(e="0"+e);let t=" ";return e.match(/../g)?.join(t)||""};var $=l(S(),1);function le({ignoreFields:e,record:t,RecordComponent:r}){return t?(0,$.jsx)($.Fragment,{children:Object.keys(t).map(a=>{if(e?.includes(a))return null;let _=je(a),T=t[a];return!T||typeof T!="string"&&typeof T!="number"&&typeof T!="boolean"?null:(0,$.jsx)(r,{name:_,value:T},a)})}):null}var pe="Details",ut="Banner",vt="Banner (Hex)",gt="Response",Et="OID System",Nt="Object ID",Ct="Description",Pt="Contact",At="Uptime",yt="Name",Lt="Location";var J={banner:"VcWVm"};var d=l(S(),1);function Nr(e){let t=e?.snmp?.oid_system;return!t||!Object.values(t).some(a=>a!==void 0)?null:(0,d.jsx)(C,{label:Et,children:(0,d.jsxs)(N,{children:[t.object_id&&(0,d.jsx)(i,{label:Nt,content:t.object_id}),t?.desc&&(0,d.jsx)(i,{label:Ct,content:t.desc}),t?.init_time&&(0,d.jsx)(i,{label:At,content:`${t.init_time}`}),t?.contact&&(0,d.jsx)(i,{label:Pt,content:t.contact}),t?.name&&(0,d.jsx)(i,{label:yt,content:t.name}),t?.location&&(0,d.jsx)(i,{label:Lt,content:t.location})]})})}function ce({scan:e,protocolScan:t}){if(!e?.banner&&!t)return null;let r=(0,Z.useMemo)(()=>St(t?.response),[t?.response]),a=(0,Z.useMemo)(()=>{if(r)return;let T=(e?.banner||t?.banner)?.replaceAll(/[\n\r]/g,"");return!!T&&/^[\x20-\x7F]*$/.test(T)?T:""},[e?.banner]),_=(0,Z.useMemo)(()=>{if(!r)return!a&&e?.banner?ht(Tt(e.banner)):""},[a,e?.banner,r]);return r?(0,d.jsx)(C,{label:pe,children:(0,d.jsx)(N,{children:(0,d.jsx)(i,{label:gt,content:(0,d.jsx)("div",{className:J.banner,children:(0,d.jsx)(oe,{text:r})})})})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(C,{label:pe,children:(0,d.jsxs)(N,{children:[a&&(0,d.jsx)(i,{label:ut,content:(0,d.jsx)("div",{className:J.banner,children:(0,d.jsx)(oe,{text:a})})}),_&&(0,d.jsx)(i,{label:vt,content:(0,d.jsx)("div",{className:J.banner,children:(0,d.jsx)(Ze,{text:_})})}),e?.snmp?.oid_interfaces?.num_ifaces&&(0,d.jsx)(i,{label:"Interface Count",content:e?.snmp.oid_interfaces?.num_ifaces?.toString()}),(0,d.jsx)(le,{record:t,ignoreFields:["banner","transport","response"],RecordComponent:({name:T,value:L})=>(0,d.jsx)(i,{label:T,content:Xe(L.toString())})})]})}),Nr(e)]})}function me(e){return e.filter(t=>Y(t)).map(t=>({...t,slug:Be(t)}))}function Dt(e){return/^[\x20-\x7F]*$/.test(e)}var Rt="Time Header",Ht="Leap Indicator",Ot="Version",bt="Mode",xt="Stratum",Mt="Poll",kt="Precision",It="Reference ID";var v=l(S(),1);function Gt({ntp:e}){if(!e)return null;let{get_time_header:t}=e;return t?(0,v.jsx)("div",{children:(0,v.jsx)(C,{label:Rt,children:(0,v.jsxs)(N,{children:[t.leap_indicator!==void 0&&(0,v.jsx)(i,{label:Ht,content:(0,v.jsx)(n,{href:s({kind:0,field:"host.services.ntp.get_time_header.leap_indicator",value:t.leap_indicator.toString()}),variant:"ghost",children:t.leap_indicator})}),t.version!==void 0&&(0,v.jsx)(i,{label:Ot,content:(0,v.jsx)(n,{href:s({kind:0,field:"host.services.ntp.get_time_header.version",value:t.version.toString()}),variant:"ghost",children:t.version})}),t.mode!==void 0&&(0,v.jsx)(i,{label:bt,content:(0,v.jsx)(n,{href:s({kind:0,field:"host.services.ntp.get_time_header.mode",value:t.mode.toString()}),variant:"ghost",children:t.mode})}),t.stratum!==void 0&&(0,v.jsx)(i,{label:xt,content:(0,v.jsx)(n,{href:s({kind:0,field:"host.services.ntp.get_time_header.stratum",value:t.stratum.toString()}),variant:"ghost",children:t.stratum})}),t.poll!==void 0&&(0,v.jsx)(i,{label:Mt,content:(0,v.jsx)(n,{href:s({kind:0,field:"host.services.ntp.get_time_header.poll",value:t.poll.toString()}),variant:"ghost",children:t.poll})}),t.precision!==void 0&&(0,v.jsx)(i,{label:kt,content:(0,v.jsx)(n,{href:s({kind:0,field:"host.services.ntp.get_time_header.precision",value:t.precision.toString()}),variant:"ghost",children:t.precision})}),t.reference_id!==void 0&&Dt(t.reference_id)&&(0,v.jsx)(i,{label:It,content:(0,v.jsx)(n,{href:s({kind:0,field:"host.services.ntp.get_time_header.reference_id",value:t.reference_id}),variant:"ghost",children:t.reference_id})})]})})}):null}var fe="Version",wt="Network ID",Vt="Universal Address",_e="Shorthand",Xt="Protocol",Ft="Port",Ut="V2 Entries",$t="V3 Entries";var u={tableContainer:"_9pdgy",detailTable:"lJquT"};var o=l(S(),1);function he({portmap:e,transportProtocol:t}){if(!e)return null;let r=e.v2_entries??[],a=e.v3_entries??[],_=t!==void 0?(R.TransportProtocol[t]||"").toLowerCase():void 0,T=a.filter(p=>{let y=(p.network_id||"").toLowerCase(),b=y.includes("tcp"),x=y.includes("udp");return!_||!b&&!x?!0:_==="tcp"?b:_==="udp"?x:!0}),L=r.length>0,O=T.length>0;return!L&&!O?null:(0,o.jsx)("div",{children:(0,o.jsxs)(C,{label:"Portmap",children:[L&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c,{variant:g.H5,children:Ut}),(0,o.jsx)("div",{className:u.tableContainer,children:(0,o.jsxs)("table",{className:F(u.detailTable),children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:fe})}),(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:Xt})}),(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:Ft})}),(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:_e})})]})}),(0,o.jsx)("tbody",{children:r.map((p,y)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:u.cell,children:p.version!==void 0&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v2_entries.version",value:p.version.toString()}),variant:"ghost",children:p.version})}),(0,o.jsx)("td",{className:u.cell,children:p.protocol&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v2_entries.protocol",value:p.protocol}),variant:"ghost",children:p.protocol})}),(0,o.jsx)("td",{className:u.cell,children:p.port!==void 0&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v2_entries.port",value:p.port.toString()}),variant:"ghost",children:p.port})}),(0,o.jsx)("td",{className:u.cell,children:p.shorthand&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v2_entries.shorthand",value:p.shorthand}),variant:"ghost",children:p.shorthand})})]},`v2-row-${y}`))})]})})]}),O&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c,{variant:g.H5,children:$t}),(0,o.jsx)("div",{className:u.tableContainer,children:(0,o.jsxs)("table",{className:F(u.detailTable),children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:fe})}),(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:wt})}),(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:Vt})}),(0,o.jsx)("th",{className:u.headerCell,children:(0,o.jsx)(c,{variant:g.SMALL,children:_e})})]})}),(0,o.jsx)("tbody",{children:T.map((p,y)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:u.cell,children:p.version!==void 0&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v3_entries.version",value:p.version.toString()}),variant:"ghost",children:p.version})}),(0,o.jsx)("td",{className:u.cell,children:p.network_id&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v3_entries.network_id",value:p.network_id}),variant:"ghost",children:p.network_id})}),(0,o.jsx)("td",{className:u.cell,children:p.universal_address&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v3_entries.universal_address",value:p.universal_address}),variant:"ghost",children:p.universal_address})}),(0,o.jsx)("td",{className:u.cell,children:p.shorthand&&(0,o.jsx)(n,{href:s({kind:0,field:"host.services.portmap.v3_entries.shorthand",value:p.shorthand}),variant:"ghost",children:p.shorthand})})]},`v3-row-${y}`))})]})})]})]})})}var Te={highlightArea:"lLEzx",scanIcon:"_49a0a"};var Kt=(e,t)=>`This host has multiple services detected on various ${t} ports. Displayed as '${e} [many] /${t}' to indicate a combination of identified and sampled services.`;var K=l(S(),1);function Se({protocol:e,transportProtocol:t}){return(0,K.jsx)(dt,{color:"systemBlueBg",className:Te.highlightArea,children:(0,K.jsxs)(c,{children:[(0,K.jsx)(D,{name:"information",mode:"line",className:Te.scanIcon}),Kt(e,t)]})})}var Bt="SNMP",zt="Versions",Wt="Engine",jt="Raw ID",Yt="RFC3411",Qt="PEN",qt="Organization",Jt="Format",Zt="Format Data",er="Engine Boots",tr="Engine Time",rr="Description";var h=l(S(),1);function or({snmp:e}){if(!e)return null;let{versions:t,engine:r}=e;return(0,h.jsxs)("div",{children:[t&&(0,h.jsx)(C,{label:Bt,children:(0,h.jsx)(N,{children:(0,h.jsx)(i,{label:zt,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.versions",value:Array.isArray(t)?t.join(", "):t}),variant:"ghost",children:Array.isArray(t)?t.join(", "):t})})})}),r&&(0,h.jsx)(C,{label:Wt,children:(0,h.jsxs)(N,{children:[r.raw_id&&(0,h.jsx)(i,{label:jt,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.raw_id",value:r.raw_id}),variant:"ghost",children:r.raw_id})}),r.rfc3411!==void 0&&(0,h.jsx)(i,{label:Yt,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.rfc3411",value:r.rfc3411.toString()}),variant:"ghost",children:r.rfc3411?"Yes":"No"})}),r.pen!==void 0&&(0,h.jsx)(i,{label:Qt,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.pen",value:r.pen.toString()}),variant:"ghost",children:r.pen})}),r.organization!==void 0&&(0,h.jsx)(i,{label:qt,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.organization",value:r.organization}),variant:"ghost",children:r.organization})}),r.format!==void 0&&(0,h.jsx)(i,{label:Jt,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.format",value:r.format}),variant:"ghost",children:r.format})}),r.format_data!==void 0&&(0,h.jsx)(i,{label:Zt,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.format_data",value:r.format_data}),variant:"ghost",children:r.format_data})}),r.engine_boots!==void 0&&(0,h.jsx)(i,{label:er,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.engine_boots",value:r.engine_boots.toString()}),variant:"ghost",children:r.engine_boots})}),r.engine_time!==void 0&&(0,h.jsx)(i,{label:tr,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.engine_time",value:r.engine_time.toString()}),variant:"ghost",children:r.engine_time})}),r.description!==void 0&&(0,h.jsx)(i,{label:rr,content:(0,h.jsx)(n,{href:s({kind:0,field:"host.services.snmp.engine.description",value:r.description}),variant:"ghost",children:r.description})})]})})]})}var ar="Host Key",nr="Algorithm",ir="Fingerprint",sr="Negotiated",lr="Key Exchange",pr="Symmetric Cipher",cr="MAC";var B={sshIcon:"Q8CV3"};var f=l(S(),1);function ue({ssh:e}){if(!e)return null;let{algorithm_selection:t,server_host_key:r}=e;return(0,f.jsxs)("div",{children:[(0,f.jsx)(C,{label:ar,children:(0,f.jsxs)(N,{children:[(0,f.jsx)(i,{label:nr,content:t?.host_key_algorithm&&(0,f.jsx)(n,{href:s({kind:0,field:"host.services.ssh.algorithm_selection.host_key_algorithm",value:t.host_key_algorithm}),variant:"ghost",children:t.host_key_algorithm})}),(0,f.jsx)(i,{label:ir,content:r?.fingerprint_sha256&&(0,f.jsx)(n,{href:s({kind:0,field:"host.services.ssh.server_host_key.fingerprint_sha256",value:r?.fingerprint_sha256}),variant:"ghost",children:r?.fingerprint_sha256})})]})}),(0,f.jsx)(C,{label:sr,children:(0,f.jsxs)(N,{children:[(0,f.jsx)(i,{label:lr,content:t?.kex_algorithm&&(0,f.jsx)(n,{href:s({kind:0,field:"host.services.ssh.algorithm_selection.kex_algorithm",value:t.kex_algorithm}),variant:"ghost",children:t.kex_algorithm})}),(0,f.jsx)(i,{label:pr,content:(0,f.jsxs)("div",{children:[t?.client_to_server_alg_group?.cipher&&(0,f.jsxs)(c,{children:[(0,f.jsx)(n,{href:s({kind:0,field:"host.services.ssh.algorithm_selection.client_to_server_alg_group.cipher",value:t.client_to_server_alg_group.cipher}),variant:"ghost",children:t.client_to_server_alg_group.cipher}),(0,f.jsx)(D,{className:B.sshIcon,name:"upload-2",mode:"line","aria-hidden":!0})]}),t?.server_to_client_alg_group?.cipher&&(0,f.jsxs)(c,{children:[(0,f.jsx)(n,{href:s({kind:0,field:"host.services.ssh.algorithm_selection.server_to_client_alg_group.cipher",value:t.server_to_client_alg_group.cipher}),variant:"ghost",children:t.server_to_client_alg_group.cipher}),(0,f.jsx)(D,{className:B.sshIcon,name:"download-2",mode:"line","aria-hidden":!0})]})]})}),(0,f.jsx)(i,{label:cr,content:(0,f.jsxs)("div",{children:[t?.client_to_server_alg_group?.mac&&(0,f.jsxs)(c,{children:[(0,f.jsx)(n,{href:s({kind:0,field:"host.services.ssh.algorithm_selection.client_to_server_alg_group.mac",value:t.client_to_server_alg_group.mac}),variant:"ghost",children:t.client_to_server_alg_group.mac}),(0,f.jsx)(D,{className:B.sshIcon,name:"upload-2","aria-hidden":!0})]}),t?.server_to_client_alg_group?.mac&&(0,f.jsxs)(c,{children:[(0,f.jsx)(n,{href:s({kind:0,field:"host.services.ssh.algorithm_selection.server_to_client_alg_group.mac",value:t.server_to_client_alg_group.mac}),variant:"ghost",children:t.server_to_client_alg_group.mac}),(0,f.jsx)(D,{className:B.sshIcon,name:"download-2","aria-hidden":!0})]})]})})]})})]})}var mr=l(k(),1);var ve={container:"G3Kd7",label:"_8PPNb"};var V=l(S(),1);function ge({threats:e,threatRoute:t}){if(!e.length)return null;let r=(0,mr.useMemo)(()=>Array.from(new Set(e.map(_=>_.name).filter(Y))).sort(),[e]);if(!r.length)return null;let a=$e("threat",e.length);return(0,V.jsxs)("div",{className:ve.container,children:[(0,V.jsxs)(c,{className:ve.label,variant:g.H4,children:[a," (",(0,V.jsx)(j,{value:e.length}),")"]}),(0,V.jsx)(Ye,{threats:r,baseURL:t,size:ke.MEDIUM})]})}var X={titleContainer:"Oe9iL",detailCardContent:"eTNTe",leftColumn:"v5V9L",rightColumn:"jihi3",divider:"_66idV"};function dr(e){let t=new Map;return e.screenshots?.forEach(r=>{r.handle&&e.protocol&&t.set(r.handle,{src:ae(r.handle,e.protocol)})}),e.endpoints?.forEach(r=>{r.screenshots?.forEach(a=>{a.handle&&r.endpoint_type&&t.set(a.handle,{src:ae(a.handle,r.endpoint_type)})})}),Array.from(t.values())}var m=l(S(),1);function Ee({service:e,rawData:t}){let r=De(),[a]=He(),_=a.toString(),[T,L,O]=U([9,5,15]),[p]=U([11]),y="/censys",b=`/hosts/${r.id}/cves${_?`?${_}`:""}`,x=`/hosts/${r.id}/threats${_?`?${_}`:""}`;r.collectionId&&(b=`/collections/${r.collectionId}/${b}`,y=`/collections/${r.collectionId}/results`,x=`/collections/${r.collectionId}/results`);let M=e.port===0,_r=(0,ee.useMemo)(()=>!e?.ssh&&!e?.ntp&&!e?.snmp&&!e?.portmap&&!e.endpoints?.some(A=>A.http),[e.ssh,e.ntp,e.snmp,e.portmap,e.endpoints]),hr=e?.[e.protocol.toLowerCase()],Pe=(0,ee.useMemo)(()=>O?dr(e):[],[e.screenshots,e.endpoints,e.protocol,O]),Tr=(0,ee.useMemo)(()=>{if(!e.endpoints)return{openDirectoryDataList:[],ollama:null};let A=e.endpoints.map(G=>G.open_directory).filter(G=>!!G?.files&&G.files.length>0),Sr=e.endpoints.find(G=>G.ollama)?.ollama||null;return{openDirectoryDataList:A,ollama:Sr}},[e.endpoints]),{openDirectoryDataList:Ae,ollama:ye}=Tr;return(0,m.jsx)(st,{id:e.slug,title:(0,m.jsxs)("div",{className:X.titleContainer,"data-testid":"detail-header-container",children:[(0,m.jsx)(Q,{name:e.protocol,port:e.port,transportProtocol:R.TransportProtocol[e.transport_protocol]}),e.labels.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(re,{variant:"dot"}),(0,m.jsx)(et,{baseURL:y,labels:e.labels.map(A=>A.value),resourceType:"host"})]})]}),timestamp:e?.scan_time,jsonData:t.json,rawData:t.table,slots:{bottomLeft:T&&e.ip&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(re,{variant:"dot",className:X.divider}),(0,m.jsx)(Ue,{rescanResourceType:"KNOWN_HOST",entityId:e.ip,port:e.port.toString(),protocol:e.protocol,transportProtocol:R.TransportProtocol[e.transport_protocol],scanTime:e.scan_time})]})},children:(0,m.jsxs)("div",{className:X.detailCardContent,children:[(0,m.jsxs)("div",{className:X.leftColumn,children:[M&&(0,m.jsx)(Se,{protocol:e.protocol,transportProtocol:R.TransportProtocol[e.transport_protocol]}),(0,m.jsx)(ne,{software:e.software}),_r&&(0,m.jsx)(ce,{scan:e,protocolScan:hr}),(0,m.jsx)(ue,{ssh:e.ssh}),(0,m.jsx)(Gt,{ntp:e.ntp}),(0,m.jsx)(or,{snmp:e.snmp}),(0,m.jsx)(he,{portmap:e.portmap,transportProtocol:e.transport_protocol}),e.endpoints?.filter(A=>A.http).map(A=>(0,m.jsx)(pt,{http:A.http,path:A.path},`${A.port}-${A.path}`)),Ae.length>0&&(0,m.jsx)(mt,{openDirectoryDataList:Ae}),ye&&(0,m.jsx)(lt,{ollama:ye}),(0,m.jsx)(ct,{certificate:e.cert,ja4t:e.ja4tscan,jarm:e.jarm,tls:e.tls,resourceType:"host"}),L&&e.vulns.length>0&&(0,m.jsx)(se,{cveRoute:b,vulns:e.vulns}),p&&(0,m.jsx)(ge,{threats:e.threats,threatRoute:x})]}),(0,m.jsx)("div",{className:X.rightColumn,children:!!Pe?.length&&(0,m.jsx)(it,{assetName:`${e.protocol} on ${e.ip}:${e.port}`,screenshots:Pe})})]})})}var fr=l(k(),1);var z={card:"QEfbE",cardHeader:"d6N1x",titleContainer:"DSz4x",headerText:"_96QOu"};var H=l(S(),1),Cr=(0,fr.forwardRef)(({children:e,className:t,...r},a)=>(0,H.jsxs)(c,{ref:a,...r,className:F(t,z.headerText),children:[(0,H.jsx)(Ve,{action:"view"}),e]}));function Ne({service:e}){let{slug:t}=e;return(0,H.jsx)(Me,{className:z.card,bodyPadding:xe.NONE,variant:be.DEFAULT,id:t,tabIndex:-1,header:(0,H.jsx)(Ke,{className:z.cardHeader,lastUpdatedAt:e?.scan_time,labelText:"Last observed",children:(0,H.jsx)("div",{className:z.titleContainer,"data-testid":"locked-header-container",children:(0,H.jsx)(Q,{name:e.protocol,port:e.port,slots:{TypographyComponent:Cr},transportProtocol:R.TransportProtocol[e.transport_protocol]})})})})}var Ce={content:"r7H-G",lockedSectionHeader:"urjKZ",lockHeaderText:"PZxdl",lockDivider:"wjJme"};var P=l(S(),1),Pr="We haven't found any publicly accessible services on this host or the host is on our blocklist.";function Ar(){let{host:e,servicesRawData:t,lockedServices:r}=nt();we();let a=(0,W.useMemo)(()=>me(e.services),[e]),_=(0,W.useMemo)(()=>me(r),[r]);return(0,P.jsxs)("div",{className:Ce.content,children:[a.length>0?a.map(T=>(0,P.jsx)(Ee,{service:T,rawData:t[T.slug]},T.slug)):(0,P.jsx)(c,{children:Pr}),_.length>0&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(at,{}),_.map(T=>(0,P.jsx)(Ne,{service:T},T.slug))]})]})}function Rn(){let e=Re(),t=Ie(),r=Ge(t),a=(0,W.useContext)(Oe);return(0,P.jsx)("div",{className:Ce.content,children:Le(e)&&ze(e.data)?(0,P.jsx)(We,{errorCode:e.data.code,orgState:r,env:a}):(0,P.jsx)(Fe,{error:e})})}export{Ar as a,Rn as b};
