import{a as we}from"/censys/build/_shared/chunk-7OUAFXOD.js";import{a as Ie,b as De,c as $,d as He,e as Ue,f as $e}from"/censys/build/_shared/chunk-NVOUF2X3.js";import{a as Le}from"/censys/build/_shared/chunk-LEUHO63S.js";import{a as Ee}from"/censys/build/_shared/chunk-NAHO4RKJ.js";import{a as Me,d as b}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{d as Ne}from"/censys/build/_shared/chunk-JBWYREVY.js";import{a as Pe}from"/censys/build/_shared/chunk-JMHN7ZWW.js";import{a as Re}from"/censys/build/_shared/chunk-YTHNDA7O.js";import{b as g,d as xe}from"/censys/build/_shared/chunk-DT7XMIXP.js";import{a as Ae}from"/censys/build/_shared/chunk-OFRBI5JW.js";import{a as W}from"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as qe}from"/censys/build/_shared/chunk-IC5AY47K.js";import{c as pe,l as Te,p as ve,q as ge,r as be,s as _e}from"/censys/build/_shared/chunk-B5UNN2SO.js";import{a as re}from"/censys/build/_shared/chunk-EMHGEENV.js";import{a as Ce}from"/censys/build/_shared/chunk-CJIEOTRC.js";import{g as he}from"/censys/build/_shared/chunk-IRHQADG7.js";import{a as ke}from"/censys/build/_shared/chunk-BWODHJE6.js";import{j as Se}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{a as de}from"/censys/build/_shared/chunk-XTODG4BZ.js";import{i as z}from"/censys/build/_shared/chunk-6EMU7K4F.js";import{a as ye}from"/censys/build/_shared/chunk-M5RKE22T.js";import{d as ce,f as me,k as le}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{e as N,f as ne,h as se}from"/censys/build/_shared/chunk-ST66DGSY.js";import{B as ue,D as fe,a as ee,x as D,z as x}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{$ as F,A,B as v,Xa as ae,_ as I,ca as ie,y as oe}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as L}from"/censys/build/_shared/chunk-F5K75D4K.js";import{c as te}from"/censys/build/_shared/chunk-44DVAK2X.js";import{a as Y,g as R,k as Z,m as q,p as J}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as y}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as B}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as l}from"/censys/build/_shared/chunk-2TWE7TSA.js";var _=l(B(),1);var T=l(B(),1);var O=l(B(),1);var Oe={switch:"ONlcc"};var H=l(y(),1);function V({leftText:e,rightText:r,checked:t,initialState:i=!0,onToggle:o,leftClassName:n,rightClassName:p,isDisabled:u}){let[d,k]=(0,O.useState)(t!==void 0?t:i),S=t!==void 0,s=S?t:d,f=(0,O.useCallback)(()=>{S||k(E=>!E),o&&o(!s)},[S,s,o]),P=s,C=!s;return(0,H.jsxs)("div",{className:Oe.switch,children:[(0,H.jsx)(F,{role:"checkbox",type:"button",variant:v.GHOST,size:I.SMALL,onClick:!P&&!u?f:()=>{},"aria-checked":P,"aria-label":e,className:n,disabled:u,children:e}),(0,H.jsx)(F,{role:"checkbox",type:"button",variant:v.GHOST,size:I.SMALL,onClick:!C&&!u?f:()=>{},"aria-checked":C,"aria-label":r,className:p,disabled:u,children:r})]})}var Je=ee.object({before:z,after:z});function Ve(e){return Je.safeParse(e).success}function Be(e){let r=Number(e.after.epochMilliseconds-e.before.epochMilliseconds),t=Math.floor(r/1e3),i=Math.floor(t/(24*3600)),o=Math.floor(t%(24*3600)/3600).toString().padStart(0,"2"),n=Math.floor(t%3600/60).toString().padStart(2,"0"),p=(t%60).toString().padStart(2,"0");return`(${i} days, ${o}:${n}:${p})`}var M={detailSummary:"-WBYu",validityRow:"Ig2mb",detailTableContent:"_4SHUM",switchContainer:"tDKw6",copyButton:"xoM-E"};function Fe(e){let r=e.certificate?.parsed?.subject_dn||W,t=e.certificate?.parsed?.issuer_dn||W,i={before:e.certificate?.parsed?.validity_period?.not_before,after:e.certificate?.parsed?.validity_period?.not_after},o=e.certificate?.fingerprint_sha256,n=e.certificate?.fingerprint_sha1,p=e.certificate?.parsed?.serial_number,u=e.certificate?.parsed?.serial_number_hex?`0x${e.certificate.parsed.serial_number_hex}`:void 0,d=e.certificate?.names?e.certificate?.names.join(" "):void 0;return{subjectDN:r,issuerDN:t,serialNumberDecimal:p,serialNumberHex:u,validityPeriod:i,fingerprintSha256:o,fingerprintSha1:n,names:d}}var c=l(y(),1);function j({cert:e}){let[r,t]=(0,T.useState)(!0),[i,o]=(0,T.useState)(!0),{t:n}=L(),{subjectDN:p,issuerDN:u,validityPeriod:d,names:k,serialNumberValue:S,fingerprintValue:s}=(0,T.useMemo)(()=>{let{fingerprintSha256:C,fingerprintSha1:E,serialNumberDecimal:U,serialNumberHex:Ye,...Ze}=Fe(e);return{fingerprintValue:i?C:E,serialNumberValue:r?Ye:U,...Ze}},[r,i,e]),f=(0,T.useMemo)(()=>{if(Ve(d))return Be(d)},[d]),P=(0,T.useCallback)(async()=>{typeof s=="string"&&await Ce(s)},[s]);return(0,c.jsxs)("div",{className:M.detailSummary,children:[(0,c.jsx)($,{iconName:"file-list-2",children:n("Summary")}),(0,c.jsxs)(Me,{children:[(0,c.jsx)(b,{label:n("Subject DN"),content:p}),(0,c.jsx)(b,{label:n("Issuer DN"),content:u}),(0,c.jsx)(b,{label:n("Serial Number"),content:(0,c.jsxs)("div",{className:M.switchContainer,children:[(0,c.jsx)(V,{leftText:"Hex",rightText:"Decimal",onToggle:t}),(0,c.jsx)(A,{children:S})]})}),(0,c.jsx)(b,{label:n("Validity Period"),content:(0,c.jsxs)("div",{className:M.validityRow,children:[(0,c.jsx)(Le,{...d}),f!==void 0&&(0,c.jsx)(A,{children:f})]})}),(0,c.jsx)(b,{label:n("Fingerprint"),content:s&&(0,c.jsxs)("div",{className:M.switchContainer,children:[(0,c.jsx)(V,{leftText:"SHA-256",rightText:"SHA-1",onToggle:o}),(0,c.jsx)(A,{title:s,children:s.slice(0,7)}),(0,c.jsx)(ie,{onClick:P,className:M.copyButton,iconName:"file-copy-2",iconMode:"line","aria-label":"Copy Fingerprint to Clipboard",variant:v.DEFAULT})]})}),(0,c.jsx)(b,{label:n("All Names"),content:k})]})]})}var ze={detail:"NQjLT"};var w=l(y(),1);function K({cert:e}){let r=R(),t=r.collectionId?`/collections/${r.collectionId}/certificates/${r.id}`:`/certificates/${r.id}`;return(0,w.jsxs)("div",{className:ze.detail,children:[(0,w.jsx)($,{iconName:"shield-check",children:"Trust and Revocation"}),(0,w.jsx)(Ne,{baseURL:t,browsers:["chrome","edge","firefox","safari"],cert:e})]})}var We="app/cert-summary-chat-cache";function je(e,r,t,i){return`/cert:${e}/atTime:${r}/userId:${t}/orgId:${i||"none"}`}function Ke(e,r){return`Provide a 2-3 sentence summary of the certificate ${e}${r?` as it appeared at ${r} UTC`:""}.`}var Xe=l(y(),1);function X({fingerprint:e,atTime:r}){let t=ne(),i=N(),o=r&&i?.userId?je(e,r,i.userId,t?.organizationId):void 0;return(0,Xe.jsx)($e,{localStorageKey:We,cacheKey:o,prompt:Ke(e,r),source:"cert-summarizer",dataPendoId:Te.CERT_SUMMARY_CHAT_PIVOT_BUTTON,tooltipText:"Summarize Certificate with AI",children:"Summarize Certificate"})}var h={overviewHeaderContainer:"D0O1R",contentTop:"Wtsqk",popoverContainer:"zPBwT",contentTopItems:"Bd0Kk",textIcon:"X0ZmS",whiteText:"vZ0EJ",contentBottom:"xEoBy",tagsSection:"DZhKW",tagsIcon:"ElJtF",link:"dOjsp"};function ot(e){let{certificate:r}=e,t=new Set;if(r?.parsed?.subject?.common_name?.forEach(o=>{o&&o.trim().length>0&&t.add(o.trim())}),r?.parsed?.extensions?.subject_alt_name?.dns_names?.forEach(o=>{o&&o.trim().length>0&&t.add(o)}),t.size===0)return!1;let i=Array.from(t).sort();return x({field:"cert.names",values:i,kind:4})}function Qe(e){let r=[],{certificate:t}=e;if(t?.parsed){let i=ot(e),o={sectionName:"Related Certificates",links:[]};t.spki_subject_fingerprint_sha256&&o.links.push({linkText:"With the same identity (key + subject)",linkIcon:"admin",linkTo:x({field:"cert.spki_subject_fingerprint_sha256",value:t.spki_subject_fingerprint_sha256,kind:0})}),t.parsed?.subject_key_info?.fingerprint_sha256&&o.links.push({linkText:"With the same public key",linkIcon:"key",linkTo:x({field:"cert.parsed.subject_key_info.fingerprint_sha256",value:t.parsed.subject_key_info.fingerprint_sha256,kind:0})}),t.parsed?.serial_number&&o.links.push({linkText:"With the same serial number",linkIcon:"barcode",linkTo:x({field:"cert.parsed.serial_number",value:t.parsed.serial_number,kind:0})}),i&&i.length<100&&o.links.push({linkText:"With the same names",linkIcon:"price-tag-2",linkTo:i}),o.links.length>0&&r.push(o)}return t?.tbs_no_ct_fingerprint_sha256&&r.push({sectionName:"Certificate Transparency",links:[{linkText:"Associated Pre-certificates",linkIcon:"megaphone",linkTo:`/censys?q=${encodeURIComponent(ue(D({field:"cert.tbs_no_ct_fingerprint_sha256",value:t.tbs_no_ct_fingerprint_sha256,kind:0}),D({field:"cert.precert",value:!0,kind:0}),"and",!1))}`}]}),t?.fingerprint_sha256&&r.push({sectionName:"What's Using This Certificate?",links:[{linkText:"Hosts",linkIcon:"computer",linkTo:x({field:"host.services.tls.fingerprint_sha256",value:t.fingerprint_sha256,kind:0})}]}),r}var m=l(y(),1),at={popover:h.popoverContainer};function Q({cert:e}){let r=N(),t=Qe(e),i=R(),o=i.collectionId?`/collections/${i.collectionId}/results`:"/censys",n=e.certificate?.fingerprint_sha256,p=se("cert-summary-chat-pivot");return(0,m.jsxs)("div",{className:h.overviewHeaderContainer,children:[(0,m.jsxs)("div",{className:h.contentTop,children:[(0,m.jsxs)("div",{className:h.contentTopItems,children:[e?.labels?.find(u=>u?.toLowerCase()==="precert")&&(0,m.jsx)(ae,{content:(0,m.jsxs)(A,{className:h.whiteText,children:["Associated ",(0,m.jsx)("br",{}),"Pre-certificate"]}),children:(0,m.jsx)(oe,{size:"md",name:"megaphone",mode:"line",className:h.textIcon,"data-testid":"associated-pre-cert-icon","aria-hidden":!0})}),(0,m.jsx)(Ue,{children:e.displayName}),(0,m.jsx)(ye,{variant:"dot"}),(0,m.jsx)(He,{assetType:"certificate"})]}),(0,m.jsxs)("div",{className:h.contentTopItems,children:[n&&(0,m.jsx)(Se,{assetId:n,assetType:"cert",investigationName:`${e.displayName} Certificate Investigation`}),!!r&&(0,m.jsx)(de,{link:{to:`/certificates/${e?.certificate?.fingerprint_sha256}/pem/raw`,download:!0,reloadDocument:!0},button:{variant:v.DEFAULT,size:I.MEDIUM},children:"Download PEM"}),(0,m.jsx)(we,{pivots:t,customClassNames:at}),p&&n&&(0,m.jsx)(X,{fingerprint:n,atTime:e?.certificate?.modified_at?.toString()})]})]}),(0,m.jsxs)("div",{className:h.contentBottom,children:[e?.labels&&e.labels.length>0&&(0,m.jsx)("div",{className:h.tagsSection,children:(0,m.jsx)(Ee,{baseURL:o,labels:e.labels,resourceType:"certificate"})}),e?.certificate?.modified_at&&(0,m.jsx)(Ae,{timestamp:e?.certificate?.modified_at?.toString()})]})]})}var G={errorWrapper:"Tsnma",summaryLayout:"R-XDs"};var st=l(qe(),1),a=l(y(),1),Zr=({data:e})=>{let r=null;return e&&(r=e?.cert.certificate?.parsed?.subject_dn||e.cert.displayName),[{title:r?`${r} - Cert Summary`:"Censys"}]};function Ge({children:e,id:r,slots:t={},collectionId:i,collectionName:o}){let{t:n}=L(),p=he({collectionsLabel:n("Collections"),collectionName:o,fallback:[{pathName:n("Search")}]}),u=D({kind:0,field:"cert.fingerprint_sha256",value:r});return(0,a.jsx)(be,{initialQuery:u,breadcrumbs:p,slots:{searchHeader:o?(0,a.jsx)(ve,{breadcrumbs:p,placeholder:n("Search within",{name:o}),collectionId:i,children:(0,a.jsx)(_e,{})}):(0,a.jsx)(ge,{breadcrumbs:p}),header:t.pageHeader,navTabs:t.pageNavTabs},children:e})}function nt(){let[e,r]=J(),{capabilities:t,cert:i,id:o,collection:n,hasCertificateHistoryAccess:p,csrf:u}=Re(),{t:d}=L(),k=fe(),[S]=me([13]),s=`/certificates/${o}`,f="/certificates/:id";n&&(s=`/collections/${n.collection_id}${s}`,f=`/collections/:collectionId${f}`);let P=(0,_.useMemo)(()=>({cert:i}),[i]),C=(0,_.useMemo)(()=>e.get("isCollapsed")===void 0||e.get("isCollapsed")==="true",[e]),E=(0,_.useCallback)(()=>{let U=new URLSearchParams(e);U.set("isCollapsed",(!C).toString()),r(U,{state:k})},[e,C,k]);return(0,a.jsx)(re,{token:u,children:(0,a.jsx)(ce,{value:t,children:(0,a.jsx)(Ge,{id:o,slots:{pageHeader:(0,a.jsx)(Ie,{assetType:"certificate",header:(0,a.jsx)(Q,{cert:i}),isCollapsed:C,toggle:E,children:(0,a.jsxs)("div",{className:G.summaryLayout,children:[(0,a.jsx)(j,{cert:i}),(0,a.jsx)(K,{cert:i})]})}),pageNavTabs:(0,a.jsxs)(xe,{children:[(0,a.jsx)(g,{id:"certificate",to:s,children:d("Certificate")}),(0,a.jsx)(g,{id:"trust",to:`${s}/trust/${"chrome"}`,routePattern:`${f}/trust/:browser`,prefetch:"intent",children:d("Trust")}),(0,a.jsx)(g,{id:"zlint",to:`${s}/zlint`,prefetch:"intent",children:d("ZLint")}),(0,a.jsx)(g,{id:"transparency",to:`${s}/transparency`,prefetch:"intent",children:d("Certificate Transparency")}),p&&(0,a.jsx)(g,{id:"history",to:`${s}/history`,routePattern:`${f}/history/*`,prefetch:"none",children:d("Timeline")}),(0,a.jsx)(De,{canViewCenseye:S,targetRoute:s,routePattern:f}),(0,a.jsx)(g,{id:"rawData",to:`${s}/data/table`,routePattern:`${f}/data/*`,prefetch:"none",children:d("Raw Data")})]})},collectionId:n?.collection_id,collectionName:n?.name,children:(0,a.jsx)(pe,{children:(0,a.jsx)(q,{context:P})})})})})}function qr(){let e=Z(),r=R(),t=N(),i=(0,_.useContext)(te);return(0,a.jsx)(Ge,{id:r.id||"",children:(0,a.jsx)("div",{className:G.errorWrapper,children:Y(e)&&le(e.data)?(0,a.jsx)(Pe,{accessState:t,errorCode:e.data.code,env:i}):(0,a.jsx)(ke,{error:e})})})}export{Zr as a,nt as b,qr as c};
