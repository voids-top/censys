function s(t){if(t&&t.bgp_prefix&&t.name&&t.country_code&&t.asn){let{bgp_prefix:o,name:e,asn:n,country_code:r}=t;return`${o} via ${e}, ${r} (AS${n})`}}function d(t){let o=t?.coordinates?.latitude,e=t?.coordinates?.longitude;if(o&&e){let n=o>0?"N":"S",r=e>0?"E":"W";return`${o}\xB0 ${n}, ${e}\xB0 ${r}`}}function u(t){if(t&&t.city&&t.country&&t.country_code){let{city:o,country_code:e,country:n}=t;return`${o}, ${n} (${e})`}}function l(t){return{network:{name:t?.network?.name,handle:t?.network?.handle},organization:{name:t?.organization?.name,address:t?.organization?.address,handle:t?.organization?.handle}}}function m(t){let{whois:o,autonomous_system:e,location:n}=t,r=s(e),a=u(n),i=d(n),c=l(o);return{asn:e?.asn,autonomousSystem:r,location:a,coordinates:i,whois:c,countryCode:n?.country_code?.toLowerCase()??void 0,latitude:n?.coordinates?.latitude,longitude:n?.coordinates?.longitude}}function f(t,o,e,n,r=!0){return t.length>0&&o.length>0&&o.some(a=>t.includes(a))?r?n:null:e}export{m as a,f as b};
