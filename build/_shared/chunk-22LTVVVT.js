import{a as it,b as ct}from"/censys/build/_shared/chunk-3IV5MLJ3.js";import{j as w,l as N,m as nt}from"/censys/build/_shared/chunk-LAGC572J.js";import{b as pt}from"/censys/build/_shared/chunk-AARCMGAD.js";import{a as st}from"/censys/build/_shared/chunk-NAHO4RKJ.js";import{a as mt}from"/censys/build/_shared/chunk-ZD7QYARS.js";import{b as ot,e as at}from"/censys/build/_shared/chunk-DXLA43JS.js";import{c as rt}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as et,d as H}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{a as j}from"/censys/build/_shared/chunk-OFRYIVI6.js";import{b as K}from"/censys/build/_shared/chunk-XMNCU3E4.js";import{a as tt}from"/censys/build/_shared/chunk-SZRPTSUZ.js";import{a as J}from"/censys/build/_shared/chunk-OFRBI5JW.js";import{g as X}from"/censys/build/_shared/chunk-VKYVKQW2.js";import{k as Q,m as Y,p as G}from"/censys/build/_shared/chunk-MB47ZWHU.js";import{a as V}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as q}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{a as Z}from"/censys/build/_shared/chunk-M5RKE22T.js";import{f as z}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{A as x,ua as F,xa as O,z as A}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as l}from"/censys/build/_shared/chunk-F5K75D4K.js";import{g as U}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as p}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as R}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as a}from"/censys/build/_shared/chunk-2TWE7TSA.js";var $=a(R(),1);var dt=a(p(),1);function k({endpointTags:e}){let{t}=l();return(0,dt.jsx)(w,{title:t("Endpoints"),tags:e,maxVisibleTags:20})}function M(e){try{let t=new URL(e);return t.pathname.endsWith("/")?t.host+t.pathname.slice(0,-1):t.host+t.pathname}catch{return e}}var lt=a(R(),1);var m={hostIdentifier:"ZQENU",cardHeaderContainer:"pUZEp",cardHeaderContent:"DAdrn",cardHeaderContentLeft:"aLB-C",portNumber:"TcVSz",webProperty:"VFObq",cardHeaderContentRight:"_3eYla"};var s=a(p(),1);function B({baseURL:e,hostname:t,port:c,timestamp:i}){let n=`${t}:${c}`,f=(0,lt.useMemo)(()=>`${e}${i?`?at_time=${encodeURIComponent(nt(i))}`:""}`,[e,i]),o=N(),{t:g}=l();return(0,s.jsxs)("div",{className:m.cardHeaderContainer,children:[(0,s.jsx)(tt,{assetType:"web",size:"md"}),(0,s.jsxs)("div",{className:m.cardHeaderContent,children:[(0,s.jsxs)("div",{className:m.cardHeaderContentLeft,children:[(0,s.jsx)(q,{state:o,href:f,title:g("View Details",{displayName:n}),variant:"nav",size:"lg",children:(0,s.jsx)(it,{hostname:t,port:c,customClassNames:{hostIdentifier:m.hostIdentifier,port:m.portNumber}})}),(0,s.jsx)(Z,{variant:"dot"}),(0,s.jsx)(x,{className:m.webProperty,variant:A.H5,children:g("Web Property")})]}),(0,s.jsx)("div",{className:m.cardHeaderContentRight,children:i&&(0,s.jsx)("div",{className:m.timestamp,children:(0,s.jsx)(J,{timestamp:i})})})]})]})}var ft=a(R(),1);var gt=a(p(),1);function _({hit:e,baseURL:t}){let{t:c}=l(),i=(0,ft.useMemo)(()=>{let n=[];for(let f of e.software){let o=pt(f,!0);o&&n.push({href:t,label:o})}return n},[t,e.software]);return i.length?(0,gt.jsx)(w,{title:c("Software"),tags:i,maxVisibleTags:10}):null}var T={cardBody:"vANBs",cardBodyContent:"AH0l1",tagsLists:"SSvOq",labelOverview:"dttWW",screenshots:"Ln0Fk"};var ut=a(p(),1);function ht(e,t){let c=e.scan_time,i=Array.from(new Set(e.labels.flatMap(o=>o.value))).sort(),n=X(e.cert?[e.cert]:[]),f=e?.endpoints?.map(o=>{if(!o)return null;let{port:g,endpoint_type:v,path:b}=o,h,y="",d=Q(o);if(d)h=(0,ut.jsx)(ct,{variant:A.SMALL,application:d});else{let{truncatedLabel:u,tooltipContent:C}=mt(g,v,b);y=C,h=u}let L=Y(o);return{label:h,href:`${t}?isCollapsed=true#${L}`,id:L,isApplication:!!d,tooltip:y}}).filter(V).sort((o,g)=>Number(g.isApplication)-Number(o.isApplication))||[];return{timestamp:c,labels:i,aggregatedStatus:n?.aggregatedStatus,everValid:n?.everValid,endpointTags:f}}function Tt(e){return Array.from(new Set(e.threats.map(t=>t.name).filter(V))).sort()}var r=a(p(),1);function Nt({collectionIdParam:e="id",hit:t,children:c,screenshots:i}){let[n,f,o]=z([5,19,11]),v=!!(f||o),{hostname:b,port:h,endpoints:y,vulns:d,threats:L}=t,u=U(),C=`${M(b)}:${h}`,bt=N(),S=u[e]?`/collections/${u[e]}/web/${C}`:`/web/${C}`,St=u[e]?`/collections/${u[e]}/results`:"/censys";if(!b||typeof h>"u")return null;let{timestamp:vt,labels:P,aggregatedStatus:I,everValid:D,endpointTags:yt}=(0,$.useMemo)(()=>ht(t,S),[t]),W=(0,$.useMemo)(()=>Tt(t),[L]),Lt=G(y),{t:E}=l(),Ct=n&&d.length>0||v&&W?.length>0||P.length>0;return(0,r.jsxs)(O,{variant:F.INTERACTIVE,header:(0,r.jsx)(B,{baseURL:S,hostname:M(b),port:h,timestamp:vt?.toString()}),children:[(0,r.jsxs)("div",{className:T.cardBody,children:[Ct?(0,r.jsxs)("div",{className:T.labelOverview,children:[v&&W?.length>0&&(0,r.jsx)(rt,{baseURL:`${S}/threats`,threats:W}),n&&d.length>0&&(0,r.jsx)(ot,{count:d.length,severity:at(d),state:bt,to:`${S}/cves`}),(0,r.jsx)(st,{baseURL:St,labels:P,resourceType:"web"})]}):null,(0,r.jsxs)("div",{className:T.cardBodyContent,children:[(0,r.jsx)("div",{className:T.tableContainer,children:(0,r.jsxs)(et,{children:[(0,r.jsx)(H,{label:E("HTML Title"),content:Lt}),(0,r.jsx)(H,{label:E("Browser Trust"),content:I!==void 0&&(0,r.jsx)(K,{aggregatedStatus:I})}),(0,r.jsx)(H,{label:E("Ever Valid?"),content:(0,r.jsx)(j,{isTrusted:!!D,state:D})})]})}),(0,r.jsxs)("div",{className:T.tagsLists,children:[(0,r.jsx)(k,{endpointTags:yt}),(0,r.jsx)(_,{hit:t,baseURL:S})]}),(0,r.jsx)("div",{className:T.screenshots,children:i})]})]}),c]})}export{Nt as a};
