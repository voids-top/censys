import{a as je}from"/censys/build/_shared/chunk-ZTRDGSLT.js";import{a as Qe}from"/censys/build/_shared/chunk-YK4PMZMK.js";import{a as Fe,b as ze,c as B,d as Xe,e as Ye}from"/censys/build/_shared/chunk-RVNR7NXG.js";import{a as z,b as w,d as Ve}from"/censys/build/_shared/chunk-5DIHBHL2.js";import{a as Be,b as Oe}from"/censys/build/_shared/chunk-EFKOGGO3.js";import{a as $e,b as Ue}from"/censys/build/_shared/chunk-SRUDFCT7.js";import{a as He}from"/censys/build/_shared/chunk-GKOF6QGC.js";import{a as ke}from"/censys/build/_shared/chunk-5HUKVACE.js";import{a as Me}from"/censys/build/_shared/chunk-ZD7QYARS.js";import{a as We}from"/censys/build/_shared/chunk-BVX6X5MK.js";import{b as Ee}from"/censys/build/_shared/chunk-IHXQKSC2.js";import{a as we}from"/censys/build/_shared/chunk-3IID2F3B.js";import{b as Re,e as Ne}from"/censys/build/_shared/chunk-ZDOHYF7S.js";import{b as xe}from"/censys/build/_shared/chunk-GMNB7RSU.js";import{a as U,d as P}from"/censys/build/_shared/chunk-AIDQO3P6.js";import{a as lt}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as _e}from"/censys/build/_shared/chunk-LQXVLPA4.js";import{a as Le}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{c as ue,j as ve,l as Ae,m as De,n as Ie}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import{a as ie}from"/censys/build/_shared/chunk-RAMDI2JB.js";import{g as fe}from"/censys/build/_shared/chunk-JLZAPT5W.js";import{b as ce,j as Ce}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{e as ge,g as Se,h as ye,i as be}from"/censys/build/_shared/chunk-AEP7YWHE.js";import{a as y}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as he}from"/censys/build/_shared/chunk-HG7D3PDC.js";import{c as V}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as Pe}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{j as Te}from"/censys/build/_shared/chunk-HLRAT4GD.js";import{a as me}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{d as pe,f as A,k as le}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{e as ne}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as oe}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{A as de,w as $}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{A as ae,B as k,Ma as x,Na as F,Ta as se,y as H}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as Z,d as O,g as ee,k as te,m as re,p as L}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as N,c as h}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as l}from"/censys/build/_shared/chunk-2QEWK57A.js";var C=l(N(),1);var X=l(N(),1);var Ge={detailsCertInfo:"Fjh16"};function Ke(t){let{cert:e}=t,a=e?[e]:[],r=fe(a),c=[],s=[];a.forEach(d=>{d&&(c.push(d.parsed?.subject_dn),s.push(d.parsed?.issuer_dn))});let i=new Set(c.filter(y)),m=new Set(s.filter(y)),g=i.size>=1?i.values().next().value:void 0,f=m.size>=1?m.values().next().value:void 0;return{browserTrust:r,subjectDn:g,issuerDn:f}}var T=l(h(),1);function Q({webAggregate:t}){let{browserTrust:e,subjectDn:a,issuerDn:r}=(0,X.useMemo)(()=>Ke(t),[t]),c=(0,X.useMemo)(()=>e||a||r,[e,a,r]);return(0,T.jsxs)("div",{className:H(Ge.detailsCertInfo),children:[(0,T.jsx)(B,{iconName:"award",children:"Certificate Information"}),c?(0,T.jsxs)(U,{children:[(0,T.jsx)(P,{label:"Browser Trust",content:e&&(0,T.jsx)(Ee,{aggregatedStatus:e.aggregatedStatus})}),(0,T.jsx)(P,{label:"Subject DN",content:a}),(0,T.jsx)(P,{label:"Issuer DN",content:r})]}):(0,T.jsx)(k,{variant:ae.DEFAULT_ITALICS,children:"No Certificate Information Found"})]})}var j=l(N(),1);var Y={detailsSummary:"d4DeX",whiteText:"WbU8l"};var Ze=l(h(),1);function qe(t,e,a){let{endpoints:r=[]}=t;return{serviceTags:r.map(s=>{let{port:i,endpoint_type:m,path:g}=s,f,d="",D=Se(s);if(D)f=(0,Ze.jsx)(Oe,{application:D});else{let{truncatedLabel:W,tooltipContent:p}=Me(i,m,g);d=p,f=W}let I=be(s);return{label:f,href:`${e}${a?`?${a}`:""}#${I}`,id:I,tooltip:d}}).filter(y)}}function Je(t){return`${t} ${t>1?"Total ":""}${Pe("Endpoint",t)}`}var u=l(h(),1);function G({baseLink:t,webAggregate:e}){let[a]=A([0]),[r]=L(),c=$e(e.software,!1),{serviceTags:s}=(0,j.useMemo)(()=>{let m=new URLSearchParams(r);return qe(e,t,m.toString())},[e,t,r]),i=(0,j.useMemo)(()=>s.slice(0,20),[s]);return(0,u.jsxs)("div",{className:H(Y.detailsSummary),children:[(0,u.jsx)(B,{iconName:"file-list-2",children:"Summary"}),(0,u.jsxs)(U,{children:[(0,u.jsx)(ke,{label:"Software",items:c,listComponent:m=>(0,u.jsx)(se,{content:(0,u.jsxs)(k,{className:Y.whiteText,children:["Search Censys for web properties ",(0,u.jsx)("br",{})," with this software"," ",a?"CPE":"version"]}),children:(0,u.jsx)(me,{variant:"ghost",href:Ue(m,"web.software",a),children:m.label})})}),(0,u.jsx)(P,{label:Je(s.length),content:i.length>0&&(0,u.jsx)(we,{tags:i,maxVisibleRows:i.length,tagSize:"md"})})]})]})}var K=l(N(),1);var v={overviewHeaderContainer:"wy57t",contentTop:"kExPA",popoverContainer:"C3Ima",contentTopItems:"BmuFm",actions:"gWs4O",assetType:"tvUiK",contentBottom:"_2amWn",tagsSection:"aCvGp",tagsIcon:"Tkzpf",portText:"rQDWv"};function tt(t){let e=t?.cert?.fingerprint_sha256,a=[];return e&&a.push({sectionName:"Related Certificates",links:[{linkText:"With the same certificate used in scan",linkIcon:"award",linkTo:$({field:"cert.fingerprint_sha256",value:e,kind:0})},{linkText:"With the same host name",linkIcon:"computer",linkTo:$({field:"cert.names",value:t.hostname,kind:0})}]}),a.push({sectionName:"Related Web Properties",links:[{linkText:"With the same host name",linkIcon:"computer",linkTo:$({field:"web.hostname",value:t.hostname,kind:0})}]}),a}var n=l(h(),1),ft={popover:v.popoverContainer};function q({baseRoute:t,webAggregate:e,hasScanData:a}){let r=ee(),[c]=L(),s=c.toString(),i=tt(e),[m]=A([5]),g=e.scan_time,f=[...e.labels].map(_=>_.value).sort(),d=r.collectionId?`/collections/${r.collectionId}/results`:"/censys",D=`${e.hostname}:${e.port}`,I=(0,K.useMemo)(()=>Ne(e.vulns),[e.vulns]),W=m&&e.vulns.length>0,p=(0,K.useMemo)(()=>e.threats.map(_=>_.name).filter(y),[e.threats]),[b]=A([11]);return(0,n.jsxs)("div",{className:v.overviewHeaderContainer,children:[(0,n.jsxs)("div",{className:v.contentTop,children:[(0,n.jsxs)("div",{className:v.contentTopItems,children:[(0,n.jsx)(Ye,{children:(0,n.jsx)(Be,{hostname:e.hostname,port:e.port,customClassNames:{port:v.portText}})}),(0,n.jsx)(he,{variant:"dot"}),(0,n.jsx)("div",{className:v.assetType,children:(0,n.jsx)(Xe,{assetType:"web"})})]}),(0,n.jsxs)("div",{className:v.actions,children:[(0,n.jsx)(Ce,{assetId:D,assetType:"web",investigationName:`${e.hostname} Web Investigation`}),a&&(0,n.jsx)(Qe,{pivots:i,customClassNames:ft})]})]}),(0,n.jsxs)("div",{className:v.contentBottom,children:[(0,n.jsxs)("div",{className:v.tagsSection,children:[W&&(0,n.jsx)(Re,{count:e.vulns.length,severity:I,to:`${t}/cves${s?`?${s}`:""}`}),b&&p?.length>0&&(0,n.jsx)(xe,{baseURL:`${t}/threats`,threats:p}),f.length>0&&(0,n.jsx)(He,{baseURL:d,labels:f,resourceType:"web"})]}),g&&(0,n.jsx)(_e,{timestamp:g})]})]})}var rt="details-list",ot="cves",at="raw-data",st="threats";var J={summaryLayout:"_8Wr8D",errorWrapper:"_2YogW"};var ht=l(lt(),1),o=l(h(),1),eo=({data:t})=>{let e;return t&&t.webAggregate&&(e=ge(t.webAggregate)),[{title:e?`${e} - Web Property Summary`:"Censys"}]};function it({children:t,webAggregate:e,collectionId:a,collectionName:r,slots:c={}}){let{t:s}=V(),i=Te({collectionsLabel:s("Collections"),collectionName:r,fallback:[{pathName:s("Search")}]}),m=e?ye(e):"";return(0,o.jsx)(De,{initialQuery:m,breadcrumbs:i,slots:{searchHeader:r?(0,o.jsx)(ve,{breadcrumbs:i,placeholder:s("Search within",{name:r}),collectionId:a,children:(0,o.jsx)(Ie,{})}):(0,o.jsx)(Ae,{breadcrumbs:i}),header:c.pageHeader,navTabs:c.pageNavTabs},children:t})}function dt(){let t=de(),[e,a]=L(),{webAggregate:r,id:c,capabilities:s,collection:i,cveDetails:m,endpointsRawData:g,tlsDetailsRawData:f,threatDetails:d,csrf:D}=We(),[I,W]=A([11,13]),p=`/web/${c}`,b="/web/:id";i&&(p=`/collections/${i.collection_id}${p}`,b=`/collections/:collectionId${b}`);let _=!!O(`${p}/cves/*`),nt=!!O(`${p}/threats/*`),E=(0,C.useMemo)(()=>{let S=!!r?.endpoints?.length;return{webAggregate:r,hasScanData:S,endpointsRawData:g,tlsDetailsRawData:f,cveDetails:m,threatDetails:d}},[r,g,f,m,d]),M=(0,C.useMemo)(()=>{let S=e.get("isCollapsed");return S===void 0||S==="true"},[e]),mt=(0,C.useCallback)(()=>{a(S=>(S.set("isCollapsed",(!M).toString()),S),{state:t})},[M,t]),pt=(0,C.useMemo)(()=>new Set(r.threats.map(S=>S.name).filter(y)).size,[r]),{t:R}=V();return(0,o.jsx)(ie,{token:D,children:(0,o.jsx)(pe,{value:s,children:(0,o.jsx)(it,{webAggregate:r,slots:{pageHeader:(0,o.jsx)(Fe,{assetType:"web",header:(0,o.jsx)(q,{baseRoute:p,webAggregate:r,hasScanData:E.hasScanData}),isCollapsed:M||!E.hasScanData,toggle:mt,shouldShowControls:E.hasScanData,children:(0,o.jsxs)("div",{className:J.summaryLayout,children:[(0,o.jsx)(G,{baseLink:p,webAggregate:r}),(0,o.jsx)(Q,{webAggregate:r})]})}),pageNavTabs:E.hasScanData&&(0,o.jsxs)(Ve,{children:[(0,o.jsx)(w,{id:rt,to:p,prefetch:"intent",children:R("HTTP and Application Details")}),(0,o.jsxs)(w,{id:ot,to:`${p}/cves`,prefetch:"intent",routePattern:`${b}/cves/*`,children:[(0,o.jsx)(z,{children:R("CVEs")}),(0,o.jsx)(F,{count:r.vulns.length,variant:_?x.SYSTEM:x.NEUTRAL})]}),I&&(0,o.jsxs)(w,{id:st,routePattern:`${b}/threats/*`,to:`${p}/threats`,prefetch:"none",children:[(0,o.jsx)(z,{children:R("Threats")}),(0,o.jsx)(F,{count:pt,variant:nt?x.SYSTEM:x.NEUTRAL})]}),(0,o.jsx)(ze,{canViewCenseye:W,targetRoute:p,routePattern:b}),(0,o.jsx)(w,{id:at,routePattern:`${b}/data/*`,to:`${p}/data/table`,prefetch:"none",children:R("Raw Data")})]})},collectionId:i?.collection_id,collectionName:i?.name,children:(0,o.jsx)(ue,{children:(0,o.jsx)(re,{context:E})})})})})}function to(){let t=te(),e=ne(),a=ce(e),r=(0,C.useContext)(oe);return(0,o.jsx)(it,{children:(0,o.jsx)("div",{className:J.errorWrapper,children:Z(t)&&le(t.data)?(0,o.jsx)(je,{errorCode:t.data.code,orgState:a,env:r}):(0,o.jsx)(Le,{error:t})})})}export{eo as a,dt as b,to as c};
