import{a as mt,b as lt,c as Z,d as ct,e as ut,f as pt}from"/censys/build/_shared/chunk-NVOUF2X3.js";import{b as nt}from"/censys/build/_shared/chunk-AARCMGAD.js";import{a as it}from"/censys/build/_shared/chunk-NAHO4RKJ.js";import{a as at,b as H}from"/censys/build/_shared/chunk-DPQLMYXH.js";import{a as ot}from"/censys/build/_shared/chunk-4533AUAX.js";import{a as st,b as rt,e as q}from"/censys/build/_shared/chunk-DXLA43JS.js";import{a as tt}from"/censys/build/_shared/chunk-XNAXVUO4.js";import{a as je,c as et}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as G,b as I,d as E}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{a as We}from"/censys/build/_shared/chunk-YTHNDA7O.js";import{a as re,b as k,d as Ye}from"/censys/build/_shared/chunk-DT7XMIXP.js";import{b as Ke}from"/censys/build/_shared/chunk-SZRPTSUZ.js";import{a as Fe}from"/censys/build/_shared/chunk-AEM63NKL.js";import{a as ze}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as Xe}from"/censys/build/_shared/chunk-OFRBI5JW.js";import{a as Je}from"/censys/build/_shared/chunk-QHRZ4J4F.js";import{c as Qe,e as Ge,g as ie,h as ne,i as qe,j as Ze}from"/censys/build/_shared/chunk-IO4OV3HV.js";import{a as Ot}from"/censys/build/_shared/chunk-IC5AY47K.js";import{c as Ve}from"/censys/build/_shared/chunk-BSJLYU5L.js";import{c as Ee,l as ke,p as Me,q as Oe,r as $e,s as Ue}from"/censys/build/_shared/chunk-B5UNN2SO.js";import{a as Ie}from"/censys/build/_shared/chunk-J22KWXE5.js";import{a as ge}from"/censys/build/_shared/chunk-EMHGEENV.js";import{g as De}from"/censys/build/_shared/chunk-IRHQADG7.js";import{b as Ne,c as y}from"/censys/build/_shared/chunk-FP2KPINM.js";import{a as Be}from"/censys/build/_shared/chunk-BWODHJE6.js";import{E as Re,j as xe}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{a as Q}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as P}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{a as se}from"/censys/build/_shared/chunk-M5RKE22T.js";import{b as Ae,d as Pe,f as U}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{e as K,f as _e,h as oe}from"/censys/build/_shared/chunk-ST66DGSY.js";import{B as ae,D as we,x as B,z as D}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{A as $,Qa as F,Ra as te,Ta as He,Xa as be,x as Ce,y as Le}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as Te}from"/censys/build/_shared/chunk-F5K75D4K.js";import{c as ye}from"/censys/build/_shared/chunk-44DVAK2X.js";import{a as he,c as fe,d as ee,g as Y,k as ve,m as Se,p as O}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as A}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as X}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as T}from"/censys/build/_shared/chunk-2TWE7TSA.js";var v=T(X(),1);var dt=T(X(),1);var m={hostDetailsLocationItems:"_54H4t",hostDetailsLocationTable:"-XqVm",hostDetailsLocationMapWrapper:"j8CmB",hostDetailsLocationContent:"OhWSL",hostDetailsLocationMap:"pCZQo",hostDetailsLocationFlag:"MDudf",hostDetailsLocationText:"_3xA8V",flagIconContainer:"HdL5p",multipleItemDetail:"_52VKz",itemLocationLine:"PbwMM",iconButton:"sf5Lf",autonomousSystem:"qe6HO"};var t=T(A(),1);function me({host:e}){let{location:i,coordinates:c,whois:o,countryCode:a,latitude:S,longitude:p}=at(e),d=Ae("MAPS_API_KEY"),g=(0,dt.useMemo)(()=>!S||!p||!d?null:`https://www.google.com/maps/embed/v1/place?key=${d}&q=${S},${p}&zoom=5`,[S,p]),r=e.autonomous_system,f=r&&r.asn&&r.bgp_prefix&&r.country_code&&r.name;return(0,t.jsxs)("div",{className:Ce(m.hostDetailsLocation),children:[(0,t.jsx)(Z,{iconName:"map-pin-user",children:"Network and Geolocation"}),(0,t.jsxs)("div",{className:m.hostDetailsLocationItems,children:[(0,t.jsx)("div",{className:m.hostDetailsLocationTable,children:(0,t.jsxs)(G,{children:[(0,t.jsx)(E,{label:"WHOIS Network",content:(0,t.jsxs)("div",{className:m.multipleItemDetail,children:[(0,t.jsx)(I,{text:o.network.name&&H(e.presence_unset||[],["host.whois.network"],(0,t.jsx)(P,{variant:"ghost",href:D({kind:0,field:"host.whois.network.name",value:o.network.name}),children:o.network.name}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!0)}),o.network.handle&&(0,t.jsx)(I,{text:H(e.presence_unset||[],["host.whois.network"],(0,t.jsx)(P,{variant:"ghost",href:D({kind:0,field:"host.whois.network.handle",value:o.network.handle}),children:o.network.handle}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!1)})]})}),(0,t.jsx)(E,{label:"WHOIS Organization",content:(0,t.jsxs)("div",{className:m.multipleItemDetail,children:[(0,t.jsx)(I,{text:o.organization.name&&H(e.presence_unset||[],["host.whois.organization"],(0,t.jsx)(P,{variant:"ghost",href:D({kind:0,field:"host.whois.organization.name",value:o.organization.name}),children:o.organization.name}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!0)}),o.organization.address&&(0,t.jsx)(I,{text:H(e.presence_unset||[],["host.whois.organization"],(0,t.jsx)(P,{variant:"ghost",href:D({kind:0,field:"host.whois.organization.address",value:o.organization.address}),children:o.organization.address.replace(/\\n/g,", ")}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!1)}),o.organization.handle&&(0,t.jsx)(I,{text:H(e.presence_unset||[],["host.whois.organization"],(0,t.jsx)(P,{variant:"ghost",href:D({kind:0,field:"host.whois.organization.handle",value:o.organization.handle}),children:o.organization.handle}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!1)})]})}),(0,t.jsx)(E,{label:"Autonomous System",content:f&&(0,t.jsxs)("div",{className:m.multipleItemDetail,children:[r.bgp_prefix&&(0,t.jsx)(I,{text:H(e.presence_unset||[],["host.autonomous_system.bgp_prefix"],(0,t.jsx)(P,{variant:"ghost",href:D({kind:0,field:"host.autonomous_system.bgp_prefix",value:r.bgp_prefix}),children:r.bgp_prefix}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!0)}),r.country_code&&r.asn&&r.name&&(0,t.jsx)(I,{text:H(e.presence_unset||[],["host.autonomous_system.country_code","host.autonomous_system.asn","host.autonomous_system.name"],(0,t.jsxs)(P,{variant:"ghost",href:D(ae(ae(B({kind:0,field:"host.autonomous_system.name",value:r.name}),B({kind:0,field:"host.autonomous_system.asn",value:r.asn}),"and",!1,!1),B({kind:0,field:"host.autonomous_system.country_code",value:r.country_code}),"and",!1,!1)),children:[r.name," (",r.asn,"),"," ",r.country_code]}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!1)})]})})]})}),(0,t.jsxs)("div",{className:m.hostDetailsLocationMapWrapper,children:[g&&(0,t.jsx)("iframe",{className:m.hostDetailsLocationMap,title:"Google Map View",src:g,allowFullScreen:!0,credentialless:""}),(0,t.jsxs)("div",{className:m.hostDetailsLocationContent,children:[a&&(0,t.jsx)("div",{className:m.hostDetailsLocationFlag,children:H(e.presence_unset||[],["host.location","host.location.city","host.location.country","host.location.country_code"],(0,t.jsx)(Fe,{"aria-hidden":!0,countryCode:a}),(0,t.jsx)(y,{iconClassName:m.iconButton}),!1)}),i&&(0,t.jsx)($,{children:H(e.presence_unset||[],["host.location","host.location.city","host.location.country","host.location.country_code"],i,(0,t.jsx)(y,{iconClassName:m.iconButton}))}),c&&(0,t.jsx)($,{className:m.hostDetailsLocationText,children:H(e.presence_unset||[],["host.location.coordinates","host.location.coordinates.latitude","host.location.coordinates.longitude"],c,(0,t.jsx)(y,{iconClassName:m.iconButton}))})]})]})]})]})}var V=T(X(),1);var b={hostDetailsSummary:"_1lxtH",detailTableContent:"_3Jmse",expandableList:"YnSLt",listWrapper:"_3xnF3",listElementWrapper:"chPAX",iconButton:"ZnXpj",disable:"uGO1E",lockButton:"Il2vm",listControlButton:"aUf46"};function ht(e,i,c,o){let{dns:a,services:S,operating_system:p}=e,d=a?.reverse_dns?.names?.[0],g={label:p?.product?nt(p,!0):void 0,isLocked:e.presence_unset.includes("host.operating_system.product")},r=e.presence_unset.includes("host.dns.names")?[{label:void 0,isLocked:!0}]:(a?.names??[]).length===0?[{label:void 0,isLocked:!1}]:a?.names?.map(h=>({label:h,isLocked:!1}))||[],f=S?.filter(Q).map(h=>({label:ie(h),isLocked:!1,href:ne(h,c,o),hasThreats:h.threats?.some(N=>N.name?.trim()!=="")??!1,hasCves:!!h.vulns?.length,cveSeverity:q(h.vulns)}));for(let h of i)f.push({label:ie(h),isLocked:!0,href:ne(h,c,o)});return{reverseDns:d,operatingSystem:g,serviceTags:f,forwardDnsNames:r}}var l=T(A(),1),Bt={expandableList:b.expandableList,listWrapper:b.listWrapper,listElementWrapper:b.listElementWrapper,listControlButton:b.listControlButton};function le({baseLink:e,host:i,lockedServices:c}){let o=(0,V.useRef)(null),[a]=O(),{reverseDns:S,operatingSystem:p,serviceTags:d,forwardDnsNames:g}=(0,V.useMemo)(()=>{let u=new URLSearchParams(a);return ht(i,c,e,u.toString())},[i,c,e,a]),r=(0,V.useCallback)(()=>{o.current&&Ie(o.current,{behavior:"auto"})},[o]),[f,h,N]=U([5,19,11]),x=h||N,R=!!f,M=!!x;return(0,l.jsxs)("div",{className:b.hostDetailsSummary,children:[(0,l.jsx)(Z,{iconName:"file-list-2",children:"Summary"}),(0,l.jsxs)(G,{children:[(0,l.jsx)(E,{label:"Reverse DNS",content:i.presence_unset.includes("host.dns.reverse_dns.names")?(0,l.jsx)(y,{className:b.iconButton}):S}),(0,l.jsx)(E,{label:"Forward DNS",content:!!i.dns?.names?.length&&(0,l.jsx)(tt,{ref:o,customClassNames:Bt,data:g.map(u=>u.isLocked?(0,l.jsx)(y,{className:b.iconButton}):u.label),maxVisibleRows:8,onCollapse:r,renderListElement:u=>(0,l.jsx)($,{children:u})})}),(0,l.jsx)(E,{label:"OS",content:p.isLocked?(0,l.jsx)(y,{className:b.iconButton}):p.label}),(0,l.jsx)(E,{label:`${d.length} Total ${ze("Service",d.length)}`,content:(0,l.jsx)(ot,{tagSize:"md",tags:d.map(u=>({...u,label:(0,l.jsx)($,{className:u.isLocked?b.disable:"",children:u.label}),contentRight:u.isLocked&&(0,l.jsx)(Ne,{iconClassName:b.iconButton}),contentLeft:(0,l.jsxs)(l.Fragment,{children:[R&&u.hasCves&&u.cveSeverity&&(0,l.jsx)(st,{size:"md","aria-label":"Censys found a CVE on this service.",severity:u.cveSeverity}),M&&u.hasThreats&&(0,l.jsx)(je,{size:"md","aria-label":"Censys found a threat on this service."})]})})),maxVisibleRows:20})})]})]})}var gt=T(X(),1);var vt="app/host-summary-chat-cache";function St(e,i,c,o){return`/host:${e}/atTime:${i}/userId:${c}/orgId:${o||"none"}`}function Tt(e,i){return`Provide a 2-3 sentence summary of the host ${e}${i?` as it appeared at ${i} UTC`:""}.`}var yt=T(A(),1);function J({ip:e,atTime:i}){let c=_e(),o=K(),a=i&&o?.userId?St(e,i,o.userId,c?.organizationId):void 0;return(0,yt.jsx)(pt,{localStorageKey:vt,cacheKey:a,prompt:Tt(e,i),source:"summarizer",dataPendoId:ke.HOST_SUMMARY_CHAT_PIVOT_BUTTON,tooltipText:"Summarize Host with AI",children:"Summarize Host"})}var _={overviewHeaderContainer:"_7pK9h",contentTop:"_3lb1q",section:"Tstol",textIcon:"_3lmsn",historicalTag:"nLQ1e",contentBottom:"U6LgS",tagsSection:"KoaXW",contentRow:"Pdkf2",tagsIcon:"HIwAN",breadcrumbHeader:"qLo7u",breadcrumbSeparator:"gIJY9",trailLink:"_0w1UJ",scanBtn:"tDRqP"};var n=T(A(),1);function ce({baseRoute:e,cveCount:i,cveSeverity:c,ip:o,isLatest:a,isTruncated:S,tags:p,lastUpdatedAt:d,threats:g}){let[r]=U([10]),[f]=O(),h=fe(),N=Y(),x=N.collectionId?`/collections/${N.collectionId}/results`:"/censys",R=(0,gt.useMemo)(()=>{let z=new URLSearchParams(f);return z.delete("at_time"),`${h.pathname}?${z.toString()}`},[f,h]),M=f.toString(),u=`${M?`?${M}`:""}`,W=!a&&!!f.get("at_time");return(0,n.jsxs)("div",{className:_.overviewHeaderContainer,children:[(0,n.jsxs)("div",{className:_.contentTop,children:[(0,n.jsxs)("div",{className:_.section,children:[S&&(0,n.jsx)(be,{content:"Truncated",children:(0,n.jsx)(Le,{size:"md",name:"eye-off",mode:"line",className:_.textIcon,"data-testid":"truncated-icon","aria-hidden":!0})}),(0,n.jsx)(ut,{children:o}),(0,n.jsx)(se,{variant:"dot"}),(0,n.jsx)(ct,{assetType:"host"}),W&&(0,n.jsx)(He,{className:_.historicalTag,size:"sm",children:"Historical"})]}),(0,n.jsxs)("div",{className:_.section,children:[(0,n.jsx)(xe,{assetId:o,assetType:"host",investigationName:`${o} Host Investigation`}),r&&(0,n.jsx)(Ve,{entityId:o,rescanResourceType:"UNKNOWN_HOST",className:_.scanBtn,scanTime:d}),(0,n.jsx)(J,{ip:o,atTime:d})]})]}),(0,n.jsxs)("div",{className:_.contentBottom,children:[(0,n.jsxs)("div",{className:_.tagsSection,children:[i>0&&(0,n.jsx)(rt,{count:i,severity:c,to:`${e}/cves${u}`}),g?.length>0&&(0,n.jsx)(et,{baseURL:`${e}/threats${u}`,threats:g}),p&&p.length>0&&(0,n.jsx)(it,{baseURL:x,labels:p,resourceType:"host"})]}),d&&(0,n.jsxs)("div",{className:_.contentRow,children:[(0,n.jsx)(Xe,{timestamp:d}),W&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(se,{variant:"line--vertical",spacing:6}),(0,n.jsx)(P,{href:R,"aria-label":"Link to latest",children:"See Latest"})]})]})]})]})}var ue={summaryLayout:"_9rY0X",errorWrapper:"YYWsZ"};var Wt=T(Ot(),1),s=T(A(),1),Qa=({data:e})=>[{title:e?.id?`${e.id} - Host Summary`:"Censys"}];function Ct({children:e,id:i,slots:c={},collectionId:o,collectionName:a}){let{t:S}=Te(),p=i.toLowerCase(),d=De({collectionsLabel:S("Collections"),collectionName:a,fallback:[{pathName:S("Search")}]}),g=B({kind:0,field:"host.ip",value:p});return(0,s.jsx)($e,{initialQuery:g,breadcrumbs:d,slots:{searchHeader:a?(0,s.jsx)(Me,{breadcrumbs:d,placeholder:S("Search within",{name:a}),collectionId:o,children:(0,s.jsx)(Ue,{})}):(0,s.jsx)(Oe,{breadcrumbs:d}),header:c.pageHeader,navTabs:c.pageNavTabs},children:e})}function Ft(){let[e,i]=O(),{atTime:c,cveDetails:o,host:a,servicesRawData:S,id:p,isLatest:d,capabilities:g,collection:r,flashMessage:f,lockedServices:h,csrf:N,threatDetails:x}=We(),R=we(),M=oe("host-services-timeline"),u=oe("web-property-improvements"),[W,z,Lt]=U([19,11,13]),Ht=z||W,C=`/hosts/${p}`,w="/hosts/:id";r&&(C=`/collections/${r.collection_id}${C}`,w=`/collections/:collectionId${w}`);let bt=!!ee(`${C}/cves/*`),_t=!!ee(`${C}/threats/*`),At=(0,v.useMemo)(()=>({collection:r,cveDetails:o,host:a,servicesRawData:S,lockedServices:h,threatDetails:x}),[a,r,o,S,h,x]),j=(0,v.useMemo)(()=>e.get("isCollapsed")===void 0||e.get("isCollapsed")==="true",[e]),Pt=(0,v.useCallback)(()=>{let L=new URLSearchParams(e);L.set("isCollapsed",(!j).toString()),i(L,{state:R})},[j,e,R]),Et=(0,v.useMemo)(()=>Array.from(new Set([...a.labels.map(L=>L.value)||[],...a.services.flatMap(L=>L.labels.map(Mt=>Mt.value))||[]])),[a]),Nt=(0,v.useMemo)(()=>Array.from(new Set(a.services.flatMap(L=>L.threats).map(L=>L.name).filter(Q))).sort(),[a]),wt=!!a?.labels?.some(L=>L.value.toLowerCase()==="truncated"),pe=(0,v.useMemo)(()=>qe(a),[a]),Dt=(0,v.useMemo)(()=>Ze(a),[a]),kt=(0,v.useMemo)(()=>q(a.services.flatMap(L=>L.vulns)),[a]),[It,de]=(0,v.useState)(f!==null);(0,v.useEffect)(()=>{f&&de(!0)},[f]);let{iconName:xt,description:Rt}=(0,v.useMemo)(()=>Ke(a.hardware),[a]);return(0,s.jsx)(Pe,{value:g,children:(0,s.jsx)(ge,{token:N,children:(0,s.jsx)(Ct,{id:p,slots:{pageHeader:(0,s.jsx)(mt,{assetType:"host",iconName:xt,description:Rt,header:(0,s.jsx)(ce,{baseRoute:C,cveCount:g[5]?pe:0,cveSeverity:kt,ip:p,isLatest:d,isTruncated:wt,tags:Et,lastUpdatedAt:Qe(a,c)||void 0,threats:Ht?Nt:[]}),isCollapsed:j,toggle:Pt,children:(0,s.jsxs)("div",{className:ue.summaryLayout,children:[(0,s.jsx)(le,{baseLink:C,host:a,lockedServices:h}),(0,s.jsx)(me,{host:a})]})}),pageNavTabs:(0,s.jsxs)(Ye,{children:[(0,s.jsx)(k,{id:"services",to:C,shouldPreserveQueryParams:!1,children:"Services"}),(0,s.jsx)(k,{id:"eventHistory",routePattern:`${w}/events/*`,to:`${C}/events`,shouldPreserveQueryParams:!1,children:"Event History"}),M?(0,s.jsx)(k,{id:"serviceHistory",to:`${C}/history`,shouldPreserveQueryParams:!1,children:"Service History"}):null,(0,s.jsx)(k,{id:"cves",routePattern:`${w}/cves/*`,to:`${C}/cves`,shouldPreserveQueryParams:!1,children:(0,s.jsxs)(re,{children:["CVEs"," ",(0,s.jsx)(te,{count:pe,variant:bt?F.SYSTEM:F.NEUTRAL})]})}),z&&(0,s.jsx)(k,{id:"threats",routePattern:`${w}/threats/*`,to:`${C}/threats`,prefetch:"none",shouldPreserveQueryParams:!1,children:(0,s.jsxs)(re,{children:["Threats"," ",(0,s.jsx)(te,{count:Dt,variant:_t?F.SYSTEM:F.NEUTRAL})]})}),(0,s.jsx)(lt,{canViewCenseye:Lt,targetRoute:C,routePattern:w}),u&&(0,s.jsx)(k,{id:"relatedAssets",routePattern:`${w}/related-assets`,to:`${C}/related-assets`,prefetch:"none",children:"Related Assets"}),(0,s.jsx)(k,{id:"rawData",routePattern:`${w}/data/*`,to:`${C}/data/table`,prefetch:"none",shouldPreserveQueryParams:!1,children:"Raw Data"})]})},collectionId:r?.collection_id,collectionName:r?.name,children:(0,s.jsxs)(Ee,{children:[(0,s.jsx)(Se,{context:At}),!!f&&It&&(0,s.jsx)(Re,{atTime:f.atTime,onDismiss:()=>{de(!1)}})]})})})})}function Ga(){let e=ve(),i=Y(),c=K(),o=(0,v.useContext)(ye);return(0,s.jsx)(Ct,{id:i.id||"",children:(0,s.jsx)("div",{className:ue.errorWrapper,children:he(e)&&Ge(e.data)?(0,s.jsx)(Je,{accessState:c,error:e.data,env:o}):(0,s.jsx)(Be,{error:e})})})}export{Qa as a,Ft as b,Ga as c};
