import{e as h}from"/censys/build/_shared/chunk-DSG73WCA.js";import{a as m}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{a as P}from"/censys/build/_shared/chunk-EZHABQF2.js";import{A as l,B as T,Ja as N,Va as S,ba as w,ca as H,da as b,z as s}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as p}from"/censys/build/_shared/chunk-2QEWK57A.js";var t={panel:"Ets-O",headerRow:"YcwGK",dateRow:"M-MRm",headerLeft:"mbKl4",rows:"jT5Up",row:"VSGwu",value:"kxElS",label:"_48cU-",divider:"efyyZ",close:"Ksx1R"};var d=p(c(),1);function A({displayName:o,port:e,protocol:i,transportProtocol:n,onClose:y}){return(0,d.jsxs)("div",{className:t.headerRow,children:[(0,d.jsxs)("div",{className:t.headerLeft,children:[(0,d.jsx)(l,{variant:s.H1,children:o}),e!==void 0&&(0,d.jsxs)(l,{variant:s.H1_SUB_HEADLINE,children:[": ",e]}),i&&(0,d.jsxs)(l,{variant:s.H1_SUB_HEADLINE,children:["/ ",i]}),n&&(0,d.jsxs)(l,{variant:s.H1_SUB_HEADLINE,children:["(",n,")"]})]}),(0,d.jsx)(b,{"aria-controls":"details-panel","aria-label":"Close",className:t.close,iconName:"close",iconMode:"line",onClick:y,shape:H.SQUARE,size:w.MEDIUM,type:"button",variant:T.GHOST})]})}var u=p(c(),1);function f({label:o,value:e,shouldTruncate:i}){if(e===void 0||typeof e=="string"&&e.length===0)return null;let n=i?(0,u.jsx)(S,{content:e,side:"top",children:(0,u.jsx)("div",{className:t.value,"data-title":e,children:(0,u.jsx)(l,{children:e})})}):(0,u.jsx)(l,{children:e});return(0,u.jsxs)("div",{className:t.row,children:[(0,u.jsx)(l,{variant:s.SMALL,className:t.label,children:o}),n]})}var R=(o,e,i)=>{switch(o){case"host":return`/hosts/${e}?at_time=${i}`;case"web":return`/web/${e}?at_time=${i}`}},B=o=>{let e="View Historical",i=o==="host"?"Host":"Web Property";return`${e} ${i}`};var r=p(c(),1);function I({displayName:o,type:e,port:i,protocol:n,transportProtocol:y,onClose:E,timestamp:g,threatCount:L,serviceCount:x,jarm:D,bodyHash:_,bannerHash:k,network:z}){let C=R(e,o,g);return(0,r.jsxs)("div",{className:t.panel,"data-testid":"details-panel",children:[(0,r.jsx)(A,{displayName:o,port:i,protocol:n,transportProtocol:y,onClose:E}),(0,r.jsxs)("div",{className:t.rows,children:[(0,r.jsx)(m,{variant:"line--horizontal",className:t.divider}),(0,r.jsx)(f,{label:"Date",value:(0,r.jsxs)("div",{className:t.dateRow,children:[(0,r.jsx)(N,{timestamp:g}),(0,r.jsx)(P,{href:C,target:"_blank",rel:"noopener noreferrer",children:B(e)})]})}),(0,r.jsx)(m,{variant:"line--horizontal",className:t.divider}),(0,r.jsx)(f,{label:"Threats",value:L}),(0,r.jsx)(f,{label:"Services",value:x}),(0,r.jsx)(f,{label:"JARM",value:D,shouldTruncate:!0}),(0,r.jsx)(f,{label:"Body Hash",value:_,shouldTruncate:!0}),(0,r.jsx)(f,{label:"Banner Hash",value:k,shouldTruncate:!0}),(0,r.jsx)(f,{label:"Network (AS)",value:z}),(0,r.jsx)(m,{variant:"line--horizontal",className:t.divider})]})]})}var a=p(c(),1);function M(){return(0,a.jsxs)("div",{className:t.panel,"data-testid":"details-panel","aria-busy":!0,children:[(0,a.jsx)(h,{width:300,variant:s.H1}),(0,a.jsxs)("div",{className:t.rows,children:[(0,a.jsx)(m,{variant:"line--horizontal",className:t.divider}),(0,a.jsx)(v,{width:100}),(0,a.jsx)(m,{variant:"line--horizontal",className:t.divider}),(0,a.jsx)(v,{width:150}),(0,a.jsx)(v,{width:200}),(0,a.jsx)(v,{width:180}),(0,a.jsx)(v,{width:140}),(0,a.jsx)(v,{width:100}),(0,a.jsx)(m,{variant:"line--horizontal",className:t.divider})]})]})}var v=({width:o})=>(0,a.jsxs)("div",{className:t.row,children:[(0,a.jsx)("div",{className:t.label,children:(0,a.jsx)(h,{width:o-30})}),(0,a.jsx)(h,{width:o})]});var ce=o=>o.services.reduce((e,i)=>e+i.threats.length,0),me=(o,e,i)=>!e||!i?null:o.services.find(n=>n.port===Number(e)&&n.transport_protocol===i);export{t as a,I as b,M as c,ce as d,me as e};
