import{a as je}from"/censys/build/_shared/chunk-IASZ2KIP.js";import{a as Qe}from"/censys/build/_shared/chunk-5C77OQL6.js";import{a as Fe,b as ze,c as U,d as Xe,e as Ye}from"/censys/build/_shared/chunk-JG6RDZZZ.js";import{a as Ve}from"/censys/build/_shared/chunk-BJQIOMMT.js";import{a as X,b as x,d as Oe}from"/censys/build/_shared/chunk-YP7RGGRG.js";import{a as Ue,b as Me}from"/censys/build/_shared/chunk-ZWMFGUZT.js";import{a as ke,c as $e}from"/censys/build/_shared/chunk-OV3VCMX3.js";import{a as He}from"/censys/build/_shared/chunk-FMRIG57S.js";import{a as Be}from"/censys/build/_shared/chunk-ZD7QYARS.js";import{a as we}from"/censys/build/_shared/chunk-ISPS5TGZ.js";import{b as Re,e as Ne}from"/censys/build/_shared/chunk-OIVUAPPH.js";import{a as _e}from"/censys/build/_shared/chunk-3W2VQNCA.js";import{c as xe}from"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as $,d as _}from"/censys/build/_shared/chunk-53UREJP4.js";import{b as We}from"/censys/build/_shared/chunk-NEH6M55V.js";import{a as pt}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as Ee}from"/censys/build/_shared/chunk-IJLDI467.js";import{a as Le}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{c as Se,l as Ce,n as Ae,o as De,p as Ie}from"/censys/build/_shared/chunk-22JANVKU.js";import{a as ne}from"/censys/build/_shared/chunk-RAMDI2JB.js";import{g as ge}from"/censys/build/_shared/chunk-ATOZ4ARP.js";import{e as ve}from"/censys/build/_shared/chunk-HUE44QRB.js";import{e as de,g as fe,h as he,i as Te}from"/censys/build/_shared/chunk-Z3PARXZG.js";import{a as b}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as ye}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{c as F}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as Pe}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{f as be}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import{a as ce}from"/censys/build/_shared/chunk-EZHABQF2.js";import{d as pe,f as D,k as le}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{e as me}from"/censys/build/_shared/chunk-D5QEORL2.js";import{v as k,z as ue}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{A as H,Oa as W,Pa as z,Va as ie,x as N,z as se}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as ae}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{a as ee,d as V,g as te,k as re,m as oe,p as P}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as R,c as h}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as l}from"/censys/build/_shared/chunk-2QEWK57A.js";var A=l(R(),1);var Q=l(R(),1);var Ge={detailsCertInfo:"Fjh16"};function Ke(t){let{cert:e}=t,a=e?[e]:[],o=ge(a),c=[],s=[];a.forEach(f=>{f&&(c.push(f.parsed?.subject_dn),s.push(f.parsed?.issuer_dn))});let i=new Set(c.filter(b)),p=new Set(s.filter(b)),S=i.size>=1?i.values().next().value:void 0,d=p.size>=1?p.values().next().value:void 0;return{browserTrust:o,subjectDn:S,issuerDn:d}}var T=l(h(),1);function Y({webAggregate:t}){let{browserTrust:e,subjectDn:a,issuerDn:o}=(0,Q.useMemo)(()=>Ke(t),[t]),c=(0,Q.useMemo)(()=>e||a||o,[e,a,o]);return(0,T.jsxs)("div",{className:N(Ge.detailsCertInfo),children:[(0,T.jsx)(U,{iconName:"award",children:"Certificate Information"}),c?(0,T.jsxs)($,{children:[(0,T.jsx)(_,{label:"Browser Trust",content:e&&(0,T.jsx)(We,{aggregatedStatus:e.aggregatedStatus})}),(0,T.jsx)(_,{label:"Subject DN",content:a}),(0,T.jsx)(_,{label:"Issuer DN",content:o})]}):(0,T.jsx)(H,{variant:se.DEFAULT_ITALICS,children:"No Certificate Information Found"})]})}var G=l(R(),1);var j={detailsSummary:"d4DeX",whiteText:"WbU8l"};var Ze=l(h(),1);function qe(t,e,a){let{endpoints:o=[]}=t;return{serviceTags:o.map(s=>{let{port:i,endpoint_type:p,path:S}=s,d,f="",I=fe(s);if(I)d=(0,Ze.jsx)(Me,{application:I});else{let{truncatedLabel:E,tooltipContent:m}=Be(i,p,S);f=m,d=E}let L=Te(s);return{label:d,href:`${e}${a?`?${a}`:""}#${L}`,id:L,tooltip:f}}).filter(b)}}function Je(t){return`${t} ${t>1?"Total ":""}${Pe("Endpoint",t)}`}var u=l(h(),1);function K({baseLink:t,webAggregate:e}){let[a]=D([0]),[o]=P(),c=ke(e.software,!0),{serviceTags:s}=(0,G.useMemo)(()=>{let p=new URLSearchParams(o);return qe(e,t,p.toString())},[e,t,o]),i=(0,G.useMemo)(()=>s.slice(0,20),[s]);return(0,u.jsxs)("div",{className:N(j.detailsSummary),children:[(0,u.jsx)(U,{iconName:"file-list-2",children:"Summary"}),(0,u.jsxs)($,{children:[(0,u.jsx)(Ve,{label:"Software",items:c,listComponent:p=>(0,u.jsx)(ie,{content:(0,u.jsxs)(H,{className:j.whiteText,children:["Search Censys for web properties ",(0,u.jsx)("br",{})," with this software"," ",a?"CPE":"version"]}),children:(0,u.jsx)(ce,{variant:"ghost",href:$e(p,"web.software",a),children:p.label})})}),(0,u.jsx)(_,{label:Je(s.length),content:i.length>0&&(0,u.jsx)(we,{tags:i,maxVisibleRows:i.length,tagSize:"md"})})]})]})}var q=l(R(),1);var v={overviewHeaderContainer:"wy57t",contentTop:"kExPA",popoverContainer:"C3Ima",contentTopItems:"BmuFm",actions:"gWs4O",assetType:"tvUiK",contentBottom:"_2amWn",tagsSection:"aCvGp",tagsIcon:"Tkzpf",portText:"rQDWv"};function tt(t){let e=t?.cert?.fingerprint_sha256,a=[];return e&&a.push({sectionName:"Related Certificates",links:[{linkText:"With the same certificate used in scan",linkIcon:"award",linkTo:k({field:"cert.fingerprint_sha256",value:e,kind:0})},{linkText:"With the same host name",linkIcon:"computer",linkTo:k({field:"cert.names",value:t.hostname,kind:0})}]}),a.push({sectionName:"Related Web Properties",links:[{linkText:"With the same host name",linkIcon:"computer",linkTo:k({field:"web.hostname",value:t.hostname,kind:0})}]}),a}var n=l(h(),1),ut={popover:v.popoverContainer};function J({baseRoute:t,webAggregate:e,hasScanData:a}){let o=te(),[c]=P(),s=c.toString(),i=tt(e),[p]=D([5]),S=e.scan_time,d=[...e.labels].map(g=>g.value).sort(),f=o.collectionId?`/collections/${o.collectionId}/results`:"/censys",I=`${e.hostname}:${e.port}`,L=(0,q.useMemo)(()=>Ne(e.vulns),[e.vulns]),E=p&&e.vulns.length>0,m=(0,q.useMemo)(()=>e.threats.map(g=>g.name).filter(b),[e.threats]),[C,B]=D([19,11]),M=C||B;return(0,n.jsxs)("div",{className:v.overviewHeaderContainer,children:[(0,n.jsxs)("div",{className:v.contentTop,children:[(0,n.jsxs)("div",{className:v.contentTopItems,children:[(0,n.jsx)(Ye,{children:(0,n.jsx)(Ue,{hostname:e.hostname,port:e.port,customClassNames:{port:v.portText}})}),(0,n.jsx)(ye,{variant:"dot"}),(0,n.jsx)("div",{className:v.assetType,children:(0,n.jsx)(Xe,{assetType:"web"})})]}),(0,n.jsxs)("div",{className:v.actions,children:[(0,n.jsx)(ve,{assetId:I,assetType:"web",investigationName:`${e.hostname} Web Investigation`}),a&&(0,n.jsx)(Qe,{pivots:i,customClassNames:ut})]})]}),(0,n.jsxs)("div",{className:v.contentBottom,children:[(0,n.jsxs)("div",{className:v.tagsSection,children:[E&&(0,n.jsx)(Re,{count:e.vulns.length,severity:L,to:`${t}/cves${s?`?${s}`:""}`}),M&&m?.length>0&&(0,n.jsx)(xe,{baseURL:`${t}/threats`,threats:m}),d.length>0&&(0,n.jsx)(He,{baseURL:f,labels:d,resourceType:"web"})]}),S&&(0,n.jsx)(Ee,{timestamp:S.toString()})]})]})}var rt="details-list",ot="cves",at="raw-data",st="threats";var Z={summaryLayout:"_8Wr8D",errorWrapper:"_2YogW"};var ft=l(pt(),1),r=l(h(),1),Jr=({data:t})=>{let e;return t&&t.webAggregate&&(e=de(t.webAggregate)),[{title:e?`${e} - Web Property Summary`:"Censys"}]};function it({children:t,webAggregate:e,collectionId:a,collectionName:o,slots:c={}}){let{t:s}=F(),i=be({collectionsLabel:s("Collections"),collectionName:o,fallback:[{pathName:s("Search")}]}),p=e?he(e):"";return(0,r.jsx)(De,{initialQuery:p,breadcrumbs:i,slots:{searchHeader:o?(0,r.jsx)(Ce,{breadcrumbs:i,placeholder:s("Search within",{name:o}),collectionId:a,children:(0,r.jsx)(Ie,{})}):(0,r.jsx)(Ae,{breadcrumbs:i}),header:c.pageHeader,navTabs:c.pageNavTabs},children:t})}function dt(){let t=ue(),[e,a]=P(),{webAggregate:o,id:c,capabilities:s,collection:i,cveDetails:p,endpointsRawData:S,tlsDetailsRawData:d,threatDetails:f,csrf:I}=_e(),[L,E]=D([11,13]),m=`/web/${c}`,C="/web/:id";i&&(m=`/collections/${i.collection_id}${m}`,C=`/collections/:collectionId${C}`);let B=!!V(`${m}/cves/*`),M=!!V(`${m}/threats/*`),g=(0,A.useMemo)(()=>{let y=!!o?.endpoints?.length;return{webAggregate:o,hasScanData:y,endpointsRawData:S,tlsDetailsRawData:d,cveDetails:p,threatDetails:f,targetRoute:m}},[o,S,d,p,f,m]),O=(0,A.useMemo)(()=>{let y=e.get("isCollapsed");return y===void 0||y==="true"},[e]),nt=(0,A.useCallback)(()=>{a(y=>(y.set("isCollapsed",(!O).toString()),y),{state:t})},[O,t]),mt=(0,A.useMemo)(()=>new Set(o.threats.map(y=>y.name).filter(b)).size,[o]),{t:w}=F();return(0,r.jsx)(ne,{token:I,children:(0,r.jsx)(pe,{value:s,children:(0,r.jsx)(it,{webAggregate:o,slots:{pageHeader:(0,r.jsx)(Fe,{assetType:"web",header:(0,r.jsx)(J,{baseRoute:m,webAggregate:o,hasScanData:g.hasScanData}),isCollapsed:O||!g.hasScanData,toggle:nt,shouldShowControls:g.hasScanData,children:(0,r.jsxs)("div",{className:Z.summaryLayout,children:[(0,r.jsx)(K,{baseLink:m,webAggregate:o}),(0,r.jsx)(Y,{webAggregate:o})]})}),pageNavTabs:g.hasScanData&&(0,r.jsxs)(Oe,{children:[(0,r.jsx)(x,{id:rt,to:m,prefetch:"intent",children:w("HTTP and Application Details")}),(0,r.jsxs)(x,{id:ot,to:`${m}/cves`,prefetch:"intent",routePattern:`${C}/cves/*`,children:[(0,r.jsx)(X,{children:w("CVEs")}),(0,r.jsx)(z,{count:o.vulns.length,variant:B?W.SYSTEM:W.NEUTRAL})]}),L&&(0,r.jsxs)(x,{id:st,routePattern:`${C}/threats/*`,to:`${m}/threats`,prefetch:"none",children:[(0,r.jsx)(X,{children:w("Threats")}),(0,r.jsx)(z,{count:mt,variant:M?W.SYSTEM:W.NEUTRAL})]}),(0,r.jsx)(ze,{canViewCenseye:E,targetRoute:m,routePattern:C}),(0,r.jsx)(x,{id:at,routePattern:`${C}/data/*`,to:`${m}/data/table`,prefetch:"none",children:w("Raw Data")})]})},collectionId:i?.collection_id,collectionName:i?.name,children:(0,r.jsx)(Se,{children:(0,r.jsx)(oe,{context:g})})})})})}function Zr(){let t=re(),e=me(),a=(0,A.useContext)(ae);return(0,r.jsx)(it,{children:(0,r.jsx)("div",{className:Z.errorWrapper,children:ee(t)&&le(t.data)?(0,r.jsx)(je,{accessState:e,errorCode:t.data.code,env:a}):(0,r.jsx)(Le,{error:t})})})}export{Jr as a,dt as b,Zr as c};
