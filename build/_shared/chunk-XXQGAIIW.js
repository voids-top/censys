import{a as ae}from"/censys/build/_shared/chunk-GFDCBQTR.js";import{b as We}from"/censys/build/_shared/chunk-CUDHDFMO.js";import{a as qe}from"/censys/build/_shared/chunk-ZD7QYARS.js";import{a as Ke,b as je}from"/censys/build/_shared/chunk-KCNATP3M.js";import{a as Be}from"/censys/build/_shared/chunk-BVX6X5MK.js";import{a as ze}from"/censys/build/_shared/chunk-62I4RDM3.js";import{a as D,c as Me,e as Oe,l as Ve,m as $e}from"/censys/build/_shared/chunk-TUFJ6JAI.js";import{a as Le}from"/censys/build/_shared/chunk-6PRZAB44.js";import{a as kt}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as Fe}from"/censys/build/_shared/chunk-LQXVLPA4.js";import{a as Ie}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{F as Ue,b as Y,d as ke,f as He,z as we}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{a as Ge}from"/censys/build/_shared/chunk-ZKAH2G64.js";import{a as F}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{b as Ae}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{e as Q}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as z}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{A as C,B as p,C as I,Na as _e,Oa as X,Pa as J,Ta as De,Wa as xe,a as K,aa as Re,c as j,e as L,f as P,h as q,k as U,l as W,m as B,va as Ne,z as be}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as Pe,g as $,k as Ce,p as x}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as _,c as v}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as c}from"/censys/build/_shared/chunk-2QEWK57A.js";var S=c(_(),1);var Xe=c(_(),1);var G={eventHistoryTimeline:"EU-qS",timestampCell:"vdP2z",linkCell:"_69ZHf",detailCell:"aqnP-",checkboxCell:"rhz16",timestamp:"zru5h",emptyState:"kaCVu"};var T=c(v(),1);function ie({events:e,selectedEventTimestamps:t,onSelectedEventTimestampsChange:o,latestEventTime:r,slots:{DetailLinkComponent:a,DescriptionComponent:n}}){let s=(0,Xe.useCallback)(i=>d=>{let u=i.eventTime;d?t.length<2?o(m=>[...m,u]):o(m=>[m[1],u]):o(m=>m.filter(g=>g!==u))},[t,o]);return e.length===0?(0,T.jsx)(ke,{className:G.emptyState,title:"No events matching the selected filters were found.",iconName:"calendar-event"}):(0,T.jsx)("div",{role:"grid",className:G.eventHistoryTimeline,children:e.map((i,d)=>{let u=Ht(i,t),m=`${i.eventTime}-label`;return(0,T.jsxs)("div",{role:"row","data-testid":"timeline-event","aria-selected":u,children:[(0,T.jsx)("div",{role:"gridcell",className:G.checkboxCell,"aria-label":"Select event for comparison",children:(0,T.jsx)(xe,{"data-testid":"event-timestamp-checkbox","aria-label":"","aria-labelledby":m,checked:u,onCheckedChange:s(i)})}),(0,T.jsx)("div",{role:"gridcell",className:G.timestampCell,children:(0,T.jsx)(Fe,{id:m,timestamp:i.eventTime,className:G.timestamp,variant:"short",includeTooltip:!1})}),(0,T.jsx)("div",{role:"gridcell",className:G.linkCell,children:(0,T.jsx)(a,{event:i,isLatest:d===0,latestEventTime:r})}),(0,T.jsx)("div",{role:"gridcell",className:G.detailCell,children:(0,T.jsx)(n,{event:i})})]},i.eventTime)})})}function Ht(e,t){return t.includes(e.eventTime)}var oe=c(_(),1);var H=c(_(),1);var Qe=c(_(),1);var Ye=c(v(),1),wt="Separator",Je="horizontal",Ut=["horizontal","vertical"],Ze=Qe.forwardRef((e,t)=>{let{decorative:o,orientation:r=Je,...a}=e,n=It(r)?r:Je,i=o?{role:"none"}:{"aria-orientation":n==="vertical"?n:void 0,role:"separator"};return(0,Ye.jsx)(P.div,{"data-orientation":n,...i,...a,ref:t})});Ze.displayName=wt;function It(e){return Ut.includes(e)}var et=Ze;var h=c(_(),1);var tt=c(_(),1);var ot=c(v(),1),rt="Toggle",se=tt.forwardRef((e,t)=>{let{pressed:o,defaultPressed:r,onPressedChange:a,...n}=e,[s,i]=L({prop:o,onChange:a,defaultProp:r??!1,caller:rt});return(0,ot.jsx)(P.button,{type:"button","aria-pressed":s,"data-state":s?"on":"off","data-disabled":e.disabled?"":void 0,...n,ref:t,onClick:K(e.onClick,()=>{e.disabled||i(!s)})})});se.displayName=rt;var f=c(v(),1),A="ToggleGroup",[at,le]=j(A,[U]),it=U(),ce=h.default.forwardRef((e,t)=>{let{type:o,...r}=e;if(o==="single")return(0,f.jsx)(Ft,{...r,ref:t});if(o==="multiple")return(0,f.jsx)(Mt,{...r,ref:t});throw new Error(`Missing prop \`type\` expected on \`${A}\``)});ce.displayName=A;var[st,lt]=at(A),Ft=h.default.forwardRef((e,t)=>{let{value:o,defaultValue:r,onValueChange:a=()=>{},...n}=e,[s,i]=L({prop:o,defaultProp:r??"",onChange:a,caller:A});return(0,f.jsx)(st,{scope:e.__scopeToggleGroup,type:"single",value:h.default.useMemo(()=>s?[s]:[],[s]),onItemActivate:i,onItemDeactivate:h.default.useCallback(()=>i(""),[i]),children:(0,f.jsx)(ct,{...n,ref:t})})}),Mt=h.default.forwardRef((e,t)=>{let{value:o,defaultValue:r,onValueChange:a=()=>{},...n}=e,[s,i]=L({prop:o,defaultProp:r??[],onChange:a,caller:A}),d=h.default.useCallback(m=>i((g=[])=>[...g,m]),[i]),u=h.default.useCallback(m=>i((g=[])=>g.filter(V=>V!==m)),[i]);return(0,f.jsx)(st,{scope:e.__scopeToggleGroup,type:"multiple",value:s,onItemActivate:d,onItemDeactivate:u,children:(0,f.jsx)(ct,{...n,ref:t})})});ce.displayName=A;var[Ot,Vt]=at(A),ct=h.default.forwardRef((e,t)=>{let{__scopeToggleGroup:o,disabled:r=!1,rovingFocus:a=!0,orientation:n,dir:s,loop:i=!0,...d}=e,u=it(o),m=q(s),g={role:"group",dir:m,...d};return(0,f.jsx)(Ot,{scope:o,rovingFocus:a,disabled:r,children:a?(0,f.jsx)(W,{asChild:!0,...u,orientation:n,dir:m,loop:i,children:(0,f.jsx)(P.div,{...g,ref:t})}):(0,f.jsx)(P.div,{...g,ref:t})})}),Z="ToggleGroupItem",pt=h.default.forwardRef((e,t)=>{let o=lt(Z,e.__scopeToggleGroup),r=Vt(Z,e.__scopeToggleGroup),a=it(e.__scopeToggleGroup),n=o.value.includes(e.value),s=r.disabled||e.disabled,i={...e,pressed:n,disabled:s},d=h.default.useRef(null);return r.rovingFocus?(0,f.jsx)(B,{asChild:!0,...a,focusable:!s,active:n,ref:d,children:(0,f.jsx)(nt,{...i,ref:t})}):(0,f.jsx)(nt,{...i,ref:t})});pt.displayName=Z;var nt=h.default.forwardRef((e,t)=>{let{__scopeToggleGroup:o,value:r,...a}=e,n=lt(Z,o),s={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},i=n.type==="single"?s:void 0;return(0,f.jsx)(se,{...i,...a,ref:t,onPressedChange:d=>{d?n.onItemActivate(r):n.onItemDeactivate(r)}})}),mt=ce,dt=pt;var y=c(v(),1),pe="Toolbar",[zt,xo]=j(pe,[U,le]),me=U(),vt=le(),[Kt,ut]=zt(pe),ft=H.forwardRef((e,t)=>{let{__scopeToolbar:o,orientation:r="horizontal",dir:a,loop:n=!0,...s}=e,i=me(o),d=q(a);return(0,y.jsx)(Kt,{scope:o,orientation:r,dir:d,children:(0,y.jsx)(W,{asChild:!0,...i,orientation:r,dir:d,loop:n,children:(0,y.jsx)(P.div,{role:"toolbar","aria-orientation":r,dir:d,...s,ref:t})})})});ft.displayName=pe;var gt="ToolbarSeparator",jt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=ut(gt,o);return(0,y.jsx)(et,{orientation:a.orientation==="horizontal"?"vertical":"horizontal",...r,ref:t})});jt.displayName=gt;var qt="ToolbarButton",de=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=me(o);return(0,y.jsx)(B,{asChild:!0,...a,focusable:!e.disabled,children:(0,y.jsx)(P.button,{type:"button",...r,ref:t})})});de.displayName=qt;var Wt="ToolbarLink",Xt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=me(o);return(0,y.jsx)(B,{asChild:!0,...a,focusable:!0,children:(0,y.jsx)(P.a,{...r,ref:t,onKeyDown:K(e.onKeyDown,n=>{n.key===" "&&n.currentTarget.click()})})})});Xt.displayName=Wt;var Tt="ToolbarToggleGroup",Jt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=ut(Tt,o),n=vt(o);return(0,y.jsx)(mt,{"data-orientation":a.orientation,dir:a.dir,...n,...r,ref:t,rovingFocus:!1})});Jt.displayName=Tt;var Qt="ToolbarToggleItem",Yt=H.forwardRef((e,t)=>{let{__scopeToolbar:o,...r}=e,a=vt(o),n={__scopeToolbar:e.__scopeToolbar};return(0,y.jsx)(de,{asChild:!0,...n,children:(0,y.jsx)(dt,{...a,...r,ref:t})})});Yt.displayName=Qt;var Et=ft;var ht=de;var yt={actionBar:"Ru0yn"};var ee=c(v(),1);function ve({children:e,actions:t,ariaLabel:o}){return(0,ee.jsxs)(Et,{className:yt.actionBar,"aria-label":o,children:[e,t.map((r,a)=>(0,ee.jsx)(ht,{asChild:!0,children:r},a))]})}var ue={AT_TIME_A:"at_time_a",AT_TIME_B:"at_time_b"},fe=2;var te={compareBar:"_4v6Ji",selectedEvents:"we0eO",tooltipContent:"UpU5l"};var b=c(v(),1);function ge({selectedTimestamps:e,setSelectedTimestamps:t}){let o=$(),[r]=x(),a=(0,oe.useCallback)(()=>{t([])},[t]),n=(0,oe.useMemo)(()=>{let s=new URLSearchParams(r);return s.set(ue.AT_TIME_A,e[0]),s.set(ue.AT_TIME_B,e[1]),`${o.collectionId?`/collections/${o.collectionId}/hosts/${o.id}/events/compare`:`/hosts/${o.id}/events/compare`}?${s.toString()}`},[o.collectionId,o.id,e,r]);return e.length===0?null:(0,b.jsx)(ve,{ariaLabel:"Action bar for comparing two events",actions:[(0,b.jsxs)("div",{className:te.compareBar,children:[(0,b.jsxs)("div",{className:te.selectedEvents,"data-testid":"events-selected-timestamps",children:[(0,b.jsx)(_e,{count:e.length}),(0,b.jsx)(p,{children:` of ${fe} Selected`})]}),(0,b.jsx)(De,{content:"Select 2 events to compare",contentClassName:te.tooltipContent,children:(0,b.jsx)(Ge,{button:{variant:I.PRIMARY,disabled:e.length!==fe},link:{to:n,isExternal:!0},children:"Compare"})}),e.length>0&&(0,b.jsx)(Ke,{onClick:a})]})]})}var St=c(_(),1);var M={container:"CToH1",datePickerContainer:"_5lCC9",inlineAlert:"OkFtJ",icon:"XPzPi",viewChangesText:"VRQcU"};var k=c(v(),1);function Te({startDate:e="",endDate:t="",minDate:o}){let[r,a]=x(),n=(0,St.useCallback)((s,i)=>{let d=new URLSearchParams(r);d.set("start",s),d.set("end",i),a(d)},[r,a]);return(0,k.jsxs)("div",{className:M.container,children:[(0,k.jsx)("div",{className:M.datePickerContainer,children:(0,k.jsx)(je,{startDate:e,endDate:t,minDate:o,onApply:n})}),(0,k.jsxs)("div",{className:M.inlineAlert,children:[(0,k.jsx)(be,{name:"lightbulb",mode:"line",className:M.icon}),(0,k.jsx)(p,{"data-testid":"event-date-picker-form-inline-alert",children:"Select two events to compare."})]})]})}var Ee={detailLink:"_1bmvh",textSecondary:"EiTdG",pill:"eBKf7"};var O=c(v(),1);function he({event:e,isLatest:t,latestEventTime:o}){let[r]=x(),{id:a}=$(),n=r.get("at_time"),s=!!r.get("start"),i=n&&n!==e.eventTime||!n&&o!==e.eventTime,d=n&&e.eventTime===n||!n&&o===e.eventTime,u=a,m=t&&!s?`/hosts/${u}`:`/hosts/${u}?at_time=${e.eventTime}`;return(0,O.jsxs)("div",{className:Ee.detailLink,children:[i&&(0,O.jsx)(F,{href:m,children:"View historical host"}),d&&(0,O.jsx)(p,{className:Ee.textSecondary,children:"Currently viewing"})]})}var R={negativeScan:"PDFU5",negativeScanContainer:"-Tean",pill:"WgN9L"};function Pt(e){if(e?.scan){let{port:t,protocol:o,transportProtocol:r}=e.scan;return`${t}/${We.TransportProtocol[r]}/${o}`}return"Unknown"}function Ct(e){if(e.scan){let{port:t,endpointType:o,path:r}=e.scan;return qe(t,o,r).fullLabel}return"Unknown"}function bt(e){return e?.scan?.isSuccess??!1}var l=c(v(),1);function ye({event:e}){let t={serviceScanned:e.serviceScanned,locationUpdated:e.locationUpdated,forwardDnsResolved:e.forwardDnsResolved,reverseDnsResolved:e.reverseDnsResolved,whoisUpdated:e.whoisUpdated,routeUpdated:e.routeUpdated,endpointScanned:e.endpointScanned,jarmScanned:e.jarmScanned};if(t.serviceScanned){let o=!bt(t.serviceScanned);return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.serviceScanned}),(0,l.jsxs)("div",{className:o?R.negativeScanContainer:"",children:[(0,l.jsx)(p,{className:o?R.negativeScan:"",children:Pt(t.serviceScanned)}),o&&(0,l.jsx)(J,{size:"sm",variant:X.FEEDBACK_NEGATIVE_DEFAULT,className:R.pill,children:"Not Observed"})]})]})}if(t.locationUpdated)return(0,l.jsx)(p,{variant:C.H5,children:D.locationUpdated});if(t.forwardDnsResolved)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.forwardDnsResolved}),(0,l.jsx)(p,{children:t.forwardDnsResolved?.name})]});if(t.reverseDnsResolved)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.reverseDnsResolved}),(0,l.jsx)(p,{children:(t.reverseDnsResolved?.names||[]).join(", ")})]});if(t.whoisUpdated)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.whoisUpdated}),(0,l.jsx)(p,{children:t.whoisUpdated?.whois?.network?.name})]});if(t.routeUpdated)return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.routeUpdated}),(0,l.jsx)(p,{children:t.routeUpdated.route?.name})]});if(t.endpointScanned){let o=!t.endpointScanned?.scan?.isSuccess;return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.endpointScanned}),(0,l.jsxs)("div",{className:o?R.negativeScanContainer:"",children:[(0,l.jsx)(p,{className:o?R.negativeScan:"",children:Ct(t.endpointScanned)}),o&&(0,l.jsx)(J,{size:"sm",variant:X.FEEDBACK_NEGATIVE_DEFAULT,className:R.pill,children:"Not Observed"})]})]})}if(t.jarmScanned){let o=!t.jarmScanned?.scan?.isSuccess;return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{variant:C.H5,children:D.jarmScanned}),(0,l.jsxs)("div",{className:o?R.negativeScanContainer:"",children:[(0,l.jsx)(p,{className:o?R.negativeScan:"",children:t.jarmScanned?.scan?.fingerprint}),o&&(0,l.jsx)(J,{size:"sm",variant:X.FEEDBACK_NEGATIVE_DEFAULT,className:R.pill,children:"Not Observed"})]})]})}return(0,l.jsx)(p,{variant:C.H5,children:"Event with No Details"})}var Rt=c(_(),1);var N=c(v(),1);function Se(){let e=Q(),t=Y(e),o=Ae("ACCOUNTS_SITE_URL"),r=(0,Rt.useContext)(z),a=He(r),n=null;switch(t){case 1:n=(0,N.jsxs)(p,{children:["The Free tier does not include viewing asset history."," ",(0,N.jsx)(we,{buttonVariant:I.GHOST})," to your Organization account to view additional history."]});break;case 2:n=(0,N.jsxs)(p,{children:["The Starter tier includes one week of asset history."," ",(0,N.jsx)(F,{href:a,isExternal:!0,children:"Upgrade"})," ","to the Enterprise tier to view additional history."]});break;case 3:n=(0,N.jsx)(p,{children:"The Enterprise tier includes six months of asset history. Contact your Sales Representative to get access to extended history."});break;case 0:default:n=(0,N.jsxs)(p,{children:["The Free tier does not include viewing asset history."," ",(0,N.jsx)(F,{href:`${o}/settings/plan`,isExternal:!0,shouldOmitOrg:!1,children:"Upgrade"})," ","to the Starter or Enterprise tier to view asset history."]})}return(0,N.jsx)(ae,{content:n})}var re={events:"vwbn6",emptyState:"_6FFEn",loadMoreButton:"s6GYb"};function Nt(e,t){let o={};for(let r of e){let a=new Date(r.eventTime).getTime();o[a]=r}for(let r of t){let a=new Date(r.eventTime).getTime();o[a]=r}return Object.values(o)}var to=c(kt(),1),E=c(v(),1);function eo(){let{events:e,scannedTo:t,hasEventsBeyondEntitlement:o,host:r}=Be(),[a,n]=(0,S.useState)(e),[s,i]=(0,S.useState)(t),[d,u]=(0,S.useState)(o),m=Ue(),[g]=x(),[V,ne]=(0,S.useState)([]),_t=g.get("at_time"),Dt=Me(r,_t),xt=(0,S.useCallback)(()=>{if(s){let w=new URLSearchParams(g);w.set("scannedTo",s),m.load(`./?index&${w}`)}},[s,m.load,g]);return(0,S.useEffect)(()=>{n(e),i(t),ne([]),u(o)},[e,t,o]),(0,S.useEffect)(()=>{if(m.data){let{events:w,scannedTo:Gt}=Le(m.data);n(At=>Nt(At,w)),i(Gt),u(m.data.hasEventsBeyondEntitlement)}},[m.data]),(0,E.jsxs)("div",{"data-testid":"host-timeline-events",className:re.events,children:[(0,E.jsx)("div",{children:(0,E.jsx)(Te,{startDate:g.get("start")||"",endDate:g.get("end")||""})}),(0,E.jsx)(Ne,{children:(0,E.jsx)(ie,{events:a,selectedEventTimestamps:V,onSelectedEventTimestampsChange:ne,latestEventTime:Dt,slots:{DetailLinkComponent:he,DescriptionComponent:ye}})}),s&&!d&&(0,E.jsx)(Re,{className:re.loadMoreButton,variant:I.DEFAULT,onClick:xt,isLoading:m.state==="loading",children:"Load More"}),d&&(0,E.jsx)(Se,{}),(0,E.jsx)(ge,{selectedTimestamps:V,setSelectedTimestamps:w=>ne(w)})]})}function cn(e){let{currentParams:t,nextParams:o,currentUrl:r,nextUrl:a}=e;if(t.id!==o.id)return!0;let n=r.searchParams,s=a.searchParams;return Ve(n,s)||n.get("event_time")!==s.get("event_time")?!1:$e(e)}function pn(){let e=Ce(),t=Q(),o=Y(t),r=(0,S.useContext)(z);return(0,E.jsx)("div",{className:re.emptyState,children:Pe(e)&&Oe(e.data)?(0,E.jsx)(ze,{errorCode:e.data.code,orgState:o,env:r}):(0,E.jsx)(Ie,{error:e})})}export{eo as a,cn as b,pn as c};
