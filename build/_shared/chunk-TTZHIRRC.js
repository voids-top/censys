import{a as To,b as ho,c as Re,d as go,e as vo}from"/censys/build/_shared/chunk-JG6RDZZZ.js";import{a as Be,b as ce,c as Fe,d as Ne}from"/censys/build/_shared/chunk-YP7RGGRG.js";import{b as Eo}from"/censys/build/_shared/chunk-OV3VCMX3.js";import{a as fo}from"/censys/build/_shared/chunk-FMRIG57S.js";import{a as uo,b as F}from"/censys/build/_shared/chunk-DPQLMYXH.js";import{a as po}from"/censys/build/_shared/chunk-ISPS5TGZ.js";import{a as So,b as yo,e as Ce}from"/censys/build/_shared/chunk-OIVUAPPH.js";import{a as co}from"/censys/build/_shared/chunk-QAUM4UBV.js";import{a as to}from"/censys/build/_shared/chunk-3W2VQNCA.js";import{a as no}from"/censys/build/_shared/chunk-JC22C2KM.js";import{c as oo,e as ao,g as we,h as Ue,i as ro,j as so}from"/censys/build/_shared/chunk-6D64NL5L.js";import{b as lo}from"/censys/build/_shared/chunk-7REQVUFL.js";import{a as io,c as mo}from"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as Ae,b as J,d as j}from"/censys/build/_shared/chunk-53UREJP4.js";import{a as aa}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as ve}from"/censys/build/_shared/chunk-IJLDI467.js";import{c as jt}from"/censys/build/_shared/chunk-KGWKFMKN.js";import{a as Wt,b as Zt}from"/censys/build/_shared/chunk-DZSPRLCC.js";import{a as Xt,b as Me,c as Kt,d as qt,e as Jt}from"/censys/build/_shared/chunk-PAYW5E74.js";import{a as $t}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{c as wt,i as xe,l as zt,n as Vt,o as Gt,p as Yt}from"/censys/build/_shared/chunk-22JANVKU.js";import{a as Ft}from"/censys/build/_shared/chunk-J22KWXE5.js";import{a as Ct,b as Nt}from"/censys/build/_shared/chunk-RAMDI2JB.js";import{e as ye}from"/censys/build/_shared/chunk-DSG73WCA.js";import{e as Dt,q as xt,w as Mt}from"/censys/build/_shared/chunk-HUE44QRB.js";import{a as ge}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as De}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{c as ut}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as eo}from"/censys/build/_shared/chunk-BI4XKJZW.js";import{a as Qt}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{f as Bt}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import{b as Ut,c as D}from"/censys/build/_shared/chunk-UKMMPQ5X.js";import{a as G}from"/censys/build/_shared/chunk-EZHABQF2.js";import{b as Ot,d as Ht,f as le}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{e as Rt,f as bt,h as _t,j as Lt,k as It}from"/censys/build/_shared/chunk-D5QEORL2.js";import{u as Pt,v as q,z as kt}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{A as v,B as Z,D as St,O as yt,Oa as Se,Pa as ke,Q as ft,R as Et,Ra as At,S as Tt,Va as he,aa as ae,ba as ht,da as gt,va as Pe,wa as vt,x as te,y as oe,z as E}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as dt}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{d as s}from"/censys/build/_shared/chunk-6URBRDCL.js";import{C as pt,a as it,c as mt,d as He,g as Te,k as lt,m as ct,p as me}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as K,c as b}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as S}from"/censys/build/_shared/chunk-2QEWK57A.js";var k=S(K(),1);var Ao=S(K(),1);var A={hostDetailsLocationItems:"_54H4t",hostDetailsLocationTable:"-XqVm",hostDetailsLocationMapWrapper:"j8CmB",hostDetailsLocationContent:"OhWSL",hostDetailsLocationMap:"pCZQo",hostDetailsLocationFlag:"MDudf",hostDetailsLocationText:"_3xA8V",flagIconContainer:"HdL5p",multipleItemDetail:"_52VKz",itemLocationLine:"PbwMM",iconButton:"sf5Lf",autonomousSystem:"qe6HO"};var i=S(b(),1);function ze({host:e}){let{location:t,coordinates:r,whois:o,countryCode:a,latitude:m,longitude:l}=uo(e),c=Ot("MAPS_API_KEY"),y=(0,Ao.useMemo)(()=>!m||!l||!c?null:`https://www.google.com/maps/embed/v1/place?key=${c}&q=${m},${l}&zoom=5`,[m,l]),n=e.autonomous_system,h=n&&n.asn&&n.bgp_prefix&&n.country_code&&n.name;return(0,i.jsxs)("div",{className:te(A.hostDetailsLocation),children:[(0,i.jsx)(Re,{iconName:"map-pin-user",children:"Network and Geolocation"}),(0,i.jsxs)("div",{className:A.hostDetailsLocationItems,children:[(0,i.jsx)("div",{className:A.hostDetailsLocationTable,children:(0,i.jsxs)(Ae,{children:[(0,i.jsx)(j,{label:"WHOIS Network",content:(0,i.jsxs)("div",{className:A.multipleItemDetail,children:[(0,i.jsx)(J,{text:o.network.name&&F(e.presence_unset||[],["host.whois.network"],(0,i.jsx)(G,{variant:"ghost",href:q({kind:0,field:"host.whois.network.name",value:o.network.name}),children:o.network.name}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!0)}),o.network.handle&&(0,i.jsx)(J,{text:F(e.presence_unset||[],["host.whois.network"],(0,i.jsx)(G,{variant:"ghost",href:q({kind:0,field:"host.whois.network.handle",value:o.network.handle}),children:o.network.handle}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!1)})]})}),(0,i.jsx)(j,{label:"WHOIS Organization",content:(0,i.jsxs)("div",{className:A.multipleItemDetail,children:[(0,i.jsx)(J,{text:o.organization.name&&F(e.presence_unset||[],["host.whois.organization"],(0,i.jsx)(G,{variant:"ghost",href:q({kind:0,field:"host.whois.organization.name",value:o.organization.name}),children:o.organization.name}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!0)}),o.organization.address&&(0,i.jsx)(J,{text:F(e.presence_unset||[],["host.whois.organization"],(0,i.jsx)(G,{variant:"ghost",href:q({kind:0,field:"host.whois.organization.address",value:o.organization.address}),children:o.organization.address}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!1)}),o.organization.handle&&(0,i.jsx)(J,{text:F(e.presence_unset||[],["host.whois.organization"],(0,i.jsx)(G,{variant:"ghost",href:q({kind:0,field:"host.whois.organization.handle",value:o.organization.handle}),children:o.organization.handle}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!1)})]})}),(0,i.jsx)(j,{label:"Autonomous System",content:h&&(0,i.jsxs)("div",{className:A.multipleItemDetail,children:[n.bgp_prefix&&(0,i.jsx)(J,{text:F(e.presence_unset||[],["host.autonomous_system.bgp_prefix"],(0,i.jsx)(G,{variant:"ghost",href:q({kind:0,field:"host.autonomous_system.bgp_prefix",value:n.bgp_prefix}),children:n.bgp_prefix}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!0)}),n.name&&(0,i.jsx)(J,{text:F(e.presence_unset||[],["host.autonomous_system.name"],(0,i.jsxs)(G,{variant:"ghost",href:q({kind:0,field:"host.autonomous_system.name",value:n.name}),children:["via ",n.name]}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!1)}),n.country_code&&n.asn&&(0,i.jsx)(J,{text:F(e.presence_unset||[],["host.autonomous_system.country_code","host.autonomous_system.asn"],(0,i.jsxs)(G,{variant:"ghost",href:q({kind:0,field:"host.autonomous_system.asn",value:n.asn}),children:[n.country_code," (AS",n.asn,")"]}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!1)})]})})]})}),(0,i.jsxs)("div",{className:A.hostDetailsLocationMapWrapper,children:[y&&(0,i.jsx)("iframe",{className:A.hostDetailsLocationMap,title:"Google Map View",src:y,allowFullScreen:!0,credentialless:""}),(0,i.jsxs)("div",{className:A.hostDetailsLocationContent,children:[a&&(0,i.jsx)("div",{className:A.hostDetailsLocationFlag,children:F(e.presence_unset||[],["host.location","host.location.city","host.location.country","host.location.country_code"],(0,i.jsx)(eo,{"aria-hidden":!0,countryCode:a}),(0,i.jsx)(D,{iconClassName:A.iconButton}),!1)}),t&&(0,i.jsx)(v,{children:F(e.presence_unset||[],["host.location","host.location.city","host.location.country","host.location.country_code"],t,(0,i.jsx)(D,{iconClassName:A.iconButton}))}),r&&(0,i.jsx)(v,{className:A.hostDetailsLocationText,children:F(e.presence_unset||[],["host.location.coordinates","host.location.coordinates.latitude","host.location.coordinates.longitude"],r,(0,i.jsx)(D,{iconClassName:A.iconButton}))})]})]})]})]})}var pe=S(K(),1);var Y={hostDetailsSummary:"_1lxtH",detailTableContent:"_3Jmse",expandableList:"YnSLt",listWrapper:"_3xnF3",listElementWrapper:"chPAX",iconButton:"ZnXpj",disable:"uGO1E",lockButton:"Il2vm",listControlButton:"aUf46"};function Co(e,t,r,o){let{dns:a,services:m,operating_system:l}=e,c=a?.reverse_dns?.names?.[0],y={label:l?.product?Eo(l,!0):void 0,isLocked:e.presence_unset.includes("host.operating_system.product")},n=e.presence_unset.includes("host.dns.names")?[{label:void 0,isLocked:!0}]:(a?.names??[]).length===0?[{label:void 0,isLocked:!1}]:a?.names?.map(p=>({label:p,isLocked:!1}))||[],h=m?.filter(ge).map(p=>({label:we(p),isLocked:!1,href:Ue(p,r,o),hasThreats:p.threats?.some(L=>L.name?.trim()!=="")??!1,hasCves:!!p.vulns?.length,cveSeverity:Ce(p.vulns)}));for(let p of t)h.push({label:we(p),isLocked:!0,href:Ue(p,r,o)});return{reverseDns:c,operatingSystem:y,serviceTags:h,forwardDnsNames:n}}var C=S(b(),1),na={expandableList:Y.expandableList,listWrapper:Y.listWrapper,listElementWrapper:Y.listElementWrapper,listControlButton:Y.listControlButton};function Ve({baseLink:e,host:t,lockedServices:r}){let o=(0,pe.useRef)(null),[a]=me(),{reverseDns:m,operatingSystem:l,serviceTags:c,forwardDnsNames:y}=(0,pe.useMemo)(()=>{let u=new URLSearchParams(a);return Co(t,r,e,u.toString())},[t,r,e,a]),n=(0,pe.useCallback)(()=>{o.current&&Ft(o.current,{behavior:"auto"})},[o]),[h,p,L]=le([5,19,11]),g=p||L,O=!!h,V=!!g;return(0,C.jsxs)("div",{className:Y.hostDetailsSummary,children:[(0,C.jsx)(Re,{iconName:"file-list-2",children:"Summary"}),(0,C.jsxs)(Ae,{children:[(0,C.jsx)(j,{label:"Reverse DNS",content:t.presence_unset.includes("host.dns.reverse_dns.names")?(0,C.jsx)(D,{className:Y.iconButton}):m}),(0,C.jsx)(j,{label:"Forward DNS",content:!!t.dns?.names?.length&&(0,C.jsx)(co,{ref:o,customClassNames:na,data:y.map(u=>u.isLocked?(0,C.jsx)(D,{className:Y.iconButton}):u.label),maxVisibleRows:8,onCollapse:n,renderListElement:u=>(0,C.jsx)(v,{children:u})})}),(0,C.jsx)(j,{label:"OS",content:l.isLocked?(0,C.jsx)(D,{className:Y.iconButton}):l.label}),(0,C.jsx)(j,{label:`${c.length} Total ${Qt("Service",c.length)}`,content:(0,C.jsx)(po,{tagSize:"md",tags:c.map(u=>({...u,label:(0,C.jsx)(v,{className:u.isLocked?Y.disable:"",children:u.label}),contentRight:u.isLocked&&(0,C.jsx)(Ut,{iconClassName:Y.iconButton}),contentLeft:(0,C.jsxs)(C.Fragment,{children:[O&&u.hasCves&&u.cveSeverity&&(0,C.jsx)(So,{size:"md","aria-label":"Censys found a CVE on this service.",severity:u.cveSeverity}),V&&u.hasThreats&&(0,C.jsx)(io,{size:"md","aria-label":"Censys found a threat on this service."})]})})),maxVisibleRows:20})})]})]})}var Vo=S(K(),1);var ee=S(K(),1);var Ie=S(K(),1);var w={container:"EpuZd",stepList:"_41TnA",analysisStep:"FFhE2",header:"cGlz7",title:"_96-BC",lightText:"_5hF8z",pendingIcon:"cZpUF",runningIcon:"H053t",spin:"LKOtE",successIcon:"W6sQS",errorIcon:"_7-HhM"};var be=(a=>(a.PENDING="pending",a.RUNNING="running",a.SUCCESS="success",a.ERROR="error",a))(be||{}),_e=(o=>(o.HOST_PROFILER="host_profiler",o.SERVICE_ANALYSIS="service_orchestrator",o.MASTER_SUMMARIZER="master_summarizer",o))(_e||{});var re=s.string().optional(),X=s.object({}),ia=X.extend({type:s.literal("connection"),message:s.string()}),ma=X.extend({type:s.literal("route_error"),message:s.string()}),la=X.extend({type:s.literal("node_start"),timestamp:re,node:s.string(),message:s.string()}),ca=X.extend({type:s.literal("node_complete"),timestamp:re,node:s.string(),message:s.string(),duration_ms:s.number().nullable().optional()}),pa=X.extend({type:s.literal("sub_agent_start"),timestamp:re,parent_node:s.string(),agent:s.string(),message:s.string(),service_info:s.record(s.unknown()).nullable().optional()}),ua=X.extend({type:s.literal("sub_agent_complete"),timestamp:re,parent_node:s.string(),agent:s.string(),message:s.string(),success:s.boolean(),duration_ms:s.number().nullable().optional()}),da=X.extend({type:s.literal("task_list"),timestamp:re,node:s.string(),message:s.string(),tasks:s.array(s.string())}),Sa=X.extend({type:s.literal("token"),timestamp:re,node:s.string(),content:s.string(),metadata:s.record(s.unknown()).nullable().optional()}),ya=X.extend({type:s.literal("error"),timestamp:re,node:s.string(),agent:s.string().nullable().optional(),message:s.string(),error_details:s.string()}),fa=X.extend({type:s.literal("complete"),timestamp:re,message:s.string(),final_response:s.record(s.string(),s.unknown()),agent_outputs:s.record(s.string(),s.string()),total_duration_ms:s.number().nullable().optional(),run_id:s.string().nullable().optional()}),Ye=s.discriminatedUnion("type",[ia,ma,la,ca,pa,ua,da,Sa,ya,fa]),Ge=s.object({error:s.string().nullable(),events:s.array(Ye),status:s.nativeEnum(be)}),Ea=s.object({["service_orchestrator"]:Ge,["host_profiler"]:Ge,["master_summarizer"]:Ge.extend({durationMs:s.number().nullable(),summary:s.string().nullable(),verboseSummary:s.record(s.string(),s.string()).nullable()})}),Ta=s.object({unhandledEvents:s.array(Ye)}),gr=s.object({agentState:Ea,error:s.string().nullable(),finishedAt:s.string().nullable(),totalDurationMs:s.number().nullable(),meta:Ta,runId:s.string().nullable()}),Ro=s.object({events:s.array(s.unknown())});function bo(e){try{let t;typeof e=="string"?t=JSON.parse(e):t=e;let r=Ye.safeParse(t);return r.success?r.data:null}catch{return null}}var $e={error:null,events:[],status:"pending"},We={agentState:{["service_orchestrator"]:{...$e},["host_profiler"]:{...$e},["master_summarizer"]:{...$e,durationMs:null,summary:null,verboseSummary:null}},error:null,finishedAt:null,totalDurationMs:null,meta:{unhandledEvents:[]},runId:null};function Lo(e,t){let r=ga(t);switch(t.type){case"sub_agent_start":case"node_start":return r?ue(e,t,r,{status:"running"}):e;case"node_complete":case"sub_agent_complete":return r?ue(e,t,r,{status:"success"}):e;case"complete":{let o={...e,finishedAt:t.timestamp||Temporal.Now.instant().toString(),runId:t.run_id??null,totalDurationMs:t.total_duration_ms??null};return"summary"in t.final_response&&typeof t.final_response.summary=="string"?ue(o,t,"master_summarizer",{status:"success",summary:t.final_response.summary,verboseSummary:t.agent_outputs}):ue(o,t,"master_summarizer",{status:"error",error:"The Compass service returned the final response in an unexpected format."})}case"route_error":return r?ue(e,t,r,{error:t.message,status:"error"}):{...e,error:t.message};case"error":return r?ue(e,t,r,{error:t.error_details,status:"success"}):{...e,error:t.error_details};case"connection":case"token":default:return Aa(e,t)}return e}function ga(e){return"node"in e?_o(e.node):"agent"in e?_o(e.agent):null}var va=new Set(Object.values(_e));function _o(e){return va.has(e)?e:null}function ue(e,t,r,o){return{...e,agentState:{...e.agentState,[r]:{...e.agentState[r],...o,events:[...e.agentState[r].events,t]}}}}var Aa=(e,t)=>({...e,meta:{...e.meta,unhandledEvents:[...e.meta.unhandledEvents,t]}}),U={firstError:({error:e,agentState:t})=>e??Object.values(t).reduce((r,o)=>r??o.error,null),getAgentState:({agentState:e})=>e,getCompletionTimestamp:({finishedAt:e})=>e,getRunId:({runId:e})=>e,getSimpleSummary:({agentState:e})=>e["master_summarizer"].summary,getVerboseSummary:({agentState:e})=>e["master_summarizer"].verboseSummary};var Xe=(a=>(a.COORDINATE_ANALYSIS="coordinate-analysis",a.HOST_PROFILE="host-profile",a.ANALYZE_SERVICES="analyze-services",a.SUMMARIZE="summarize",a))(Xe||{});var Ke=e=>e===2||e===3;function Oo(e){let t=U.firstError(e)!==null,r=U.getAgentState(e),o=Ze(r["host_profiler"].status),a=Ze(r["service_orchestrator"].status),m=Ze(r["master_summarizer"].status);m===3&&!r["master_summarizer"].summary&&(m=1),m!==0&&(o=o===2?2:3,a=a===2?2:3);let l={["coordinate-analysis"]:Io(o,a),["host-profile"]:o,["analyze-services"]:a,["summarize"]:m},c=Object.values(l).reduce((y,n)=>Ke(n)?y+1:y,0);return{steps:l,hasError:t,overallStatus:t?2:Math.max(1,Io(...Object.values(l))),totalComplete:c}}function Ze(e){switch(e){case"error":return 2;case"success":return 3;case"running":return 1;case"pending":default:return 0}}function Io(...e){return e.every(t=>t===3)?3:e.some(t=>t===1)?1:Math.min(...e)}var I=S(b(),1),Le="progress-accordion",Ca={["coordinate-analysis"]:"Coordinating analysis",["host-profile"]:"Building host profile",["analyze-services"]:"Analyzing services...",["summarize"]:"Building final summary"},qe=Object.values(Xe),Ho={[2]:{icon:"close-circle-fill",className:w.errorIcon,size:"sm"},[0]:{icon:"time-fill",className:te(w.pendingIcon,w.lightText),size:"sm"},[1]:{icon:"loader-4-fill",className:w.runningIcon,size:"sm"},[3]:{icon:"checkbox-circle-fill",className:w.successIcon,size:"sm"}};function Je({analysis:e,hasConnectionError:t,isAccordionOpen:r,onSetAccordionOpen:o}){let a=(0,Ie.useCallback)(c=>{o(c===Le)},[o]),m=(0,Ie.useMemo)(()=>Oo(e),[e]),l=m.overallStatus;return t&&l!==3&&(l=2),(0,I.jsx)(vt,{"data-testid":"summary-analysis-progress",className:w.container,headerPadding:Pe.NONE,bodyPadding:Pe.NONE,children:(0,I.jsxs)(Xt,{type:"single",collapsible:!0,value:r?Le:"",onValueChange:a,children:[(0,I.jsx)(Me,{value:Le,children:(0,I.jsxs)(Kt,{className:w.header,children:[(0,I.jsxs)(v,{className:te(w.title,m.totalComplete!==qe.length&&w.lightText),children:[(0,I.jsx)(oe,{...Ho[l]}),"Generation progress (",m.totalComplete,"/",qe.length,")"]}),(0,I.jsx)("span",{children:(0,I.jsx)(qt,{asChild:!0,children:(0,I.jsx)(gt,{iconName:r?"arrow-up-s":"arrow-down-s",iconMode:"line",size:ht.SMALL,variant:Z.GHOST,"aria-label":r?"Collapse":"Expand",className:w.accordionTrigger})})})]})}),(0,I.jsx)(Me,{value:Le,children:(0,I.jsx)(Jt,{className:w.subAgentsContainer,children:(0,I.jsx)("ul",{className:w.stepList,children:qe.map(c=>(0,I.jsx)("li",{children:(0,I.jsxs)("span",{className:w.title,children:[(0,I.jsx)(oe,{...Ho[m.steps[c]]}),(0,I.jsx)(v,{className:te(!Ke(m.steps[c])&&w.lightText),children:Ca[c]})]})},c))})})})]})})}var Po={errorDetails:"AjIvC"};var fe=S(b(),1);function Ee({className:e,error:t}){return(0,fe.jsxs)(xt,{className:e,title:"Analysis Error",iconName:"error-warning",iconMode:"line",children:["Unfortunately, the summarizer encountered a fatal error. Please regenerate the summary.",(0,fe.jsx)("div",{className:Po.errorDetails,children:(0,fe.jsxs)(v,{variant:E.DEFAULT_SOURCE,children:["Error details: ",t]})})]})}var Mo=S(K(),1);var M=S(K(),1);var x={feedbackContainer:"X3Tok",feedbackTitle:"yh8BK",thumbsContainer:"_6fFww",thumbsButton:"BX5yk",commentContainer:"bidRg",thumbsIndicator:"L-umb",selectedThumb:"-GTCc",selectedThumbText:"J7pMP",commentActions:"FFqbP",submitButton:"MXRRX",feedbackError:"Y2zgh",feedbackSuccess:"RRu3J",successIcon:"RiPE2",successText:"XyEgq"};var N=S(b(),1);function je({runId:e,className:t}){let[r,o]=(0,M.useState)(null),[a,m]=(0,M.useState)(!1),[l,c]=(0,M.useState)(""),[y,n]=(0,M.useState)(!1),[h,p]=(0,M.useState)(null),L=Nt(),g=pt();(0,M.useEffect)(()=>{e&&(o(null),m(!1),c(""),n(!1),p(null))},[e]);let O=(0,M.useCallback)(f=>{o(f),m(!0),p(null)},[]),V=(0,M.useCallback)(()=>{O(1)},[O]),u=(0,M.useCallback)(()=>{O(0)},[O]),ne=(0,M.useCallback)(f=>{c(f.target.value)},[]),ie=(0,M.useCallback)(()=>{if(!e||r===null)return;p(null);let f=new FormData;f.set("csrf",L),f.set("runId",e),f.set("score",r.toString()),l.trim()&&f.set("comment",l.trim()),g.submit(f,{method:"POST",action:"/api/summary/feedback"})},[e,r,l,g,L]),H=(0,M.useCallback)(()=>{m(!1),o(null),c(""),p(null)},[]);return(0,M.useEffect)(()=>{if(g.state==="idle"&&g.data){let f=g.data;"feedback_id"in f&&f.feedback_id?(n(!0),m(!1),p(null)):"success"in f&&f.success===!1?p(f.message||"Failed to submit feedback. Please try again."):"error"in f&&typeof f.error=="string"&&p(f.error)}},[g.state,g.data]),e?(0,N.jsxs)("div",{className:te(x.feedbackContainer,t),children:[(0,N.jsx)(v,{variant:E.H6,className:x.feedbackTitle,children:"Was this summary helpful?"}),y?(0,N.jsxs)("div",{className:x.feedbackSuccess,children:[(0,N.jsx)(oe,{name:"checkbox-circle",mode:"fill",className:x.successIcon,size:"sm"}),(0,N.jsx)(v,{variant:E.SMALL,className:x.successText,children:"Thank you for your feedback!"})]}):(0,N.jsxs)(N.Fragment,{children:[a?(0,N.jsxs)("div",{className:x.commentContainer,children:[(0,N.jsxs)("div",{className:x.thumbsIndicator,children:[(0,N.jsx)(oe,{name:r===1?"thumb-up":"thumb-down",mode:"fill",className:x.selectedThumb,size:"sm"}),(0,N.jsx)(v,{variant:E.SMALL,className:x.selectedThumbText,children:r===1?"Thumbs up":"Thumbs down"})]}),(0,N.jsx)(St,{placeholder:"Tell us more about your experience (optional)",value:l,onChange:ne,disabled:g.state!=="idle",isFullWidth:!0,rows:3}),(0,N.jsxs)("div",{className:x.commentActions,children:[(0,N.jsx)(ae,{variant:Z.DEFAULT,onClick:ie,disabled:g.state!=="idle",className:x.submitButton,children:g.state!=="idle"?"Submitting...":"Submit"}),(0,N.jsx)(ae,{variant:Z.GHOST,onClick:H,disabled:g.state!=="idle",children:"Cancel"})]})]}):(0,N.jsxs)("div",{className:x.thumbsContainer,children:[(0,N.jsx)(ae,{variant:Z.GHOST,iconLeft:"thumb-up",onClick:V,className:x.thumbsButton,disabled:g.state!=="idle",children:"Yes"}),(0,N.jsx)(ae,{variant:Z.GHOST,iconLeft:"thumb-down",onClick:u,className:x.thumbsButton,disabled:g.state!=="idle",children:"No"})]}),h&&(0,N.jsx)(v,{variant:E.SMALL,className:x.feedbackError,children:h})]})]}):null}var P={container:"Is1p3",summaryResult:"_0clWk",skeleton:"sdAkQ",verboseOutput:"PVq68",error:"EaB4R",errorDetails:"_9f8px",markdownList:"hsyit",markdownListItem:"_-57N-",markdownContent:"XuTCl",markdownHeading:"CjdNa"};var Q=S(b(),1),ko=[300,280,290,300,310,150],Na=ko.toReversed();function Do(){return(0,Q.jsxs)("div",{className:P.skeleton,children:[(0,Q.jsx)(ye,{variant:E.H1,color:"heading",width:200}),ko.map((e,t)=>(0,Q.jsx)("div",{className:P.skeletonItem,children:(0,Q.jsx)(ye,{variant:E.DEFAULT,width:e})},`skeleton-row-${t}`)),(0,Q.jsx)(ye,{variant:E.H1,color:"heading",width:180}),Na.map((e,t)=>(0,Q.jsx)("div",{children:(0,Q.jsx)(ye,{variant:E.DEFAULT,width:e})},`skeleton-row-${t}`))]})}var R=S(b(),1),$=(e={})=>({component:v,props:e}),Ra={h1:$({className:P.markdownHeading,variant:E.H1}),h2:$({className:P.markdownHeading,variant:E.H2}),h3:$({className:P.markdownHeading,variant:E.H3}),h4:$({className:P.markdownHeading,variant:E.H4}),h5:$({className:P.markdownHeading,variant:E.H5}),h6:$({className:P.markdownHeading,variant:E.H6}),ul:{component:e=>(0,R.jsx)("ul",{...e,className:P.markdownList})},ol:{component:e=>(0,R.jsx)("ol",{...e,className:P.markdownList})},li:{component:({children:e,...t})=>(0,R.jsx)("li",{...t,className:P.markdownListItem,children:(0,R.jsx)(v,{children:e})})},strong:$({variant:E.DEFAULT_SEMIBOLD}),em:$({variant:E.DEFAULT_ITALICS}),p:$(),code:$({variant:E.DEFAULT_SOURCE}),pre:$({variant:E.SMALL_SOURCE})},xo={disableAutoLink:!0,overrides:Ra};function Qe({analysis:e}){let[t,r]=(0,Mo.useState)("simple"),o=It(),a=U.getRunId(e),m=U.getSimpleSummary(e),l=U.getVerboseSummary(e),c=U.firstError(e),y=!!m,n;return c?n=(0,R.jsx)(Ee,{error:c}):t==="simple"?m===null?n=(0,R.jsx)(v,{children:"Failed to load simple summary."}):n=(0,R.jsx)(xe,{options:xo,children:m}):l===null?n=(0,R.jsx)(v,{children:"Failed to load verbose summary."}):n=(0,R.jsx)("div",{className:P.verboseOutput,children:Object.entries(l).map(([h,p])=>(0,R.jsxs)("div",{className:P.agent,children:[(0,R.jsx)(v,{variant:E.H1,children:h}),(0,R.jsx)(xe,{options:xo,children:p})]},h))}),(0,R.jsxs)("div",{className:P.container,children:[!c&&(0,R.jsxs)(Ne,{children:[(0,R.jsx)(Fe,{id:`analysis-${"simple"}`,isActive:t==="simple",onClick:()=>r("simple"),children:"Simple"}),(0,R.jsx)(Fe,{id:`analysis-${"verbose"}`,isActive:t==="verbose",onClick:()=>r("verbose"),children:"Verbose"})]}),(0,R.jsx)("div",{className:P.summaryResult,"data-testid":"summary-result",children:y||c?n:(0,R.jsx)(Do,{})}),o&&y&&(0,R.jsx)(je,{runId:a})]})}var et="summarize-host-label";var wo="app/hosts/summary/";var se={content:"DOoBk",container:"puhDD",titleContainer:"faFxK",title:"j3W-U",subtitle:"R2K3c",body:"qZoIt",accordionTrigger:"bjT2Y",accordionIcon:"VJg97",accordionContent:"eE-SY",subAgentsContainer:"_1zy7r",submitButton:"R71Ho",clearButton:"hbjPR"};var tt={analysis:null,events:[],error:null,connectionState:"disconnected",isAccordionOpen:!1,isPopoverOpen:!1},_a=new Set(["error","route_error","complete"]);function Bo(e,t){switch(t.type){case"reset":return tt;case"clear-analysis":return{...e,analysis:null,error:null,connectionState:"disconnected"};case"load-analysis":return{...e,analysis:t.payload,error:null,connectionState:"disconnected"};case"new-analysis":return{...e,analysis:We,error:null,connectionState:"connecting",isAccordionOpen:!0};case"set-is-accordion-open":return{...e,isAccordionOpen:t.payload};case"set-is-popover-open":return{...e,isPopoverOpen:t.payload};case"set-connection-established":return{...e,connectionState:t.payload};case"error":return{...e,error:t.payload};case"receive-event":{let r=bo(t.payload),o=r&&_a.has(r.type)?"disconnected":"connected";return r===null?{...e,connectionState:o,error:"Failed to validate stream event format",events:[...e.events,t.payload]}:{...e,connectionState:o,events:[...e.events,t.payload],analysis:Lo(e.analysis??We,r)}}default:return e}}var de={firstError:({error:e,analysis:t})=>e??(t&&U.firstError(t)),getAgentState:({analysis:e})=>e&&U.getAgentState(e),getCompletionTimestamp:({analysis:e})=>e&&U.getCompletionTimestamp(e),getRunId:({analysis:e})=>e&&U.getRunId(e),getAnalysis:({analysis:e})=>e,hasReceivedAnyEvents:({events:e})=>e.length>0,isConnected:({connectionState:e})=>e==="connected",isConnecting:({connectionState:e})=>e==="connecting",isDisconnected:({connectionState:e})=>e==="disconnected",isAccordionOpen:({isAccordionOpen:e})=>e,isPopoverOpen:({isPopoverOpen:e})=>e};var W=S(K(),1);function Fo({isDisconnected:e,onError:t,onReceiveEvent:r,onTimeout:o,streamUrl:a}){let m=(0,W.useRef)(t),l=(0,W.useRef)(r),c=(0,W.useRef)(o);(0,W.useEffect)(()=>{m.current=t,l.current=r,c.current=o},[t,r]),(0,W.useEffect)(()=>{if(e||!a)return;let y=!0,n=new EventSource(a),h;function p(){h=setTimeout(()=>{c.current(),L()},1e4)}function L(){y=!1,clearTimeout(h),n.removeEventListener("error",O),n.removeEventListener("message",g),n.close()}function g(V){clearTimeout(h),y&&(l.current(V),p())}function O(){clearTimeout(h),y&&(m.current(),L())}return n.addEventListener("message",g),n.addEventListener("error",O),p(),L},[e,a])}var La={events:[]};function zo(e,t){let r=`${wo}${t??"free"}/${e}`,[o,a]=(0,W.useReducer)(Bo,tt);return(0,W.useEffect)(()=>{a({type:"reset"});let m=Wt(r,Ro,La);if(m.events.length>0)for(let l of m.events)a({type:"receive-event",payload:l})},[r]),(0,W.useEffect)(()=>{o.analysis&&U.getSimpleSummary(o.analysis)&&Zt(r,{events:o.events})},[o.analysis,r]),[o,a]}var _=S(b(),1);function ot({hostIp:e,className:t}){let r=bt(),[o,a]=zo(e,r?.organizationId),m=de.isDisconnected(o),l=de.isConnected(o),c=de.getAnalysis(o),y=de.getCompletionTimestamp(o),n=(0,ee.useMemo)(()=>{let u=`/api/asset/summary/${e}?t=${Date.now()}`;return r?.organizationId&&(u=`${u}&org=${r.organizationId}`),u},[e,r?.organizationId]),h=(0,ee.useCallback)(u=>{a({type:"receive-event",payload:u.data})},[]),p=(0,ee.useCallback)(()=>{a({type:"set-connection-established",payload:"disconnected"}),a({type:"error",payload:"Error establishing connection to server"})},[]),L=(0,ee.useCallback)(()=>{a({type:"set-connection-established",payload:"disconnected"}),a({type:"error",payload:"Connection timeout - please try again"})},[]);Fo({isDisconnected:m,streamUrl:n,onError:p,onReceiveEvent:h,onTimeout:L});let g=(0,ee.useCallback)(u=>{a({type:"set-is-popover-open",payload:u}),!o.analysis&&u&&a({type:"new-analysis"})},[o]),O=(0,ee.useCallback)(()=>{a({type:"new-analysis"})},[]),V=(0,ee.useCallback)(u=>{a({type:"set-is-accordion-open",payload:u})},[]);return(0,_.jsxs)(yt,{open:o.isPopoverOpen,onOpenChange:g,children:[(0,_.jsx)(he,{content:"Summarize Host with AI",tabIndex:-1,children:(0,_.jsx)(ft,{asChild:!0,children:(0,_.jsx)(ae,{"data-testid":"summarize-host",variant:Z.DEFAULT,iconLeft:"sparkling-2",iconLeftMode:"fill",className:t,children:"Summarize Host"})})}),(0,_.jsx)(Et,{children:(0,_.jsx)(Tt,{className:se.content,"aria-labelledby":et,align:"end",children:(0,_.jsxs)("div",{className:se.container,"data-testid":"summary-popover",children:[(0,_.jsxs)("header",{children:[(0,_.jsxs)("div",{className:se.titleContainer,children:[(0,_.jsx)(v,{id:et,variant:E.H1,className:se.title,children:"Host Summary"}),(0,_.jsx)(ae,{variant:Z.DEFAULT,iconLeft:"reset-left",iconLeftMode:"line",onClick:O,className:se.clearButton,disabled:!m,children:"Regenerate"})]}),(0,_.jsxs)("div",{className:se.subtitle,children:[l&&(0,_.jsx)(v,{variant:E.H5,children:"Generating..."}),!l&&!!y&&(0,_.jsx)(ve,{labelText:"Generated",variant:"long",timestamp:y})]})]}),(0,_.jsxs)("section",{className:se.body,children:[!!c&&(0,_.jsx)(Je,{analysis:c,hasConnectionError:o.error!==null,isAccordionOpen:de.isAccordionOpen(o),isConnectionEstablished:l,onSetAccordionOpen:V}),o.error?(0,_.jsx)(Ee,{error:o.error}):!!c&&(0,_.jsx)(Qe,{analysis:c})]})]})})})]})}var z={overviewHeaderContainer:"_7pK9h",contentTop:"_3lb1q",section:"Tstol",textIcon:"_3lmsn",historicalTag:"nLQ1e",contentBottom:"U6LgS",tagsSection:"KoaXW",contentRow:"Pdkf2",tagsIcon:"HIwAN",breadcrumbHeader:"qLo7u",breadcrumbSeparator:"gIJY9",trailLink:"_0w1UJ",scanBtn:"tDRqP"};var T=S(b(),1);function at({baseRoute:e,cveCount:t,cveSeverity:r,ip:o,isLatest:a,isTruncated:m,tags:l,lastUpdatedAt:c,threats:y}){let[n]=le([10]),h=_t("compass-ai-summary"),p=Lt(),[L]=me(),g=mt(),O=Te(),V=O.collectionId?`/collections/${O.collectionId}/results`:"/censys",u=(0,Vo.useMemo)(()=>{let f=new URLSearchParams(L);return f.delete("at_time"),`${g.pathname}?${f.toString()}`},[L,g]),ne=L.toString(),ie=`${ne?`?${ne}`:""}`,H=!a&&!!L.get("at_time");return(0,T.jsxs)("div",{className:z.overviewHeaderContainer,children:[(0,T.jsxs)("div",{className:z.contentTop,children:[(0,T.jsxs)("div",{className:z.section,children:[m&&(0,T.jsx)(he,{content:"Truncated",children:(0,T.jsx)(oe,{size:"md",name:"eye-off",mode:"line",className:z.textIcon,"data-testid":"truncated-icon","aria-hidden":!0})}),(0,T.jsx)(vo,{children:o}),(0,T.jsx)(De,{variant:"dot"}),(0,T.jsx)(go,{assetType:"host"}),H&&(0,T.jsx)(At,{className:z.historicalTag,size:"sm",children:"Historical"})]}),(0,T.jsxs)("div",{className:z.section,children:[(0,T.jsx)(Dt,{assetId:o,assetType:"host",investigationName:`${o} Host Investigation`}),n&&(0,T.jsx)(jt,{entityId:o,rescanResourceType:"UNKNOWN_HOST",className:z.scanBtn,scanTime:c}),h&&p&&(0,T.jsx)(ot,{hostIp:o,className:z.summarizeBtn})]})]}),(0,T.jsxs)("div",{className:z.contentBottom,children:[(0,T.jsxs)("div",{className:z.tagsSection,children:[t>0&&(0,T.jsx)(yo,{count:t,severity:r,to:`${e}/cves${ie}`}),y?.length>0&&(0,T.jsx)(mo,{baseURL:`${e}/threats${ie}`,threats:y}),l&&l.length>0&&(0,T.jsx)(fo,{baseURL:V,labels:l,resourceType:"host"})]}),c&&(0,T.jsxs)("div",{className:z.contentRow,children:[(0,T.jsx)(ve,{timestamp:c}),H&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(De,{variant:"line--vertical",spacing:6}),(0,T.jsx)(G,{href:u,"aria-label":"Link to latest",children:"See Latest"})]})]})]})]})}var rt={summaryLayout:"_9rY0X",errorWrapper:"YYWsZ"};var Ha=S(aa(),1),d=S(b(),1),ti=({data:e})=>[{title:e?.id?`${e.id} - Host Summary`:"Censys"}];function Go({children:e,id:t,slots:r={},collectionId:o,collectionName:a}){let{t:m}=ut(),l=t.toLowerCase(),c=Bt({collectionsLabel:m("Collections"),collectionName:a,fallback:[{pathName:m("Search")}]}),y=Pt({kind:0,field:"host.ip",value:l});return(0,d.jsx)(Gt,{initialQuery:y,breadcrumbs:c,slots:{searchHeader:a?(0,d.jsx)(zt,{breadcrumbs:c,placeholder:m("Search within",{name:a}),collectionId:o,children:(0,d.jsx)(Yt,{})}):(0,d.jsx)(Vt,{breadcrumbs:c}),header:r.pageHeader,navTabs:r.pageNavTabs},children:e})}function Oa(){let[e,t]=me(),{atTime:r,cveDetails:o,host:a,servicesRawData:m,id:l,isLatest:c,capabilities:y,collection:n,flashMessage:h,lockedServices:p,csrf:L,threatDetails:g}=to(),O=kt(),[V,u,ne]=le([19,11,13]),ie=u||V,H=`/hosts/${l}`,f="/hosts/:id";n&&(H=`/collections/${n.collection_id}${H}`,f=`/collections/:collectionId${f}`);let Yo=!!He(`${H}/cves/*`),$o=!!He(`${H}/threats/*`),Wo=(0,k.useMemo)(()=>({collection:n,cveDetails:o,host:a,servicesRawData:m,lockedServices:p,threatDetails:g}),[a,n,o,m,p,g]),Oe=(0,k.useMemo)(()=>e.get("isCollapsed")===void 0||e.get("isCollapsed")==="true",[e]),Zo=(0,k.useCallback)(()=>{let B=new URLSearchParams(e);B.set("isCollapsed",(!Oe).toString()),t(B,{state:O})},[Oe,e,O]),Xo=(0,k.useMemo)(()=>Array.from(new Set([...a.labels.map(B=>B.value)||[],...a.services.flatMap(B=>B.labels.map(oa=>oa.value))||[]])),[a]),Ko=(0,k.useMemo)(()=>Array.from(new Set(a.services.flatMap(B=>B.threats).map(B=>B.name).filter(ge))).sort(),[a]),qo=!!a?.labels?.some(B=>B.value.toLowerCase()==="truncated"),st=(0,k.useMemo)(()=>ro(a),[a]),Jo=(0,k.useMemo)(()=>so(a),[a]),jo=(0,k.useMemo)(()=>Ce(a.services.flatMap(B=>B.vulns)),[a]),[Qo,nt]=(0,k.useState)(h!==null);(0,k.useEffect)(()=>{h&&nt(!0)},[h]);let{iconName:ea,description:ta}=(0,k.useMemo)(()=>lo(a.hardware),[a]);return(0,d.jsx)(Ht,{value:y,children:(0,d.jsx)(Ct,{token:L,children:(0,d.jsx)(Go,{id:l,slots:{pageHeader:(0,d.jsx)(To,{assetType:"host",iconName:ea,description:ta,header:(0,d.jsx)(at,{baseRoute:H,cveCount:y[5]?st:0,cveSeverity:jo,ip:l,isLatest:c,isTruncated:qo,tags:Xo,lastUpdatedAt:oo(a,r)||void 0,threats:ie?Ko:[]}),isCollapsed:Oe,toggle:Zo,children:(0,d.jsxs)("div",{className:rt.summaryLayout,children:[(0,d.jsx)(Ve,{baseLink:H,host:a,lockedServices:p}),(0,d.jsx)(ze,{host:a})]})}),pageNavTabs:(0,d.jsxs)(Ne,{children:[(0,d.jsx)(ce,{id:"services",to:H,children:"Services"}),(0,d.jsx)(ce,{id:"eventHistory",routePattern:`${f}/events/*`,to:`${H}/events`,children:"Event History"}),(0,d.jsx)(ce,{id:"cves",routePattern:`${f}/cves/*`,to:`${H}/cves`,children:(0,d.jsxs)(Be,{children:["CVEs"," ",(0,d.jsx)(ke,{count:st,variant:Yo?Se.SYSTEM:Se.NEUTRAL})]})}),u&&(0,d.jsx)(ce,{id:"threats",routePattern:`${f}/threats/*`,to:`${H}/threats`,prefetch:"none",children:(0,d.jsxs)(Be,{children:["Threats"," ",(0,d.jsx)(ke,{count:Jo,variant:$o?Se.SYSTEM:Se.NEUTRAL})]})}),(0,d.jsx)(ho,{canViewCenseye:ne,targetRoute:H,routePattern:f}),(0,d.jsx)(ce,{id:"rawData",routePattern:`${f}/data/*`,to:`${H}/data/table`,prefetch:"none",children:"Raw Data"})]})},collectionId:n?.collection_id,collectionName:n?.name,children:(0,d.jsxs)(wt,{children:[(0,d.jsx)(ct,{context:Wo}),h&&Qo&&(0,d.jsx)(Mt,{onDismiss:()=>{nt(!1)}})]})})})})}function oi(){let e=lt(),t=Te(),r=Rt(),o=(0,k.useContext)(dt);return(0,d.jsx)(Go,{id:t.id||"",children:(0,d.jsx)("div",{className:rt.errorWrapper,children:it(e)&&ao(e.data)?(0,d.jsx)(no,{accessState:r,errorCode:e.data.code,env:o}):(0,d.jsx)($t,{error:e})})})}export{ti as a,Oa as b,oi as c};
