import{a as to,b as oo}from"/censys/build/_shared/chunk-ZWMFGUZT.js";import{a as eo}from"/censys/build/_shared/chunk-QA66J4VQ.js";import{a as qo}from"/censys/build/_shared/chunk-NM5TSDRZ.js";import{b as ae}from"/censys/build/_shared/chunk-OV3VCMX3.js";import{a as ge}from"/censys/build/_shared/chunk-FMRIG57S.js";import{a as jr}from"/censys/build/_shared/chunk-ZORAMBCF.js";import{a as Jr}from"/censys/build/_shared/chunk-X4CXZ5YA.js";import{a as ro}from"/censys/build/_shared/chunk-ZD7QYARS.js";import{a as Xe}from"/censys/build/_shared/chunk-ISPS5TGZ.js";import{a as Zr,b as Ze,e as fe}from"/censys/build/_shared/chunk-OIVUAPPH.js";import{a as Or}from"/censys/build/_shared/chunk-AKZYFWPJ.js";import{b as Br,c as Ge,d as Ke,i as zr,k as qr,l as Qr}from"/censys/build/_shared/chunk-6D64NL5L.js";import{a as Gr}from"/censys/build/_shared/chunk-JZYLTBAZ.js";import{a as ue,b as Xr}from"/censys/build/_shared/chunk-7REQVUFL.js";import{a as Yr,c as Ye}from"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as he,c as Kr,d as D}from"/censys/build/_shared/chunk-53UREJP4.js";import{b as Qe}from"/censys/build/_shared/chunk-NEH6M55V.js";import{a as $r}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as zo}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as qe}from"/censys/build/_shared/chunk-IJLDI467.js";import{a as Vr}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{q as Ur}from"/censys/build/_shared/chunk-22JANVKU.js";import{a as Pr}from"/censys/build/_shared/chunk-J6D36YFI.js";import{b as Be,g as ze}from"/censys/build/_shared/chunk-ATOZ4ARP.js";import{b as Dr,c as yt,d as Ir,e as F}from"/censys/build/_shared/chunk-DSG73WCA.js";import{B as vt,q as Hr,r as Rr,s as ft,t as _r,u as gt,v as St}from"/censys/build/_shared/chunk-HUE44QRB.js";import{g as Cr,i as br,l as Lr}from"/censys/build/_shared/chunk-Z3PARXZG.js";import{a as G}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as A}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{a as Ar}from"/censys/build/_shared/chunk-437XWWKH.js";import{c as S}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as Wr}from"/censys/build/_shared/chunk-BI4XKJZW.js";import{a as Tt}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as xr}from"/censys/build/_shared/chunk-WJT5ZZXK.js";import{d as Mr,e as Fr}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import{a as wr,c as kr}from"/censys/build/_shared/chunk-UKMMPQ5X.js";import{b as fr,p as Nr,q as Er}from"/censys/build/_shared/chunk-WJEUPJRQ.js";import{a as E}from"/censys/build/_shared/chunk-EZHABQF2.js";import{d as hr,f as de,j as ur}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{e as Ve}from"/censys/build/_shared/chunk-D5QEORL2.js";import{D as We,E as Tr,F as $e,H as Oe,n as gr,p as Sr,q as ht,r as vr,u as ut,x as yr}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{$ as mr,A as f,B as oe,Va as Ue,Z as Ie,_ as pr,aa as be,ta as pe,va as dr,wa as me,x as ce,y as cr,z as u}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as lr}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{a as rr,c as Z,g as J,i as or,k as ar,l as sr,p as le,r as ir,z as nr}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as _,c as l}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as i}from"/censys/build/_shared/chunk-2QEWK57A.js";var Ee=i(_(),1);var Je=i(_(),1);var Ct={sidebar:"_6BA67",sidebarContent:"_9-GNN"};var bt=i(l(),1);function Le({children:e,className:t,...a}){let o=(0,Je.useRef)(null);return(0,Je.useEffect)(()=>{let r=()=>{if(!o.current)return;let s=o.current.getBoundingClientRect();o.current.style.setProperty("--sidebar-top-position",`${s.top}px`)},n=new ResizeObserver(r);return o.current&&n.observe(o.current),r(),()=>{n.disconnect()}},[]),(0,bt.jsx)("aside",{ref:o,className:ce(Ct.sidebar,t),...a,children:(0,bt.jsx)("div",{className:Ct.sidebarContent,children:e})})}var je={skeletonFilterCategory:"xBuHn",category:"vQGbz",filter:"OneKU"};var K=i(l(),1);function Se({items:e=3}){return(0,K.jsxs)("div",{className:je.skeletonFilterCategory,children:[(0,K.jsxs)("div",{className:je.category,children:[(0,K.jsx)(cr,{icon:"arrow-down-s-line",size:"sm"}),(0,K.jsx)(F,{variant:u.H5,color:"heading",width:100})]}),Array.from(Array(e).keys()).map((t,a)=>(0,K.jsxs)("div",{className:je.filter,children:[(0,K.jsx)(F,{width:100}),(0,K.jsx)(F,{variant:u.SMALL,width:25,color:"secondary"})]},a))]})}var Lt={skeletonFilterSidebar:"Erl6u",skeletonContent:"_4sYK9"};var $=i(l(),1);function ve({isEmpty:e}){return(0,$.jsx)(Le,{className:Lt.skeletonFilterSidebar,children:!e&&(0,$.jsxs)("div",{role:"menu","aria-busy":!0,className:Lt.skeletonContent,children:[(0,$.jsx)(Se,{}),(0,$.jsx)(A,{variant:"line--horizontal",size:"100%"}),(0,$.jsx)(Se,{items:4}),(0,$.jsx)(A,{variant:"line--horizontal",size:"100%"}),(0,$.jsx)(Se,{items:5}),(0,$.jsx)(A,{variant:"line--horizontal",size:"100%"}),(0,$.jsx)(Se,{})]})})}var w={card:"UFC99",header:"_9P5QI",assetDetails:"cIoWU",headerText:"-RtEs",cardBody:"q39jD",labels:"c0uoO",columns:"-bzy-",detailRows:"X3IvY",detailRow:"By-re",label:"wfw-2",services:"_0FM1c",divider:"_3W6oC"};var v=i(l(),1);function se(){return(0,v.jsx)(Dr,{className:w.card,header:(0,v.jsxs)("div",{className:w.header,children:[(0,v.jsxs)("div",{className:w.assetDetails,children:[(0,v.jsx)(Ir,{size:50,shape:"round"}),(0,v.jsxs)("div",{className:w.headerText,children:[(0,v.jsx)(F,{variant:u.SMALL_NUMERAL,width:200}),(0,v.jsx)(A,{variant:"dot",inheritColor:!0}),(0,v.jsx)(F,{variant:u.H5,width:100,color:"secondary"})]})]}),(0,v.jsx)(F,{width:160})]}),children:(0,v.jsxs)("div",{className:w.cardBody,children:[(0,v.jsx)("div",{className:w.labels,children:Array.from({length:3}).map((e,t)=>(0,v.jsx)(yt,{},t))}),(0,v.jsxs)("div",{className:w.columns,children:[(0,v.jsxs)("div",{className:w.detailRows,children:[(0,v.jsx)(Nt,{width:120}),(0,v.jsx)(Nt,{width:100}),(0,v.jsx)(Nt,{width:150})]}),(0,v.jsxs)("div",{className:w.services,children:[(0,v.jsx)(F,{variant:u.SMALL,width:100,color:"secondary"}),(0,v.jsx)("div",{className:w.labels,children:Array.from({length:2}).map((e,t)=>(0,v.jsx)(yt,{size:"small",width:60},t))})]})]}),(0,v.jsx)(A,{className:w.divider,variant:"line--horizontal",size:"100%",inheritColor:!0}),(0,v.jsxs)("div",{className:w.detailRow,children:[(0,v.jsx)("div",{className:w.label,children:(0,v.jsx)(F,{width:120,color:"secondary"})}),(0,v.jsx)(F,{width:90})]})]})})}var Nt=({width:e})=>(0,v.jsxs)("div",{className:w.detailRow,children:[(0,v.jsx)("div",{className:w.label,children:(0,v.jsx)(F,{variant:u.SMALL,color:"secondary",width:e-10})}),(0,v.jsx)(F,{width:e})]});var et={resultsContainer:"A6s6D",resultsText:"_1Qurq",resultCards:"umhsr"};var P=i(l(),1);function Ne(){let{t:e}=S();return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(ve,{}),(0,P.jsxs)("div",{className:et.resultsContainer,children:[(0,P.jsx)("div",{className:et.resultsText,children:(0,P.jsx)(f,{children:e("Searching every corner of the internet...")})}),(0,P.jsxs)("div",{className:et.resultCards,"data-testid":"search-loading",children:[(0,P.jsx)(se,{}),(0,P.jsx)(se,{}),(0,P.jsx)(se,{}),(0,P.jsx)(se,{})]})]})]})}var ao={contentWrapper:"HAjRM"};var so="field",io="num_buckets",no="50";function lo(e,t,a,o){let r=`?q=${a}&${so}=${e}&${io}=${no}`,n="report";t(o?`/collections/${o}/${n}/data/table${r}`:`/censys/${n}/data/table${r}`)}function tt(e,t){return $e(e)?Sr[e].filter(o=>t.has(We(o))):[]}var rt=i(l(),1);function co({filters:e,dataSets:t,applyFilter:a,viewAggregation:o}){let r=ht.every(s=>!e[s]?.buckets?.length),n=s=>{let c=tt(s,t),p=c.length===1?c[0]:s;return e[s]?.buckets.length?(0,rt.jsx)(Jr,{onApplyFilter:a,onViewAggregation:Tr(s)||p!==s?o:void 0,field:s,buckets:e[s].buckets,title:vr[s]},s):null};return(0,rt.jsx)(Le,{"aria-label":"Select a filter to narrow down your results",children:!r&&(0,rt.jsx)("div",{className:ao.contentWrapper,children:ht.map(n)})})}var Et=i(l(),1);function Ht({queryDataSets:e}){let{q:t,submitSearch:a}=Oe(),[o]=le(),r=Fr(),n=Rr(),s=Pr(()=>{let m=[["q",t],["data_sets",e.join(",")]];return r?.collection_id&&m.push(["collection_id",r.collection_id]),`/api/filters?${new URLSearchParams(m).toString()}`},[t,r?.collection_id,JSON.stringify(e)]),c=(0,Ee.useMemo)(()=>new Set(e),[e]),p=(0,Ee.useCallback)((m,g,y)=>{let b;if(Array.isArray(m)){if(m.length===0)return;let C=m.filter(X=>c.has(gr.DataSet.DATA_SET_UNSPECIFIED)||c.has(We(X))),N=C.reduce((X,De)=>yr(X,ut({kind:0,field:De,value:g}),"or",!1),"");if(C.length===0)return;let re=C.length>1;a({q:y?re?`not (${N})`:`not ${N}`:re?`(${N})`:N});return}if(m==="type"){let C;switch(g){case"cert":C="cert.fingerprint_sha256";break;case"web":C="web.port";break;case"host":default:C="host.ip";break}b={field:C,kind:1,value:"*",escape:!1}}else b={kind:0,field:m,value:g};let W=ut(b);a({q:y?`not ${W}`:W})},[a,c]),d=(0,Ee.useCallback)(m=>{if($e(m)){let g=tt(m,c);if(g.length===1)m=g[0];else return}lo(m,n,o.get("q")??"",r?.collection_id)},[n,o,r?.collection_id,c]);return s.state===0||s.state===2?(0,Et.jsx)(ve,{isEmpty:s.state===2}):(0,Et.jsx)(co,{applyFilter:p,dataSets:c,filters:s.data.filters,viewAggregation:d})}var Zt=i(_(),1);var po=e=>!e||!e.certificate?null:{fingerprint_sha256:e.certificate.fingerprint_sha256,parsed:{subject:{common_name:e.certificate.parsed?.subject?.common_name||[]},subject_dn:e.certificate.parsed?.subject_dn,issuer_dn:e.certificate.parsed?.issuer_dn,validity_period:{not_before:e.certificate.parsed?.validity_period?.not_before,not_after:e.certificate.parsed?.validity_period?.not_after},signature:{self_signed:e.certificate.parsed?.signature?.self_signed||!1}},modified_at:e.certificate.modified_at,added_at:e.certificate.added_at,names:e.certificate.names,validation:{chrome:{is_valid:e.certificate.validation?.chrome?.is_valid||!1,ever_valid:e.certificate.validation?.chrome?.ever_valid||!1,type:e.certificate.validation?.chrome?.type||"UNKNOWN"},apple:{is_valid:e.certificate.validation?.apple?.is_valid||!1,ever_valid:e.certificate.validation?.apple?.ever_valid||!1,type:e.certificate.validation?.apple?.type||"UNKNOWN"},microsoft:{is_valid:e.certificate.validation?.microsoft?.is_valid||!1,ever_valid:e.certificate.validation?.microsoft?.ever_valid||!1,type:e.certificate.validation?.microsoft?.type||"UNKNOWN"},nss:{is_valid:e.certificate.validation?.nss?.is_valid||!1,ever_valid:e.certificate.validation?.nss?.ever_valid||!1,type:e.certificate.validation?.nss?.type||"UNKNOWN"}}},mo=e=>!e||!e.host?null:{ip:e.host.ip,labels:e.host.labels?.map(t=>({value:t.value})),location:{city:e.host.location?.city,country:e.host.location?.country,country_code:e.host.location?.country_code,province:e.host.location?.province},autonomous_system:{asn:e.host.autonomous_system?.asn,name:e.host.autonomous_system?.name},dns:{reverse_dns:{names:e.host.dns?.reverse_dns?.names}},operating_system:e.host.operating_system,service_count:e.host.service_count,services:e.host.services?.map(t=>({port:t.port,protocol:t.protocol,scan_time:t.scan_time,transport_protocol:t.transport_protocol,labels:t.labels.map(a=>({value:a.value})),vulns:t.vulns||[],threats:t.threats||[],endpoints:t.endpoints||[],software:t.software||[]})),hardware:e.host.hardware},ho=e=>!e||!e.web?null:{hostname:e.web.hostname,port:e.web.port,cert:e.web.cert,software:e.web.software,labels:e.web.labels,scan_time:e.web.scan_time,endpoints:e.web.endpoints,vulns:e.web.vulns||[],threats:e.web.threats||[]},ot=e=>e.includes("/collections");function uo(e){let t={asset_id:void 0,asset_type:void 0,date_updated:void 0,display_name:void 0};return e.host?.host?(t.asset_type="host",t.asset_id=e.host.host.ip,t.display_name=t.asset_id,t.date_updated=Ge(e.host.host)):e.certificate?.certificate?(t.asset_type="certificate",t.asset_id=e.certificate.certificate.fingerprint_sha256,t.display_name=Be(e.certificate.certificate.parsed,t.asset_id),t.date_updated=e.certificate.certificate.modified_at?.toString()):e.web?.web&&(t.asset_type="web property",t.asset_id=`${e.web.web.hostname}:${e.web.web.port}`,t.display_name=t.asset_id,t.date_updated=e.web.web.scan_time?.toString()),t.asset_id&&t.asset_type?t:null}var j={resultTips:"gg5cP",headline:"_4juzy",tipList:"kBc-8",source:"ZnvKT"};var T=i(l(),1);function Rt(){let{t:e}=S();return(0,T.jsxs)("div",{className:j.resultTips,"data-testid":"empty-results",children:[(0,T.jsx)(f,{className:j.headline,variant:u.H1_SUB_HEADLINE,children:e("Your query returned no results.")}),(0,T.jsx)(f,{variant:u.DEFAULT_SEMIBOLD,children:e("Quick tips:")}),(0,T.jsxs)("ul",{className:j.tipList,children:[(0,T.jsxs)("li",{children:[(0,T.jsxs)(f,{children:[e("Try searching using a")," ",(0,T.jsx)(f,{className:j.source,variant:u.DEFAULT_SOURCE,children:e("key:value")})," ",e("pair. The")," "]}),(0,T.jsx)(E,{href:"/home/definitions",title:"View Data Definitions",children:e("Data Definitions")})," ",(0,T.jsx)(f,{children:e("page provides a list of keys.")})]}),(0,T.jsx)("li",{children:(0,T.jsxs)(f,{children:[e("Don't know the value? Use a wildcard")," ",(0,T.jsx)(f,{className:j.source,variant:u.DEFAULT_SOURCE,children:"(*)"})," ",e("instead to return hosts that have any value for the field.")]})}),(0,T.jsx)("li",{children:(0,T.jsxs)(f,{children:[e("Use the exact operator")," ",(0,T.jsx)(f,{className:j.source,variant:u.DEFAULT_SOURCE,children:"="})," ",e("to restrict results to exact matches.")]})})]}),(0,T.jsx)(f,{variant:u.DEFAULT_SEMIBOLD,children:e("For more information:")}),(0,T.jsx)("ul",{className:j.tipList,children:(0,T.jsxs)("li",{children:[(0,T.jsx)(f,{children:e("Read the")})," ",(0,T.jsx)(E,{href:"https://docs.censys.com/docs/censys-query-language#/",isExternal:!0,children:e("Introduction to Censys Query Language")})," ",(0,T.jsx)(f,{children:e("for information on writing queries.")})]})})]})}var _t=i(l(),1);function fo(){let e=Z();return ot(e.pathname)?(0,_t.jsx)(jr,{}):(0,_t.jsx)(Rt,{})}var at={searchResults:"pd2r0",resultsContainer:"W63L-",resultCards:"rAnPY"};var yo=i(_(),1);var go=i(_(),1);function At(e,t){if(!t)return[];let a=new Map,o=[];for(let r of t){let n=r.protocol,s=r.port,c=r.transport_protocol;if(n&&s!==void 0&&c!==void 0){let p=s===0,d=Qr(r),m=`${p?Br:s} / ${d}`,g=`${e}#${Ke(r)}`,y={label:m,href:g};r.vulns?.length>0&&(y.vulns=r.vulns),r.threats?.length>0&&(y.threats=r.threats),a.has(n)?o.push(y):a.set(n,y)}}return[...a.values(),...o]}var ee=i(l(),1);function He({services:e=[],baseURL:t,shouldShowCves:a=!1,shouldShowThreats:o=!1,maxVisibleServices:r=10,customClassNames:n}){let s=(0,go.useMemo)(()=>At(t,e).map(g=>{let y=a&&!!g.vulns?.length,b=o&&(g.threats?.some(W=>W.name?.trim()!=="")??!1);return{href:g.href,label:g.label,contentLeft:(y||b)&&(0,ee.jsxs)(ee.Fragment,{children:[y&&(0,ee.jsx)(Zr,{"aria-label":"Censys found a CVE on this service.",severity:fe(g.vulns)}),b&&(0,ee.jsx)(Yr,{"aria-label":"Censys found a threat on this service."})]})}}),[t,e,a,o]),c=Math.max(0,s.length-r),p=c>0?`Show ${c} more`:"",d="Show less";return s.length?(0,ee.jsx)(Xe,{customClassNames:n,tags:s,maxVisibleRows:r,expandTextOverride:p,collapseTextOverride:d,hasWrappingTrigger:!0}):null}var Re={highlightItem:"wGlhw",highlightMatchWithMatchedServices:"ZZzMX",highlightMatchWithoutMatchedServices:"_3z1h2",servicesListWrapper:"cXIgt"};var te=i(l(),1),Go=4;function wt({highlight:e,targetURL:t,shouldShowCves:a,shouldShowThreats:o}){let r=e.services.length>0;return(0,te.jsxs)("div",{className:Re.highlightItem,children:[(0,te.jsx)("dt",{children:(0,te.jsx)(Kr,{children:e.field})}),(0,te.jsxs)("dd",{children:[(0,te.jsx)(xr,{highlightVariant:e.negative?"negative":"default",typographyVariant:u.SMALL_SOURCE,pre:e.segment?.pre,match:e.segment?.match,post:e.segment?.post,className:ce(r?Re.highlightMatchWithMatchedServices:Re.highlightMatchWithoutMatchedServices)}),(0,te.jsx)(He,{services:e.services,baseURL:t,shouldShowCves:a,shouldShowThreats:o,maxVisibleServices:Go,customClassNames:{listWrapper:Re.servicesListWrapper}})]})]})}var O={tooltipContent:"pyTFj",tooltipTrigger:"-Ncht",ctaIcon:"pXkFN",highlightListSection:"-Mtxq",headerContainer:"gRgfD",header:"_0C6as",headerText:"BPv3Q",dividerLine:"KgSpn",highlightList:"OmLts",none:"xiRoh"};var Ko=/^host\.services\[(\d+)\]/;function So(e,t){if(!e.length)return[];let a=new Map;for(let r of e){let n=`${r.field}-${r.segment?.match}`;a.has(n)||a.set(n,[]),a.get(n)?.push(r)}let o=[];for(let r of a.values()){let n=r[0],s=new Set;for(let c of r){let p=c.json_path?.match(Ko),d=p?parseInt(p[1],10):null;d!==null&&d<t.length&&!isNaN(d)&&s.add(t[d])}o.push({...n,services:Array.from(s).sort((c,p)=>(c.port||0)-(p.port||0))})}return o}var I=i(l(),1),Yo="Highlights the exact fields in each result that match your query terms.";function st({listKey:e,highlights:t,hasHighlightEntitlement:a,services:o=[],ip:r}){let{t:n}=S(),s=J(),c=s.id?`/collections/${s.id}/hosts/${r}`:`/hosts/${r}`,p=(0,yo.useMemo)(()=>So(t,o),[t,o]),[d,m]=de([5,11]);return typeof a!="boolean"?null:(0,I.jsxs)("div",{className:O.highlightListSection,children:[(0,I.jsxs)("div",{className:O.headerContainer,children:[(0,I.jsxs)(f,{className:O.header,variant:u.H5,as:"span",children:[(0,I.jsx)(wr,{icon:"lightbulb-flash-line",iconLabel:"Matched Fields",content:Yo,side:"left",contentClassName:O.tooltipContent,triggerClassName:O.tooltipTrigger}),(0,I.jsx)("span",{className:O.headerText,children:n("Matched Fields")}),(0,I.jsx)("span",{className:O.dividerLine})]}),!a&&(0,I.jsx)("span",{className:O.ctaIcon,children:(0,I.jsx)(kr,{action:"search"})})]}),a&&(0,I.jsx)("dl",{className:O.highlightList,children:p.length>0?p.map((g,y)=>(0,I.jsx)(wt,{highlight:g,targetURL:c,shouldShowCves:d,shouldShowThreats:m},`${e}-${g.field}-${y}`)):(0,I.jsx)(f,{variant:u.DEFAULT_ITALICS,className:O.none,children:n("None")})})]})}var Co=i(_(),1);var To={paginationContainer:"hG1k9"};var ye=i(l(),1);function kt({nextCursor:e,pageLimitMessage:t,previousCursor:a,onCursorChange:o}){let{t:r}=S(),n=Ur(),s=(0,Co.useCallback)(p=>()=>{n(),o(p||void 0)},[o,n]),c=(0,ye.jsx)(be,{onClick:s(e),disabled:!e||!!t,variant:oe.DEFAULT,iconRight:t?"lock-star":"arrow-right-s",iconRightMode:"line",type:"submit",value:e?.toString(),name:"cursor",children:r("Next")});return(0,ye.jsxs)("div",{className:To.paginationContainer,children:[(0,ye.jsx)(be,{onClick:s(a),disabled:!a,variant:oe.DEFAULT,iconLeft:"arrow-left-s",iconLeftMode:"line",type:"submit",value:a?.toString(),name:"cursor",children:r("Previous")}),t!==null?(0,ye.jsx)(Ue,{content:t,children:c}):c]})}var Te={resultHeader:"TAmZh",suffix:"vtoPM",durationNumber:"RTJVc",gray8:"E-l0f",downloadButton:"GTBhI"};var k=i(l(),1);function xt({durationMs:e,currentPageSize:t,totalHits:a,onDownloadCsv:o}){let r=Gr(a),n=(e/1e3).toFixed(2),{t:s}=S();return(0,k.jsxs)("div",{className:Te.resultHeader,children:[(0,k.jsx)(f,{"aria-hidden":!0,variant:u.H5,children:s("Results:")}),(0,k.jsx)(f,{variant:u.H4,className:Te.gray8,"aria-label":`${r} ${Tt("result",a)}`,children:r}),(0,k.jsx)(A,{"aria-hidden":!0,variant:"dot",size:4,spacing:6}),(0,k.jsx)(f,{"aria-hidden":!0,variant:u.H5,children:s("Duration:")}),(0,k.jsxs)(f,{variant:u.H4,className:Te.durationNumber,"aria-label":`The query took ${n} seconds to complete`,children:[n,(0,k.jsx)("span",{className:Te.suffix,children:"s"})]}),o&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(A,{"aria-hidden":!0,variant:"line--vertical"}),(0,k.jsx)(Ue,{content:"Download the current page of results as a CSV",tabIndex:-1,children:(0,k.jsxs)(be,{className:Te.downloadButton,iconLeft:"download-2",variant:oe.TERTIARY,onClick:o,"data-testid":"download-button",children:["Download CSV (",(0,k.jsx)(pr,{value:t})," page"," ",Tt("result",t),")"]})})]})]})}var ie={cardHeaderContainer:"KidRo",cardHeaderContent:"ZW9k0",cardHeaderContentLeft:"lJbkl",displayNameContent:"SMBE7",displayName:"qnT0K",cardHeaderContentRight:"rv7Bo"};var bo=i(_(),1);function it(e){return!!e&&typeof e=="object"&&"code"in e&&ur(e.code)}function z(){let e=Z();return(0,bo.useMemo)(()=>({lastSearch:e}),[e])}function nt(e,t){return Temporal.Instant.compare(e,t)<0?t:e}var U=i(l(),1);function Pt({hit:{fingerprint_sha256:e,parsed:t,modified_at:a},baseURL:o}){let r=Be(t,e),n=z(),{t:s}=S();return(0,U.jsxs)("div",{className:ie.cardHeaderContainer,children:[(0,U.jsx)(ue,{assetType:"certificate",size:"md"}),(0,U.jsxs)("div",{className:ie.cardHeaderContent,children:[(0,U.jsxs)("div",{className:ie.cardHeaderContentLeft,children:[(0,U.jsx)("div",{className:ie.displayNameContent,children:(0,U.jsx)(E,{state:n,href:o,title:s("View Details",{displayName:r}),variant:"nav",size:"lg",children:(0,U.jsx)("span",{className:ie.displayName,children:r})})}),(0,U.jsx)(A,{variant:"dot"}),(0,U.jsx)(f,{variant:u.H5,children:s("Certificate")})]}),(0,U.jsx)("div",{className:ie.cardHeaderContentRight,children:a&&(0,U.jsx)(qe,{timestamp:a.toString()})})]})]})}var Eo=i(_(),1);var No={tableContainer:"elFe6"};var q=i(l(),1);function Mt(e){let{t}=S(),{parsed:a,names:o}=e,r=(0,Eo.useMemo)(()=>ze([e])?.aggregatedStatus,[e]);return(0,q.jsx)("div",{className:No.tableContainer,children:(0,q.jsxs)(he,{children:[(0,q.jsx)(D,{label:t("Issuer"),content:a?.issuer_dn}),(0,q.jsx)(D,{label:t("Validity Period"),content:(0,q.jsx)(eo,{before:a?.validity_period?.not_before,after:a?.validity_period?.not_after})}),(0,q.jsx)(D,{label:t("Browser Trust"),content:r&&(0,q.jsx)(Qe,{aggregatedStatus:r})}),(0,q.jsx)(D,{label:t("All Names"),content:o&&o.join(" ")})]})})}var lt={cardBodyContent:"rlZPP",labelOverview:"VYjDV"};var Q=i(l(),1);function Ft({hit:e,labels:t,children:a}){let o=J(),r=o.id?`/collections/${o.id}/certificates/${e.fingerprint_sha256}`:`/certificates/${e.fingerprint_sha256}`,n=o.id?`/collections/${o.id}/results`:"/censys",s=t.length>0;return(0,Q.jsx)("div",{"data-testid":"cert-details-card",children:(0,Q.jsxs)(me,{variant:pe.INTERACTIVE,header:(0,Q.jsx)(Pt,{hit:e,baseURL:r}),children:[(0,Q.jsxs)("div",{className:lt.cardBody,children:[s?(0,Q.jsx)("div",{className:lt.labelOverview,children:(0,Q.jsx)(ge,{baseURL:n,labels:t,resourceType:"certificate"})}):null,(0,Q.jsx)("div",{className:lt.cardBodyContent,children:(0,Q.jsx)(Mt,{...e})})]}),a]})})}var xe=i(_(),1);var ct=i(_(),1);var Ce={container:"nphuy",ip:"apoUv",cardHeaderContent:"_5xwlU",noMargin:"YdqcL",dnsText:"YBVJJ"};var B=i(l(),1);function Dt({historyLimitDays:e,hit:t,baseURL:a}){let{ip:o,dns:r}=t,n=z(),s=(0,ct.useMemo)(()=>{let g=Ge(t);return!g||qr(g,e)?void 0:g},[e,t]),c=(0,ct.useMemo)(()=>`${a}${s?`?at_time=${encodeURIComponent(nt(Temporal.Instant.from(s),Temporal.Now.instant().subtract({hours:24})).toString())}`:""}`,[a,s]),{t:p}=S(),{iconName:d,description:m}=(0,ct.useMemo)(()=>Xr(t.hardware),[t]);return(0,B.jsxs)("div",{className:Ce.container,children:[(0,B.jsx)(ue,{assetType:"host",size:"md",iconName:d,description:m}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("div",{className:Ce.cardHeaderContent,children:[(0,B.jsx)(E,{state:n,href:c,title:p("View Details",{displayName:o}),variant:"nav",size:"lg",children:(0,B.jsx)("div",{className:Ce.ip,children:o})}),(0,B.jsx)(A,{variant:"dot"}),(0,B.jsx)(f,{className:Ce.noMargin,variant:u.H5,children:p("Host")})]}),r?.reverse_dns?.names&&r.reverse_dns.names.length>0&&(0,B.jsx)(f,{className:Ce.dnsText,children:r?.reverse_dns?.names[0]})]})]})}var Ho={locationValue:"KUSQD"};var M=i(l(),1);function It({location:e,autonomous_system:t,operating_system:a,hardware:o}){let{t:r}=S(),n=o?ae(o,!0):null,s=a?ae(a,!0):null,c=t?(0,M.jsx)(Xo,{asn:t}):null,p=e?(0,M.jsx)(Zo,{location:e}):null;return(0,M.jsx)("div",{children:(0,M.jsxs)(he,{children:[n?(0,M.jsx)(D,{label:r("Hardware"),content:n}):null,s?(0,M.jsx)(D,{label:r("OS"),content:s}):null,c?(0,M.jsx)(D,{label:r("Network (AS)"),content:c}):null,p?(0,M.jsx)(D,{label:r("Location"),content:(0,M.jsxs)("span",{className:Ho.locationValue,children:[p,e?.country_code&&(0,M.jsx)(Wr,{size:"sm",countryCode:e.country_code})]})}):null]})})}function Xo({asn:e}){return!e.name||!e.asn?null:(0,M.jsxs)(f,{children:[e.name," (",e.asn,")"]})}function Zo({location:e}){let t=e?.province?.toLowerCase()===e?.city?.toLowerCase();return(0,M.jsxs)(f,{children:[e.city,!t&&e.province?", ":" ",!t&&e.province?`${e.province} `:"","(",e.country_code?.toUpperCase(),")"]})}var pt={tagList:"RT4RN",tagListTitle:"nG--r",container:"FkQYJ"};var Ae=i(l(),1);function we({title:e,children:t}){return(0,Ae.jsx)("div",{className:pt.container,children:(0,Ae.jsxs)("div",{className:pt.tagList,children:[(0,Ae.jsx)(f,{variant:u.SMALL,className:pt.tagListTitle,children:e}),t]})})}var Ut=i(l(),1);function Wt({hit:{service_count:e,services:t=[]},baseURL:a,shouldShowCves:o,shouldShowThreats:r}){let{t:n}=S(),s=Ie(e||t.length);return s?(0,Ut.jsx)(we,{title:`${n("Services")} (${s})`,children:(0,Ut.jsx)(He,{services:t,baseURL:a,shouldShowCves:o,shouldShowThreats:r,maxVisibleServices:20})}):null}var _o=i(_(),1);function Ro(e,t){if(!t)return[];let a=new Map;for(let o of t)if(o.software?.length)for(let r of o.software){let n=ae(r,!0);if(!n)continue;let s=`${e}#${Ke(o)}`,c={label:n,href:s};a.has(n)||a.set(n,c)}return Array.from(a.values())}var $t=i(l(),1);function ne({title:e,tags:t,maxVisibleTags:a,customClassNames:o}){let r=Ie(t.length),n=Math.max(0,t.length-a),s=n>0?`Show ${n} more`:"",c="Show less";return t.length?(0,$t.jsx)(we,{title:`${e} (${r})`,children:(0,$t.jsx)(Xe,{customClassNames:o,tags:t,maxVisibleRows:a,expandTextOverride:s,collapseTextOverride:c,hasWrappingTrigger:!0})}):null}var Ao=i(l(),1);function Bt({hit:e,baseURL:t}){let{t:a}=S(),o=(0,_o.useMemo)(()=>Ro(t,e.services),[t,e.services]);return o.length?(0,Ao.jsx)(ne,{title:a("Software"),tags:o,maxVisibleTags:10}):null}var ke={cardBody:"HeEGH",cardBodyContent:"_9VJbz",labelOverview:"nEiB1"};function wo(e){return Array.from(new Set([...e.labels.map(t=>t.value).filter(G),...e.services.flatMap(t=>t.labels).map(t=>t.value).filter(G)])).sort()}function ko(e){return Array.from(new Set(e.services.flatMap(t=>t.threats).map(t=>t.name).filter(G))).sort()}var x=i(l(),1);function zt({historyLimitDays:e,hit:t,children:a}){let[o,r,n]=de([5,19,11]),s=r||n,c=!!o,p=!!s,d=J(),m=d.id?`/collections/${d.id}/hosts/${t.ip}`:`/hosts/${t.ip}`,g=d.id?`/collections/${d.id}/results`:"/censys",y=z(),b=(0,xe.useMemo)(()=>zr(t),[t]),W=(0,xe.useMemo)(()=>fe(t.services.flatMap(X=>X.vulns)),[t]),C=(0,xe.useMemo)(()=>wo(t),[t]),N=(0,xe.useMemo)(()=>ko(t),[t]),re=c&&b>0||p&&N?.length>0||C.length>0;return(0,x.jsx)("div",{className:ke.cardOuterContainer,"data-testid":"hostDetailsCard",children:(0,x.jsxs)(me,{variant:pe.INTERACTIVE,header:(0,x.jsx)(Dt,{hit:t,baseURL:m,historyLimitDays:e}),headerPadding:dr.NONE,children:[(0,x.jsxs)("div",{className:ke.cardBody,children:[re?(0,x.jsxs)("div",{className:ke.labelOverview,children:[p&&N?.length>0&&(0,x.jsx)(Ye,{baseURL:`${m}/threats`,threats:N}),c&&b>0&&(0,x.jsx)(Ze,{count:b,severity:W,state:y,to:`${m}/cves`}),(0,x.jsx)(ge,{baseURL:g,labels:C,resourceType:"host"})]}):null,(0,x.jsxs)("div",{className:ke.cardBodyContent,children:[(0,x.jsx)(It,{...t}),(0,x.jsxs)("div",{children:[(0,x.jsx)(Wt,{hit:t,baseURL:`${m}?isCollapsed=true`,shouldShowCves:c,shouldShowThreats:p}),(0,x.jsx)(Bt,{hit:t,baseURL:`${m}?isCollapsed=true`})]})]})]}),a]})})}var Yt=i(_(),1);var xo=i(l(),1);function qt({endpointTags:e}){let{t}=S();return(0,xo.jsx)(ne,{title:t("Endpoints"),tags:e,maxVisibleTags:20})}function Qt(e){try{let t=new URL(e);return t.pathname.endsWith("/")?t.host+t.pathname.slice(0,-1):t.host+t.pathname}catch{return e}}var Po=i(_(),1);var Y={hostIdentifier:"ZQENU",cardHeaderContainer:"pUZEp",cardHeaderContent:"DAdrn",cardHeaderContentLeft:"aLB-C",portNumber:"TcVSz",webProperty:"VFObq",cardHeaderContentRight:"_3eYla"};var V=i(l(),1);function Gt({baseURL:e,hostname:t,port:a,timestamp:o}){let r=`${t}:${a}`,n=(0,Po.useMemo)(()=>`${e}${o?`?at_time=${encodeURIComponent(nt(Temporal.Instant.from(o),Temporal.Now.instant().subtract({hours:24})).toString())}`:""}`,[e,o]),s=z(),{t:c}=S();return(0,V.jsxs)("div",{className:Y.cardHeaderContainer,children:[(0,V.jsx)(ue,{assetType:"web",size:"md"}),(0,V.jsxs)("div",{className:Y.cardHeaderContent,children:[(0,V.jsxs)("div",{className:Y.cardHeaderContentLeft,children:[(0,V.jsx)(E,{state:s,href:n,title:c("View Details",{displayName:r}),variant:"nav",size:"lg",children:(0,V.jsx)(to,{hostname:t,port:a,customClassNames:{hostIdentifier:Y.hostIdentifier,port:Y.portNumber}})}),(0,V.jsx)(A,{variant:"dot"}),(0,V.jsx)(f,{className:Y.webProperty,variant:u.H5,children:c("Web Property")})]}),(0,V.jsx)("div",{className:Y.cardHeaderContentRight,children:o&&(0,V.jsx)("div",{className:Y.timestamp,children:(0,V.jsx)(qe,{timestamp:o})})})]})]})}var Mo=i(_(),1);var Fo=i(l(),1);function Kt({hit:e,baseURL:t}){let{t:a}=S(),o=(0,Mo.useMemo)(()=>e.software.map(r=>({href:`${t}`,label:ae(r,!0)})),[t,e.software]);return o.length?(0,Fo.jsx)(ne,{title:a("Software"),tags:o,maxVisibleTags:10}):null}var Pe={cardBody:"vANBs",cardBodyContent:"AH0l1",labelOverview:"dttWW"};var Uo=i(l(),1);function Do(e,t){let a=e.scan_time,o=Array.from(new Set(e.labels.flatMap(s=>s.value))).sort(),r=ze(e.cert?[e.cert]:[])?.aggregatedStatus,n=e?.endpoints?.map(s=>{if(!s)return null;let{port:c,endpoint_type:p,path:d}=s,m,g="",y=Cr(s);if(y)m=(0,Uo.jsx)(oo,{variant:u.SMALL,application:y});else{let{truncatedLabel:W,tooltipContent:C}=ro(c,p,d);g=C,m=W}let b=br(s);return{label:m,href:`${t}?isCollapsed=true#${b}`,id:b,isApplication:!!y,tooltip:g}}).filter(G).sort((s,c)=>Number(c.isApplication)-Number(s.isApplication))||[];return{timestamp:a,labels:o,aggregatedStatus:r,endpointTags:n}}function Io(e){return Array.from(new Set(e.threats.map(t=>t.name).filter(G))).sort()}var L=i(l(),1);function Xt({hit:e,children:t}){let[a,o,r]=de([5,19,11]),s=!!(o||r),{hostname:c,port:p,endpoints:d,vulns:m,threats:g}=e,y=J(),b=`${Qt(c)}:${p}`,W=z(),C=y.id?`/collections/${y.id}/web/${b}`:`/web/${b}`,N=y.id?`/collections/${y.id}/results`:"/censys";if(!c||typeof p>"u")return null;let{timestamp:re,labels:X,aggregatedStatus:De,endpointTags:$o}=(0,Yt.useMemo)(()=>Do(e,C),[e]),dt=(0,Yt.useMemo)(()=>Io(e),[g]),Oo=Lr(d),{t:tr}=S(),Bo=a&&m.length>0||s&&dt?.length>0||X.length>0;return(0,L.jsxs)(me,{variant:pe.INTERACTIVE,header:(0,L.jsx)(Gt,{baseURL:C,hostname:Qt(c),port:p,timestamp:re?.toString()}),children:[(0,L.jsxs)("div",{className:Pe.cardBody,children:[Bo?(0,L.jsxs)("div",{className:Pe.labelOverview,children:[s&&dt?.length>0&&(0,L.jsx)(Ye,{baseURL:`${C}/threats`,threats:dt}),a&&m.length>0&&(0,L.jsx)(Ze,{count:m.length,severity:fe(m),state:W,to:`${C}/cves`}),(0,L.jsx)(ge,{baseURL:N,labels:X,resourceType:"web"})]}):null,(0,L.jsxs)("div",{className:Pe.cardBodyContent,children:[(0,L.jsx)("div",{className:Pe.tableContainer,children:(0,L.jsxs)(he,{children:[(0,L.jsx)(D,{label:tr("HTML Title"),content:Oo}),(0,L.jsx)(D,{label:tr("Browser Trust"),content:De!==void 0&&(0,L.jsx)(Qe,{aggregatedStatus:De})})]})}),(0,L.jsxs)("div",{children:[(0,L.jsx)(qt,{endpointTags:$o}),(0,L.jsx)(Kt,{hit:e,baseURL:C})]})]})]}),t]})}var H=i(l(),1);function Jo(e,t,a,o){if(e.web?.web){let r=ho(e.web);return r&&(0,H.jsx)(Xt,{hit:r,children:(0,H.jsx)(st,{listKey:`${r.hostname}:${r.port}`,highlights:e.highlights,hasHighlightEntitlement:a})},`${r.hostname}:${r.port}`)}else if(e.certificate){let r=po(e.certificate);return r&&(0,H.jsx)(Ft,{hit:r,labels:e.certificate.labels,children:(0,H.jsx)(st,{listKey:r.fingerprint_sha256,highlights:e.highlights,hasHighlightEntitlement:a})},r.fingerprint_sha256)}else if(e.host?.host){let r=mo(e.host);return r&&(0,H.jsx)(zt,{hit:r,historyLimitDays:o,children:(0,H.jsx)(st,{listKey:e.host.host.ip,highlights:e.highlights,hasHighlightEntitlement:a,services:r.services,ip:r.ip})},e.host.host.ip)}return null}function Jt({historyLimitDays:e,pageLimitMessage:t,q:a,results:o,hasHighlightEntitlement:r}){let[n,s]=le(),c=Z(),p=ot(c.pathname),d=Ve()?.currentPlanType==="Enterprise",m=!!o.hits?.length,g=m||!p,y=m&&d,b=(0,Zt.useCallback)(N=>{N?n.set("cursor",N):n.delete("cursor"),s(n)},[n,s]),W=(0,Zt.useCallback)(()=>{if(o.hits){let N=o.hits.map(uo);try{Er(`CensysSearch_${Temporal.Now.instant().toString().split(".")[0]}`,Nr(N.filter(G)))}catch{}}},[o.hits]),C=o.hits?.length?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{className:at.resultCards,children:o.hits.map(N=>Jo(N,a,r,e))}),(0,H.jsx)(kt,{pageLimitMessage:t,nextCursor:o.next_page_token||null,previousCursor:o.previous_page_token||null,onCursorChange:b})]}):(0,H.jsx)(fo,{});return(0,H.jsx)("div",{className:at.searchResults,children:(0,H.jsxs)("div",{className:at.resultsContainer,children:[g&&(0,H.jsx)(xt,{currentPageSize:o.hits?.length||0,durationMs:o.query_duration_millis||0,onDownloadCsv:y?W:void 0,totalHits:o.total_hits||0}),C]})})}var Wo=i(_(),1);var Vo=i(_(),1);var h=i(l(),1);function ea({errorCode:e,env:t,accessState:a,searchParams:o}){let r=ta(e,t,a,o);return(0,h.jsx)(Hr,{"data-testid":`error_${String(e)}`,iconName:r.iconName,iconMode:r.iconMode,title:r.title,children:r.message})}function ta(e,t,a,o){let{t:r}=S(),n=fr(a),s=(0,h.jsx)(Ar,{link:{to:`${t.ACCOUNTS_SITE_URL}/register`},button:{variant:oe.PRIMARY,size:mr.LARGE},children:"Register Now"});switch(e){case 100001:let c;switch(n){case 0:c={title:r("You do not have enough credits to run this search."),message:(0,h.jsx)(gt,{})};break;case 1:c={title:r("You do not have enough credits on your Free account to run this search."),message:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{children:r("Switch to your Organization account.")}),(0,h.jsx)(vt,{})]})};break;case 2:c={title:r("You do not have enough credits to run this search."),message:(0,h.jsx)(gt,{})};break;case 3:c={title:r("You do not have enough credits to run this search."),message:(0,h.jsx)("span",{children:r("Contact your Censys Sales Representative.")})};break}return{iconName:"emotion-sad",iconMode:"line",title:c.title,message:c.message};case 17e4:return{iconName:"timer-flash",title:r("Query Timeout"),message:r("Try again or optimize your query.")};case 170005:case 100007:return{iconName:"error-warning",title:r("Your query is invalid"),message:(0,h.jsxs)("div",{children:[r("Please refer to the")," ",(0,h.jsx)(E,{href:"https://docs.censys.com/docs/censys-query-language#/",isExternal:!0,children:r("Censys Query Language documentation")})," ",r("for information on writing queries.")]})};case 170002:{let p=new URLSearchParams(o);p.delete("cursor");let d;switch(n){case 0:{a?d={title:r("The Free tier includes one page of results"),message:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("span",{children:[(0,h.jsx)(E,{href:_r(t),isExternal:!0,children:r("Upgrade")})," ",r("to the Starter or Enterprise tier to view more results")]}),(0,h.jsxs)("span",{children:[r("Return to the")," ",(0,h.jsx)(E,{href:`.?${p.toString()}`,children:r("First page")})," ",r("Of results")]})]})}:d={title:"Unregistered users may only view one page of results",message:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{children:"Register and move up to the Starter or Enterprise tier to view more results"}),s]})};break}case 1:d={title:r("The Free tier includes one page of results"),message:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{children:r("Switch to your Organization account to view additional results")}),(0,h.jsx)(vt,{})]})};break;case 2:d={title:r("The Starter tier includes five pages of results"),message:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("span",{children:[(0,h.jsx)(E,{href:ft(t),isExternal:!0,children:r("Upgrade")})," ",r("to the Enterprise tier to view more results")]}),(0,h.jsxs)("span",{children:[r("Return to the")," ",(0,h.jsx)(E,{href:`.?${p.toString()}`,children:r("First page")})," ",r("Of results")]})]})};break;case 3:d={title:r("The Enterprise tier includes unlimited pages of results"),message:(0,h.jsx)("span",{children:r("Contact your Censys Sales Representative.")})};break}return{iconName:"lock-star",title:d.title,message:d.message}}case 170003:return{iconName:"lock-star",title:r("Advanced queries unavailable in your current tier"),message:(0,h.jsxs)("div",{children:[r("Access this feature with a")," ",(0,h.jsx)(E,{href:`${t.ACCOUNTS_SITE_URL}/settings/plan`,isExternal:!0,children:r("Starter")})," ",r("or")," ",(0,h.jsx)(E,{href:ft(t),isExternal:!0,children:r("Enterprise")})," ",r("Tier Organization")]})};case 170004:return St(100003,{accessState:a,env:t});default:return St(e,{accessState:a,env:t})}}var jt=(0,Vo.memo)(ea);var mt={container:"giZC4",errorWrapper:"xLLK1"};var Me=i(l(),1);function Fe(e){let t=sr(),a=e.error??t,o=rr(a)?a.data:a,r=it(o),n=!r&&o?.results?.errors?.length>0,s=Ve(),c=(0,Wo.useContext)(lr),[p]=le();return r||n?(0,Me.jsx)("div",{className:ce(mt.container,mt.errorWrapper),children:(0,Me.jsx)(jt,{errorCode:n?100007:o.code,env:c,accessState:s,searchParams:p})}):(0,Me.jsx)("div",{className:mt.container,children:(0,Me.jsx)(Vr,{error:o})})}var er={resultsWrapper:"WWWTn",filterResults:"dyI0L",searchBar:"_8gc8j"};var ia=i(qo(),1),na=i(zo(),1),R=i(l(),1);function ra(e){let t=e.headers.get("X-Remix-Redirect");return t!==null?(window.location.assign(t),new Promise(()=>{})):e.json()}var oa=async({request:e,serverLoader:t})=>{let a=await t(),o=new URL(e.url),{origin:r,searchParams:n}=o,s=new URLSearchParams(n),c=s.get("q")||"",p=Mr(o.pathname);s.set("q",c.trim());let d=p?`${s}&collection_id=${p.collection_id}`:`${s}`,m=fetch(`${r}/api/search?${d}&_data=${encodeURIComponent("routes/api.search")}`,{headers:new Headers([["Accept","application/json"]]),signal:e.signal});return ir({capabilities:a.capabilities,hasHighlightEntitlement:a.hasHighlightEntitlement,historyLimitDays:a.historyLimitDays,data:m.then(ra).then(g=>$r(g))})};oa.hydrate=!0;var em=()=>[{title:"Censys Search Results"}];function tm({currentUrl:e,nextUrl:t,defaultShouldRevalidate:a}){let o=e.searchParams,r=t.searchParams,n=o.has("showCode"),s=r.has("showCode");return n||s?!1:a}function aa(){let e=or(),t=Z(),{capabilities:a,data:o,hasHighlightEntitlement:r,historyLimitDays:n}=nr(),{q:s,submitSearch:c}=Oe();return e.state!=="idle"&&e.location.pathname===t.pathname?(0,R.jsx)(sa,{}):(0,R.jsx)(hr,{value:a,children:(0,R.jsx)("div",{className:er.resultsWrapper,children:(0,R.jsx)(Or,{errorElement:(0,R.jsx)(Fe,{}),fallback:(0,R.jsx)(Ne,{}),resolve:o,children:p=>{let d=it(p),m=!d&&p.results?.errors?.length>0;return d||m?(0,R.jsx)(Fe,{error:p}):(0,R.jsxs)(R.Fragment,{children:[p.results.total_hits>0&&(0,R.jsx)(Ht,{queryDataSets:p.results.query_datasets}),(0,R.jsx)(Jt,{historyLimitDays:n,pageLimitMessage:p.pageLimitMessage,q:s,results:p.results,submitSearch:c,hasHighlightEntitlement:r})]})}})})})}function sa(){return(0,R.jsx)("div",{className:er.resultsWrapper,children:(0,R.jsx)(Ne,{})})}function rm(){let e=ar();return(0,R.jsx)(Fe,{error:e})}export{oa as a,em as b,tm as c,aa as d,sa as e,rm as f};
