import{a as k}from"/censys/build/_shared/chunk-OSJU6MWK.js";import{a as V}from"/censys/build/_shared/chunk-H6D6H4VM.js";import{a as E}from"/censys/build/_shared/chunk-ZN6GT6EF.js";import{a as C}from"/censys/build/_shared/chunk-CJIEOTRC.js";import{d as H}from"/censys/build/_shared/chunk-JLZAPT5W.js";import{a as U}from"/censys/build/_shared/chunk-2G5R6E4Q.js";import{a as O}from"/censys/build/_shared/chunk-O72FINBK.js";import{b as S}from"/censys/build/_shared/chunk-JBBGPRTD.js";import{A as N,B as l,C as R,Ta as W,aa as I,sa as x,ua as A,va as M,y as h}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{c as g,g as L}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as u,c as s}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as o}from"/censys/build/_shared/chunk-2QEWK57A.js";var $={card:"p0oXt"};var T=o(s(),1);function D({headerTop:t,timestamp:a,children:r}){return(0,T.jsx)(M,{className:$.card,variant:x.LIGHT,bodyPadding:A.NONE,"data-testid":"raw-data-card",header:(0,T.jsx)(E,{lastUpdatedAt:a,children:t}),children:r})}var Z=o(u(),1);var y=o(u(),1);var w={container:"omOQm",controls:"_02Hbb",viewAsText:"C1upY"};var d=o(s(),1);function _({entity:t,entityName:a,children:r}){let e=g(),n=e.pathname.endsWith("/table"),p=(0,y.useMemo)(()=>{let P=new URLSearchParams(e.search).toString();return P?`?${P}`:""},[e.search]),z=(0,y.useCallback)(()=>C(JSON.stringify(t,S,4)),[t]);return(0,d.jsxs)("div",{className:w.container,"data-testid":"raw-data-layout",children:[(0,d.jsxs)("div",{className:w.controls,children:[(0,d.jsx)(l,{className:w.viewAsText,children:"View as"}),(0,d.jsx)(V,{activeState:n?"left":"right",title:`Link to ${a} ${n?"JSON":"table"} data view`,href:`../data/${n?"json":"table"}${p}`,leftText:"Table",rightText:"JSON"}),(0,d.jsx)(W,{content:`Copy ${a} JSON data`,children:(0,d.jsx)(I,{"data-testid":"copy-json",variant:R.DEFAULT,iconLeft:"file-copy-2",iconLeftMode:"line",onClick:z,children:"Copy"})})]}),r]})}var G=o(u(),1),X=o(u(),1);var J="attribute",F="value";var c={rawDataTable:"RLW1J",headerText:"_6UJ5C",cellContent:"il233",indented:"Xysry",restricted:"ZcXrW",lockedIndicator:"GxoLM",headerBorder:"bW-Fj"};function j(t,a){return!H(a)||t.includes("tbs")||t.includes("spki")||t.includes("subject_key_info")?!1:t.endsWith("fingerprint_sha256")||t.endsWith("sha256fp")||t.endsWith("parents")}var i=o(s(),1),v=[{id:J,header:"Attribute",render:t=>q(t,"attribute")},{id:F,header:"Value",render:t=>q(t,"value")}];function K({row:t}){let a=L(),r=a.collectionId?`/collections/${a.collectionId}/results?${t.queryParams}`:`/censys?${t.queryParams}`,e=t.queryParams&&!(t.restriction==="search"||t.restriction==="view"),n=(0,G.useMemo)(()=>{if(t.restriction==="view")return[];let p=[];return t.value&&p.push({label:"Copy",icon:"file-copy",onClick:()=>C(t.value),buttonVariant:R.DEFAULT}),e&&p.push({label:"New Search",icon:"search",href:r}),j(t.attribute,t.value)&&p.push({label:"Go to Asset",icon:"arrow-right",href:`/certificates/${t.value}`}),p},[t.restriction,r]);return(0,i.jsx)(k,{actions:n,as:"tr",children:v.map(p=>(0,i.jsx)("td",{children:p.render(t)},p.id))})}function q(t,a){let r=(0,i.jsxs)(i.Fragment,{children:[t[a]&&(0,i.jsxs)(l,{children:[t[a]," "]}),t.restriction&&a==="value"&&(0,i.jsx)(U,{action:t.restriction,side:"right",iconClassName:c.lockedIndicator})]});return(0,i.jsx)("span",{className:h(t.groupParentId&&t.groupParentId!==t.id&&a==="attribute"&&c.indented,t.restriction&&a==="value"&&c.restricted),children:(0,i.jsx)("span",{className:c.cellContent,children:r})})}var Q=(0,X.memo)(K);var m=o(s(),1);function b({data:t,hasHeaderBorder:a,...r}){return(0,m.jsxs)("table",{...r,className:c.rawDataTable,children:[(0,m.jsx)("thead",{className:h(a&&c.headerBorder),children:(0,m.jsx)("tr",{children:v.map(e=>(0,m.jsx)("th",{children:(0,m.jsx)(l,{className:c.headerText,variant:N.DEFAULT_SEMIBOLD,children:e.header})},e.id))})}),(0,m.jsx)("tbody",{children:t.map((e,n)=>(0,m.jsx)(Q,{row:e},`${e.id}-${e.attribute}_${n}`))})]})}var Y={jsonContainer:"_0hD0U"};var f=o(s(),1);function B({headerTop:t,timestamp:a,data:r,jsonInput:e}){let n=(0,Z.useMemo)(()=>r?(0,f.jsx)(b,{"data-testid":"raw-data-table",data:r,hasHeaderBorder:!0}):e?(0,f.jsx)("div",{className:Y.jsonContainer,children:(0,f.jsx)(O,{jsonInput:e})}):null,[r,e]);return t||a?(0,f.jsx)(D,{headerTop:t,timestamp:a,children:n}):n}export{D as a,B as b,_ as c,b as d};
