import{a as h,b as X,c as Z,d as J}from"/censys/build/_shared/chunk-JBWYREVY.js";import{a as Y}from"/censys/build/_shared/chunk-QIP37K23.js";import{a as G}from"/censys/build/_shared/chunk-JMHN7ZWW.js";import{a as z}from"/censys/build/_shared/chunk-YTHNDA7O.js";import{a as Q}from"/censys/build/_shared/chunk-EB3L7FWK.js";import{a as W}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{a as V}from"/censys/build/_shared/chunk-D7RWISVJ.js";import{a as q}from"/censys/build/_shared/chunk-XMNCU3E4.js";import{a as tr}from"/censys/build/_shared/chunk-IC5AY47K.js";import{a as T,c as F}from"/censys/build/_shared/chunk-VKYVKQW2.js";import{a as k}from"/censys/build/_shared/chunk-BWODHJE6.js";import{d as H}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{a as O}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{k as $}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{e as _}from"/censys/build/_shared/chunk-ST66DGSY.js";import{A as n,wa as L,x as P,xa as y,y as U,z as u}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as I}from"/censys/build/_shared/chunk-44DVAK2X.js";import{a as D,g as l,k as M,p as N}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as c}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as B}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as i}from"/censys/build/_shared/chunk-2TWE7TSA.js";var S=i(B(),1);var K=i(B(),1);var f={cardBody:"l6oPt",bodyHeader:"yfwcS",pathsTable:"_94q1j",indentedRow:"_6ee7b"};var t=i(c(),1);function A({browser:r,cert:e,graph:o}){let a=l(),m=a.collectionId?`/collections/${a.collectionId}/certificates/${a.id}`:`/certificates/${a.id}`;return(0,t.jsxs)("div",{className:f.cardBody,"data-testid":"trust-card-body",children:[(0,t.jsx)(n,{className:f.bodyHeader,variant:u.H5,children:"Browser Trust"}),(0,t.jsx)(J,{baseURL:m,browsers:[r],cert:e}),o.paths.length?(0,t.jsx)(er,{paths:o.paths}):null]})}function er({paths:r}){return(0,t.jsxs)("table",{className:f.pathsTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:(0,t.jsx)(n,{variant:u.DEFAULT_SEMIBOLD,children:"Path"})}),(0,t.jsx)("th",{children:(0,t.jsx)(n,{variant:u.DEFAULT_SEMIBOLD,children:"Certificate"})})]})}),(0,t.jsx)("tbody",{children:r.map((e,o)=>(0,t.jsxs)(K.Fragment,{children:[(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:2,children:(0,t.jsxs)(n,{children:["Path ",o+1]})})}),e.map(([a,m])=>(0,t.jsxs)("tr",{className:f.indentedRow,children:[(0,t.jsx)("td",{children:(0,t.jsx)(Y,{fingerprint:a})}),(0,t.jsx)("td",{children:(0,t.jsx)(n,{children:m})})]},a))]},`${e[0]?.[0]}-${o}`))})]})}var C=i(c(),1);function x({browser:r,cert:e,graph:o}){return(0,C.jsx)(y,{header:(0,C.jsx)(V,{"data-testid":"trust-card-header",lastUpdatedAt:e.certificate?.validated_at?.toString(),children:h[r]}),children:(0,C.jsx)(A,{browser:r,cert:e,graph:o})})}var j=i(B(),1);var d={container:"F4v-w",sidebarHeader:"rkPeD",sidebarEntriesWrapper:"nwAUX",sidebarEntry:"YkC49",active:"oZaA0",inactiveText:"slqj6",sidebarEntryContent:"_3Q-8P",entryIcon:"zHzyo",headerText:"acz1Z",activeText:"MwIAg"};var s=i(c(),1);function v({browser:r,cert:e}){return(0,s.jsxs)(y,{className:d.container,bodyPadding:L.NONE,children:[(0,s.jsx)("div",{className:d.sidebarHeader,children:(0,s.jsx)(n,{className:d.headerText,variant:u.SMALL_NUMERAL,children:"Browsers"})}),(0,s.jsxs)("div",{className:d.sidebarEntriesWrapper,children:[(0,s.jsx)(b,{browser:"chrome",cert:e,isActive:r==="chrome"}),(0,s.jsx)(b,{browser:"edge",cert:e,isActive:r==="edge"}),(0,s.jsx)(b,{browser:"firefox",cert:e,isActive:r==="firefox"}),(0,s.jsx)(b,{browser:"safari",cert:e,isActive:r==="safari"})]})]})}function b({browser:r,cert:e,isActive:o}){let a=l(),[m]=N(),E=a.collectionId?`/collections/${a.collectionId}/certificates/${a.id}`:`/certificates/${a.id}`,w=(0,j.useMemo)(()=>{if(!e)return null;let g=Z(e,r);return F(e?.certificate?.parsed?.signature?.self_signed,g?.type,g?.is_valid,g?.ever_valid)},[r,e]);return(0,s.jsxs)(O,{"data-testid":`trust-sidebar-${r}`,href:`${E}/trust/${r}${m?`?${m}`:""}`,className:P(d.sidebarEntry,o&&d.active),prefetch:"intent",children:[(0,s.jsxs)(n,{className:P(d.sidebarEntryContent,o?d.activeText:d.inactiveText),children:[(0,s.jsx)(U,{className:d.entryIcon,name:X[r],"aria-label":`${r} logo`,mode:"fill",size:"2xl"}),h[r]]}),w&&(0,s.jsx)(q,{isTrusted:w.isTrusted,status:w.status})]})}var R={container:"oOFJW",errorWrapper:"A5wDs"};var or=new Set(Object.values(T));function rr(r){return or.has(r)}var sr=i(tr(),1),p=i(c(),1),Kr=W("Cert Trust","routes/certificates.$id");function ar(){let{browser:r,graph:e}=z(),{cert:o}=Q();return(0,p.jsxs)("div",{className:R.container,children:[(0,p.jsx)(v,{browser:r,cert:o}),(0,p.jsx)(x,{browser:r,cert:o,graph:e})]})}function jr(){let r=M(),e=H(),o=l(),a=rr(o.browser)?o.browser:"chrome";(0,S.useEffect)(()=>{o.browser!==a&&e(`../trust/${a}`)},[]);let m=_(),E=(0,S.useContext)(I);return(0,p.jsxs)("div",{className:R.container,children:[(0,p.jsx)(v,{browser:a}),(0,p.jsx)("div",{className:R.errorWrapper,children:D(r)&&$(r.data)?(0,p.jsx)(G,{accessState:m,errorCode:r.data.code,env:E}):(0,p.jsx)(k,{error:r})})]})}export{Kr as a,ar as b,jr as c};
