import{a as _}from"/censys/build/_shared/chunk-PT5XZOYK.js";import{a as N}from"/censys/build/_shared/chunk-PLG22QRR.js";import{a as U}from"/censys/build/_shared/chunk-62I4RDM3.js";import{a as V}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{a as k}from"/censys/build/_shared/chunk-3IID2F3B.js";import{d as B}from"/censys/build/_shared/chunk-ZDOHYF7S.js";import{e as D,g as A,h as I}from"/censys/build/_shared/chunk-TUFJ6JAI.js";import{a as w}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as x}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{a as T}from"/censys/build/_shared/chunk-WMKH6XX3.js";import{b as L}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{a as R}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{e as b}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as C}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{A as d,B as l,_ as H}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as g,k as y,p as S}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as $,c as E}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as n}from"/censys/build/_shared/chunk-2QEWK57A.js";var p=n($(),1);var m={cveLayout:"qo4tA",servicesLabel:"_24anj"};var z=n(w(),1),t=n(E(),1),no=V("CVEs","routes/hosts.$id");function P(){let[s]=S(),{collection:a,cveDetails:i,host:c}=N(),u=`/hosts/${c.ip}`;a&&(u=`/collections/${a.collection_id}${u}`);let f=(0,p.useMemo)(()=>{let r=new Map;for(let o of c.services)if(o.vulns)for(let e of o.vulns){let h=r.get(e.id);h?h[1].push(o):r.set(e.id,[e,[o]])}return Array.from(r.entries()).sort((o,e)=>B(o[1][0],e[1][0]))},[c]);return T(),(0,t.jsxs)("div",{className:m.cveLayout,children:[f.length===0&&(0,t.jsx)(l,{children:"We haven't found any publicly accessible services with CVEs on this host or the host is on our blocklist."}),f.length>0&&f.map(([r,[v,o]])=>(0,t.jsxs)(_,{cve:v,description:i?.[r]?.description,relatedLinks:i?.[r]?.links,subHeader:o.length>0?(0,t.jsxs)(l,{variant:d.H5,children:[o.length," ",R("service",o.length)]}):null,children:[o.length>0&&(0,t.jsxs)(l,{className:m.servicesLabel,variant:d.H4,children:["Services (",(0,t.jsx)(H,{value:o.length}),")"]}),(0,t.jsx)(k,{tagSize:"md",tags:o.map(e=>({href:I(e,u,s.toString()),label:A(e)})),maxVisibleRows:20})]},r))]})}function lo(){let s=y(),a=L(b()),i=(0,p.useContext)(C);return(0,t.jsx)("div",{className:m.emptyState,"data-testid":"host-cves-error",children:g(s)&&D(s.data)?(0,t.jsx)(U,{errorCode:s.data.code,orgState:a,env:i}):(0,t.jsx)(x,{error:s})})}export{no as a,P as b,lo as c};
