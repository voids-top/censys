import{a as ae}from"/censys/build/_shared/chunk-UUDCK53D.js";import{a as te}from"/censys/build/_shared/chunk-WPUKKDY4.js";import{b as ee}from"/censys/build/_shared/chunk-HQXBH47J.js";import{a as oe}from"/censys/build/_shared/chunk-D7RWISVJ.js";import{a as y}from"/censys/build/_shared/chunk-CJIEOTRC.js";import{c as X}from"/censys/build/_shared/chunk-FP2KPINM.js";import{d as Z}from"/censys/build/_shared/chunk-VKYVKQW2.js";import{a as Q}from"/censys/build/_shared/chunk-XTODG4BZ.js";import{$ as z,A as D,B as v,K as F,L as $,N as J,O as G,Xa as M,aa as H,ca as q,ua as K,wa as Y,x as T,xa as j,z as W}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as V,g as B}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as s}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as P}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as r}from"/censys/build/_shared/chunk-2TWE7TSA.js";var re={card:"p0oXt"};var L=r(s(),1);function g({headerTop:e,timestamp:t,children:n}){return(0,L.jsx)(j,{className:re.card,variant:K.LIGHT,bodyPadding:Y.NONE,"data-testid":"raw-data-card",header:(0,L.jsx)(oe,{lastUpdatedAt:t,children:e}),children:n})}var Ae=r(P(),1);var O=r(P(),1);var E={container:"omOQm",controls:"_02Hbb",viewAsText:"C1upY"};var h=r(s(),1);function ie({entity:e,entityName:t,children:n}){let o=V(),i=o.pathname.endsWith("/table"),p=(0,O.useMemo)(()=>{let A=new URLSearchParams(o.search).toString();return A?`?${A}`:""},[o.search]),C=(0,O.useCallback)(()=>y(JSON.stringify(e,ee,4)),[e]);return(0,h.jsxs)("div",{className:E.container,"data-testid":"raw-data-layout",children:[(0,h.jsxs)("div",{className:E.controls,children:[(0,h.jsx)(D,{className:E.viewAsText,children:"View as"}),(0,h.jsx)(ae,{activeState:i?"left":"right",title:`Link to ${t} ${i?"JSON":"table"} data view`,href:`../data/${i?"json":"table"}${p}`,leftText:"Table",rightText:"JSON"}),(0,h.jsx)(M,{content:`Copy ${t} JSON data`,children:(0,h.jsx)(z,{"data-testid":"copy-json",variant:v.DEFAULT,iconLeft:"file-copy-2",iconLeftMode:"line",onClick:C,children:"Copy"})})]}),n]})}var Re=r(P(),1),he=r(P(),1);var c=r(P(),1);var se="hover-action-menu-description",ce="hover-action-menu";var pe={top:125};var I={hoverActionMenuContainer:"pcqEa",hoverActionMenu:"YTo-u",tooltipTrigger:"cuCo4"};var l=r(s(),1);function le({actions:e,children:t,as:n="div",contentOption:o={side:"top",align:"end",sideOffset:-36,alignOffset:10,collisionPadding:pe},className:i}){let p=(0,c.useId)(),[C,A]=(0,c.useState)(!1),[m,Te]=(0,c.useState)(-1),N=(0,c.useRef)([]),S=(0,c.useRef)(null);function k(){A(!0)}function U(){A(!1)}let De=(0,c.useCallback)(a=>{if(!C||e.length===0)return;let R=m;switch(a.key){case"ArrowDown":case"ArrowRight":{a.preventDefault(),R=m===-1?0:(m+1)%e.length;break}case"ArrowLeft":case"ArrowUp":{a.preventDefault(),R=m===-1?e.length-1:(m-1+e.length)%e.length;break}case"Escape":case"Tab":{if(R===-1)break;a.preventDefault(),R=-1,A(!1),S.current?.focus();break}}Te(R)},[e.length,m,C]);return(0,c.useEffect)(()=>{C&&m!==null&&N.current[m]?.focus()},[C,m,N]),(0,l.jsx)(F,{open:C,children:(0,l.jsx)($,{asChild:!0,ref:S,children:(0,l.jsxs)(n,{onMouseEnter:k,onMouseLeave:U,onFocus:k,onBlur:U,onKeyDown:De,tabIndex:0,"data-testid":`${ce}`,className:T(I.hoverActionMenuContainer,i),children:[t,(0,l.jsx)(J,{children:(0,l.jsx)(G,{side:o.side,sideOffset:o.sideOffset,align:o.align,alignOffset:o.alignOffset,collisionPadding:o.collisionPadding,onOpenAutoFocus:a=>{a.preventDefault()},children:(0,l.jsx)("div",{className:I.hoverActionMenu,"aria-describedby":`${se}-${p}`,children:e.map((a,R)=>(0,l.jsx)(M,{content:a.label,triggerClassName:I.tooltipTrigger,children:be(a)?(0,l.jsx)(Q,{ref:w=>N.current[R]=w,iconButton:{iconName:a.icon,iconMode:"line",variant:a.buttonVariant??v.PRIMARY,tabIndex:-1,className:I.actionButton,"aria-label":a.label,size:a.size??H.MEDIUM},link:{to:a.href}}):(0,l.jsx)(q,{ref:w=>N.current[R]=w,iconName:a.icon,iconMode:"line",onClick:a.onClick,variant:a.buttonVariant??v.PRIMARY,tabIndex:-1,className:I.actionButton,"aria-label":a.label,size:a.size??H.MEDIUM})},a.label))})})})]})})})}function be(e){return"href"in e}var de="attribute",me="value";var f={rawDataTable:"RLW1J",headerText:"_6UJ5C",cellContent:"il233",indented:"Xysry",restricted:"ZcXrW",lockedIndicator:"GxoLM",headerBorder:"bW-Fj"};function fe(e,t){return!Z(t)||e.includes("tbs")||e.includes("spki")||e.includes("subject_key_info")?!1:e.endsWith("fingerprint_sha256")||e.endsWith("sha256fp")||e.endsWith("parents")}var d=r(s(),1),x=[{id:de,header:"Attribute",render:e=>ue(e,"attribute")},{id:me,header:"Value",render:e=>ue(e,"value")}];function Ne({row:e}){let t=B(),n=t.collectionId?`/collections/${t.collectionId}/results?${e.queryParams}`:`/censys?${e.queryParams}`,o=e.queryParams&&!(e.restriction==="search"||e.restriction==="view"),i=(0,Re.useMemo)(()=>{if(e.restriction==="view")return[];let p=[];return e.value&&p.push({label:"Copy",icon:"file-copy",onClick:()=>y(e.value),buttonVariant:v.DEFAULT}),o&&p.push({label:"New Search",icon:"search",href:n}),fe(e.attribute,e.value)&&p.push({label:"Go to Asset",icon:"arrow-right",href:`/certificates/${e.value}`}),p},[e.restriction,n]);return(0,d.jsx)(le,{actions:i,as:"tr",children:x.map(p=>(0,d.jsx)("td",{children:p.render(e)},p.id))})}function ue(e,t){let n=(0,d.jsxs)(d.Fragment,{children:[e[t]&&(0,d.jsxs)(D,{children:[e[t]," "]}),e.restriction&&t==="value"&&(0,d.jsx)(X,{action:e.restriction,side:"right",iconClassName:f.lockedIndicator})]});return(0,d.jsx)("span",{className:T(e.groupParentId&&e.groupParentId!==e.id&&t==="attribute"&&f.indented,e.restriction&&t==="value"&&f.restricted),children:(0,d.jsx)("span",{className:f.cellContent,children:n})})}var Ce=(0,he.memo)(Ne);var u=r(s(),1);function _({data:e,hasHeaderBorder:t,...n}){return(0,u.jsxs)("table",{...n,className:f.rawDataTable,children:[(0,u.jsx)("thead",{className:T(t&&f.headerBorder),children:(0,u.jsx)("tr",{children:x.map(o=>(0,u.jsx)("th",{children:(0,u.jsx)(D,{className:f.headerText,variant:W.DEFAULT_SEMIBOLD,children:o.header})},o.id))})}),(0,u.jsx)("tbody",{children:e.map((o,i)=>(0,u.jsx)(Ce,{row:o},`${o.id}-${o.attribute}_${i}`))})]})}var ve={jsonContainer:"_0hD0U"};var b=r(s(),1);function ne({headerTop:e,timestamp:t,data:n,jsonInput:o}){let i=(0,Ae.useMemo)(()=>n?(0,b.jsx)(_,{"data-testid":"raw-data-table",data:n,hasHeaderBorder:!0}):o?(0,b.jsx)("div",{className:ve.jsonContainer,children:(0,b.jsx)(te,{jsonInput:o})}):null,[n,o]);return e||t?(0,b.jsx)(g,{headerTop:e,timestamp:t,children:i}):i}export{g as a,ne as b,ie as c,_ as d};
