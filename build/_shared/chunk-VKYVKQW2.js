import{a as o}from"/censys/build/_shared/chunk-WK35ORSL.js";import{g as T}from"/censys/build/_shared/chunk-6EMU7K4F.js";import{f as n}from"/censys/build/_shared/chunk-QJVHIZ52.js";var u=(s=>(s.CHROME="chrome",s.EDGE="edge",s.FIREFOX="firefox",s.SAFARI="safari",s))(u||{});function V(e,r){return e?.subject?.common_name?.[0]?e.subject.common_name[0]:e?.subject_dn?e?.subject_dn:r}function _(e,r,i,t){if(r===n.Certificate_CertificateType.LEAF){if(e)return"Self-Signed";if(i)return"Trusted";if(t)return"Previously Trusted"}else if(r===n.Certificate_CertificateType.INTERMEDIATE){if(i)return"Trusted Intermediate";if(t)return"Historical Intermediate"}else if(r===n.Certificate_CertificateType.ROOT){if(i)return"Trusted Root";if(t)return"Historical Root"}else if(r===n.Certificate_CertificateType.UNKNOWN&&e)return"Self-Signed";return"Untrusted"}var A=new Set(["Trusted","Trusted Intermediate","Trusted Root"]);function l(e,r,i,t){let s=_(e,r,i,t);return{status:s,everValid:t,isTrusted:A.has(s)}}var U=/^[a-fA-F0-9]{64}$/;function D(e){return typeof e!="string"?!1:U.test(e)}function S(e){let r=T(e);return Temporal.Instant.compare(Temporal.Now.instant(),r)>0}var I=e=>e.replace(/(..)(?=..)/g,"$1:\u200B");function c(e){if(e.length===0)return;let r=e.flatMap(t=>{let s=t?.parsed?.signature?.self_signed;return[t?.validation?.chrome,t?.validation?.microsoft,t?.validation?.nss,t?.validation?.apple].filter(o).map(a=>{let d=a.type,E=a.is_valid,p=a.ever_valid,{isTrusted:f,status:R}=l(s,d,E,p);return{everValid:a.ever_valid,isTrusted:f,status:R}})}),i=r.find(({status:t})=>t!=="Trusted")?.status||"Trusted";return{aggregatedStatus:r.every(t=>t.isTrusted)?"All Trusted":r.some(t=>t.isTrusted)?"Partially Trusted":"No Trust",everValid:r.every(t=>t.everValid),isTrusted:r.every(t=>t.isTrusted),status:i}}export{u as a,V as b,l as c,D as d,S as e,I as f,c as g};
