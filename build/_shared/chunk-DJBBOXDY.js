import{a as Me}from"/censys/build/_shared/chunk-YK4PMZMK.js";import{a as De,b as Le,c as O,d as Ae,e as Ee}from"/censys/build/_shared/chunk-RVNR7NXG.js";import{b as g,d as xe}from"/censys/build/_shared/chunk-5DIHBHL2.js";import{a as Re}from"/censys/build/_shared/chunk-ZI5VZYCA.js";import{a as Pe}from"/censys/build/_shared/chunk-GKOF6QGC.js";import{d as _e}from"/censys/build/_shared/chunk-N7NUWUYZ.js";import{a as ge}from"/censys/build/_shared/chunk-BVX6X5MK.js";import{a as Se}from"/censys/build/_shared/chunk-BUVQHUPU.js";import{a as Ne,d as S}from"/censys/build/_shared/chunk-AIDQO3P6.js";import{a as je}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as ke}from"/censys/build/_shared/chunk-LQXVLPA4.js";import{a as W}from"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as be}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{c as le,j as fe,l as Ce,m as Te,n as ve}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import{a as ie}from"/censys/build/_shared/chunk-RAMDI2JB.js";import{a as ye}from"/censys/build/_shared/chunk-CJIEOTRC.js";import{b as ce,j as he}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{a as de}from"/censys/build/_shared/chunk-HG7D3PDC.js";import{a as oe}from"/censys/build/_shared/chunk-ZKAH2G64.js";import{c as A}from"/censys/build/_shared/chunk-G6DKMBFA.js";import{j as ue}from"/censys/build/_shared/chunk-HLRAT4GD.js";import{d as ae,f as ne,k as se}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{e as $}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as Y}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{A as pe,v as E,w as x,y as me}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{$ as M,B as R,C as b,Ta as re,aa as j,da as te,z as ee}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{d as U}from"/censys/build/_shared/chunk-6URBRDCL.js";import{a as K,g as P,k as Z,m as q,p as J}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as F,c as y}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d}from"/censys/build/_shared/chunk-2QEWK57A.js";var k=d(F(),1);var T=d(F(),1);var B=d(F(),1);var we={switch:"ONlcc"};var w=d(y(),1);function V({leftText:e,rightText:i,checked:t,initialState:a=!0,onToggle:r,leftClassName:n,rightClassName:m,isDisabled:u}){let[p,_]=(0,B.useState)(t!==void 0?t:a),v=t!==void 0,s=v?t:p,f=(0,B.useCallback)(()=>{v||_(L=>!L),r&&r(!s)},[v,s,r]),N=s,C=!s;return(0,w.jsxs)("div",{className:we.switch,children:[(0,w.jsx)(j,{role:"checkbox",type:"button",variant:b.GHOST,size:M.SMALL,onClick:!N&&!u?f:()=>{},"aria-checked":N,"aria-label":e,className:n,disabled:u,children:e}),(0,w.jsx)(j,{role:"checkbox",type:"button",variant:b.GHOST,size:M.SMALL,onClick:!C&&!u?f:()=>{},"aria-checked":C,"aria-label":i,className:m,disabled:u,children:i})]})}var We=U.object({before:U.string().datetime({precision:3}),after:U.string().datetime({precision:3})});function He(e){return We.safeParse(e).success}function Ie(e){let i=new Date(e.after).getTime()-new Date(e.before).getTime(),t=Math.floor(i/1e3),a=Math.floor(t/(24*3600)),r=Math.floor(t%(24*3600)/3600).toString().padStart(0,"2"),n=Math.floor(t%3600/60).toString().padStart(2,"0"),m=(t%60).toString().padStart(2,"0");return`(${a} days, ${r}:${n}:${m})`}var D={detailSummary:"-WBYu",validityRow:"Ig2mb",detailTableContent:"_4SHUM",switchContainer:"tDKw6",copyButton:"xoM-E"};function Ue(e){let i=e.certificate?.parsed?.subject_dn||W,t=e.certificate?.parsed?.issuer_dn||W,a={before:e.certificate?.parsed?.validity_period?.not_before,after:e.certificate?.parsed?.validity_period?.not_after},r=e.certificate?.fingerprint_sha256,n=e.certificate?.fingerprint_sha1,m=e.certificate?.parsed?.serial_number,u=e.certificate?.parsed?.serial_number_hex?`0x${e.certificate.parsed.serial_number_hex}`:void 0,p=e.certificate?.names?e.certificate?.names.join(" "):void 0;return{subjectDN:i,issuerDN:t,serialNumberDecimal:m,serialNumberHex:u,validityPeriod:a,fingerprintSha256:r,fingerprintSha1:n,names:p}}var c=d(y(),1);function z({cert:e}){let[i,t]=(0,T.useState)(!0),[a,r]=(0,T.useState)(!0),{t:n}=A(),{subjectDN:m,issuerDN:u,validityPeriod:p,names:_,serialNumberValue:v,fingerprintValue:s}=(0,T.useMemo)(()=>{let{fingerprintSha256:C,fingerprintSha1:L,serialNumberDecimal:I,serialNumberHex:Ve,...Fe}=Ue(e);return{fingerprintValue:a?C:L,serialNumberValue:i?Ve:I,...Fe}},[i,a,e]),f=(0,T.useMemo)(()=>{if(He(p))return Ie(p)},[p]),N=(0,T.useCallback)(async()=>{typeof s=="string"&&await ye(s)},[s]);return(0,c.jsxs)("div",{className:D.detailSummary,children:[(0,c.jsx)(O,{iconName:"file-list-2",children:n("Summary")}),(0,c.jsxs)(Ne,{children:[(0,c.jsx)(S,{label:n("Subject DN"),content:m}),(0,c.jsx)(S,{label:n("Issuer DN"),content:u}),(0,c.jsx)(S,{label:n("Serial Number"),content:(0,c.jsxs)("div",{className:D.switchContainer,children:[(0,c.jsx)(V,{leftText:"Hex",rightText:"Decimal",onToggle:t}),(0,c.jsx)(R,{children:v})]})}),(0,c.jsx)(S,{label:n("Validity Period"),content:(0,c.jsxs)("div",{className:D.validityRow,children:[(0,c.jsx)(Re,{...p}),f!==void 0&&(0,c.jsx)(R,{children:f})]})}),(0,c.jsx)(S,{label:n("Fingerprint"),content:s&&(0,c.jsxs)("div",{className:D.switchContainer,children:[(0,c.jsx)(V,{leftText:"SHA-256",rightText:"SHA-1",onToggle:r}),(0,c.jsx)(R,{title:s,children:s.slice(0,7)}),(0,c.jsx)(te,{onClick:N,className:D.copyButton,iconName:"file-copy-2",iconMode:"line","aria-label":"Copy Fingerprint to Clipboard",variant:b.DEFAULT})]})}),(0,c.jsx)(S,{label:n("All Names"),content:_})]})]})}var $e={detail:"NQjLT"};var H=d(y(),1);function X({cert:e}){let i=P(),t=i.collectionId?`/collections/${i.collectionId}/certificates/${i.id}`:`/certificates/${i.id}`;return(0,H.jsxs)("div",{className:$e.detail,children:[(0,H.jsx)(O,{iconName:"shield-check",children:"Trust and Revocation"}),(0,H.jsx)(_e,{baseURL:t,browsers:["chrome","edge","firefox","safari"],cert:e})]})}var h={overviewHeaderContainer:"D0O1R",contentTop:"Wtsqk",popoverContainer:"zPBwT",contentTopItems:"Bd0Kk",textIcon:"X0ZmS",whiteText:"vZ0EJ",contentBottom:"xEoBy",tagsSection:"DZhKW",tagsIcon:"ElJtF",link:"dOjsp"};function Ge(e){let{certificate:i}=e,t=new Set;if(i?.parsed?.subject?.common_name?.forEach(r=>{r&&r.trim().length>0&&t.add(r.trim())}),i?.parsed?.extensions?.subject_alt_name?.dns_names?.forEach(r=>{r&&r.trim().length>0&&t.add(r)}),t.size===0)return!1;let a=Array.from(t).sort();return x({field:"cert.names",values:a,kind:4})}function Oe(e){let i=[],{certificate:t}=e;if(t?.parsed){let a=Ge(e),r={sectionName:"Related Certificates",links:[]};t.spki_subject_fingerprint_sha256&&r.links.push({linkText:"With the same identity (key + subject)",linkIcon:"admin",linkTo:x({field:"cert.spki_subject_fingerprint_sha256",value:t.spki_subject_fingerprint_sha256,kind:0})}),t.parsed?.subject_key_info?.fingerprint_sha256&&r.links.push({linkText:"With the same public key",linkIcon:"key",linkTo:x({field:"cert.parsed.subject_key_info.fingerprint_sha256",value:t.parsed.subject_key_info.fingerprint_sha256,kind:0})}),t.parsed?.serial_number&&r.links.push({linkText:"With the same serial number",linkIcon:"barcode",linkTo:x({field:"cert.parsed.serial_number",value:t.parsed.serial_number,kind:0})}),a&&a.length<100&&r.links.push({linkText:"With the same names",linkIcon:"price-tag-2",linkTo:a}),r.links.length>0&&i.push(r)}return t?.tbs_no_ct_fingerprint_sha256&&i.push({sectionName:"Certificate Transparency",links:[{linkText:"Associated Pre-certificates",linkIcon:"megaphone",linkTo:`/search?q=${encodeURIComponent(me(E({field:"cert.tbs_no_ct_fingerprint_sha256",value:t.tbs_no_ct_fingerprint_sha256,kind:0}),E({field:"cert.precert",value:!0,kind:0}),"and",!1))}`}]}),t?.fingerprint_sha256&&i.push({sectionName:"What's Using This Certificate?",links:[{linkText:"Hosts",linkIcon:"computer",linkTo:x({field:"host.services.tls.fingerprint_sha256",value:t.fingerprint_sha256,kind:0})}]}),i}var l=d(y(),1),Ze={popover:h.popoverContainer};function Q({cert:e}){let i=$(),t=Oe(e),a=P(),r=a.collectionId?`/collections/${a.collectionId}/results`:"/search",n=e.certificate?.fingerprint_sha256;return(0,l.jsxs)("div",{className:h.overviewHeaderContainer,children:[(0,l.jsxs)("div",{className:h.contentTop,children:[(0,l.jsxs)("div",{className:h.contentTopItems,children:[e?.labels?.find(m=>m?.toLowerCase()==="precert")&&(0,l.jsx)(re,{content:(0,l.jsxs)(R,{className:h.whiteText,children:["Associated ",(0,l.jsx)("br",{}),"Pre-certificate"]}),children:(0,l.jsx)(ee,{size:"md",name:"megaphone",mode:"line",className:h.textIcon,"data-testid":"associated-pre-cert-icon","aria-hidden":!0})}),(0,l.jsx)(Ee,{children:e.displayName}),(0,l.jsx)(de,{variant:"dot"}),(0,l.jsx)(Ae,{assetType:"certificate"})]}),(0,l.jsxs)("div",{className:h.contentTopItems,children:[n&&(0,l.jsx)(he,{assetId:n,assetType:"cert",investigationName:`${e.displayName} Certificate Investigation`}),!!i&&(0,l.jsx)(oe,{link:{to:`/certificates/${e?.certificate?.fingerprint_sha256}/pem/raw`,download:!0,reloadDocument:!0},button:{variant:b.DEFAULT,size:M.MEDIUM},children:"Download PEM"}),(0,l.jsx)(Me,{pivots:t,customClassNames:Ze})]})]}),(0,l.jsxs)("div",{className:h.contentBottom,children:[e?.labels&&e.labels.length>0&&(0,l.jsx)("div",{className:h.tagsSection,children:(0,l.jsx)(Pe,{baseURL:r,labels:e.labels,resourceType:"certificate"})}),e?.certificate?.modified_at&&(0,l.jsx)(ke,{timestamp:e?.certificate?.modified_at})]})]})}var G={errorWrapper:"Tsnma",summaryLayout:"R-XDs"};var Je=d(je(),1),o=d(y(),1),Dr=({data:e})=>{let i=null;return e&&(i=e?.cert.certificate?.parsed?.subject_dn||e.cert.displayName),[{title:i?`${i} - Cert Summary`:"Censys"}]};function Be({children:e,id:i,slots:t={},collectionId:a,collectionName:r}){let{t:n}=A(),m=ue({collectionsLabel:n("Collections"),collectionName:r,fallback:[{pathName:n("Search")}]}),u=E({kind:0,field:"cert.fingerprint_sha256",value:i});return(0,o.jsx)(Te,{initialQuery:u,breadcrumbs:m,slots:{searchHeader:r?(0,o.jsx)(fe,{breadcrumbs:m,placeholder:n("Search within",{name:r}),collectionId:a,children:(0,o.jsx)(ve,{})}):(0,o.jsx)(Ce,{breadcrumbs:m}),header:t.pageHeader,navTabs:t.pageNavTabs},children:e})}function qe(){let[e,i]=J(),{capabilities:t,cert:a,id:r,collection:n,hasCertificateHistoryAccess:m,csrf:u}=ge(),{t:p}=A(),_=pe(),[v]=ne([13]),s=`/certificates/${r}`,f="/certificates/:id";n&&(s=`/collections/${n.collection_id}${s}`,f=`/collections/:collectionId${f}`);let N=(0,k.useMemo)(()=>({cert:a}),[a]),C=(0,k.useMemo)(()=>e.get("isCollapsed")===void 0||e.get("isCollapsed")==="true",[e]),L=(0,k.useCallback)(()=>{let I=new URLSearchParams(e);I.set("isCollapsed",(!C).toString()),i(I,{state:_})},[e,C,_]);return(0,o.jsx)(ie,{token:u,children:(0,o.jsx)(ae,{value:t,children:(0,o.jsx)(Be,{id:r,slots:{pageHeader:(0,o.jsx)(De,{assetType:"certificate",header:(0,o.jsx)(Q,{cert:a}),isCollapsed:C,toggle:L,children:(0,o.jsxs)("div",{className:G.summaryLayout,children:[(0,o.jsx)(z,{cert:a}),(0,o.jsx)(X,{cert:a})]})}),pageNavTabs:(0,o.jsxs)(xe,{children:[(0,o.jsx)(g,{id:"certificate",to:s,children:p("Certificate")}),(0,o.jsx)(g,{id:"trust",to:`${s}/trust/${"chrome"}`,routePattern:`${f}/trust/:browser`,prefetch:"intent",children:p("Trust")}),(0,o.jsx)(g,{id:"zlint",to:`${s}/zlint`,prefetch:"intent",children:p("ZLint")}),(0,o.jsx)(g,{id:"transparency",to:`${s}/transparency`,prefetch:"intent",children:p("Certificate Transparency")}),m&&(0,o.jsx)(g,{id:"history",to:`${s}/history`,routePattern:`${f}/history/*`,prefetch:"none",children:p("Timeline")}),(0,o.jsx)(Le,{canViewCenseye:v,targetRoute:s,routePattern:f}),(0,o.jsx)(g,{id:"rawData",to:`${s}/data/table`,routePattern:`${f}/data/*`,prefetch:"none",children:p("Raw Data")})]})},collectionId:n?.collection_id,collectionName:n?.name,children:(0,o.jsx)(le,{children:(0,o.jsx)(q,{context:N})})})})})}function Lr(){let e=Z(),i=P(),t=$(),a=ce(t),r=(0,k.useContext)(Y);return(0,o.jsx)(Be,{id:i.id||"",children:(0,o.jsx)("div",{className:G.errorWrapper,children:K(e)&&se(e.data)?(0,o.jsx)(Se,{errorCode:e.data.code,orgState:a,env:r}):(0,o.jsx)(be,{error:e})})})}export{Dr as a,qe as b,Lr as c};
