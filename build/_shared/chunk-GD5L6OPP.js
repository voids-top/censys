import{a as R}from"/censys/build/_shared/chunk-4JAPIORE.js";import{a as H}from"/censys/build/_shared/chunk-IASZ2KIP.js";import{a as D,b as k}from"/censys/build/_shared/chunk-T2656LNT.js";import{a as w}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{a as _}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as L}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{f as E,k as g}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{e as b,h as v}from"/censys/build/_shared/chunk-D5QEORL2.js";import{u as c,v as A,x as C}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{A as i,z as m}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as y}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{a as h,k as f}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as M,c as T}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as a}from"/censys/build/_shared/chunk-2QEWK57A.js";var n=a(M(),1);var s={threatsLayout:"zbvzi",serviceList:"gYMbh",sectionHeader:"-kzUw"};var P=a(_(),1),e=a(T(),1),oe=w("Web Property Threats","routes/web.$id");function N(){let o=v("threat-detections"),[p]=E([20]),{webAggregate:r,threatDetails:l,targetRoute:u}=R(),d=(0,n.useMemo)(()=>r.threats.filter(t=>Boolean(t.name)),[r.threats]),S=`${r.hostname}: ${r.port}`;return(0,e.jsxs)("div",{className:s.threatsLayout,children:[d.length===0&&(0,e.jsx)(i,{children:"We haven't found any threats on this web property."}),d.length>0&&d.map(t=>{let x=[{to:A(C(c({kind:0,field:"web.threats.id",value:t.id}),c({kind:0,field:"web.port",value:r.port}),"and",!1)),iconName:"search",label:"Search for threat on port"}];return(0,e.jsx)(D,{threat:t,description:l?.[t.id]?.description,subHeader:(0,e.jsx)(i,{variant:m.H5,children:"Observed on web property"}),baseRoute:u,addedAt:l?.[t.id]?.addedAt,children:o&&p&&(0,e.jsxs)("div",{children:[(0,e.jsx)(i,{className:s.sectionHeader,variant:m.H4,children:"Evidence (1)"}),(0,e.jsx)("ul",{className:s.serviceList,children:(0,e.jsx)(k,{threat:t,baseRoute:u,title:S,timestamp:r.scan_time?.toString(),actionLinks:x,ariaLabel:"Threat details for web property",testId:`threat-detail-item-${t.id}`})})]})},t.id)})]})}function ae(){let o=f(),p=b(),r=(0,n.useContext)(y);return(0,e.jsx)("div",{"data-testid":"web-threats-error",children:h(o)&&g(o.data)?(0,e.jsx)(H,{accessState:p,errorCode:o.data.code,env:r}):(0,e.jsx)(L,{error:o})})}export{oe as a,N as b,ae as c};
