import{a as h,b as Ro,d as D,e as $}from"/censys/build/_shared/chunk-KA2ES3R2.js";import{a as Co,b as vo,c as Lo,d as yo,e as ho}from"/censys/build/_shared/chunk-2C6N3S4L.js";import{f as Io}from"/censys/build/_shared/chunk-B5UNN2SO.js";import{a as K,c as Eo,d as No}from"/censys/build/_shared/chunk-5HYWBZZN.js";import{d as Bo}from"/censys/build/_shared/chunk-4DOFQKLI.js";import{a as Y}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as z}from"/censys/build/_shared/chunk-XTODG4BZ.js";import{a as w}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{$ as U,A as m,B as T,E as so,H as co,I as lo,J as uo,K as go,M as po,N as mo,O as Ao,Q as fo,R as ko,S as To,T as So,Xa as bo,aa as G,ca as V,x as io,y as F,z as b}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as ao}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as p}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as O}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as a}from"/censys/build/_shared/chunk-2TWE7TSA.js";var oo=a(O(),1);var P=a(O(),1);var W={backgroundActionsErrorItem:"fmKIm",backgroundActionsErrorTitle:"l3N5U"};var M=a(p(),1);function q({title:e,description:o}){return(0,M.jsxs)("li",{className:W.backgroundActionsErrorItem,children:[(0,M.jsx)(m,{className:W.backgroundActionsErrorTitle,children:e}),(0,M.jsx)(m,{variant:b.DEFAULT,as:"span",children:o})]})}var Q="background-actions-item-dialog";var C={actionItemHeader:"td-rr",actionItemTriggerContainer:"e2dND",actionItemTriggerTitle:"nRnfC",actionItemTriggerIconContainer:"sn-NM",actionItemIcon:"n84v1",actionItemsContainer:"snrgI",slideDown:"WKZC5",slideUp:"PCtTA",actionItems:"v6Cq8"};var f=a(p(),1);function J({title:e,titleRight:o,children:t}){return(0,f.jsx)(Co,{collapsible:!0,type:"single",defaultValue:Q,children:(0,f.jsxs)(vo,{value:Q,children:[(0,f.jsx)(Lo,{className:C.actionItemHeader,children:(0,f.jsxs)("div",{className:C.actionItemTriggerContainer,children:[(0,f.jsx)("div",{className:C.actionItemTriggerTitle,children:e}),(0,f.jsxs)("div",{className:C.actionItemTriggerIconContainer,children:[(0,f.jsx)(yo,{asChild:!0,children:(0,f.jsx)(V,{iconName:"arrow-up-s",iconMode:"line",size:G.LARGE,variant:T.GHOST,className:C.actionItemIcon,"aria-label":"Toggle background actions details"})}),o]})]})}),(0,f.jsx)(ho,{className:C.actionItemsContainer,children:(0,f.jsx)("div",{className:C.actionItems,children:t})})]})})}var Do=a(O(),1);var _={backgroundActionItem:"fTG0-",backgroundActionItemTitle:"zDz-6",backgroundActionItemNoComparisons:"Iawr-",backgroundActionItemActions:"_0su4Y"};var v=a(p(),1);function Z({scannedAssetHref:e,screenshotHref:o,onClose:t,successMessage:s,successLinkText:r,noComparisonsText:i}){let c=ao(),l=Bo(),A=(0,Do.useCallback)(()=>{if(!o)return;let k=!1;try{let u=new URL(o,window.location.origin);k=c.pathname===u.pathname}catch{k=!1}k?window.location.replace(new URL(o,window.location.origin).toString()):l(o),t()},[l,o,t]);return(0,v.jsxs)("li",{className:_.backgroundActionItem,children:[(0,v.jsx)(m,{as:"span",className:_.backgroundActionItemTitle,children:s}),(0,v.jsxs)("div",{className:_.backgroundActionItemActions,children:[e?(0,v.jsx)(z,{button:{variant:T.TERTIARY,iconRight:"arrow-right",iconRightMode:"line",onClick:t},link:{to:e},children:r}):(0,v.jsx)(m,{as:"span",className:_.backgroundActionItemNoComparisons,children:i}),o?(0,v.jsx)(z,{button:{variant:T.TERTIARY,iconRight:"arrow-right",iconRightMode:"line",onClick:A},link:{to:o},children:"View screenshot"}):null]})]})}var E={actionItemStatus:"uEc12",loading:"_6oQkK",success:"Iaw-R",error:"kM26d"};var x=a(p(),1),Mo={["LOADING"]:{element:(0,x.jsx)("div",{className:E.loading,"aria-hidden":!0,children:(0,x.jsx)(uo,{variant:lo.SYSTEM,size:co.MEDIUM})}),ariaLabel:"Background action in progress",ariaLive:"polite",ariaBusy:!0,role:"progressbar"},["SUCCESS"]:{element:(0,x.jsx)(F,{name:"checkbox-circle",mode:"fill",size:"2xl",className:E.success}),ariaLabel:"Background action completed successfully",ariaLive:"polite",ariaBusy:!1,role:"status"},["ERROR"]:{element:(0,x.jsx)(F,{name:"close-circle",mode:"fill",size:"2xl",className:E.error}),ariaLabel:"Background action failed with an error",ariaLive:"assertive",ariaBusy:!1,role:"status"}};var _o=a(p(),1);function X({status:e}){let{element:o,ariaLabel:t,ariaLive:s,ariaBusy:r,role:i}=Mo[e];return(0,_o.jsx)("div",{className:E.actionItemStatus,"aria-label":t,"aria-live":s,"aria-busy":r,role:i,"aria-atomic":"true",children:o})}var xo=w.object({isOpen:w.boolean(),status:w.enum(h)});var j={loadingTitle:"Scanning...",successTitle:"Rescan Completed",errorTitle:"Error",loadingDescription:"Scanning... This may take a few minutes.",loadingSubtitle:"You can continue working while we rescan this asset. This window will remain active and notify you when it is complete.",successMessage:"Rescan Complete!",successLinkText:"View differences in results",noComparisonsText:"No new comparisons",loadingAriaLabel:"Background Actions are loading",errorAriaLabel:"Background Actions have an error",successAriaLabel:"Background Actions",closeAriaLabel:"Close background actions dialog"},Po={...j},Re={loadingTitle:"Running CensEye...",successTitle:"CensEye Run Completed",errorTitle:"CensEye Run Error",loadingDescription:"This may take a few seconds.",loadingSubtitle:"You can continue working while we analyze this asset. This window will remain active and notify you when it is complete.",successMessage:"Analysis Complete!",successLinkText:"View results",noComparisonsText:"No new analysis data",loadingAriaLabel:"Asset analysis in progress",errorAriaLabel:"Asset analysis has an error",successAriaLabel:"Asset analysis completed",closeAriaLabel:"Close analysis dialog"};var I={backgroundActionsContent:"_335Y0",slideUp:"YFhse",backgroundActionsContainer:"jdMpp",backgroundActionsTitle:"cYU4c",backgroundActionsLoadingContainer:"_644sD",backgroundActionsLoadingTitle:"_6J6E0",backgroundActionsLoadingDescription:"KTEoW",backgroundActionsListContainer:"IAO5-"};var n=a(p(),1);function Oo({status:e,backgroundActions:o,errors:t,className:s,messages:r={},localStateKey:i="app/background-actions-dialog"}){let c={...j,...r},[l,A]=Io({isOpen:!1,status:e},i,xo);(0,P.useEffect)(()=>{(e!==l.status||e==="LOADING")&&A({isOpen:!0,status:e})},[e,o,l.status,A]);let k=(0,P.useCallback)(g=>{if(!g)return;let{offsetHeight:N,offsetWidth:R}=g,y=document.documentElement;l.isOpen?(y.style.setProperty("--background-actions-dialog-width",`${R}px`),y.style.setProperty("--background-actions-dialog-height",`${N}px`)):(y.style.removeProperty("--background-actions-dialog-width"),y.style.removeProperty("--background-actions-dialog-height"))},[l.isOpen]),u=(0,P.useCallback)(g=>{A(N=>({...N,isOpen:g}))},[A]),L=e==="LOADING"?c.loadingTitle:e==="SUCCESS"?c.successTitle:c.errorTitle;return(0,n.jsx)(fo,{open:l.isOpen,onOpenChange:u,modal:!1,children:(0,n.jsx)(ko,{children:(0,n.jsx)(To,{ref:k,className:io(I.backgroundActionsContent,s),"aria-describedby":void 0,role:"alertdialog",onInteractOutside:g=>{g.preventDefault()},onOpenAutoFocus:g=>{g.preventDefault()},children:(0,n.jsx)("div",{className:I.backgroundActionsContainer,children:(0,n.jsx)(J,{title:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(X,{status:e}),(0,n.jsx)(So,{asChild:!0,children:(0,n.jsx)(m,{variant:b.DEFAULT_SEMIBOLD,className:I.backgroundActionsTitle,children:L})})]}),titleRight:e==="LOADING"?null:(0,n.jsx)(V,{iconName:"close",iconMode:"line",size:G.LARGE,variant:T.GHOST,onClick:()=>u(!1),"aria-label":c.closeAriaLabel}),children:(0,n.jsx)(Ko,{status:e,errors:t,backgroundActions:o,onClose:()=>u(!1),messages:c})})})})})})}function Ko({status:e,errors:o,backgroundActions:t,onClose:s,messages:r}){switch(e){case"LOADING":return(0,n.jsxs)("div",{className:I.backgroundActionsLoadingContainer,"aria-label":r.loadingAriaLabel,children:[(0,n.jsx)(m,{variant:b.DEFAULT_SEMIBOLD,className:I.backgroundActionsLoadingTitle,children:r.loadingDescription}),(0,n.jsx)(m,{variant:b.DEFAULT_ITALICS,className:I.backgroundActionsLoadingDescription,children:r.loadingSubtitle})]});case"ERROR":return(0,n.jsx)("ul",{className:I.backgroundActionsListContainer,"aria-label":r.errorAriaLabel,children:o?.map((i,c)=>(0,n.jsx)(q,{title:i.title,description:i.description},`${i.description}-${c}`))});case"SUCCESS":return(0,n.jsx)("ul",{className:I.backgroundActionsListContainer,"aria-label":r.successAriaLabel,children:t?.map((i,c)=>(0,n.jsx)(Z,{scannedAssetHref:i.scannedAssetHref??"",screenshotHref:i.screenshotHref??"",onClose:s,successMessage:r.successMessage,successLinkText:r.successLinkText,noComparisonsText:r.noComparisonsText},`${i.scannedAssetHref}-${c}`))})}}function wo(e){return e?.filter(o=>o.completed).map(o=>{let t=o.target,s=t?.serviceId?.ip??t?.hostPort?.ip;if(!s)return{scannedAssetHref:void 0};let r=o.scanTime??o.createTime?.value,i=o.tasks.reduce((u,L)=>{let g=L.updateTime?.value;return g?u?g>u?g:u:g:u},void 0),c=t?.serviceId?.port??t?.hostPort?.port;if(!r||!i||!c)return{scannedAssetHref:void 0};let l=new URL(`/hosts/${s}/events/compare`,window.location.origin);l.searchParams.set("at_time_a",r),l.searchParams.set("at_time_b",i),l.searchParams.set("port",c.toString());let A=l.pathname+l.search,k=o?.screenshotServiceSlug?`/hosts/${s}#${o.screenshotServiceSlug}`:void 0;return{scannedAssetHref:A,screenshotHref:k}}).filter(Y)??[]}function Uo(e){let o=e?.filter(Y).flatMap(t=>t.tasks.filter(s=>s.status===K.TrackedScan_Task_Status.REJECTED||s.status===K.TrackedScan_Task_Status.TIMED_OUT)).map(t=>({title:"Scan Error",description:t.description}));return o?.length?o:null}var Vo=a(p(),1);function Go(){let{trackedScans:e,status:o}=D(),t=(0,oo.useMemo)(()=>wo(e),[e]),s=(0,oo.useMemo)(()=>o==="ERROR"?Uo(e):null,[e,o]);return o===null?null:(0,Vo.jsx)(Oo,{status:o,errors:s,backgroundActions:t,messages:Po})}var S=a(O(),1);var eo="live-scan-label",to="live-scan-port-input",ro="live-scan-port-error";var B={content:"_97GoN",form:"Q0qRQ",title:"y1TZM",description:"NeIa4",inputContainer:"z9kAN",input:"fBVg4",error:"EW7Cp",scanInProgressBtn:"CboT7",spin:"mwr43"};var d=a(p(),1);function Ho({entityId:e,rescanResourceType:o,className:t,scanTime:s}){let[r,i]=(0,S.useState)(null),[c,l]=(0,S.useState)(!1),[A,k]=(0,S.useState)(""),{status:u,isPerformingDiscoveryScanOnAsset:L}=D(),g=(0,S.useMemo)(()=>L(e),[L,e,u]),{isSubmitting:N,errorText:R,submit:y,Form:Fo}=$({isScanInProgress:u==="LOADING",rescanResourceType:o,entityId:e,port:A,scanTime:s}),zo=(0,S.useCallback)(Yo=>{let H=Yo.target.value;if(i(null),H===""){k("");return}Ro.safeParse(H).error?i("Invalid port number"):k(H)},[]),no=(0,S.useMemo)(()=>R||r||null,[R,r]);return(0,S.useEffect)(()=>{u==="LOADING"&&(l(!1),k(""))},[u]),u==="LOADING"&&g?(0,d.jsx)(bo,{content:"Live Discovery in progress",triggerClassName:t,children:(0,d.jsx)(U,{variant:T.DEFAULT,iconLeft:"loader-4",iconLeftMode:"line",iconRight:"arrow-down-s",iconRightMode:"line",disabled:!0,"aria-label":"Live Discovery in progress",className:B.scanInProgressBtn,children:"Scanning..."})}):(0,d.jsxs)(go,{open:c,onOpenChange:l,children:[(0,d.jsx)(po,{asChild:!0,children:(0,d.jsx)(U,{variant:T.DEFAULT,iconLeft:"scan-2",iconLeftMode:"line",iconRight:c?"arrow-up-s":"arrow-down-s",iconRightMode:"line",className:t,disabled:u==="LOADING",children:"Live Discovery"})}),(0,d.jsx)(mo,{children:(0,d.jsx)(Ao,{className:B.content,"aria-labelledby":eo,align:"end",children:(0,d.jsxs)(Fo,{onSubmit:y,className:B.form,noValidate:!0,children:[(0,d.jsx)("label",{id:eo,htmlFor:to,className:B.title,children:(0,d.jsx)(m,{variant:b.H5,as:"span",children:"Live Discovery"})}),(0,d.jsx)(m,{variant:b.SMALL,className:B.description,children:"Enter a port to scan for service changes on asset."}),(0,d.jsxs)("div",{className:B.inputContainer,children:[(0,d.jsx)(so,{placeholder:"Port","aria-label":"Port number","aria-invalid":!!r,"aria-describedby":r?ro:void 0,value:A,onChange:zo,className:B.input,type:"number",min:Eo,max:No,id:to,required:!0}),(0,d.jsx)(U,{"aria-label":"Start port scan",variant:T.PRIMARY,iconLeft:"scan-2",iconLeftMode:"line",disabled:!A||!!r,isLoading:N,type:"submit",children:"Scan"})]}),no&&(0,d.jsx)(m,{id:ro,variant:b.SMALL,className:B.error,role:"alert",children:no})]})})})]})}export{Re as a,Oo as b,Ho as c,Go as d};
