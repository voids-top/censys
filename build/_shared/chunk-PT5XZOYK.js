import{a as M,d}from"/censys/build/_shared/chunk-AIDQO3P6.js";import{a as _}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as A}from"/censys/build/_shared/chunk-ZKAH2G64.js";import{a as R}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{e as s,v as b,w as k,y as U}from"/censys/build/_shared/chunk-KMD3IRPL.js";import{A as l,B as t,C as V,Ta as H,_ as T,ba as P,sa as N,ua as C,va as E,z as w}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as I,c as f}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as y}from"/censys/build/_shared/chunk-2QEWK57A.js";var x=y(I(),1);var u=y(I(),1);var m={cveDetailTable:"Xo-52",nested:"Gpf4y",rowLabel:"_8TtKZ",red:"K0cKs"};var e=y(f(),1),B={[s.Severity_Value.CRITICAL]:"Critical",[s.Severity_Value.HIGH]:"High",[s.Severity_Value.MEDIUM]:"Medium",[s.Severity_Value.LOW]:"Low",[s.Severity_Value.UNSPECIFIED]:"Unspecified"},W=new Set([s.Severity_Value.CRITICAL,s.Severity_Value.HIGH]);function g({cve:o}){let{metrics:a}=o,n=(0,u.useMemo)(()=>o.severity===s.Severity_Value.UNRECOGNIZED_ENUM_KEY?null:B[o.severity],[o.severity]),h=(0,u.useMemo)(()=>[["v40",a?.cvss_v40],["v31",a?.cvss_v31],["v30",a?.cvss_v30]].filter(([,c])=>!!c),[a]);return(0,e.jsxs)(M,{className:m.cveDetailTable,children:[h.map(([c,p])=>(0,e.jsxs)(u.Fragment,{children:[(0,e.jsx)(d,{label:(0,e.jsxs)(v,{children:["CVSS (",c,")"]}),content:(0,e.jsx)(e.Fragment,{})}),(0,e.jsx)(d,{className:m.nested,label:(0,e.jsx)(v,{children:"Score"}),content:(0,e.jsxs)("span",{className:W.has(o.severity)?m.red:void 0,children:[(0,e.jsxs)(t,{variant:l.DEFAULT_SEMIBOLD,children:[(0,e.jsx)(T,{value:p.score.toFixed(2)})," "]}),n&&(0,e.jsxs)(t,{"aria-label":n,children:["(",n,")"]})]})}),!!p.vector&&(0,e.jsx)(d,{className:m.nested,label:(0,e.jsx)(v,{children:"Vector"}),content:(0,e.jsx)(t,{title:p.vector,children:p.vector})})]},c)),typeof a?.epss?.score<"u"&&(0,e.jsx)(d,{label:(0,e.jsx)(v,{children:"EPSS Score"}),content:(0,e.jsxs)(t,{children:[(0,e.jsx)(T,{value:(a.epss.score*100).toFixed(2)}),"%"]})}),typeof a?.epss?.percentile<"u"&&(0,e.jsx)(d,{label:(0,e.jsx)(v,{children:"EPSS Percentile"}),content:(0,e.jsxs)(t,{children:[(0,e.jsx)(T,{value:(a.epss.percentile*100).toFixed(2)}),"%"]})}),!!o.cwes&&o.cwes.length>0&&(0,e.jsx)(d,{label:(0,e.jsx)(v,{children:"EPSS Percentile"}),content:(0,e.jsx)(t,{children:o.cwes.join(", ")})})]})}function v({children:o}){return(0,e.jsx)(t,{className:m.rowLabel,variant:l.SMALL,children:o})}var i={cardHeader:"A5Y8D",cardHeaderDetails:"WFtoD",cardIconWrapper:"DozTl",cardHeaderActions:"vXIUz","severity-low":"MP9fs","severity-medium":"_7oRXE","severity-high":"Gkxv8","severity-critical":"vpQ3N",sectionHeader:"By-sA",cardBody:"t5qUH",cardGroup:"Ik7XN",groupSection:"PZ9Mu",linkList:"-frQ0",relatedLink:"lTf6s"};var r=y(f(),1);function K({children:o,cve:a,description:n,relatedLinks:h=[],subHeader:c}){let p=k(U(b({kind:0,field:"host.services.vulns.id",value:a.id}),b({kind:0,field:"web.vulns.id",value:a.id}),"or",!1)),L=[typeof a?.metrics?.cvss_v30?.score<"u",!!a?.metrics?.cvss_v30?.vector,typeof a?.metrics?.epss?.score<"u",typeof a?.metrics?.epss?.percentile<"u",!!a.cwes&&a.cwes.length>0].some(_),F=!L&&!n&&h.length===0,S=(0,r.jsxs)("div",{className:i.cardHeader,children:[(0,r.jsx)("div",{className:i.cardIconWrapper,children:(0,r.jsx)(w,{"aria-hidden":!0,size:"2xl",icon:"alert-line"})}),(0,r.jsxs)("div",{className:i.cardHeaderDetails,children:[(0,r.jsx)(t,{variant:l.DEFAULT_NUMERAL,children:a.id}),c]}),(0,r.jsx)("div",{className:i.cardHeaderActions,children:(0,r.jsx)(H,{content:"Search for assets with this CVE",children:(0,r.jsx)(A,{iconButton:{iconName:"search",iconMode:"line",size:P.LARGE,variant:V.DEFAULT,["aria-label"]:"Search for assets with this CVE"},link:{to:p}})})})]});return F?(0,r.jsxs)(E,{headerPadding:C.NONE,variant:N.INTERACTIVE,id:a.id,tabIndex:-1,"aria-label":a.id,className:i[`severity-${a.severity.toLowerCase()}`],header:S,children:[(0,r.jsx)("div",{className:i.cardBody,children:(0,r.jsx)(t,{children:"No metrics were observed on this CVE."})}),o]}):(0,r.jsxs)(E,{headerPadding:C.NONE,id:a.id,tabIndex:-1,"aria-label":a.id,"aria-describedby":n?`${a.id}_description`:void 0,variant:N.INTERACTIVE,className:i[`severity-${a.severity.toLowerCase()}`],header:S,children:[(0,r.jsxs)("div",{className:i.cardBody,children:[L&&(0,r.jsxs)("div",{className:i.cardGroup,children:[(0,r.jsx)(t,{className:i.sectionHeader,variant:l.H4,children:"Properties"}),(0,r.jsx)(g,{cve:a})]}),(0,r.jsxs)("div",{className:i.cardGroup,children:[!!n&&(0,r.jsxs)("div",{className:i.groupSection,children:[(0,r.jsx)(t,{className:i.sectionHeader,variant:l.H4,children:"Description"}),(0,r.jsx)(t,{id:`${a.id}_description`,children:n})]}),h.length>0&&(0,r.jsxs)("div",{className:i.groupSection,children:[(0,r.jsx)(t,{className:i.sectionHeader,variant:l.H4,children:"Related Links"}),(0,r.jsx)("ul",{className:i.linkList,children:h.map(({label:G,href:D})=>(0,r.jsx)("li",{children:(0,r.jsx)(R,{className:i.relatedLink,href:D,isExternal:!0,showExternalIcon:!0,children:G})},D))})]})]})]}),o]})}var O=(0,x.memo)(K);export{O as a};
