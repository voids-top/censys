import{a as Ae}from"/censys/build/_shared/chunk-TML7PS4H.js";import{a as Ne}from"/censys/build/_shared/chunk-XVMBDR2S.js";import{b as be}from"/censys/build/_shared/chunk-GQIVCUZT.js";import{a as ge,b as ve}from"/censys/build/_shared/chunk-VJO7D5U3.js";import{d as ye}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as Te,d as E}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{a as x}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as fe}from"/censys/build/_shared/chunk-OFRBI5JW.js";import{l as ue,m as he}from"/censys/build/_shared/chunk-IRHQADG7.js";import{a as le}from"/censys/build/_shared/chunk-XTODG4BZ.js";import{a as K}from"/censys/build/_shared/chunk-TTVDHAYB.js";import{f as W}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{b as me}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import{h as V}from"/censys/build/_shared/chunk-ST66DGSY.js";import{B as ce,E as de,a as g,x as q,z as pe}from"/censys/build/_shared/chunk-QJVHIZ52.js";import{$ as Q,A as s,B as R,Da as ne,Ia as G,ca as te,ea as ae,sb as se,ua as re,wa as oe,xa as ie,y as U,z as u}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as _}from"/censys/build/_shared/chunk-F5K75D4K.js";import{p as P}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as T}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as F}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as d}from"/censys/build/_shared/chunk-2TWE7TSA.js";var D=d(F(),1);var I=d(F(),1);var v={threatDetailTable:"sK0vZ",nameListContent:"ifkRC",rowLabel:"xyOlM",primaryName:"xG-AY",altNames:"lGjmH"};var n=d(T(),1);function Se({threat:e}){let o=(0,I.useMemo)(()=>{let a=e.malware?.primary_name??"",i=e.malware?.all_names?.filter(m=>m!==a)??[];return{primaryName:a,altNames:i}},[e.malware]),t=(0,I.useMemo)(()=>e.actors.map(a=>({primaryName:a.primary_name??"",altNames:a.all_names?.filter(i=>i!==a.primary_name)??[]})),[e.actors]);return(0,n.jsxs)(Te,{className:v.threatDetailTable,children:[o.primaryName&&(0,n.jsx)(E,{label:(0,n.jsx)(w,{children:x("Name",o.altNames.length)}),content:(0,n.jsxs)("div",{className:v.nameListContent,children:[(0,n.jsx)(s,{className:v.primaryName,children:o.primaryName}),o.altNames.length>0&&(0,n.jsxs)(s,{className:v.altNames,variant:u.SMALL,children:["(aka ",o.altNames.join(", "),")"]})]})}),e.type&&(0,n.jsx)(E,{label:(0,n.jsx)(w,{children:x("Type",e.type.length)}),content:e.type.map(De).join(", ")}),e.tactic&&(0,n.jsx)(E,{label:(0,n.jsx)(w,{children:x("Tactic",e.tactic.length)}),content:e.tactic.map(De).join(", ")}),t.length>0&&(0,n.jsx)(Ne,{label:(0,n.jsx)(w,{children:x("Actor",t.length)}),items:t,textOverride:{expand:"Show more",collapse:"Show less"},listComponent:a=>(0,n.jsxs)("div",{className:v.nameListContent,children:[(0,n.jsx)(s,{className:v.primaryName,children:a.primaryName}),a.altNames.length>0&&(0,n.jsxs)(s,{className:v.altNames,variant:u.SMALL,children:["(aka ",a.altNames.join(", "),")"]})]})}),e.details?.campaign_theme&&(0,n.jsx)(E,{label:(0,n.jsx)(w,{children:"Campaign"}),content:e.details.campaign_theme}),e.confidence&&(0,n.jsx)(E,{label:(0,n.jsx)(w,{children:"Confidence"}),content:(0,n.jsxs)(s,{children:[(0,n.jsx)(ae,{value:((e.confidence??0)*100).toFixed(0)}),"%"]})})]})}function w({children:e}){return(0,n.jsx)(s,{className:v.rowLabel,variant:u.SMALL,children:e})}function De(e){return e.toLowerCase().replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase())}var X=(0,I.memo)(Se);var Ce="https://malpedia.caad.fkie.fraunhofer.de/details/";var l={cardHeader:"_4quOz",cardHeaderDetails:"_4RDn7",cardHeaderDetailsTitle:"dgNs-",cardIconWrapper:"DbwyG",cardHeaderActions:"eMgGj",sectionHeader:"l7cnc",cardBody:"XGGqb",cardGroup:"UZVQC",groupSection:"MyDBR",linkList:"Ryhmk",relatedLink:"Yc6qB",readMoreButton:"B91Pu"};var H=d(T(),1);function A({to:e,iconName:o,label:t}){return(0,H.jsx)(ne,{asChild:!0,children:(0,H.jsxs)(me,{to:e,children:[(0,H.jsx)(U,{name:o,mode:"line"}),t]})})}var r=d(T(),1);function Ie({children:e,description:o,threat:t,addedAt:a,subHeader:i,baseRoute:m}){let{t:p}=_(),L=he(),S=V("threat-detections"),[k]=W([20]),[M]=P(),$=(0,D.useRef)(null),O=(0,D.useMemo)(()=>de(t.name??""),[t.name]),B=ue({query:O,source:"threat"});if(!t.name)return null;let b=t.name,c=t.id,Ee=pe(ce(q({kind:0,field:"host.services.threats.name",value:t.name}),q({kind:0,field:"web.threats.name",value:t.name}),"or",!1)),ee=t.malware?.malpedia_id?[{label:`${t.malware.primary_name} at Malpedia`,href:`${Ce}${t.malware.malpedia_id}`}]:[],we=(0,D.useMemo)(()=>{let N=M.toString()?`?${M}`:"",y=[{type:"label",label:p("Actions")},{type:"custom",content:(0,r.jsx)(A,{to:`/explore/threats/${c}`,iconName:"bug",label:p("Go to threat page")})}];return L&&y.push({type:"custom",content:(0,r.jsx)(A,{to:B,iconName:"stack",label:p("Add threat to collection")})}),S&&k&&(y.push({type:"separator"}),y.push({type:"custom",content:(0,r.jsx)(A,{to:`${m}/data${N}`,iconName:"file-list-2",label:p("See raw evidence data")})})),y},[c,L,S,B]);return(0,r.jsxs)(ie,{headerPadding:oe.NONE,id:b,tabIndex:-1,"aria-label":b,"aria-describedby":`${c}_description`,variant:re.INTERACTIVE,"data-testid":`threat-detail-card-${c}`,header:(0,r.jsxs)("div",{className:l.cardHeader,children:[(0,r.jsx)(ve,{}),(0,r.jsxs)("div",{className:l.cardHeaderDetails,children:[(0,r.jsxs)("div",{className:l.cardHeaderDetailsTitle,children:[(0,r.jsx)(s,{variant:u.DEFAULT_NUMERAL,children:b}),ye(a)?(0,r.jsx)(ge,{}):null]}),i]}),(0,r.jsxs)("div",{className:l.cardHeaderActions,children:[(0,r.jsx)(G,{align:"end",trigger:(0,r.jsx)(Q,{iconRight:"arrow-drop-down",iconRightMode:"line",variant:R.DEFAULT,"aria-label":p("More options"),children:p("More Actions")}),items:we}),(0,r.jsx)(le,{link:{to:Ee},button:{variant:R.DEFAULT},children:p("View All Threat Assets")})]})]}),children:[(0,r.jsxs)("div",{className:l.cardBody,children:[(0,r.jsxs)("div",{className:l.cardGroup,children:[(0,r.jsx)(s,{className:l.sectionHeader,variant:u.H4,children:p("Properties")}),(0,r.jsx)("div",{ref:$,children:(0,r.jsx)(X,{threat:t})})]}),(0,r.jsxs)("div",{className:l.cardGroup,children:[!!o&&(0,r.jsxs)("div",{className:l.groupSection,children:[(0,r.jsx)(s,{className:l.sectionHeader,variant:u.H4,id:`${c}_description_header`,children:p("Threat Description")}),(0,r.jsx)(be,{lineClamp:4,parentRef:$,button:(N,y)=>(0,r.jsx)(Q,{onClick:y,variant:R.SECONDARY,iconRightMode:"line",iconRight:N?"arrow-up-s":"arrow-down-s",className:l.readMoreButton,"aria-controls":`${c}_description`,"aria-expanded":N,children:p(N?"Read less":"Read more")}),children:(0,r.jsx)(s,{id:`${c}_description`,"aria-labelledby":`${c}_description_header`,children:o})})]}),ee.length>0&&(0,r.jsxs)("div",{className:l.groupSection,children:[(0,r.jsx)(s,{className:l.sectionHeader,variant:u.H4,id:`${c}_related_links_header`,children:p("Related Links")}),(0,r.jsx)("ul",{className:l.linkList,"aria-labelledby":`${c}_related_links_header`,children:ee.map(({label:N,href:y})=>(0,r.jsx)("li",{children:(0,r.jsx)(K,{className:l.relatedLink,href:y,isExternal:!0,showExternalIcon:!0,children:N})},y))})]})]})]}),e]})}var He=(0,D.memo)(Ie);var Pe=d(F(),1);var Y={item:"bK7Wu",serviceTitle:"v1MaN"};var Me=d(F(),1);var C={popoverContent:"z0CSK",dismissButton:"KWvgn",evidenceHeader:"gYI0Q",container:"Au61L",evidence:"OxA00",fallbackMessage:"K1vKW"};function Le(e){let o="",t=Array.isArray(e?.evidence)?e.evidence:[];for(let a of t)if(!a.negative&&a.data_path){let i=a.data_path.replace(/^endpoints\./,"");a.exists===!0?o+=`${i}: *`:a.exists===!1?o+=`not ${i}: *`:a.found_value?o+=`${i}: ${String(a.found_value)}`:a.found_value===""&&(o+=`${i} =~ "[REDACTED REGEX]"`),o+=`
`}return o.trim()}var h=d(T(),1);function Z({threat:e,baseRoute:o}){let{t}=_(),[a]=P(),i=a.toString()?`?${a}`:"",m=(0,Me.useMemo)(()=>Le(e),[e]);return(0,h.jsx)("div",{children:(0,h.jsxs)(se,{trigger:(0,h.jsx)(Ae,{children:t("See Evidence")}),contentProps:{align:"end"},customClassNames:{contentWrapper:C.popoverContent,dismissButton:C.dismissButton},isDismissible:!0,children:[(0,h.jsxs)("div",{className:C.evidenceHeader,children:[(0,h.jsx)(s,{variant:u.H5,children:t("Threat Evidence")}),(0,h.jsxs)(K,{href:`${o}/data${i}`,children:[(0,h.jsx)(U,{name:"file-list-2",mode:"line"})," ",t("See raw evidence data")]})]}),m?(0,h.jsx)("div",{className:C.container,children:(0,h.jsx)("pre",{children:(0,h.jsx)("code",{className:C.evidence,children:m})})}):(0,h.jsx)(s,{variant:u.SMALL,className:C.fallbackMessage,children:t("Detection based on complex criteria. Evidence hidden to protect visibility and method integrity.")})]})})}var f=d(T(),1);function $e({threat:e,baseRoute:o,title:t,timestamp:a,actionLinks:i,testId:m,ariaLabel:p}){let{t:L}=_(),[S]=P(),k=V("threat-detections"),[M]=W([20]);if(!e?.id)return null;let $=(0,Pe.useMemo)(()=>{let O=S.toString(),B=O?`?${O}`:"",b=[{type:"label",label:L("Actions")},...i.map(c=>({type:"custom",content:(0,f.jsx)(A,{to:c.to,iconName:c.iconName,label:c.label})}))];return k&&M&&(b.push({type:"separator"}),b.push({type:"custom",content:(0,f.jsx)(A,{to:`${o}/data${B}`,iconName:"file-list-2",label:L("See raw evidence data")})})),b},[i,k,M,S,o,L]);return(0,f.jsxs)("div",{role:"group",className:Y.item,"aria-label":p,"data-testid":m,children:[(0,f.jsx)(s,{className:Y.serviceTitle,variant:u.DEFAULT_SEMIBOLD,as:"span",children:t}),a&&(0,f.jsx)("div",{"aria-label":`Scan time: ${a}`,children:(0,f.jsx)(fe,{labelText:"Last scanned",timestamp:a})}),k&&M&&(0,f.jsx)(Z,{threat:e,baseRoute:o}),(0,f.jsx)(G,{align:"end",trigger:(0,f.jsx)(te,{iconName:"more-2",iconMode:"line",variant:R.GHOST,"aria-label":"More options"}),items:$})]})}var j="start",J="end",_e="port",Re="protocol",Qt="pageToken";var Oe=/^[a-zA-Z0-9.+-]+$/i,z=e=>g.union([e,g.literal("")]).optional();function Zt(e){let o=Temporal.Now.zonedDateTimeISO("UTC").startOfDay().toPlainDate(),t=e===-1?void 0:o.subtract({days:e}).toString(),a=()=>{let i=g.iso.date();return z(i.refine(m=>!m||m===""||!t?!0:m>=t,{message:`Date must be on or after ${t} based on your host history entitlement.`}))};return g.object({[j]:a(),[J]:a(),[_e]:z(g.coerce.number().int().gte(1,{error:"Port must be greater than or equal to 1"}).lte(65535,{error:"Port must be less than or equal to 65535"}).transform(i=>String(i))),[Re]:z(g.string().trim().refine(i=>i===""||Oe.test(i),{error:"Invalid protocol format"}).transform(i=>i.toUpperCase()))})}function jt(e){let o=Temporal.Now.zonedDateTimeISO("UTC").startOfDay().toPlainDate(),t=e===-1?void 0:o.subtract({days:e}).toString(),a=()=>{let i=g.iso.date();return z(i.refine(m=>!m||m===""||!t?!0:m>=t,{message:`Date must be on or after ${t} based on your host history entitlement.`}))};return g.object({[j]:a(),[J]:a()})}export{He as a,$e as b,j as c,J as d,_e as e,Re as f,Qt as g,Zt as h,jt as i};
