import{a as R,b as w}from"/censys/build/_shared/chunk-T2656LNT.js";import{a as P}from"/censys/build/_shared/chunk-PLG22QRR.js";import{a as C}from"/censys/build/_shared/chunk-JC22C2KM.js";import{e as E,h as x}from"/censys/build/_shared/chunk-6D64NL5L.js";import{a as A}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{a as G}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as k}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{a as b}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{e as H}from"/censys/build/_shared/chunk-D5QEORL2.js";import{u as y,v as L,x as D}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import{A as d,z as f}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as v}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{a as g,k as S,p as T}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as B,c as $}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as c}from"/censys/build/_shared/chunk-2QEWK57A.js";var m=c(B(),1);var h={threatsLayout:"Kux5l",serviceList:"f-D5Q"};var O=c(G(),1),o=c($(),1),lt=A("Host Threats","routes/hosts.$id");function K(){let{collection:a,host:s,threatDetails:i}=P(),[M]=T(),n=`/hosts/${s.ip}`;a&&(n=`/collections/${a.collection_id}${n}`);let u=(0,m.useMemo)(()=>{let p=new Map;for(let r of s.services)if(r.threats)for(let e of r.threats){let t=p.get(e.id);t?t[1].push(r):p.set(e.id,[e,[r]])}return Array.from(p.entries()).sort()},[s,i]);return(0,o.jsxs)("div",{className:h.threatsLayout,children:[u.length===0&&(0,o.jsx)(d,{children:"We haven't found any publicly accessible services with Threat(s) on this host or the host is on our blocklist."}),u.length>0&&u.map(([p,[r,e]])=>(0,o.jsx)(R,{description:i?.[r.id]?.description,threat:r,addedAt:i?.[r.id]?.addedAt?.toString(),subHeader:e.length>0?(0,o.jsxs)(d,{variant:f.H5,children:[e.length," ",b("service",e.length)]}):null,baseRoute:n,children:(0,o.jsxs)("div",{children:[(0,o.jsxs)(d,{className:h.sectionHeader,variant:f.H4,children:["Services (",e.length,")"]}),(0,o.jsx)("ul",{className:h.serviceList,children:e.map(t=>{let N=`${t.protocol} ${t.port} / ${t.transport_protocol}`,U=M.toString(),Q=x(t,n,U),_=L(D(y({kind:0,field:"host.services.threats.id",value:r.id}),y({kind:5,field:"host.services",content:`port = ${t.port} and protocol = ${t.protocol}`}),"and",!1)),I=[{to:Q,iconName:"arrow-right",label:"Go to service on host"},{to:_,iconName:"search",label:"Search for threat on service"}];return(t.threats||[]).filter(l=>l.id===r.id).map(l=>(0,o.jsx)(w,{threat:l,baseRoute:n,title:N,timestamp:t.scan_time?.toString(),actionLinks:I,ariaLabel:`Threat details for service with protocol ${t.protocol} and port ${t.port}`,testId:`threat-detail-item-${l.id}-${t.ip}-${t.port}`},`${t.ip}-${t.port}`))})})]})},p))]})}function ct(){let a=S(),s=H(),i=(0,m.useContext)(v);return(0,o.jsx)("div",{"data-testid":"host-threats-error",children:g(a)&&E(a.data)?(0,o.jsx)(C,{accessState:s,errorCode:a.data.code,env:i}):(0,o.jsx)(k,{error:a})})}export{lt as a,K as b,ct as c};
