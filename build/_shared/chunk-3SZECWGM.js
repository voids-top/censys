import{a as N}from"/censys/build/_shared/chunk-OUCDSSIX.js";import{a as B}from"/censys/build/_shared/chunk-PLG22QRR.js";import{a as U}from"/censys/build/_shared/chunk-ISPS5TGZ.js";import{d as k}from"/censys/build/_shared/chunk-OIVUAPPH.js";import{a as I}from"/censys/build/_shared/chunk-JC22C2KM.js";import{e as V,g as D,h as A}from"/censys/build/_shared/chunk-6D64NL5L.js";import{a as R}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{a as $}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as T}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{a as L}from"/censys/build/_shared/chunk-FQTIU6PB.js";import{a as x}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{e as b}from"/censys/build/_shared/chunk-D5QEORL2.js";import{A as l,_ as H,z as d}from"/censys/build/_shared/chunk-GALQBYYN.js";import{c as C}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{a as y,k as g,p as S}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as _,c as E}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as n}from"/censys/build/_shared/chunk-2QEWK57A.js";var p=n(_(),1);var m={cveLayout:"qo4tA",servicesLabel:"_24anj"};var P=n($(),1),e=n(E(),1),ao=R("CVEs","routes/hosts.$id");function M(){let[s]=S(),{collection:a,cveDetails:i,host:c}=B(),u=`/hosts/${c.ip}`;a&&(u=`/collections/${a.collection_id}${u}`);let f=(0,p.useMemo)(()=>{let r=new Map;for(let o of c.services)if(o.vulns)for(let t of o.vulns){let h=r.get(t.id);h?h[1].push(o):r.set(t.id,[t,[o]])}return Array.from(r.entries()).sort((o,t)=>k(o[1][0],t[1][0]))},[c]);return L(),(0,e.jsxs)("div",{className:m.cveLayout,children:[f.length===0&&(0,e.jsx)(l,{children:"We haven't found any publicly accessible services with CVEs on this host or the host is on our blocklist."}),f.length>0&&f.map(([r,[v,o]])=>(0,e.jsxs)(N,{cve:v,description:i?.[r]?.description,relatedLinks:i?.[r]?.links,subHeader:o.length>0?(0,e.jsxs)(l,{variant:d.H5,children:[o.length," ",x("service",o.length)]}):null,children:[o.length>0&&(0,e.jsxs)(l,{className:m.servicesLabel,variant:d.H4,children:["Services (",(0,e.jsx)(H,{value:o.length}),")"]}),(0,e.jsx)(U,{tagSize:"md",tags:o.map(t=>({href:A(t,u,s.toString()),label:D(t)})),maxVisibleRows:20})]},r))]})}function io(){let s=g(),a=b(),i=(0,p.useContext)(C);return(0,e.jsx)("div",{className:m.emptyState,"data-testid":"host-cves-error",children:y(s)&&V(s.data)?(0,e.jsx)(I,{accessState:a,errorCode:s.data.code,env:i}):(0,e.jsx)(T,{error:s})})}export{ao as a,M as b,io as c};
