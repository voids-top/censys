import{a as u}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as A}from"/censys/build/_shared/chunk-HPK4AUA3.js";import{B as m,a as p,x as c}from"/censys/build/_shared/chunk-QJVHIZ52.js";var E="/censys/build/_assets/cobaltstrike-NI4ZUQZO.svg";var L="/censys/build/_assets/elasticsearch-PB4FORBT.svg";var x="/censys/build/_assets/fortigate-TD55T3IN.svg";var S="/censys/build/_assets/kubernetes-EVZQVKCW.svg";var H="/censys/build/_assets/prometheus-JGEE6EKO.svg";var s4=["image/bmp","image/jpeg","image/png","image/webp"];var d={handle:"handle",protocol:"protocol",explicitContent:"explicit_content",name:"name"},R=31536e3,p4=`public, max-age=${R}, immutable`,a="0000000000000000";var C=(e,t)=>`/api/image?${d.handle}=${e}&${d.protocol}=${t}`;function C4(e,t){let o=new Map,r=t?.includeDescription??!1,l=t?.port;return e.protocol&&e.screenshots&&(t?.excludeAllBlackScreenshots?e.screenshots?.filter(s=>s?.phash!==a):e.screenshots).forEach(s=>{if(s?.handle&&!o.has(s.handle)){let n={src:C(s.handle,e.protocol)};r&&l!==void 0&&(n.description=`${e.protocol} on port ${l}`),o.set(s.handle,n)}}),e.endpoints?.forEach(i=>{if(!i?.endpoint_type||!i.screenshots)return;(t?.excludeAllBlackScreenshots?i.screenshots?.filter(n=>n?.phash!==a):i.screenshots).forEach(n=>{if(!n?.handle)return;let g={src:C(n.handle,i.endpoint_type)};r&&l!==void 0&&(g.description=`${i.endpoint_type} on port ${l}`),o.set(n.handle,g)})}),Array.from(o.values())}var m4=p.ipv4(),A4=p.ipv6(),E4=p.cidrv4(),L4=p.cidrv6(),I="(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])",w=new RegExp(`^${I}$`),M="(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))",W=new RegExp(`^${M}$`),D="((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9]).){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])/([0-9]|[1-2][0-9]|3[0-2])",x4=new RegExp(`^${D}$`),F="(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})/(12[0-8]|1[01][0-9]|[1-9]?[0-9])",S4=new RegExp(`^${F}$`),v=/\[?\.\]?/g,U=/\[?\:\]?/g,P=/\[?\:\:\]?/g;function h(e){return k(e)||O(e)}function k(e){return typeof e=="string"&&w.test(e)}function O(e){return typeof e=="string"&&W.test(e)}function Z(e){return typeof e!="string"?null:e.replaceAll(v,".").replaceAll(P,"::").replaceAll(U,":")}function H4(e){return typeof e=="string"&&h(Z(e))}var $=/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/,N=/^\d+$/,K=/\[?\.\]?/g,P4=e=>{if(typeof e!="string")return!1;let t=e.replaceAll(K,".");return f(t)};function f(e){if(typeof e!="string")return!1;let t=e.match(/^(.*):(\d+)$/);if(!t)return!1;let[o,r]=t.slice(1);return N.test(r)?$.test(o)||h(o):!1}function z(e){if(!f(e))return;let t=e.match(/^(.*):(\d+)$/);if(!t)return;let[o,r]=t.slice(1);return{hostname:o,port:parseInt(r,10)}}function G(e){return`${e.hostname}:${e.port}`}function q(e){switch(e.endpoint_type){case"ELASTICSEARCH":return"Elasticsearch";case"KUBERNETES":return"Kubernetes";case"PROMETHEUS":return"Prometheus";case"FORTIGATE":return"Fortigate";case"COBALT_STRIKE":return"Cobalt Strike";default:return e.endpoint_type}}function X(e){if(e.elasticsearch)return"elasticsearch";if(e.kubernetes)return"kubernetes";if(e.prometheus)return"prometheus";if(e.fortigate)return"fortigate";if(e.cobalt_strike)return"cobalt_strike"}function Q(e){return m(c({kind:0,field:"web.hostname",value:e.hostname}),c({kind:0,field:"web.port",value:e.port}),"and",!1)}function j(e){return`${e.path}-${e.transport_protocol}-${e.endpoint_type}`}function Y(e){switch(e){case"cobalt_strike":return"Cobalt Strike";default:return A(e)}}function J(e){switch(e){case"cobalt_strike":return{path:E,altText:`${"cobalt_strike"} logo`};case"elasticsearch":return{path:L,altText:`${"elasticsearch"} logo`};case"fortigate":return{path:x,altText:`${"fortigate"} logo`};case"kubernetes":return{path:S,altText:`${"kubernetes"} logo`};case"prometheus":return{path:H,altText:`${"prometheus"} logo`}}}function e4(e){return e?.find(t=>t.http?.html_title)?.http?.html_title}function k4(e,t){return e.screenshots?(t?.excludeAllBlackScreenshots?e.screenshots?.filter(r=>r?.phash!==a):e.screenshots)?.map(r=>r.handle&&e.endpoint_type?{src:C(r.handle,e.endpoint_type)}:void 0).filter(u):[]}export{h as a,H4 as b,s4 as c,d,a as e,C4 as f,P4 as g,z as h,G as i,q as j,X as k,Q as l,j as m,Y as n,J as o,e4 as p,k4 as q};
