import{a as o}from"/censys/build/_shared/chunk-WK35ORSL.js";import{a as T}from"/censys/build/_shared/chunk-2RV3CGNA.js";import{i}from"/censys/build/_shared/chunk-VQ4M4AGG.js";var u=(n=>(n.CHROME="chrome",n.EDGE="edge",n.FIREFOX="firefox",n.SAFARI="safari",n))(u||{});function W(t,r){return t?.subject?.common_name&&t.subject.common_name.length>0?t.subject.common_name[0]:t?.subject_dn?t?.subject_dn:r}function _(t,r,s,e){if(r===i.Certificate_CertificateType.LEAF){if(t)return"Self-Signed";if(s)return"Trusted";if(e)return"Previously Trusted"}else if(r===i.Certificate_CertificateType.INTERMEDIATE){if(s)return"Trusted Intermediate";if(e)return"Historical Intermediate"}else if(r===i.Certificate_CertificateType.ROOT){if(s)return"Trusted Root";if(e)return"Historical Root"}else if(r===i.Certificate_CertificateType.UNKNOWN&&t)return"Self-Signed";return"Untrusted"}var A=new Set(["Trusted","Trusted Intermediate","Trusted Root"]);function l(t,r,s,e){let n=_(t,r,s,e);return{status:n,isTrusted:A.has(n)}}var U=/^[a-fA-F0-9]{64}$/;function S(t){return typeof t!="string"?!1:U.test(t)}function D(t){let r=T(t);return Temporal.Instant.compare(Temporal.Now.instant(),r)>0}var c=t=>t.replace(/(..)(?=..)/g,"$1:\u200B");function I(t){if(t.length===0)return;let r=t.flatMap(e=>{let n=e?.parsed?.signature?.self_signed;return[e?.validation?.chrome,e?.validation?.microsoft,e?.validation?.nss,e?.validation?.apple].filter(o).map(a=>{let E=a.type,d=a.is_valid,p=a.ever_valid,{isTrusted:f,status:g}=l(n,E,d,p);return{isTrusted:f,status:g}})}),s=r.find(({status:e})=>e!=="Trusted")?.status||"Trusted";return{aggregatedStatus:r.every(e=>e.isTrusted)?"All Trusted":r.some(e=>e.isTrusted)?"Partially Trusted":"No Trust",isTrusted:r.every(e=>e.isTrusted),status:s}}export{u as a,W as b,l as c,S as d,D as e,c as f,I as g};
