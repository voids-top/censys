import{a as l}from"/censys/build/_shared/chunk-WK35ORSL.js";import{B as u,x as a,z as i}from"/censys/build/_shared/chunk-QJVHIZ52.js";function w(e,n){let r=e.reduce((o,t)=>{let s=p(t,n);if(!s)return o;let c={confidence:t.confidence||0,label:s,cpe:t.cpe,product:t.product,vendor:t.vendor},d=o.get(t.product);return(!d||c.confidence>d.confidence)&&o.set(t.product,c),o},new Map);return Array.from(r.values())}function p(e,n){let r=n?e.vendor.trim():"",o=e.product.trim(),t=e.version.trim();return!o&&!r?null:[!(r&&o.toLowerCase().startsWith(r.toLowerCase()))&&r?r:"",o,t].filter(l).join(" ").replaceAll("_"," ").replaceAll(/\b\w/g,d=>d.toUpperCase())}function y(e,n,r){return r&&e.cpe?i({kind:0,field:`${n}.cpe`,value:e.cpe}):e.vendor&&!e.product?i(a({kind:0,field:`${n}.vendor`,value:e.vendor})):e.product&&!e.vendor?i(a({kind:0,field:`${n}.product`,value:e.product})):i({kind:5,field:n,content:u(a({kind:0,field:"vendor",value:e.vendor}),a({kind:0,field:"product",value:e.product}),"and",!1)})}export{w as a,p as b,y as c};
