import{a as Kr,b as Xr}from"/build/_shared/chunk-EFKOGGO3.js";import{a as qr}from"/build/_shared/chunk-TVSZBFAR.js";import{a as Wr}from"/build/_shared/chunk-ZI5VZYCA.js";import{a as _a}from"/build/_shared/chunk-NM5TSDRZ.js";import{a as Qr,b as Gr}from"/build/_shared/chunk-SRUDFCT7.js";import{a as me}from"/build/_shared/chunk-GKOF6QGC.js";import{a as zr}from"/build/_shared/chunk-5HUKVACE.js";import{a as Vr}from"/build/_shared/chunk-QSPTGMZY.js";import{a as Br}from"/build/_shared/chunk-NGGQ6X6W.js";import{a as Yr}from"/build/_shared/chunk-ZD7QYARS.js";import{a as wr}from"/build/_shared/chunk-AKZYFWPJ.js";import{a as Ir,b as Mr}from"/build/_shared/chunk-DDZX7K4F.js";import{b as Ve}from"/build/_shared/chunk-IHXQKSC2.js";import{a as ze}from"/build/_shared/chunk-3IID2F3B.js";import{a as $r,b as Qe,e as pe}from"/build/_shared/chunk-ZDOHYF7S.js";import{b as Fr,c as We,d as xr,i as Pr,k as Dr}from"/build/_shared/chunk-TUFJ6JAI.js";import{a as ce}from"/build/_shared/chunk-T4CQEEYS.js";import{b as qe}from"/build/_shared/chunk-GMNB7RSU.js";import{a as Or}from"/build/_shared/chunk-SNE5KUVT.js";import{a as le,c as Ur,d as O}from"/build/_shared/chunk-AIDQO3P6.js";import{a as Ar}from"/build/_shared/chunk-6PRZAB44.js";import{a as Ra}from"/build/_shared/chunk-EAJKCKTG.js";import{a as Be}from"/build/_shared/chunk-LQXVLPA4.js";import{a as Hr}from"/build/_shared/chunk-6GD6JLZ2.js";import{o as _r}from"/build/_shared/chunk-ZMYU5ULY.js";import{a as ur}from"/build/_shared/chunk-3JU625ZU.js";import{b as Pe,g as De}from"/build/_shared/chunk-JLZAPT5W.js";import{b as gr,c as pt,d as yr,e as x}from"/build/_shared/chunk-FSKKJDZY.js";import{B as Rr,b as or,d as vr,e as Sr,f as Oe,g as Cr,h as mt,z as $e}from"/build/_shared/chunk-W5Y6TOHF.js";import{g as Tr,i as br,l as Lr}from"/build/_shared/chunk-AEP7YWHE.js";import{a as Q}from"/build/_shared/chunk-WK35ORSL.js";import{a as N}from"/build/_shared/chunk-HG7D3PDC.js";import{c as g}from"/build/_shared/chunk-G6DKMBFA.js";import{a as kr}from"/build/_shared/chunk-Q3AERUF4.js";import{a as dt}from"/build/_shared/chunk-WNJFRA3F.js";import{a as dr}from"/build/_shared/chunk-KIDII43I.js";import{a as sr}from"/build/_shared/chunk-2G5R6E4Q.js";import{a as ir}from"/build/_shared/chunk-6XVOHWMX.js";import{h as hr,i as fr,s as Er,t as Nr}from"/build/_shared/chunk-HLRAT4GD.js";import{a as C}from"/build/_shared/chunk-W2GUOEY7.js";import{d as rr,f as Te,j as ar}from"/build/_shared/chunk-FQAS3FYV.js";import{e as xe}from"/build/_shared/chunk-FH7VNUY3.js";import{c as Jt}from"/build/_shared/chunk-B7DSLLNE.js";import{E as Me,F as mr,G as Ue,i as nr,k as lr,l as lt,m as cr,n as Ie,v as ct,y as pr}from"/build/_shared/chunk-KMD3IRPL.js";import{A as u,B as d,C as Se,Ta as ne,_ as er,aa as Ce,sa as ie,ua as tr,va as se,y as Fe,z as jt}from"/build/_shared/chunk-UYH4GQ7Z.js";import{a as Qt,c as Z,g as ae,i as Gt,k as Kt,l as Yt,p as oe,r as Xt,z as Zt}from"/build/_shared/chunk-Q6RLBVJI.js";import{a as F,c as l}from"/build/_shared/chunk-XJAPXWKX.js";import{d as s}from"/build/_shared/chunk-2QEWK57A.js";var Ee=s(F(),1);var Ge=s(F(),1);var ut={sidebar:"_6BA67",sidebarContent:"_9-GNN"};var ht=s(l(),1);function be({children:e,className:t,...o}){let a=(0,Ge.useRef)(null);return(0,Ge.useEffect)(()=>{let r=()=>{if(!a.current)return;let i=a.current.getBoundingClientRect();a.current.style.setProperty("--sidebar-top-position",`${i.top}px`)},n=new ResizeObserver(r);return a.current&&n.observe(a.current),r(),()=>{n.disconnect()}},[]),(0,ht.jsx)("aside",{ref:a,className:Fe(ut.sidebar,t),...o,children:(0,ht.jsx)("div",{className:ut.sidebarContent,children:e})})}var Ke={skeletonFilterCategory:"xBuHn",category:"vQGbz",filter:"OneKU"};var G=s(l(),1);function de({items:e=3}){return(0,G.jsxs)("div",{className:Ke.skeletonFilterCategory,children:[(0,G.jsxs)("div",{className:Ke.category,children:[(0,G.jsx)(jt,{icon:"arrow-down-s-line",size:"sm"}),(0,G.jsx)(x,{variant:u.H5,color:"heading",width:100})]}),Array.from(Array(e).keys()).map((t,o)=>(0,G.jsxs)("div",{className:Ke.filter,children:[(0,G.jsx)(x,{width:100}),(0,G.jsx)(x,{variant:u.SMALL,width:25,color:"secondary"})]},o))]})}var ft={skeletonFilterSidebar:"Erl6u",skeletonContent:"_4sYK9"};var $=s(l(),1);function ue({isEmpty:e}){return(0,$.jsx)(be,{className:ft.skeletonFilterSidebar,children:!e&&(0,$.jsxs)("div",{role:"menu","aria-busy":!0,className:ft.skeletonContent,children:[(0,$.jsx)(de,{}),(0,$.jsx)(N,{variant:"line--horizontal",size:"100%"}),(0,$.jsx)(de,{items:4}),(0,$.jsx)(N,{variant:"line--horizontal",size:"100%"}),(0,$.jsx)(de,{items:5}),(0,$.jsx)(N,{variant:"line--horizontal",size:"100%"}),(0,$.jsx)(de,{})]})})}var R={card:"UFC99",header:"_9P5QI",assetDetails:"cIoWU",headerText:"-RtEs",cardBody:"q39jD",labels:"c0uoO",columns:"-bzy-",detailRows:"X3IvY",detailRow:"By-re",label:"wfw-2",services:"_0FM1c",divider:"_3W6oC"};var f=s(l(),1);function j(){return(0,f.jsx)(gr,{className:R.card,header:(0,f.jsxs)("div",{className:R.header,children:[(0,f.jsxs)("div",{className:R.assetDetails,children:[(0,f.jsx)(yr,{size:24}),(0,f.jsxs)("div",{className:R.headerText,children:[(0,f.jsx)(x,{variant:u.SMALL_NUMERAL,width:200}),(0,f.jsx)(N,{variant:"dot",inheritColor:!0}),(0,f.jsx)(x,{variant:u.H5,width:100,color:"secondary"})]})]}),(0,f.jsx)(x,{width:160})]}),children:(0,f.jsxs)("div",{className:R.cardBody,children:[(0,f.jsx)("div",{className:R.labels,children:Array.from({length:3}).map((e,t)=>(0,f.jsx)(pt,{},t))}),(0,f.jsxs)("div",{className:R.columns,children:[(0,f.jsxs)("div",{className:R.detailRows,children:[(0,f.jsx)(gt,{width:120}),(0,f.jsx)(gt,{width:100}),(0,f.jsx)(gt,{width:150})]}),(0,f.jsxs)("div",{className:R.services,children:[(0,f.jsx)(x,{variant:u.SMALL,width:100,color:"secondary"}),(0,f.jsx)("div",{className:R.labels,children:Array.from({length:2}).map((e,t)=>(0,f.jsx)(pt,{size:"small",width:60},t))})]})]}),(0,f.jsx)(N,{className:R.divider,variant:"line--horizontal",size:"100%",inheritColor:!0}),(0,f.jsxs)("div",{className:R.detailRow,children:[(0,f.jsx)("div",{className:R.label,children:(0,f.jsx)(x,{width:120,color:"secondary"})}),(0,f.jsx)(x,{width:90})]})]})})}var gt=({width:e})=>(0,f.jsxs)("div",{className:R.detailRow,children:[(0,f.jsx)("div",{className:R.label,children:(0,f.jsx)(x,{variant:u.SMALL,color:"secondary",width:e-10})}),(0,f.jsx)(x,{width:e})]});var Ye={resultsContainer:"A6s6D",resultsText:"_1Qurq",resultCards:"umhsr"};var k=s(l(),1);function Le(){let{t:e}=g();return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ue,{}),(0,k.jsxs)("div",{className:Ye.resultsContainer,children:[(0,k.jsx)("div",{className:Ye.resultsText,children:(0,k.jsx)(d,{children:e("Searching every corner of the internet...")})}),(0,k.jsxs)("div",{className:Ye.resultCards,"data-testid":"search-loading",children:[(0,k.jsx)(j,{}),(0,k.jsx)(j,{}),(0,k.jsx)(j,{}),(0,k.jsx)(j,{})]})]})]})}var Zr={contentWrapper:"HAjRM"};var Jr="field",jr="num_buckets",ea="50";function ta(e,t,o,a){let r=`?q=${o}&${Jr}=${e}&${jr}=${ea}`,n="report";t(a?`/collections/${a}/${n}/data/table${r}`:`/search/${n}/data/table${r}`)}function Xe(e,t){return Ue(e)?lr[e].filter(a=>t.has(Me(a))):[]}var Ze=s(l(),1);function ra({filters:e,dataSets:t,applyFilter:o,viewAggregation:a}){let r=lt.every(i=>!e[i]?.buckets?.length),n=i=>{let c=Xe(i,t),m=c.length===1?c[0]:i;return e[i]?.buckets.length?(0,Ze.jsx)(Br,{onApplyFilter:o,onViewAggregation:mr(i)||m!==i?a:void 0,field:i,buckets:e[i].buckets,title:cr[i]},i):null};return(0,Ze.jsx)(be,{"aria-label":"Select a filter to narrow down your results",children:!r&&(0,Ze.jsx)("div",{className:Zr.contentWrapper,children:lt.map(n)})})}var yt=s(l(),1);function vt({queryDataSets:e}){let{q:t,submitSearch:o}=Ie(),[a]=oe(),r=fr(),n=Sr(),i=ur(()=>{let h=[["q",t],["data_sets",e.join(",")]];return r?.collection_id&&h.push(["collection_id",r.collection_id]),`/api/filters?${new URLSearchParams(h).toString()}`},[t,r?.collection_id,JSON.stringify(e)]),c=(0,Ee.useMemo)(()=>new Set(e),[e]),m=(0,Ee.useCallback)((h,y,A)=>{let U;if(Array.isArray(h)){if(h.length===0)return;let E=h.filter(re=>c.has(nr.DataSet.DATA_SET_UNSPECIFIED)||c.has(Me(re))),w=E.reduce((re,st)=>pr(re,ct({kind:0,field:st,value:y}),"or",!1),"");if(E.length===0)return;let ve=E.length>1;o({q:A?ve?`not (${w})`:`not ${w}`:ve?`(${w})`:w});return}if(h==="type"){let E;switch(y){case"cert":E="cert.fingerprint_sha256";break;case"web":E="web.port";break;case"host":default:E="host.ip";break}U={field:E,kind:1,value:"*",escape:!1}}else U={kind:0,field:h,value:y};let H=ct(U);o({q:A?`not ${H}`:H})},[o,c]),v=(0,Ee.useCallback)(h=>{if(Ue(h)){let y=Xe(h,c);if(y.length===1)h=y[0];else return}ta(h,n,a.get("q")??"",r?.collection_id)},[n,a,r?.collection_id,c]);return i.state===0||i.state===2?(0,yt.jsx)(ue,{isEmpty:i.state===2}):(0,yt.jsx)(ra,{applyFilter:m,dataSets:c,filters:i.data.filters,viewAggregation:v})}var $t=s(F(),1);var aa=e=>!e||!e.certificate?null:{fingerprint_sha256:e.certificate.fingerprint_sha256,parsed:{subject:{common_name:e.certificate.parsed?.subject?.common_name||[]},subject_dn:e.certificate.parsed?.subject_dn,issuer_dn:e.certificate.parsed?.issuer_dn,validity_period:{not_before:e.certificate.parsed?.validity_period?.not_before,not_after:e.certificate.parsed?.validity_period?.not_after},signature:{self_signed:e.certificate.parsed?.signature?.self_signed||!1}},modified_at:e.certificate.modified_at,added_at:e.certificate.added_at,names:e.certificate.names,validation:{chrome:{is_valid:e.certificate.validation?.chrome?.is_valid||!1,ever_valid:e.certificate.validation?.chrome?.ever_valid||!1,type:e.certificate.validation?.chrome?.type||"UNKNOWN"},apple:{is_valid:e.certificate.validation?.apple?.is_valid||!1,ever_valid:e.certificate.validation?.apple?.ever_valid||!1,type:e.certificate.validation?.apple?.type||"UNKNOWN"},microsoft:{is_valid:e.certificate.validation?.microsoft?.is_valid||!1,ever_valid:e.certificate.validation?.microsoft?.ever_valid||!1,type:e.certificate.validation?.microsoft?.type||"UNKNOWN"},nss:{is_valid:e.certificate.validation?.nss?.is_valid||!1,ever_valid:e.certificate.validation?.nss?.ever_valid||!1,type:e.certificate.validation?.nss?.type||"UNKNOWN"}}},oa=e=>!e||!e.host?null:{ip:e.host.ip,labels:e.host.labels?.map(t=>({value:t.value})),location:{city:e.host.location?.city,country:e.host.location?.country,country_code:e.host.location?.country_code,province:e.host.location?.province},autonomous_system:{asn:e.host.autonomous_system?.asn,name:e.host.autonomous_system?.name},dns:{reverse_dns:{names:e.host.dns?.reverse_dns?.names}},operating_system:e.host.operating_system,service_count:e.host.service_count,services:e.host.services?.map(t=>({port:t.port,protocol:t.protocol,scan_time:t.scan_time,transport_protocol:t.transport_protocol,labels:t.labels.map(o=>({value:o.value})),vulns:t.vulns||[],threats:t.threats||[]}))},ia=e=>!e||!e.web?null:{hostname:e.web.hostname,port:e.web.port,cert:e.web.cert,software:e.web.software,labels:e.web.labels,scan_time:e.web.scan_time,endpoints:e.web.endpoints,vulns:e.web.vulns||[],threats:e.web.threats||[]},Je=e=>e.includes("/collections");function sa(e){let t={asset_id:void 0,asset_type:void 0,date_updated:void 0,display_name:void 0};return e.host?.host?(t.asset_type="host",t.asset_id=e.host.host.ip,t.display_name=t.asset_id,t.date_updated=We(e.host.host)):e.certificate?.certificate?(t.asset_type="certificate",t.asset_id=e.certificate.certificate.fingerprint_sha256,t.display_name=Pe(e.certificate.certificate.parsed,t.asset_id),t.date_updated=e.certificate.certificate.modified_at):e.web?.web&&(t.asset_type="web property",t.asset_id=`${e.web.web.hostname}:${e.web.web.port}`,t.display_name=t.asset_id,t.date_updated=e.web.web.scan_time),t.asset_id&&t.asset_type?t:null}var J={resultTips:"gg5cP",headline:"_4juzy",tipList:"kBc-8",source:"ZnvKT"};var S=s(l(),1);function St(){let{t:e}=g();return(0,S.jsxs)("div",{className:J.resultTips,"data-testid":"empty-results",children:[(0,S.jsx)(d,{className:J.headline,variant:u.H1_SUB_HEADLINE,children:e("Your query returned no results.")}),(0,S.jsx)(d,{variant:u.DEFAULT_SEMIBOLD,children:e("Quick tips:")}),(0,S.jsxs)("ul",{className:J.tipList,children:[(0,S.jsxs)("li",{children:[(0,S.jsxs)(d,{children:[e("Try searching using a")," ",(0,S.jsx)(d,{className:J.source,variant:u.DEFAULT_SOURCE,children:e("key:value")})," ",e("pair. The")," "]}),(0,S.jsx)(C,{href:"/home/definitions",title:"View Data Definitions",children:e("Data Definitions")})," ",(0,S.jsx)(d,{children:e("page provides a list of keys.")})]}),(0,S.jsx)("li",{children:(0,S.jsxs)(d,{children:[e("Don't know the value? Use a wildcard")," ",(0,S.jsx)(d,{className:J.source,variant:u.DEFAULT_SOURCE,children:"(*)"})," ",e("instead to return hosts that have any value for the field.")]})}),(0,S.jsx)("li",{children:(0,S.jsxs)(d,{children:[e("Use the exact operator")," ",(0,S.jsx)(d,{className:J.source,variant:u.DEFAULT_SOURCE,children:"="})," ",e("to restrict results to exact matches.")]})})]}),(0,S.jsx)(d,{variant:u.DEFAULT_SEMIBOLD,children:e("For more information:")}),(0,S.jsx)("ul",{className:J.tipList,children:(0,S.jsxs)("li",{children:[(0,S.jsx)(d,{children:e("Read the")})," ",(0,S.jsx)(C,{href:"https://docs.censys.com/docs/censys-query-language#/",isExternal:!0,children:e("Introduction to Censys Query Language")})," ",(0,S.jsx)(d,{children:e("for information on writing queries.")})]})})]})}var Ct=s(l(),1);function na(){let e=Z();return Je(e.pathname)?(0,Ct.jsx)(Vr,{}):(0,Ct.jsx)(St,{})}var je={searchResults:"pd2r0",resultsContainer:"W63L-",resultCards:"rAnPY"};var la={highlightItem:"wGlhw"};var ee=s(l(),1);function Tt({highlight:e}){return(0,ee.jsxs)("div",{className:la.highlightItem,children:[(0,ee.jsx)("dt",{children:(0,ee.jsx)(Ur,{children:e.field})}),(0,ee.jsx)("dd",{children:(0,ee.jsx)(dr,{highlightVariant:e.negative?"negative":"default",typographyVariant:u.SMALL_SOURCE,pre:e.segment?.pre,match:e.segment?.match,post:e.segment?.post})})]})}var B={tooltipContent:"pyTFj",tooltipTrigger:"-Ncht",ctaIcon:"pXkFN",highlightListSection:"-Mtxq",headerContainer:"gRgfD",header:"_0C6as",headerText:"BPv3Q",dividerLine:"KgSpn",highlightList:"OmLts",none:"xiRoh"};var P=s(l(),1),ka="Highlights the exact fields in each result that match your query terms.";function et({listKey:e,highlights:t,hasHighlightEntitlement:o}){let{t:a}=g();return typeof o!="boolean"?null:(0,P.jsxs)("div",{className:B.highlightListSection,children:[(0,P.jsxs)("div",{className:B.headerContainer,children:[(0,P.jsxs)(d,{className:B.header,variant:u.H5,as:"span",children:[(0,P.jsx)(ir,{icon:"lightbulb-flash-line",iconLabel:"Matched Fields",content:ka,side:"left",contentClassName:B.tooltipContent,triggerClassName:B.tooltipTrigger}),(0,P.jsx)("span",{className:B.headerText,children:a("Matched Fields")}),(0,P.jsx)("span",{className:B.dividerLine})]}),!o&&(0,P.jsx)("span",{className:B.ctaIcon,children:(0,P.jsx)(sr,{action:"search"})})]}),o&&(0,P.jsx)("dl",{className:B.highlightList,children:t.length>0?t.map((r,n)=>(0,P.jsx)(Tt,{highlight:r},`${e}-${r.field}-${n}`)):(0,P.jsx)(d,{variant:u.DEFAULT_ITALICS,className:B.none,children:a("None")})})]})}var pa=s(F(),1);var ca={paginationContainer:"hG1k9"};var he=s(l(),1);function bt({nextCursor:e,pageLimitMessage:t,previousCursor:o,onCursorChange:a}){let{t:r}=g(),n=_r(),i=(0,pa.useCallback)(m=>()=>{n(),a(m||void 0)},[a,n]),c=(0,he.jsx)(Ce,{onClick:i(e),disabled:!e||!!t,variant:Se.DEFAULT,iconRight:t?"lock-star":"arrow-right-s",iconRightMode:"line",type:"submit",value:e?.toString(),name:"cursor",children:r("Next")});return(0,he.jsxs)("div",{className:ca.paginationContainer,children:[(0,he.jsx)(Ce,{onClick:i(o),disabled:!o,variant:Se.DEFAULT,iconLeft:"arrow-left-s",iconLeftMode:"line",type:"submit",value:o?.toString(),name:"cursor",children:r("Previous")}),t!==null?(0,he.jsx)(ne,{content:t,children:c}):c]})}var fe={resultHeader:"TAmZh",suffix:"vtoPM",durationNumber:"RTJVc",gray8:"E-l0f",downloadButton:"GTBhI"};var _=s(l(),1);function Lt({durationMs:e,currentPageSize:t,totalHits:o,onDownloadCsv:a}){let r=Ir(o),n=(e/1e3).toFixed(2),{t:i}=g();return(0,_.jsxs)("div",{className:fe.resultHeader,children:[(0,_.jsx)(d,{"aria-hidden":!0,variant:u.H5,children:i("Results:")}),(0,_.jsx)(d,{variant:u.H4,className:fe.gray8,"aria-label":`${r} ${dt("result",o)}`,children:r}),(0,_.jsx)(N,{"aria-hidden":!0,variant:"dot",size:4,spacing:6}),(0,_.jsx)(d,{"aria-hidden":!0,variant:u.H5,children:i("Duration:")}),(0,_.jsxs)(d,{variant:u.H4,className:fe.durationNumber,"aria-label":`The query took ${n} seconds to complete`,children:[n,(0,_.jsx)("span",{className:fe.suffix,children:"s"})]}),a&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(N,{"aria-hidden":!0,variant:"line--vertical"}),(0,_.jsx)(ne,{content:"Download the current page of results as a CSV",tabIndex:-1,children:(0,_.jsxs)(Ce,{className:fe.downloadButton,iconLeft:"download-2",variant:Se.TERTIARY,onClick:a,"data-testid":"download-button",children:["Download CSV (",(0,_.jsx)(er,{value:t})," page"," ",dt("result",t),")"]})})]})]})}var te={cardHeaderContainer:"KidRo",cardHeaderContent:"ZW9k0",cardHeaderContentLeft:"lJbkl",displayNameContent:"SMBE7",displayName:"qnT0K",cardHeaderContentRight:"rv7Bo"};var ma=s(F(),1);function tt(e){return!!e&&typeof e=="object"&&"code"in e&&ar(e.code)}function q(){let e=Z();return(0,ma.useMemo)(()=>({lastSearch:e}),[e])}function rt(e,t){return new Date(Math.max(new Date(e).getTime(),new Date(t).getTime()))}var D=s(l(),1);function Nt({hit:{fingerprint_sha256:e,parsed:t,modified_at:o},baseURL:a}){let r=Pe(t,e),n=q(),{t:i}=g();return(0,D.jsxs)("div",{className:te.cardHeaderContainer,children:[(0,D.jsx)(ce,{assetType:"certificate",showBorder:!1,size:"md"}),(0,D.jsxs)("div",{className:te.cardHeaderContent,children:[(0,D.jsxs)("div",{className:te.cardHeaderContentLeft,children:[(0,D.jsx)("div",{className:te.displayNameContent,children:(0,D.jsx)(C,{state:n,href:a,title:i("View Details",{displayName:r}),variant:"nav",size:"lg",children:(0,D.jsx)("span",{className:te.displayName,children:r})})}),(0,D.jsx)(N,{variant:"dot"}),(0,D.jsx)(d,{variant:u.H5,children:i("Certificate")})]}),(0,D.jsx)("div",{className:te.cardHeaderContentRight,children:o&&(0,D.jsx)(Be,{timestamp:o})})]})]})}var ua=s(F(),1);var da={tableContainer:"elFe6"};var z=s(l(),1);function Rt(e){let{t}=g(),{parsed:o,names:a}=e,r=(0,ua.useMemo)(()=>De([e])?.aggregatedStatus,[e]);return(0,z.jsx)("div",{className:da.tableContainer,children:(0,z.jsxs)(le,{children:[(0,z.jsx)(O,{label:t("Issuer"),content:o?.issuer_dn}),(0,z.jsx)(O,{label:t("Validity Period"),content:(0,z.jsx)(Wr,{before:o?.validity_period?.not_before,after:o?.validity_period?.not_after})}),(0,z.jsx)(O,{label:t("Browser Trust"),content:r&&(0,z.jsx)(Ve,{aggregatedStatus:r})}),(0,z.jsx)(O,{label:t("All Names"),content:a&&a.join(" ")})]})})}var _t={cardBodyContent:"rlZPP"};var K=s(l(),1);function Ht({hit:e,labels:t,children:o}){let a=ae(),r=a.id?`/collections/${a.id}/certificates/${e.fingerprint_sha256}`:`/certificates/${e.fingerprint_sha256}`,n=a.id?`/collections/${a.id}/results`:"/censys";return(0,K.jsx)("div",{"data-testid":"cert-details-card",children:(0,K.jsxs)(se,{variant:ie.INTERACTIVE,header:(0,K.jsx)(Nt,{hit:e,baseURL:r}),children:[(0,K.jsxs)("div",{className:_t.cardBody,children:[(0,K.jsx)(me,{baseURL:n,labels:t,resourceType:"certificate"}),(0,K.jsx)("div",{className:_t.cardBodyContent,children:(0,K.jsx)(Rt,{...e})})]}),o]})})}var He=s(F(),1);var kt=s(F(),1);var ge={container:"nphuy",ip:"apoUv",cardHeaderContent:"_5xwlU",noMargin:"YdqcL",dnsText:"YBVJJ"};var V=s(l(),1);function At({historyLimitDays:e,hit:t,baseURL:o}){let{ip:a,dns:r}=t,n=q(),i=(0,kt.useMemo)(()=>{let v=We(t);return!v||Dr(v,e)?void 0:v},[e,t]),c=(0,kt.useMemo)(()=>`${o}${i?`?at_time=${encodeURIComponent(rt(i,Date.now()-24*60*60*1e3).toISOString())}`:""}`,[o,i]),{t:m}=g();return(0,V.jsxs)("div",{className:ge.container,children:[(0,V.jsx)(ce,{assetType:"host",showBorder:!1,size:"md"}),(0,V.jsxs)("div",{children:[(0,V.jsxs)("div",{className:ge.cardHeaderContent,children:[(0,V.jsx)(C,{state:n,href:c,title:m("View Details",{displayName:a}),variant:"nav",size:"lg",children:(0,V.jsx)("div",{className:ge.ip,children:a})}),(0,V.jsx)(N,{variant:"dot"}),(0,V.jsx)(d,{className:ge.noMargin,variant:u.H5,children:m("Host")})]}),r?.reverse_dns?.names&&r.reverse_dns.names.length>0&&(0,V.jsx)(d,{className:ge.dnsText,children:r?.reverse_dns?.names[0]})]})]})}var wt={tableContainer:"XAgns",cardBodyContent:"ABSCp",flagIcon:"_9kilE"};var Y=s(l(),1);function Ft({location:e,autonomous_system:t,operating_system:o}){let{t:a}=g(),r=e&&e.province&&`${e.province} `||"";return(0,Y.jsx)("div",{className:wt.tableContainer,children:(0,Y.jsxs)(le,{children:[(0,Y.jsx)(O,{label:a("Network (AS)"),content:t&&t.asn&&t.name&&`${t.name} (${t.asn})`}),(0,Y.jsx)(O,{label:a("Location"),content:e&&(0,Y.jsxs)(d,{children:[`${e?.city}, ${r}(${e?.country_code?.toUpperCase()})`,e?.country_code&&(0,Y.jsx)(kr,{size:"sm",className:wt.flagIcon,countryCode:e.country_code})]})}),o?.product&&(0,Y.jsx)(O,{label:a("OS"),content:`${qr(o)}`})]})})}var fa=s(F(),1);var Re={tagList:"_7HVDs",tagListTitle:"SASe8",container:"aEH-Z",servicesList:"FDhX4"};function ha(e,t){if(!t)return[];let o=new Map,a=[];for(let r of t){let n=r.protocol,i=r.port,c=r.transport_protocol;if(n&&i!==void 0&&c!==void 0){let v=`${i===0?Fr:i} / ${n}`,h=`${e}#${xr(r)}`,y={label:v,href:h};r.vulns?.length>0&&(y.vulns=r.vulns),r.threats?.length>0&&(y.threats=r.threats),o.has(n)?a.push(y):o.set(n,y)}}return[...o.values(),...a]}var W=s(l(),1);function xt({hit:{service_count:e,services:t=[]},baseURL:o,shouldShowCves:a,shouldShowThreats:r}){let n=(0,fa.useMemo)(()=>{let c=ha(o,t).slice(0,20);return t.length>20?[...c,{href:o,label:"..."}]:c},[o,t]),{t:i}=g();return(0,W.jsx)("div",{className:Re.container,children:!!n.length&&(0,W.jsxs)("div",{className:Re.tagList,children:[(0,W.jsx)(d,{variant:u.SMALL,className:Re.tagListTitle,children:`${e||t.length} ${e>1||t.length>1?i("Total Services"):i("Total Service")}`}),(0,W.jsx)(ze,{customClassNames:{expandableList:Re.servicesList},tags:n.map(c=>{let m=a&&!!c.vulns?.length,v=r&&(c.threats?.some(h=>h.name?.trim()!=="")??!1);return{href:c.href,label:c.label,contentLeft:(m||v)&&(0,W.jsxs)(W.Fragment,{children:[m&&(0,W.jsx)($r,{"aria-label":"Censys found a CVE on this service.",severity:pe(c.vulns)}),v&&(0,W.jsx)(Or,{"aria-label":"Censys found a threat on this service."})]})}}),maxVisibleRows:n.length+1})]})})}var _e={cardBodyContent:"_9VJbz",labelOverview:"nEiB1"};function ga(e){return Array.from(new Set([...e.labels.map(t=>t.value).filter(Q),...e.services.flatMap(t=>t.labels).map(t=>t.value).filter(Q)])).sort()}function ya(e){return Array.from(new Set(e.services.flatMap(t=>t.threats).map(t=>t.name).filter(Q))).sort()}var I=s(l(),1);function Pt({historyLimitDays:e,hit:t,children:o}){let[a,r]=Te([5,11]),n=!!a,i=!!r,c=ae(),m=c.id?`/collections/${c.id}/hosts/${t.ip}`:`/hosts/${t.ip}`,v=c.id?`/collections/${c.id}/results`:"/censys",h=q(),y=(0,He.useMemo)(()=>Pr(t),[t]),A=(0,He.useMemo)(()=>pe(t.services.flatMap(E=>E.vulns)),[t]),U=(0,He.useMemo)(()=>ga(t),[t]),H=(0,He.useMemo)(()=>ya(t),[t]);return(0,I.jsx)("div",{className:_e.cardOuterContainer,"data-testid":"hostDetailsCard",children:(0,I.jsxs)(se,{variant:ie.INTERACTIVE,header:(0,I.jsx)(At,{hit:t,baseURL:m,historyLimitDays:e}),headerPadding:tr.NONE,children:[(0,I.jsxs)("div",{className:_e.cardBody,children:[(0,I.jsxs)("div",{className:_e.labelOverview,children:[n&&y>0&&(0,I.jsx)(Qe,{count:y,severity:A,state:h,to:`${m}/cves`}),i&&H?.length>0&&(0,I.jsx)(qe,{baseURL:`${m}/threats`,threats:H}),(0,I.jsx)(me,{baseURL:v,labels:U,resourceType:"host"})]}),(0,I.jsxs)("div",{className:_e.cardBodyContent,children:[(0,I.jsx)(Ft,{...t}),(0,I.jsx)(xt,{hit:t,baseURL:`${m}?isCollapsed=true`,shouldShowCves:n,shouldShowThreats:i})]})]}),o]})})}var ot=s(F(),1);var Dt={tagsContainer:"udAM2",tagListTitle:"k79Z0"};var ye=s(l(),1);function It({endpointTags:e}){let{t}=g(),o=e.slice(0,20);return(0,ye.jsxs)("div",{className:Dt.tagsContainer,children:[(0,ye.jsxs)(d,{variant:u.SMALL,className:Dt.tagListTitle,"data-testid":"endpoint-count",children:[(0,ye.jsx)(Mr,{value:e.length})," ",t("Endpoint",{count:e.length})]}),(0,ye.jsx)(ze,{tags:o,maxVisibleRows:o.length})]})}function Mt(e){try{let t=new URL(e);return t.pathname.endsWith("/")?t.host+t.pathname.slice(0,-1):t.host+t.pathname}catch{return e}}var va=s(F(),1);var X={hostIdentifier:"ZQENU",cardHeaderContainer:"pUZEp",cardHeaderContent:"DAdrn",cardHeaderContentLeft:"aLB-C",portNumber:"TcVSz",webProperty:"VFObq",cardHeaderContentRight:"_3eYla"};var M=s(l(),1);function Ut({baseURL:e,hostname:t,port:o,timestamp:a}){let r=`${t}:${o}`,n=(0,va.useMemo)(()=>`${e}${a?`?at_time=${encodeURIComponent(rt(a,Date.now()-24*60*60*1e3).toISOString())}`:""}`,[e,a]),i=q(),{t:c}=g();return(0,M.jsxs)("div",{className:X.cardHeaderContainer,children:[(0,M.jsx)(ce,{assetType:"web",showBorder:!1,size:"md"}),(0,M.jsxs)("div",{className:X.cardHeaderContent,children:[(0,M.jsxs)("div",{className:X.cardHeaderContentLeft,children:[(0,M.jsx)(C,{state:i,href:n,title:c("View Details",{displayName:r}),variant:"nav",size:"lg",children:(0,M.jsx)(Kr,{hostname:t,port:o,customClassNames:{hostIdentifier:X.hostIdentifier,port:X.portNumber}})}),(0,M.jsx)(N,{variant:"dot"}),(0,M.jsx)(d,{className:X.webProperty,variant:u.H5,children:c("Web Property")})]}),(0,M.jsx)("div",{className:X.cardHeaderContentRight,children:a&&(0,M.jsx)("div",{className:X.timestamp,children:(0,M.jsx)(Be,{timestamp:a})})})]})]})}var ke={cardBodyContent:"AH0l1",labelOverview:"dttWW",tableContainer:"BKTrl",whiteText:"YkrMX"};var Ta=s(l(),1);function Sa(e,t){let o=e.scan_time,a=Array.from(new Set(e.labels.flatMap(i=>i.value))).sort(),r=De(e.cert?[e.cert]:[])?.aggregatedStatus,n=e?.endpoints?.map(i=>{if(!i)return null;let{port:c,endpoint_type:m,path:v}=i,h,y="",A=Tr(i);if(A)h=(0,Ta.jsx)(Xr,{variant:u.SMALL,application:A});else{let{truncatedLabel:H,tooltipContent:E}=Yr(c,m,v);y=E,h=H}let U=br(i);return{label:h,href:`${t}?isCollapsed=true#${U}`,id:U,isApplication:!!A,tooltip:y}}).filter(Q).sort((i,c)=>Number(c.isApplication)-Number(i.isApplication))||[];return{timestamp:o,labels:a,aggregatedStatus:r,endpointTags:n}}function Ca(e){return Array.from(new Set(e.threats.map(t=>t.name).filter(Q))).sort()}var T=s(l(),1);function Ot({hit:e,children:t}){let[o,a]=Te([5,11]),r=!!a,{hostname:n,port:i,endpoints:c,vulns:m,threats:v}=e,h=ae(),[y]=Te([0]),A=`${Mt(n)}:${i}`,U=q(),H=h.id?`/collections/${h.id}/web/${A}`:`/web/${A}`,E=h.id?`/collections/${h.id}/results`:"/censys";if(!n||typeof i>"u")return null;let{timestamp:w,labels:ve,aggregatedStatus:re,endpointTags:st}=(0,ot.useMemo)(()=>Sa(e,H),[e]),qt=(0,ot.useMemo)(()=>Ca(e),[v]),Ea=(0,ot.useMemo)(()=>Qr(e.software,!1),[e.software]),Na=Lr(c),{t:nt}=g();return(0,T.jsxs)(se,{variant:ie.INTERACTIVE,header:(0,T.jsx)(Ut,{baseURL:H,hostname:Mt(n),port:i,timestamp:w}),children:[(0,T.jsxs)("div",{className:ke.labelOverview,children:[o&&m.length>0&&(0,T.jsx)(Qe,{count:m.length,severity:pe(m),state:U,to:`${H}/cves`}),r&&qt?.length>0&&(0,T.jsx)(qe,{baseURL:`${H}/threats`,threats:qt}),(0,T.jsx)(me,{baseURL:E,labels:ve,resourceType:"web"})]}),(0,T.jsxs)("div",{className:ke.cardBodyContent,children:[(0,T.jsx)("div",{className:ke.tableContainer,children:(0,T.jsxs)(le,{children:[(0,T.jsx)(O,{label:nt("HTML Title"),content:Na}),(0,T.jsx)(O,{label:nt("Browser Trust"),content:re!==void 0&&(0,T.jsx)(Ve,{aggregatedStatus:re})}),(0,T.jsx)(zr,{label:nt("Software"),items:Ea,listComponent:zt=>(0,T.jsx)(ne,{content:(0,T.jsxs)(d,{className:ke.whiteText,children:["Search Censys for web properties ",(0,T.jsx)("br",{})," with this software",y?"CPE":"version"]}),children:(0,T.jsx)(C,{variant:"ghost",href:Gr(zt,"web.software",y),children:zt.label})})})]})}),(0,T.jsx)(It,{endpointTags:st})]}),t]})}var b=s(l(),1);function wa(e,t,o,a){if(e.web?.web){let r=ia(e.web);return r&&(0,b.jsx)(Ot,{hit:r,children:(0,b.jsx)(et,{listKey:`${r.hostname}:${r.port}`,highlights:e.highlights,hasHighlightEntitlement:o})},`${r.hostname}:${r.port}`)}else if(e.certificate){let r=aa(e.certificate);return r&&(0,b.jsx)(Ht,{hit:r,labels:e.certificate.labels,children:(0,b.jsx)(et,{listKey:r.fingerprint_sha256,highlights:e.highlights,hasHighlightEntitlement:o})},r.fingerprint_sha256)}else if(e.host?.host){let r=oa(e.host);return r&&(0,b.jsx)(Pt,{hit:r,historyLimitDays:a,children:(0,b.jsx)(et,{listKey:e.host.host.ip,highlights:e.highlights,hasHighlightEntitlement:o})},e.host.host.ip)}return null}function Bt({historyLimitDays:e,pageLimitMessage:t,q:o,results:a,hasHighlightEntitlement:r}){let[n,i]=oe(),c=Z(),m=Je(c.pathname),v=xe()?.currentPlanType==="Enterprise",h=!!a.hits?.length,y=h||!m,A=h&&v,U=(0,$t.useCallback)(w=>{w?n.set("cursor",w):n.delete("cursor"),i(n)},[n,i]),H=(0,$t.useCallback)(()=>{if(a.hits){let w=a.hits.map(sa);try{Nr(`CensysSearch_${new Date().toISOString().split(".")[0]}`,Er(w.filter(Q)))}catch{}}},[a.hits]),E=a.hits?.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:je.resultCards,children:a.hits.map(w=>wa(w,o,r,e))}),(0,b.jsx)(bt,{pageLimitMessage:t,nextCursor:a.next_page_token||null,previousCursor:a.previous_page_token||null,onCursorChange:U})]}):(0,b.jsx)(na,{});return(0,b.jsx)("div",{className:je.searchResults,children:(0,b.jsxs)("div",{className:je.resultsContainer,children:[y&&(0,b.jsx)(Lt,{currentPageSize:a.hits?.length||0,durationMs:a.query_duration_millis||0,onDownloadCsv:A?H:void 0,totalHits:a.total_hits||0}),E]})})}var La=s(F(),1);var ba=s(F(),1);var p=s(l(),1);function xa({errorCode:e,env:t,orgState:o,searchParams:a}){let r=Pa(e,t,o,a);return(0,p.jsx)(vr,{"data-testid":`error_${String(e)}`,iconName:r.iconName,iconMode:r.iconMode,title:r.title,children:r.message})}function Pa(e,t,o,a){let{t:r}=g();switch(e){case 100001:let n;switch(o){case 0:n={title:r("You do not have enough credits to run this search."),message:(0,p.jsx)(mt,{})};break;case 1:n={title:r("You do not have enough credits on your Free account to run this search."),message:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:r("Switch to your Organization account.")}),(0,p.jsx)($e,{})]})};break;case 2:n={title:r("You do not have enough credits to run this search."),message:(0,p.jsx)(mt,{})};break;case 3:n={title:r("You do not have enough credits to run this search."),message:(0,p.jsx)("span",{children:r("Contact your Censys Sales Representative.")})};break}return{iconName:"emotion-sad",iconMode:"line",title:n.title,message:n.message};case 17e4:return{iconName:"timer-flash",title:r("Query Timeout"),message:r("Try again or optimize your query.")};case 170005:case 100007:return{iconName:"error-warning",title:r("Your query is invalid"),message:(0,p.jsxs)("div",{children:[r("Please refer to the")," ",(0,p.jsx)(C,{href:"https://docs.censys.com/docs/censys-query-language#/",isExternal:!0,children:r("Censys Query Language documentation")})," ",r("for information on writing queries.")]})};case 170002:{let i=new URLSearchParams(a);i.delete("cursor");let c;switch(o){case 0:c={title:r("The Free tier includes one page of results"),message:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("span",{children:[(0,p.jsx)(C,{href:Cr(t),isExternal:!0,children:r("Upgrade")})," ",r("to the Starter or Enterprise tier to view more results")]}),(0,p.jsxs)("span",{children:[r("Return to the")," ",(0,p.jsx)(C,{href:`.?${i.toString()}`,children:r("First page")})," ",r("Of results")]})]})};break;case 1:c={title:r("The Free tier includes one page of results"),message:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:r("Switch to your Organization account to view additional results")}),(0,p.jsx)($e,{})]})};break;case 2:c={title:r("The Starter tier includes five pages of results"),message:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("span",{children:[(0,p.jsx)(C,{href:Oe(t),isExternal:!0,children:r("Upgrade")})," ",r("to the Enterprise tier to view more results")]}),(0,p.jsxs)("span",{children:[r("Return to the")," ",(0,p.jsx)(C,{href:`.?${i.toString()}`,children:r("First page")})," ",r("Of results")]})]})};break;case 3:c={title:r("The Enterprise tier includes unlimited pages of results"),message:(0,p.jsx)("span",{children:r("Contact your Censys Sales Representative.")})};break}return{iconName:"lock-star",title:c.title,message:c.message}}case 170003:return{iconName:"lock-star",title:r("Advanced queries unavailable in your current tier"),message:(0,p.jsxs)("div",{children:[r("Access this feature with a")," ",(0,p.jsx)(C,{href:`${t.ACCOUNTS_SITE_URL}/settings/plan`,isExternal:!0,children:r("Starter")})," ",r("or")," ",(0,p.jsx)(C,{href:Oe(t),isExternal:!0,children:r("Enterprise")})," ",r("Tier Organization")]})};case 170004:{let i;switch(o){case 0:i={title:r("Feature Unavailable on your Current Tier"),message:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:r("Move up to the Starter or Enterprise tier to access this feature")}),(0,p.jsx)(C,{href:`${t.ACCOUNTS_SITE_URL}/settings/plan`,isExternal:!0,children:r("Upgrade Now")})]})};break;case 1:i={title:r("Feature unavailable on the Free Tier"),message:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:r("Switch to your Organization account to access this feature")}),(0,p.jsx)($e,{})]})};break;case 2:i={title:r("Feature Unavailable on your Current Tier"),message:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:r("Move up to the Enterprise tier to access this feature.")}),(0,p.jsx)(C,{href:Oe(t),isExternal:!0,children:r("Contact Sales")})]})};break;case 3:i={title:r("Feature Unavailable on your Current Tier"),message:(0,p.jsx)("span",{children:r("Contact your Censys Sales Representative.")})};break}return{iconName:"lock-star",title:i.title,message:i.message}}default:return Rr(e,{env:t,orgState:o})}}var Vt=(0,ba.memo)(xa);var it={container:"giZC4",errorWrapper:"xLLK1"};var Ae=s(l(),1);function we(e){let t=Yt(),o=e.error??t,a=Qt(o)?o.data:o,r=tt(a),n=!r&&a?.results?.errors?.length>0,i=xe(),c=(0,La.useContext)(Jt),[m]=oe(),v=or(i);return r||n?(0,Ae.jsx)("div",{className:Fe(it.container,it.errorWrapper),children:(0,Ae.jsx)(Vt,{errorCode:n?100007:a.code,env:c,orgState:v,searchParams:m})}):(0,Ae.jsx)("div",{className:it.container,children:(0,Ae.jsx)(Hr,{error:a})})}var Wt={resultsWrapper:"WWWTn",filterResults:"dyI0L",searchBar:"_8gc8j"};var Ua=s(_a(),1),Oa=s(Ra(),1),L=s(l(),1),Da=async({request:e,serverLoader:t})=>{let o=await t(),a=new URL(e.url),{origin:r,searchParams:n}=a,i=new URLSearchParams(n),c=i.get("q")||"",m=hr(a.pathname);i.set("q",c.trim());let v=m?`${i}&collection_id=${m.collection_id}`:`${i}`,h=fetch(`${r}/api/search?${v}`,{headers:new Headers([["Accept","application/json"]]),signal:e.signal});return Xt({capabilities:o.capabilities,hasHighlightEntitlement:o.hasHighlightEntitlement,historyLimitDays:o.historyLimitDays,data:h.then(y=>y.json()).then(y=>Ar(y))})};Da.hydrate=!0;var Xc=()=>[{title:"Censys Search Results"}];function Zc({currentUrl:e,nextUrl:t,defaultShouldRevalidate:o}){let a=e.searchParams,r=t.searchParams,n=a.has("showCode"),i=r.has("showCode");return n||i?!1:o}function Ia(){let e=Gt(),t=Z(),{capabilities:o,data:a,hasHighlightEntitlement:r,historyLimitDays:n}=Zt(),{q:i,submitSearch:c}=Ie();return e.state!=="idle"&&e.location.pathname===t.pathname?(0,L.jsx)(Ma,{}):(0,L.jsx)(rr,{value:o,children:(0,L.jsx)("div",{className:Wt.resultsWrapper,children:(0,L.jsx)(wr,{errorElement:(0,L.jsx)(we,{}),fallback:(0,L.jsx)(Le,{}),resolve:a,children:m=>{let v=tt(m),h=!v&&m.results?.errors?.length>0;return v||h?(0,L.jsx)(we,{error:m}):(0,L.jsxs)(L.Fragment,{children:[m.results.total_hits>0&&(0,L.jsx)(vt,{queryDataSets:m.results.query_datasets}),(0,L.jsx)(Bt,{historyLimitDays:n,pageLimitMessage:m.pageLimitMessage,q:i,results:m.results,submitSearch:c,hasHighlightEntitlement:r})]})}})})})}function Ma(){return(0,L.jsx)("div",{className:Wt.resultsWrapper,children:(0,L.jsx)(Le,{})})}function Jc(){let e=Kt();return(0,L.jsx)(we,{error:e})}export{Da as a,Xc as b,Zc as c,Ia as d,Ma as e,Jc as f};
