import{a as p}from"/censys/build/_shared/chunk-OFRYIVI6.js";import{a as y}from"/censys/build/_shared/chunk-XMNCU3E4.js";import{c as g,e as S}from"/censys/build/_shared/chunk-VKYVKQW2.js";import{b as T}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import{A as s,x as m,y as R,z as l}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{b as f}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as A}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as d}from"/censys/build/_shared/chunk-2TWE7TSA.js";var h={["chrome"]:"Chrome",["edge"]:"Edge",["firefox"]:"Firefox",["safari"]:"Safari"},C={["chrome"]:"chrome",["edge"]:"edge-new",["firefox"]:"firefox",["safari"]:"safari"};function N(t,o){switch(o){case"chrome":return t.certificate?.validation?.chrome||null;case"edge":return t?.certificate?.validation?.microsoft||null;case"firefox":return t?.certificate?.validation?.nss||null;case"safari":return t?.certificate?.validation?.apple||null}}var c=d(A(),1);var r={detailTable:"yi9xX",flagHeader:"lWARw",flagCell:"CXQFH",detailTableRowSpacing:"F8Rk4",browser:"NIBMp",blueText:"Z2gPd",gray5:"kQgXk"};var e=d(f(),1);function w({browser:t,isLink:o}){return(0,e.jsxs)(s,{className:m(r.browser,o&&r.blueText),children:[(0,e.jsx)(R,{name:C[t],"aria-label":`${t} logo`,mode:"fill",size:"2xl"}),h[t]]})}function E({browser:t,to:o}){return(0,e.jsx)(T,{to:o,children:(0,e.jsx)(w,{browser:t,isLink:!0})})}function M({cert:t,browser:o,to:i}){let a=(0,c.useMemo)(()=>N(t,o),[t,o]),{isTrusted:n,status:L}=(0,c.useMemo)(()=>g(t?.certificate?.parsed?.signature?.self_signed,a?.type,a?.is_valid,a?.ever_valid),[t,a]),u=t.certificate.parsed?.validity_period?.not_after;return(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:i?(0,e.jsx)(E,{browser:o,to:i}):(0,e.jsx)(w,{browser:o})}),(0,e.jsx)("td",{children:(0,e.jsx)(y,{isTrusted:n,status:L})}),(0,e.jsx)("td",{className:r.flagCell,children:(0,e.jsx)(p,{isTrusted:n,state:!!a?.has_trusted_path})}),(0,e.jsx)("td",{className:r.flagCell,children:(0,e.jsx)(p,{isTrusted:n,state:!!a?.in_revocation_set||!!t.certificate?.revoked})}),(0,e.jsx)("td",{className:r.flagCell,children:(0,e.jsx)(p,{isTrusted:n,state:u?S(u):void 0})})]})}function b({baseURL:t,browsers:o,cert:i}){return(0,e.jsxs)("table",{className:m(r.detailTable,o.length>1&&r.detailTableRowSpacing),children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:(0,e.jsx)(s,{className:r.gray5,variant:l.SMALL,children:"Browser"})}),(0,e.jsx)("th",{className:r.statusCell,children:(0,e.jsx)(s,{className:r.gray5,variant:l.SMALL,children:"Status"})}),(0,e.jsx)("th",{className:r.flagHeader,children:(0,e.jsx)(s,{className:r.gray5,variant:l.SMALL,children:"Trusted Path"})}),(0,e.jsx)("th",{className:r.flagHeader,children:(0,e.jsx)(s,{className:r.gray5,variant:l.SMALL,children:"Revoked"})}),(0,e.jsx)("th",{className:r.flagHeader,children:(0,e.jsx)(s,{className:r.gray5,variant:l.SMALL,children:"Expired"})})]})}),(0,e.jsx)("tbody",{children:o.map(a=>(0,e.jsx)(M,{browser:a,cert:i,to:o.length>1?`${t}/trust/${a}`:void 0},a))})]})}export{h as a,C as b,N as c,b as d};
