import{b as _i}from"/build/_shared/chunk-WMKH6XX3.js";import{a as Li}from"/build/_shared/chunk-3JU625ZU.js";import{a as xi}from"/build/_shared/chunk-I5BA26X4.js";import{b as mi}from"/build/_shared/chunk-RAMDI2JB.js";import{a as Si}from"/build/_shared/chunk-O3SGPCPK.js";import{a as bi}from"/build/_shared/chunk-CJIEOTRC.js";import{d as hi}from"/build/_shared/chunk-JLZAPT5W.js";import{b as vi,d as Ci,e as ue}from"/build/_shared/chunk-FSKKJDZY.js";import{a as Ii}from"/build/_shared/chunk-M7IO6GB7.js";import{E as Ni,G as Ri,c as Fa,y as yr}from"/build/_shared/chunk-W5Y6TOHF.js";import{a as yi}from"/build/_shared/chunk-AEP7YWHE.js";import{a as z}from"/build/_shared/chunk-HG7D3PDC.js";import{a as Te}from"/build/_shared/chunk-ZKAH2G64.js";import{c as b}from"/build/_shared/chunk-G6DKMBFA.js";import{a as Ti}from"/build/_shared/chunk-KIDII43I.js";import{a as Le}from"/build/_shared/chunk-RPAGMMSK.js";import{a as bo}from"/build/_shared/chunk-2G5R6E4Q.js";import{o as Ai}from"/build/_shared/chunk-HLRAT4GD.js";import{a as w}from"/build/_shared/chunk-W2GUOEY7.js";import{b as G,f as gi}from"/build/_shared/chunk-FQAS3FYV.js";import{a as _o}from"/build/_shared/chunk-P2FXGQA2.js";import{a as gr,c as di,d as vo,e as Co,f as xo,h as ie,j as dt,k as fi}from"/build/_shared/chunk-FH7VNUY3.js";import{a as hr}from"/build/_shared/chunk-GYDCO7LL.js";import{a as Sr,v as ze,y as Ei}from"/build/_shared/chunk-KMD3IRPL.js";import{$ as We,A as f,B as m,C as N,E as yo,F as oi,G as Eo,Ha as Ao,I as To,Ka as ut,La as mt,Pa as ai,Ta as wt,Ua as li,Va as pi,Xa as ci,aa as Ee,ba as j,ca as ct,da as H,ea as ri,fa as dr,ga as fr,gb as ui,lb as Io,n as go,na as ni,o as So,q as ho,r as Pe,s as pt,sa as ii,t as W,ua as Lo,va as si,x as Ge,y as R,z as h}from"/build/_shared/chunk-UYH4GQ7Z.js";import{C as ne,c as fo,q as ei,t as ti}from"/build/_shared/chunk-Q6RLBVJI.js";import{a as E,c as l}from"/build/_shared/chunk-XJAPXWKX.js";import{d as s}from"/build/_shared/chunk-2QEWK57A.js";var Ae=s(E(),1);function Ya({currentData:e,nextPageToken:t,filters:o}){let[r,n]=(0,Ae.useState)([]),i=(0,Ae.useRef)(null),a=(0,Ae.useRef)([]),p=(0,Ae.useRef)(o),c=Object.keys(o).some(u=>p.current[u]!==o[u]);return(0,Ae.useEffect)(()=>{i.current===t&&!c||(c||t&&a.current.includes(t)?(n(e),a.current=[]):n(u=>[...u,...e]),i.current=t,t&&a.current.push(t),p.current=o)},[e,t,c]),(0,Ae.useMemo)(()=>({data:r,hasNextPage:!!t,filterChanged:c}),[r,t,c])}var Pi={mainContent:"nN6Ut"};var Di=s(l(),1);function Oi({children:e,testId:t}){return(0,Di.jsx)("div",{"data-testid":t,className:Pi.mainContent,children:e})}var Er="exact-match-suggestion-item",Tr='""';var kt="Query Converter will automatically convert your Legacy Search queries into Platform queries until ",Ut="2026-09-30T09:00:00.000Z",Gt="https://docs.censys.com/docs/censys-platform-syntax-differences#/";var k=s(E(),1);var P=s(E(),1);var Xe=s(E(),1);function qa({shouldShowBanner:e}){let[t,o]=(0,Xe.useState)(e),[r,n]=(0,Xe.useState)(e),i=Sr();(0,Xe.useEffect)(()=>{e?(o(!0),n(!0)):n(!1)},[e]);let a=(0,Xe.useCallback)(()=>{r?n(!1):e||setTimeout(()=>o(!1),500)},[r,e]);return{animationState:(()=>!i&&!e||i&&!e&&!t?"hidden":r?"animatingIn":!e&&t?"animatingOut":e&&!r?"visible":"hidden")(),handleAnimationEnd:a}}var Mi=s(E(),1),Lr=()=>{let e=(0,Mi.useRef)(!1);return{suppressOnce:()=>{e.current=!0},shouldSkip:()=>e.current?(e.current=!1,!0):!1}};var ia=s(E(),1);var Ws=s(E(),1);var Xo=s(E(),1);var No=s(E(),1);var Be={moreActionsButton:"umkZa",popover:"BMDJd",popoverContentWrapper:"aiggS",action:"p-GaJ",actionLink:"_7yCGq",lock:"thisC",popoverHeading:"DFtR8"};var Qe=s(l(),1);function Ar({query:e,isValid:t}){let{t:o}=b(),[r,n]=(0,No.useState)(!1),i=!!Co(),a=Ai({query:e,source:"search"}),p=(0,No.useCallback)(()=>{n(!1)},[]);return(0,Qe.jsxs)(Io,{customClassNames:{popover:Be.popover,contentWrapper:Be.popoverContentWrapper},contentProps:{align:"end",sideOffset:4},open:r,onOpenChange:n,trigger:(0,Qe.jsx)(H,{variant:r?N.PRIMARY:N.DEFAULT,shape:ct.ROUND,size:j.LARGE,iconName:"list-settings",iconMode:"fill",type:"button","aria-label":o("Search Actions"),className:Be.moreActionsButton}),children:[(0,Qe.jsx)(m,{variant:f.H5,className:Be.popoverHeading,children:o("Search Actions")}),(0,Qe.jsxs)("div",{className:Be.action,children:[(0,Qe.jsx)(Te,{link:{title:t?"Create a collection based on this query":"Invalid query",to:a},button:{className:Be.actionLink,disabled:!t||!i,iconLeft:"add",onClick:p,variant:N.DEFAULT},children:o("Create a Collection")}),!i&&(0,Qe.jsx)(bo,{className:Be.lock,action:"unlock"})]})]})}var wi="Search Censys data for...",ki="Search Censys data using natural language or syntax...",Ir="global-search-bar-input",vr="q";var Cr={globalSearchBar:"I2r28"};var Ro="autocomplete-suggestions-group",Po="Will search across...",xr="autocomplete-locked-suggestions-group",_r="Upgrade to a higher tier",br="Exact Match",Oo="example-queries-group",Do="Example Queries",Ka="host-crushftp-vuln",Wa="hosts-exposed-polyfill",za="web-properties-google",Xa="certs-lets-encrypt",Nr=[{id:Ka,value:ze({kind:0,field:"host.services.cert.parsed.subject_dn",value:"OU=DEV, O=CrushFTP\\, LLC, L=Lake Tahoe, ST=NV, C=US, emailAddress=support@crushftp.com, CN=www.crushftp.com"}),label:"Hosts with CrushFTP zero-day virtual file system escape vulnerability CVE-2024-4040"},{id:Wa,value:ze({kind:5,field:"host.services",content:'"cdn.bootcdn.net" or "cdn.bootcss.com" or "cdn.staticfile.net" or "cdn.staticfile.org"'}),label:"Exposed hosts referencing associated, potentially malicious Polyfill domains"},{id:za,value:ze({kind:0,field:"web.hostname",value:"google.com"}),label:"Find Google Web Property"},{id:Xa,value:[ze({kind:0,field:"cert.parsed.issuer.organization",value:"Let's Encrypt"}),ze({kind:6,field:"cert.parsed.validity_period.not_before",value:"2024-10-29",operator:">"}),ze({kind:0,field:"cert.parsed.signature.signature_algorithm.name",value:"SHA256-RSA"})].join(" and "),label:"Find certificates from a specific issuer, within a particular validity period, matching certain cryptographic standards"}];var zo=s(E(),1);var $e=s(E(),1);var Ui={listBox:"KxvzQ"};var $a='li[role="option"]';function Gi(e,t,o,r,n,i){let a=Array.from(e.currentTarget.querySelectorAll($a));if(a.length===0){n(void 0),o(null),i.current?.focus();return}let p=t!==null?t:a.findIndex(u=>u.id===r);switch(e.key){case"ArrowDown":p=(p+1)%a.length;break;case"ArrowUp":if(p===0){n(void 0),o(null),i.current?.focus(),e.preventDefault();return}p=(p-1+a.length)%a.length;break;case"Home":p=0;break;case"End":p=a.length-1;break;case"Tab":return;case"Escape":n(void 0),o(null),i.current?.focus(),e.preventDefault();return;default:(e.key==="ArrowRight"||e.key==="Enter"||e.key.length===1)&&p!==-1&&(a[p]?.click(),i.current?.focus(),o(null),n(void 0),e.key.length===1?i.current?.dispatchEvent(new InputEvent("input",{bubbles:!0,inputType:"insertText",data:e.key})):e.preventDefault());return}o(p),n(a[p]?.id);let c=a[p];c&&typeof window<"u"&&c.scrollIntoView({block:"center",behavior:"smooth"}),e.preventDefault()}var Bi=s(l(),1);function Za({id:e,inputId:t,selectedOptionId:o,onSelectOption:r,inputRef:n,isLoading:i,children:a,className:p},c){let[u,d]=(0,$e.useState)(null),S=(0,$e.useCallback)(g=>{document.activeElement===g.currentTarget&&Gi(g,u,d,o,r,n)},[u,o,r,n]),L=(0,$e.useCallback)(()=>{d(null),r(void 0)},[r]);return(0,Bi.jsx)("div",{className:R(Ui.listBox,p),role:"listbox",ref:c,id:e,"aria-labelledby":t,"aria-activedescendant":o,tabIndex:0,onBlur:L,onKeyDown:S,"aria-busy":i,children:a})}var Mo=(0,$e.forwardRef)(Za);var Bt=s(E(),1);function wo({suggestions:e,defaultSuggestions:t,inputValue:o,setInputValue:r,inputRef:n,handleCloseListBox:i}){let[a,p]=(0,Bt.useState)(void 0),u=o.length>0||!t?e:t,d=(0,Bt.useCallback)(g=>{p(g===-1?u[u.length-1]?.id:u[g]?.id)},[u]),S;if(a){let g=u.find(T=>T.id===a);g&&(S=g.replacement?Qi(o,g.replacement):g.value)}let L=(0,Bt.useCallback)(g=>{if(!g){r(""),p(void 0),n.current?.focus();return}let T=u.find(C=>C.id===g);T&&(r(T.replacement?Qi(o,T.replacement):T.value||o),p(void 0),n.current?.focus(),requestAnimationFrame(()=>{T.onSelect?.(),i&&T.shouldCloseListBoxOnSelect&&i()}))},[u,o,r,i]);return{activeDescendantId:a,tempInputValue:S,setActiveDescendantId:p,setInputValueById:L,selectOptionByIndex:d}}function Qi(e,t){let{from:o,to:r,value:n}=t;return e.slice(0,o)+n+e.slice(r)}var Hi={list:"QPZT7"};var Vi=s(l(),1);function B({className:e,describedBy:t,children:o,...r}){return(0,Vi.jsx)("ul",{className:R(Hi.list,e),role:"group","aria-labelledby":"groupLabelId"in r?r.groupLabelId:void 0,"aria-label":"groupLabel"in r?r.groupLabel:void 0,"aria-describedby":t,children:o})}var Fi={listGroupLabel:"_8um59"};var Qt=s(l(),1);function se({id:e,groupName:t,slots:o}){let{t:r}=b();return(0,Qt.jsxs)("li",{className:Fi.listGroupLabel,role:"presentation",id:e,children:[(0,Qt.jsxs)("div",{children:[(0,Qt.jsx)(m,{variant:f.H5,as:"span",children:r(t)}),o?.bottom]}),o?.right]})}var ko=s(E(),1);var Yi={listItem:"V50b2"};var Uo=s(l(),1);function F({id:e,onSelectOption:t,isSelected:o,ariaDisabled:r,ariaBusy:n,slots:i,children:a}){let p=(0,ko.useRef)(null);(0,ko.useEffect)(()=>{o&&p.current&&p.current.scrollIntoView?.({block:"nearest"})},[o]);let c=()=>{r||n||t(e)};return(0,Uo.jsxs)("li",{className:Yi.listItem,id:e,ref:p,role:"option","aria-disabled":r,"aria-busy":n,"aria-selected":o,onClick:c,children:[i?.left,(0,Uo.jsx)(m,{children:a}),i?.right]})}var Ht={icon:"mSe0P",backgroundPulse:"M6kTk",colorPulse:"J6pWS",loading:"_5pIaX",error:"xJBlL",loadingText:"yrZTs",shimmer:"DURLG",errorText:"XZHxU"};var Vt=s(l(),1);function gt({id:e,onSelectOption:t,isSelected:o,itemState:r,loadingMessage:n,errorMessage:i,icon:a,children:p}){let c=p;return r==="loading"?c=(0,Vt.jsx)(m,{className:Ht.loadingText,children:n}):r==="error"&&(c=(0,Vt.jsx)(m,{className:Ht.errorText,children:i})),(0,Vt.jsx)(F,{id:e,onSelectOption:t,isSelected:o,ariaDisabled:r!=="idle",ariaBusy:r==="loading",slots:{left:a&&(0,Vt.jsx)(h,{"aria-hidden":!0,icon:a.name,className:R(Ht.icon,Ht[r],a.className)})},children:c})}var $i=s(E(),1);var Pr=s(l(),1);function Ft({id:e,onSelectOption:t,isSelected:o,optionValue:r,inputValue:n}){return(0,Pr.jsx)(F,{id:e,onSelectOption:t,isSelected:o,children:(0,Pr.jsx)(Ti,{value:r,searchTerm:n,highlightVariant:"bold"})})}var Yt=(d=>(d.COLON=":",d.EQUALS="=",d.REGEX="=~",d.LESS_THAN="<",d.LESS_THAN_OR_EQUAL="<=",d.GREATER_THAN=">",d.GREATER_THAN_OR_EQUAL=">=",d.AND="and",d.OR="or",d.NOT="not",d))(Yt||{}),qt=(r=>(r.CERT="cert",r.HOST="host",r.WEB="web",r))(qt||{});var ee=s(l(),1),qi={[":"]:{label:"Contains",slotLeft:":"},["="]:{label:"Exact Match",slotLeft:"="},["=~"]:{label:"Regex",slotLeft:"=~"},["<"]:{label:"Less Than",slotLeft:"<"},["<="]:{label:"Less Than or Equal To",slotLeft:"<="},[">"]:{label:"Greater Than",slotLeft:">"},[">="]:{label:"Greater Than or Equal To",slotLeft:">="},["and"]:{label:"AND",slotRight:(0,ee.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 12",children:[(0,ee.jsx)("path",{fill:Le.TEXT_SECONDARY,fillRule:"evenodd",d:"M9.342 9.935A5.484 5.484 0 0 0 11 6a5.484 5.484 0 0 0-1.658-3.935 4.1 4.1 0 1 1 0 7.87ZM8 10.9a5.5 5.5 0 1 1 0-9.8 5.5 5.5 0 1 1 0 9.8Zm-1.342-.965A4.104 4.104 0 0 1 1.399 6a4.1 4.1 0 0 1 5.259-3.935A5.484 5.484 0 0 0 5 6c0 1.542.635 2.937 1.658 3.935ZM8 9.251A4.094 4.094 0 0 1 6.4 6c0-1.324.626-2.501 1.6-3.251.974.75 1.6 1.927 1.6 3.251A4.094 4.094 0 0 1 8 9.251Z",clipRule:"evenodd"}),(0,ee.jsx)("path",{fill:Le.TEXT_SECONDARY,d:"M8 1.5C5.736 3 3.5 7 8 10.5c2.264-1.5 4.5-6 0-9Z"})]})},["or"]:{label:"OR",slotRight:(0,ee.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 12",children:[(0,ee.jsx)("path",{fill:Le.TEXT_SECONDARY,stroke:Le.TEXT_SECONDARY,d:"M15.5 6c0 2.787-2.137 5-4.717 5-2.581 0-4.718-2.213-4.718-5s2.137-5 4.718-5c2.58 0 4.717 2.213 4.717 5Z"}),(0,ee.jsx)("path",{fill:Le.TEXT_SECONDARY,stroke:Le.TEXT_SECONDARY,d:"M9.935 6c0 2.787-2.137 5-4.718 5C2.637 11 .5 8.787.5 6s2.137-5 4.717-5c2.581 0 4.718 2.213 4.718 5Z"})]})},["not"]:{label:"NOT",slotRight:(0,ee.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 12",children:[(0,ee.jsx)("mask",{id:"a",fill:Le.SURFACE_BG_CARD_1,children:(0,ee.jsx)("path",{fillRule:"evenodd",d:"M8 10.653C9.463 9.68 10.435 7.96 10.435 6c0-1.96-.972-3.679-2.435-4.653A5 5 0 0 1 10.783.5C13.664.5 16 2.962 16 6s-2.336 5.5-5.217 5.5A5 5 0 0 1 8 10.653Zm0 0a5 5 0 0 1-2.783.847C2.336 11.5 0 9.038 0 6S2.336.5 5.217.5A5 5 0 0 1 8 1.347C6.537 2.32 5.565 4.04 5.565 6c0 1.96.972 3.679 2.435 4.653Z",clipRule:"evenodd"})}),(0,ee.jsx)("path",{fill:Le.TEXT_SECONDARY,fillRule:"evenodd",d:"M8 10.653C9.463 9.68 10.435 7.96 10.435 6c0-1.96-.972-3.679-2.435-4.653A5 5 0 0 1 10.783.5C13.664.5 16 2.962 16 6s-2.336 5.5-5.217 5.5A5 5 0 0 1 8 10.653Zm0 0a5 5 0 0 1-2.783.847C2.336 11.5 0 9.038 0 6S2.336.5 5.217.5A5 5 0 0 1 8 1.347C6.537 2.32 5.565 4.04 5.565 6c0 1.96.972 3.679 2.435 4.653Z",clipRule:"evenodd"}),(0,ee.jsx)("path",{fill:Le.TEXT_SECONDARY,d:"M9.435 6c0 1.626-.806 3.033-1.99 3.821l1.11 1.665c1.742-1.16 2.88-3.194 2.88-5.486h-2Zm-1.99-3.821C8.63 2.967 9.436 4.374 9.436 6h2c0-2.292-1.138-4.325-2.88-5.486L7.444 2.18Zm1.11 0a4 4 0 0 1 2.228-.679v-2A6 6 0 0 0 7.446.514L8.554 2.18Zm2.228-.679C13.063 1.5 15 3.464 15 6h2c0-3.54-2.735-6.5-6.217-6.5v2ZM15 6c0 2.536-1.937 4.5-4.217 4.5v2C14.265 12.5 17 9.54 17 6h-2Zm-4.217 4.5c-.817 0-1.58-.247-2.229-.679l-1.108 1.665a6 6 0 0 0 3.337 1.014v-2Zm-3.337-.679a3.999 3.999 0 0 1-2.229.679v2a6 6 0 0 0 3.337-1.014L7.446 9.82Zm-2.229.679C2.937 10.5 1 8.536 1 6h-2c0 3.54 2.735 6.5 6.217 6.5v-2ZM1 6c0-2.536 1.937-4.5 4.217-4.5v-2C1.735-.5-1 2.46-1 6h2Zm4.217-4.5a4 4 0 0 1 2.229.679L8.554.514A6 6 0 0 0 5.217-.5v2ZM6.565 6c0-1.626.806-3.033 1.99-3.821L7.444.514C5.704 1.674 4.566 3.708 4.566 6h2Zm1.99 3.821C7.37 9.033 6.564 7.626 6.564 6h-2c0 2.292 1.138 4.325 2.88 5.486l1.11-1.665Z",mask:"url(#a)"})]})}};var Ki={operatorDisplaySlot:"o7OdN"};var Dr=s(l(),1);function Or({id:e,operator:t,onSelectOption:o,isSelected:r}){let{t:n}=b(),i=Ja(t);return i?(0,Dr.jsx)(F,{id:e,onSelectOption:o,isSelected:r,slots:{left:i.slotLeft&&Wi(i.slotLeft),right:i.slotRight&&Wi(i.slotRight)},children:n(i.label)}):null}var Wi=e=>(0,Dr.jsx)(m,{"aria-hidden":!0,className:Ki.operatorDisplaySlot,children:e}),Ja=e=>e?qi[e]:void 0;var zi=s(E(),1);var Mr={queryAssetDetails:"L2lQL",assetName:"_2PG8e"};var St=s(l(),1);function wr({assets:e}){return e.length?(0,St.jsx)("div",{className:Mr.queryAssetDetails,children:e.map((t,o)=>(0,St.jsxs)(zi.Fragment,{children:[(0,St.jsxs)("span",{className:Mr.assetName,children:[" ",t," "]}),o<e.length-1&&(0,St.jsx)(z,{variant:"dot",spacing:12})]},t))}):null}var Go={["host"]:"Hosts",["web"]:"Web Properties",["cert"]:"Certificates"};function Xi(e){let t=new Set,o=Object.values(Go),r=Object.values(qt);for(let n of e){for(let i of r)if(new RegExp(`(?<!\\.)\\b${i}\\b`,"i").test(n)&&(t.add(Go[i]),t.size===r.length))break;if(t.size===r.length)break}return Array.from(t).sort((n,i)=>o.indexOf(n)-o.indexOf(i))}var me=s(l(),1);function kr({inputValue:e,onSelectOption:t,selectedOptionId:o,suggestions:r,isHeaderHidden:n=!1}){let{operatorSuggestions:i,fieldSuggestions:a,uniqueAssets:p}=(0,$i.useMemo)(()=>{let c=[],u=[];r.forEach(S=>{Object.values(Yt).includes(S.value)?c.push(S):u.push(S)});let d=Xi([...r.map(S=>S.value),e]);return{operatorSuggestions:c,fieldSuggestions:u,uniqueAssets:d}},[r]);return(0,me.jsxs)(B,{groupLabel:Po,groupLabelId:p.length?Ro:void 0,children:[p.length&&!n?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(se,{id:Ro,groupName:Po,slots:{bottom:(0,me.jsx)(wr,{assets:p})}}),(0,me.jsx)(z,{variant:"line--horizontal",size:"100%"})]}):null,i.map(c=>(0,me.jsx)(Or,{id:c.id,operator:c.value,onSelectOption:t,isSelected:o===c.id},c.id)),a.map(c=>(0,me.jsx)(Ft,{id:c.id,optionValue:c.value,inputValue:e,onSelectOption:t,isSelected:o===c.id},c.id))]})}var ht={list:"_3JO-5",header:"yOSNd",divider:"exUYA",headerTitle:"adnfh",link:"XsUWP"};var Oe=s(l(),1);function Bo({inputValue:e,onSelectOption:t,selectedOptionId:o,suggestions:r}){let n=G("ACCOUNTS_SITE_URL");return(0,Oe.jsxs)(B,{className:ht.list,groupLabelId:xr,children:[(0,Oe.jsxs)("li",{className:ht.header,id:xr,role:"presentation",children:[(0,Oe.jsx)(z,{className:ht.divider,variant:"line--horizontal",size:"100%"}),(0,Oe.jsxs)(m,{className:ht.headerTitle,variant:f.SMALL,children:[(0,Oe.jsx)(w,{href:`${n}/settings/plan`,className:ht.link,children:(0,Oe.jsx)(h,{icon:"lock-star-line",size:"sm"})}),_r]})]}),r.map(i=>(0,Oe.jsx)(Ft,{id:i.id,optionValue:i.value,inputValue:e,onSelectOption:t,isSelected:o===i.id},i.id))]})}var Ur={icon:"F5w2p",scope:"Miq0Q"};var Kt=s(l(),1);function Gr({inputValue:e,suggestions:t,selectedOptionId:o,onSelectOption:r}){let{t:n}=b();return!e||t.length===0?null:(0,Kt.jsx)(B,{groupLabel:"Query context suggestions",children:t.map(i=>(0,Kt.jsx)(F,{id:i.id,onSelectOption:r,isSelected:i.id===o,slots:{left:(0,Kt.jsx)(h,{className:Ur.icon,name:"search",mode:"line"}),right:(0,Kt.jsx)(m,{className:Ur.scope,variant:f.H6,as:"span",children:i.label?n(i.label):i.value})},children:e},i.id))})}var Zi={icon:"qExpG"};var Br=s(l(),1);function Qr({id:e,onSelectOption:t,isSelected:o,children:r}){return(0,Br.jsx)(F,{id:e,onSelectOption:t,isSelected:o,slots:{left:(0,Br.jsx)(h,{"aria-hidden":!0,name:"lightbulb",mode:"line",className:Zi.icon})},children:r})}var Qo={docLink:"MElVo",linkContent:"OUQ11",linkText:"_4cwbZ"};var Ze=s(l(),1);function Je({to:e,onClick:t,isExternal:o,children:r}){return(0,Ze.jsx)(w,{className:Qo.docLink,href:e,size:"sm",onClick:t,isExternal:o,children:(0,Ze.jsxs)("span",{className:Qo.linkContent,children:[(0,Ze.jsx)(h,{name:"booklet",mode:"line"}),(0,Ze.jsx)("span",{className:Qo.linkText,children:r}),(0,Ze.jsx)(h,{name:o?"external-link":"arrow-right",mode:"line"})]})})}var yt=s(l(),1);function Hr({onSelectOption:e,selectedOptionId:t,exampleQueries:o,handleCloseListBox:r}){let{t:n}=b();return(0,yt.jsxs)(B,{groupLabel:Do,groupLabelId:Oo,children:[(0,yt.jsx)(se,{id:Oo,groupName:n(Do),slots:{right:(0,yt.jsx)(Je,{to:"/home/examples",onClick:r,children:n("See More Examples")})}}),o.map(i=>(0,yt.jsx)(Qr,{id:i.id,onSelectOption:e,isSelected:i.id===t,children:i.label?n(i.label):i.value},i.id))]})}var Ji={icon:"yMIoU"};var Vr=s(l(),1);function Fr({id:e,onSelectOption:t,isSelected:o,children:r}){return(0,Vr.jsx)(F,{id:e,onSelectOption:t,isSelected:o,slots:{left:(0,Vr.jsx)(h,{"aria-hidden":!0,name:"search",mode:"line",className:Ji.icon})},children:r})}var Yr="Recent Searches",qr="recent-searches-group";var Wt=s(l(),1);function Kr({recentSearches:e,selectedOptionId:t,onSelectOption:o}){return e.length?(0,Wt.jsxs)(B,{groupLabel:Yr,groupLabelId:qr,children:[(0,Wt.jsx)(se,{id:qr,groupName:Yr}),e.map(r=>(0,Wt.jsx)(Fr,{id:r.id,onSelectOption:o,isSelected:r.id===t,children:r.value},r.id))]}):null}var Et={listBox:"M5TMl",suggestionListsContainer:"mTBJB",loadingSpinner:"a1GwD"};var De=s(l(),1);function Wr({exampleQueries:e,recentSearches:t,isLoadingRecentSearches:o,...r}){return!e?.length&&!t?.length&&!o?null:(0,De.jsxs)(De.Fragment,{children:[o?(0,De.jsx)("div",{className:Et.loadingSpinner,"aria-hidden":!0,"data-testid":"loading-spinner",children:(0,De.jsx)(To,{size:Eo.LARGE})}):(0,De.jsx)(Kr,{recentSearches:t||[],...r}),!!e?.length&&(0,De.jsx)(Hr,{exampleQueries:e,...r})]})}var Ho={exactMatchSuggestion:"_5lQbi",icon:"P-ILu",value:"drzAM"};var He=s(l(),1);function zr({id:e,onSelectOption:t,isSelected:o,optionValue:r}){return(0,He.jsx)("div",{className:Ho.exactMatchSuggestion,"data-testid":"exact-match-suggestion",children:(0,He.jsx)(B,{groupLabel:br,children:(0,He.jsx)(F,{id:e,onSelectOption:t,isSelected:o,slots:{left:(0,He.jsx)(h,{className:Ho.icon,"aria-hidden":!0,mode:"line",name:"search",size:"lg"})},children:(0,He.jsxs)(m,{children:[(0,He.jsx)("span",{className:Ho.value,children:r})," - Search for everything with value"]})})})})}var ji="Generated Query",Xr="query-assistant-group",es="query-assistant-generated-query-option",ts="Generating query...",os="The Censys Query Assistant failed to generate a valid query from the input";var de=s(E(),1);var rs="/api/assistant/feedback";var Me=s(E(),1);var Vo={feedbackModal:"Z3wU6",inputField:"vMYUJ",characterCount:"iNMWH"};var Ie=s(l(),1),ns="feedback-comment-input",is="feedback-character-count";function $r({onClose:e,onSubmit:t}){let[o,r]=(0,Me.useState)(""),n=o.length<=250,i=(0,Me.useCallback)(()=>{n&&t(o)},[o,t,n]),a=(0,Me.useCallback)(u=>{let d=u.target.value;d.length<=250&&r(d)},[]),p=(0,Me.useCallback)(u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),i())},[i]),c=(0,Me.useCallback)(u=>{u||e()},[e]);return(0,Me.useEffect)(()=>{let u=d=>{d.stopPropagation(),d.stopImmediatePropagation()};return document.addEventListener("mousedown",u,!0),()=>{document.removeEventListener("mousedown",u,!0)}},[]),(0,Ie.jsx)(ni,{open:!0,onOpenChange:c,header:(0,Ie.jsx)(m,{variant:f.H2,children:"Help us improve"}),footerActions:[(0,Ie.jsx)(Ee,{variant:N.SECONDARY,onClick:e,"aria-label":"Cancel feedback submission",children:"Cancel"},"cancel-button"),(0,Ie.jsx)(Ee,{onClick:i,disabled:!n,"aria-label":"Submit feedback comment",children:"Submit Feedback"},"submit-button")],children:(0,Ie.jsxs)("div",{className:Vo.feedbackModal,children:[(0,Ie.jsx)(ci,{label:"Additional feedback (optional)",labelFor:ns,className:Vo.inputField,errorText:n?void 0:`Comment must be ${250} characters or less`,children:(0,Ie.jsx)(yo,{id:ns,value:o,isFullWidth:!0,onChange:a,onKeyDown:p,placeholder:"Tell us what went wrong or how we can improve...",rows:4,"aria-describedby":is})}),(0,Ie.jsxs)(m,{id:is,className:Vo.characterCount,variant:f.SMALL,"aria-live":"polite",children:[o.length,"/",250," characters"]})]})})}var Yo={feedbackContainer:"VC8Dd",successText:"ovVhr",text:"nuu8r"};var X=s(l(),1),ja="query-assistant-feedback-controls";function Zr({queryAssistantSuggestion:e,queryAssistantState:t,generatedQueryId:o}){let[r,n]=(0,de.useState)(!1),[i,a]=(0,de.useState)(!1),p=mi(),c=ne(),u=ie("query-assistant-feedback"),d=fi(),S=(0,de.useCallback)((y,U)=>{if(!o)return;let I=new FormData;I.set("csrf",p),I.set("auditLogEntryId",o.toString()),I.set("thumbsUp",y==="positive"?"true":"false"),U&&I.set("feedback",U),c.submit(I,{method:"post",action:rs}),n(!0),a(!1)},[o,p]);(0,de.useEffect)(()=>{o&&n(!1)},[o]);let L=(0,de.useCallback)(()=>{S("positive")},[S]),g=(0,de.useCallback)(()=>{a(!0)},[]),T=(0,de.useCallback)(()=>{a(!1)},[]),C=(0,de.useCallback)(y=>{S("negative",y)},[S]);return!u||!d||!e||!o||t!=="idle"?null:r?(0,X.jsxs)(m,{variant:f.SMALL,className:Yo.successText,"aria-live":"polite",children:[(0,X.jsx)(h,{icon:"checkbox-circle-line",size:"sm"}),"Thank you for your feedback!"]}):(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)("div",{className:Yo.feedbackContainer,"data-testid":ja,children:[(0,X.jsx)(m,{variant:f.SMALL,className:Yo.text,children:"Was this helpful?"}),(0,X.jsx)(z,{variant:"line--vertical",spacing:8}),(0,X.jsx)(Ee,{iconLeft:"thumb-up",iconLeftMode:"line",type:"button",variant:N.TERTIARY,size:We.SMALL,onClick:L,"aria-label":"Mark this query suggestion as helpful",children:"Yes"}),(0,X.jsx)(z,{variant:"line--vertical",spacing:8}),(0,X.jsx)(Ee,{iconLeft:"thumb-down",iconLeftMode:"line",type:"button",variant:N.TERTIARY,size:We.SMALL,onClick:g,"aria-label":"Mark this query suggestion as not helpful and provide feedback",children:"No"})]}),i&&(0,X.jsx)($r,{onClose:T,onSubmit:C})]})}var ss=s(l(),1);function Jr({id:e,onSelectOption:t,isSelected:o,itemState:r,children:n}){let i=r==="loading"?"loading":r==="error"?"error":"idle";return(0,ss.jsx)(gt,{id:e,onSelectOption:t,isSelected:o,itemState:i,loadingMessage:ts,errorMessage:os,icon:{name:"sparkling-2-line"},children:n})}var Lt=s(l(),1);function qo({queryAssistantSuggestion:e,queryAssistantState:t,generatedQueryId:o,selectedOptionId:r,onSelectOption:n}){return!e&&t==="idle"?null:(0,Lt.jsxs)(B,{groupLabelId:Xr,children:[(0,Lt.jsx)(se,{id:Xr,groupName:ji,slots:{right:(0,Lt.jsx)(Zr,{queryAssistantSuggestion:e,queryAssistantState:t,generatedQueryId:o})}}),(0,Lt.jsx)(Jr,{id:e?.id||"",itemState:t,isSelected:!!e&&r===e?.id,onSelectOption:n,children:e?.value})]})}var At=s(E(),1);var as="assistant-fetcher";function ls({prompt:e,isSyntaxInvalid:t,isLegacyQuery:o=!1}){let r=e.trim();return!r||o?!1:r.includes(" ")?t:!/[:=]|(=~)|(<=)|(>=)|[<>]/.test(r)}function jr(e,t,o,r){let[n,i]=(0,At.useState)("idle"),[a,p]=(0,At.useState)(void 0),u=xo()?.organizationId,d=dt(),S=ie("auto-legacy-query-conversion"),L=`${as}-${t}`,g=ne({key:L}),T=e.trim();return(0,At.useEffect)(()=>{if(!d)return;let y=ls({prompt:T,isSyntaxInvalid:o,isLegacyQuery:S&&r});if(p(void 0),!y){i("idle");return}i("loading");let U=setTimeout(()=>{g.load(`/api/assistant/generateQuery?prompt=${encodeURIComponent(T)}${u?`&org=${u}`:""}`)},2e3);return()=>{clearTimeout(U)}},[o,r,T,u,d,S]),(0,At.useEffect)(()=>{g.state==="idle"&&g.data&&typeof g.data=="object"&&("code"in g.data||"error"in g.data)?(p(void 0),i("error")):g.data&&g.state==="idle"&&(p(g.data&&"query"in g.data&&g.data.query?{id:`${es}-${g.data.id}`,query:`${g.data.query} `,generatedQueryId:g.data.id}:void 0),i("idle"))},[g.state,g.data]),!d||!T||T===a?.query.trim()?{queryAssistantSuggestion:void 0,queryAssistantState:void 0,generatedQueryId:void 0}:{queryAssistantSuggestion:a?{id:a.id,value:a.query,onSelect:()=>{p(void 0)},shouldCloseListBoxOnSelect:!0}:void 0,queryAssistantState:n,generatedQueryId:a?.generatedQueryId}}var ps="Query Conversions",en="legacy-query-converter-group",tn="query-converter-option",cs="Converting query...",us="Original query failed to convert";var ms={icon:"aauAa"};var ds=s(l(),1);function on({itemState:e,children:t,...o}){let r=e==="loading"?"loading":e==="error"?"error":"idle";return(0,ds.jsx)(gt,{...o,itemState:r,loadingMessage:cs,errorMessage:us,icon:{name:"swap-2-line",className:ms.icon},children:t})}var fs={description:"c-97V"};var fe=s(l(),1),tl=[{id:"converted-query-special-state-option",value:null}],gs="query-converter-suggestions-description";function Wo({queryConverterState:e,convertedQueries:t=[],selectedOptionId:o,onSelectOption:r}){return t?.length===0&&e==="idle"?null:(0,fe.jsxs)(B,{groupLabelId:en,describedBy:gs,children:[(0,fe.jsx)(se,{id:en,groupName:ps,slots:{right:(0,fe.jsx)(Je,{to:Gt,isExternal:!0,children:"Learn About Platform Syntax"})}}),(e!=="idle"?tl:t).map(({id:n,value:i})=>(0,fe.jsx)(on,{id:n,isSelected:o===n,onSelectOption:r,itemState:e,children:i},n)),(0,fe.jsxs)("li",{role:"presentation",id:gs,className:fs.description,children:[(0,fe.jsx)(h,{icon:"alert-fill",size:"xl"}),(0,fe.jsxs)(m,{children:[kt,(0,fe.jsx)(m,{variant:f.DEFAULT_SEMIBOLD,children:(0,fe.jsx)(Ao,{timestamp:Ut,format:"MMMM DD, YYYY"})}),"."]})]})]})}var It=s(E(),1);var ld="/api/convertQuery",Ss="query-to-convert",hs="convert-query-fetcher";function ys(e,t){let o=[];return e.converted_query&&o.push({id:tn,value:e.converted_query,onSelect:t,shouldCloseListBoxOnSelect:!0}),e.alternative_queries&&e.alternative_queries.forEach((r,n)=>{o.push({id:`${tn}-alt-${n}`,value:r.query,onSelect:t,shouldCloseListBoxOnSelect:!0})}),o}function rn(e,t,o){let[r,n]=(0,It.useState)("idle"),[i,a]=(0,It.useState)(void 0),p=`${hs}-${t}`,c=ne({key:p}),u=ie("auto-legacy-query-conversion"),d=e.trim(),S=o&&!!d;return(0,It.useEffect)(()=>{if(!u)return;if(!S){n("idle"),a(void 0);return}n("loading"),a(void 0);let L=new URLSearchParams({[Ss]:d}).toString();c.load(`/api/convertQuery?${L}`)},[u,S,d]),(0,It.useEffect)(()=>{if(typeof c.data=="object"&&"errorMessage"in c.data){a(void 0),n("error");return}c.state!=="idle"||!c.data||"convertedQuery"in c.data&&c.data.convertedQuery&&S&&(a(ys(c.data.convertedQuery,()=>{a(void 0)})),n("idle"))},[c.state,c.data,S]),{queryConverterSuggestions:i,queryConverterState:r}}var Y=s(l(),1);function ol({inputId:e,listBoxId:t,inputRef:o,onSelectOption:r,selectedOptionId:n,autocomplete:i,exactMatch:a,defaults:p={},contexts:c,recentSearches:u,queryAssistantSuggestion:d,queryAssistantState:S,generatedQueryId:L,queryConverterSuggestions:g,queryConverterState:T,inputValue:C,setActiveDescendantId:y,isLoading:U,isLoadingRecentSearches:I,handleCloseListBox:Q},ye){let{queries:oe}=p,Ne=!!c?.length,Re=ie("auto-legacy-query-conversion")&&(g?.length||T!=="idle"),[re,ce]=(0,zo.useMemo)(()=>{let Ue=[],Mt=[];for(let qe of i)qe.isLocked?Mt.push(qe):Ue.push(qe);return[Ue,Mt]},[i]),x;return C?re.length||ce.length?x=(0,Y.jsxs)(Y.Fragment,{children:[re.length>0&&(0,Y.jsx)(kr,{suggestions:re,inputValue:C,selectedOptionId:n,onSelectOption:r,isHeaderHidden:Ne}),ce.length>0&&(0,Y.jsx)(Bo,{suggestions:ce,inputValue:C,selectedOptionId:n,onSelectOption:r})]}):U&&(x=(0,Y.jsx)("div",{className:Et.loadingSpinner,"aria-hidden":!0,"data-testid":"loading-spinner",children:(0,Y.jsx)(To,{size:Eo.LARGE})})):x=(0,Y.jsx)(Wr,{exampleQueries:oe,recentSearches:u,selectedOptionId:n,onSelectOption:r,handleCloseListBox:Q,isLoadingRecentSearches:I}),x||a||Ne||S?(0,Y.jsxs)(Mo,{ref:ye,className:Et.listBox,id:t,inputId:e,inputRef:o,selectedOptionId:n,onSelectOption:y,isLoading:U||I||S==="loading"||T==="loading",children:[Ne&&!!C&&(0,Y.jsx)(Gr,{suggestions:c,inputValue:C,selectedOptionId:n,onSelectOption:r}),!!S&&(0,Y.jsx)(qo,{queryAssistantState:S,selectedOptionId:n,onSelectOption:r,queryAssistantSuggestion:d,generatedQueryId:L}),!!T&&(0,Y.jsx)(Wo,{queryConverterState:T,convertedQueries:g,selectedOptionId:n,onSelectOption:r}),x&&(0,Y.jsx)("div",{className:Et.suggestionListsContainer,children:x}),a&&!!C&&!Re&&(0,Y.jsx)(zr,{id:a.id,optionValue:a.value,onSelectOption:r,isSelected:n===a.id})]}):null}var nn=(0,zo.forwardRef)(ol);function Es(e){return e?`/collections/${e}/results`:"/search"}function Ts(e){let t={};return e||(t.queries=Nr),t}function Ls(e,t){if(!(!e||!t))return[{id:"collection-search",label:"Search within Collection",value:"",onSelect:t},{id:"global-search",label:"Search within Global Dataset",value:"",onSelect:()=>t(void 0,"/search")}]}function As(e){return e?ki:wi}var Xt=s(l(),1);function an({q:e,placeholder:t,collectionId:o}){let r=xo(),n=dt(),i=(0,Xo.useRef)(null),a=ei(),p=Es(o),c=(0,Xo.useCallback)((L,g)=>{L?.preventDefault();let T=new FormData(i.current);r&&T.set(_o,r.organizationId),a(T,{action:g||p,method:"get"})},[r,p,i]),u=Ts(o),d=Ls(o,c),S=As(n);return(0,Xt.jsx)(ti,{action:p,method:"get",role:"search",ref:i,onSubmit:c,children:(0,Xt.jsx)("div",{className:Cr.globalSearchBar,children:(0,Xt.jsx)(sn,{id:Ir,name:vr,inputLabel:"Global Search Bar",placeholder:t||S,onEnterKeyDown:c,size:"large",variant:"rounded",defaultSuggestions:u,contextSuggestions:d,initialValue:e,rightInputSlot:(0,Xt.jsx)(H,{className:Cr.searchButton,name:"Search",type:"submit",iconName:"arrow-right",iconMode:"line","aria-label":"Search",shape:ct.ROUND,variant:N.PRIMARY}),rightContainerSlot:Ar})})})}var Is=s(E(),1);var D={dropdownContent:"auXfc",dropdownGroup:"ckI63",captionHeading:"Nzc5M",dropdownItem:"eSGyu",dropdownItemText:"aebcD",externalLink:"IgQ-K",dropdownSeparator:"sJ355",dropdownLinkItem:"H79PL",feedbackButton:"Di-ye"};var A=s(l(),1);function vs(){let e=(0,Is.useRef)(null),{t}=b(),o=G("COMMUNITY_SITE_URL"),r=G("SUPPORT_SITE_URL"),n=G("STATUS_SITE_URL"),i=a=>{(a.key==="Enter"||a.key===" ")&&e.current?.click()};return(0,A.jsxs)(go,{children:[(0,A.jsx)(So,{asChild:!0,children:(0,A.jsx)(H,{icon:"question-mark",size:j.LARGE,variant:N.DEFAULT,"aria-label":t("Help")})}),(0,A.jsxs)(ho,{align:"end",className:D.dropdownContent,children:[(0,A.jsxs)(Pe,{className:D.dropdownGroup,children:[(0,A.jsx)(pt,{children:(0,A.jsx)(m,{className:D.captionHeading,variant:f.H4,as:"span",children:t("Help and Support")})}),(0,A.jsx)(W,{className:D.dropdownItem,asChild:!0,children:(0,A.jsx)(w,{href:`${r}/docs`,className:D.externalLink,isExternal:!0,shouldOmitOrg:!0,children:(0,A.jsxs)(m,{className:D.dropdownItemText,children:[(0,A.jsx)(h,{name:"booklet",mode:"line",size:"lg"}),t("Product Documentation")]})})}),(0,A.jsx)(W,{className:D.dropdownItem,asChild:!0,children:(0,A.jsx)(w,{href:o,className:D.externalLink,isExternal:!0,shouldOmitOrg:!0,children:(0,A.jsxs)(m,{className:D.dropdownItemText,children:[(0,A.jsx)(h,{name:"community",mode:"line",size:"lg"}),t("Community")]})})})]}),(0,A.jsx)(Ge,{className:D.dropdownSeparator}),(0,A.jsxs)(Pe,{className:D.dropdownGroup,children:[(0,A.jsx)(pt,{children:(0,A.jsx)(m,{className:D.captionHeading,variant:f.H4,as:"span",children:t("Status and Logs")})}),(0,A.jsx)(W,{className:D.dropdownItem,asChild:!0,children:(0,A.jsx)(w,{href:`${r}/changelog`,className:D.externalLink,isExternal:!0,shouldOmitOrg:!0,children:(0,A.jsxs)(m,{className:D.dropdownItemText,children:[(0,A.jsx)(h,{name:"file-history",mode:"line",size:"lg"}),t("Changelog")]})})}),(0,A.jsx)(W,{className:D.dropdownItem,asChild:!0,children:(0,A.jsx)(w,{href:n,className:D.externalLink,isExternal:!0,shouldOmitOrg:!0,children:(0,A.jsxs)(m,{className:D.dropdownItemText,children:[(0,A.jsx)(h,{name:"dashboard-3",mode:"line",size:"lg"}),t("Service Status")]})})}),(0,A.jsx)(W,{className:D.dropdownItem,asChild:!0,children:(0,A.jsx)(w,{href:"/certificates/logs",prefetch:"intent",children:(0,A.jsxs)(m,{className:D.dropdownItemText,children:[(0,A.jsx)(h,{name:"award",mode:"line",size:"lg"}),t("Certificate Transparency Logs")]})})})]}),(0,A.jsx)(Ge,{className:D.dropdownSeparator}),(0,A.jsx)(Pe,{className:D.dropdownGroup,children:(0,A.jsx)(W,{className:D.dropdownLinkItem,onKeyDown:i,children:(0,A.jsx)(Te,{link:{to:Ii,isExternal:!0,shouldOmitOrg:!0},button:{iconLeft:"feedback",iconLeftMode:"line",variant:N.PRIMARY,size:We.LARGE,className:D.feedbackButton},ref:e,children:t("Provide Feedback")})})})]})]})}var je="assistant-chat-panel";function Cs(e){return{["aria-expanded"]:e,["aria-controls"]:e?je:void 0,["aria-label"]:`${e?"Close":"Open"} assistant chat panel`}}var xs=s(l(),1);function $o(){let{isFeatureEnabled:e,isOpen:t,onToggle:o}=ge();return e?(0,xs.jsx)(H,{icon:"sparkling-2-line",size:j.LARGE,variant:N.DEFAULT,onClick:o,...Cs(t)}):null}var K=s(E(),1);var _s=[{id:"conv-1",name:"Warm Cookie Threat Analysis",summary:"Discussion about identifying and mitigating the Warm Cookie malware campaign, including detection methods and industry-specific risk factors.",lastUpdated:"2025-09-12T16:37:44.156Z"},{id:"conv-2",name:"Polar Edge Certificate Analysis",summary:"Investigation of hosts running Polar Edge certificates, including unique labeling strategies and identification of certificate characteristics.",lastUpdated:"2025-09-08T14:49:22.741Z"},{id:"conv-3",name:"Ollama Endpoint Investigation",summary:"Analysis of Ollama endpoint on host 52.79.255.76, including service configuration, security assessment, and deployment details.",lastUpdated:"2025-09-01T09:23:15.892Z"}],bs=[{id:"msg-1",sender:"user",content:"What is the Warm Cookie threat and how does it work?"},{id:"msg-2",sender:"assistant",content:"Warm Cookie is a sophisticated malware campaign that targets web applications by exploiting cookie-based authentication mechanisms. The threat actors use social engineering techniques to trick users into clicking malicious links that appear to be from legitimate services. Once activated, the malware establishes persistent backdoors and can exfiltrate sensitive data including authentication tokens, session cookies, and user credentials. The campaign has been particularly active against e-commerce platforms and SaaS applications, making it a significant concern for organizations handling customer data.",requestSeconds:2.3},{id:"msg-3",sender:"user",content:"How can I detect if my infrastructure has been compromised by Warm Cookie?"},{id:"msg-4",sender:"assistant",content:"Detection of Warm Cookie requires monitoring for several key indicators across your network infrastructure. Look for unusual outbound traffic patterns, particularly to suspicious domains that may be used for command and control communications. Monitor your web application logs for unexpected cookie modifications or authentication bypass attempts. Check for new processes running with elevated privileges that weren't initiated by legitimate applications. Additionally, scan your systems for the specific file signatures and registry modifications associated with Warm Cookie variants. Network traffic analysis can reveal the characteristic communication patterns used by this malware family.",requestSeconds:1.8},{id:"msg-5",sender:"user",content:"What are the most effective mitigation strategies for this threat?"},{id:"msg-6",sender:"assistant",content:"The most effective mitigation strategies for Warm Cookie involve a multi-layered defense approach. Implement strict cookie security policies including HttpOnly, Secure, and SameSite attributes to prevent client-side access and cross-site request forgery attacks. Deploy web application firewalls with behavioral analysis capabilities to detect and block suspicious authentication patterns. Regular security awareness training for your users is crucial since social engineering is a primary attack vector. Ensure all web applications are kept updated with the latest security patches, and implement network segmentation to limit lateral movement if a compromise occurs. Consider deploying endpoint detection and response solutions that can identify the specific behavioral patterns associated with Warm Cookie.",requestSeconds:2.1},{id:"msg-7",sender:"user",content:"Are there any specific industries or company sizes that are more at risk?"},{id:"msg-8",sender:"assistant",content:"Warm Cookie has shown a particular preference for targeting mid to large-sized organizations in the financial services, healthcare, and e-commerce sectors. These industries are attractive because they handle large volumes of sensitive customer data and often have complex web application infrastructures that provide multiple attack surfaces. Small businesses are also at risk due to typically weaker security postures and limited resources for comprehensive defense measures. The threat actors appear to favor organizations with significant online presence and customer-facing web applications, as these provide the most opportunities for cookie-based attacks. Companies with legacy web applications or those that haven't implemented modern authentication security measures are particularly vulnerable.",requestSeconds:1.5},{id:"msg-9",sender:"user",content:"How does this compare to other cookie-based attacks we've seen recently?"},{id:"msg-10",sender:"assistant",content:"Warm Cookie represents an evolution of traditional cookie-based attacks by incorporating more sophisticated persistence mechanisms and multi-stage deployment techniques. Unlike simpler cookie theft campaigns that rely on basic session hijacking, Warm Cookie uses advanced obfuscation and anti-analysis techniques to evade detection. The threat demonstrates better operational security practices compared to previous cookie-based attacks, including the use of legitimate-looking domains and more convincing social engineering tactics. While other recent campaigns have focused primarily on credential harvesting, Warm Cookie combines data exfiltration with system compromise, making it more dangerous. The campaign also shows improved lateral movement capabilities and more sophisticated command and control infrastructure compared to earlier cookie-based threats.",requestSeconds:2.7}],Ns=[{id:"polar-msg-1",sender:"user",content:"Show me unique labels for hosts running a Polar Edge certificate."},{id:"polar-msg-2",sender:"assistant",content:"I found several unique labels for hosts running Polar Edge certificates in your infrastructure. The most common labels include 'polar-edge-prod', 'polar-edge-staging', and 'polar-edge-dev' which appear to correspond to different deployment environments. Additionally, I've identified hosts with labels like 'polar-edge-api-gateway', 'polar-edge-load-balancer', and 'polar-edge-database' indicating different service roles. Some hosts also have geographic labels such as 'polar-edge-us-east', 'polar-edge-eu-west', and 'polar-edge-asia-pacific' suggesting a distributed deployment strategy. The certificate validation shows these hosts are properly configured with valid Polar Edge certificates and appropriate security headers.",requestSeconds:1.9},{id:"polar-msg-3",sender:"user",content:"What are the certificate expiration dates for these hosts?"},{id:"polar-msg-4",sender:"assistant",content:"The Polar Edge certificate expiration dates vary across your infrastructure. Most production hosts have certificates expiring between 2025-06-15 and 2025-08-20, with the majority clustered around mid-July 2025. Staging environment certificates are set to expire earlier, with dates ranging from 2025-04-10 to 2025-05-30. Development environment certificates have the shortest validity periods, expiring between 2025-02-15 and 2025-03-25. I've identified 3 hosts with certificates expiring within the next 30 days that require immediate attention. The certificate renewal process appears to be automated for most hosts, but manual intervention may be needed for the legacy systems in the 'polar-edge-legacy' label group.",requestSeconds:2.2},{id:"polar-msg-5",sender:"user",content:"Are there any security vulnerabilities associated with these certificates?"},{id:"polar-msg-6",sender:"assistant",content:"The Polar Edge certificates show good security practices overall, but I've identified a few areas of concern. All certificates are using SHA-256 encryption and have proper key lengths (2048-bit RSA), which is excellent. However, 12 hosts are still using TLS 1.1 or 1.2 instead of the recommended TLS 1.3, creating potential security gaps. The certificate chain validation is working correctly for 98% of hosts, but 3 hosts in the 'polar-edge-legacy' group have incomplete certificate chains that could cause validation issues. Additionally, 5 hosts are missing the 'Strict-Transport-Security' header, which could expose them to downgrade attacks. I recommend updating the TLS versions and implementing HSTS headers across all Polar Edge certificate hosts to maintain security best practices.",requestSeconds:1.7}],Rs=[{id:"ollama-msg-1",sender:"user",content:"Tell me about the Ollama endpoint on host 52.79.255.76."},{id:"ollama-msg-2",sender:"assistant",content:"The Ollama endpoint on host 52.79.255.76 is running Ollama version 0.1.32 and is accessible on port 11434. The service appears to be properly configured with authentication enabled and is responding to health checks. The endpoint is serving several language models including 'llama2:7b', 'codellama:13b', and 'mistral:7b' which are actively loaded and ready for inference requests. The host is running Ubuntu 22.04 LTS with 16GB RAM and 4 CPU cores, providing adequate resources for the Ollama service. Network connectivity shows the endpoint is accessible from your internal network but is not exposed to the public internet, which is a good security practice.",requestSeconds:2.1},{id:"ollama-msg-3",sender:"user",content:"What models are currently loaded and what's their performance?"},{id:"ollama-msg-4",sender:"assistant",content:"Currently, three models are loaded on the Ollama endpoint: 'llama2:7b' (3.8GB), 'codellama:13b' (7.3GB), and 'mistral:7b' (4.1GB). The llama2:7b model shows excellent performance with an average response time of 1.2 seconds for simple queries and 3.4 seconds for complex reasoning tasks. The codellama:13b model is performing well for code generation tasks with an average response time of 2.1 seconds, though it's using more memory due to its larger size. The mistral:7b model is the fastest with response times averaging 0.8 seconds for most queries. All models are showing healthy memory usage with no memory leaks detected. The endpoint is handling approximately 45 requests per minute with a 99.2% success rate.",requestSeconds:1.8},{id:"ollama-msg-5",sender:"user",content:"Are there any security concerns with this deployment?"},{id:"ollama-msg-6",sender:"assistant",content:"The Ollama deployment shows several good security practices but has a few areas that need attention. The service is running behind a reverse proxy with SSL termination, which is excellent. Authentication is enabled and the endpoint is not exposed to the public internet. However, I've identified that the Ollama service is running as root user, which is a significant security risk. The service logs show no suspicious activity or unauthorized access attempts, and the network traffic appears normal. The models themselves don't contain any malicious content, but I recommend implementing user isolation and running the service under a dedicated user account. Additionally, consider implementing rate limiting and request validation to prevent potential abuse. The current configuration allows unlimited model downloads, which could be exploited to consume disk space or bandwidth.",requestSeconds:2.4}];var ae=s(E(),1);var Zo=s(E(),1);var vt={chatMessage:"fg13W",assistantMessage:"_2vDpZ",requestTime:"GTH4q",userMessage:"_5gHVq",textContainer:"Yqf-g"};var te=s(l(),1);function cn({message:e,isSelected:t,onClick:o}){let r=(0,Zo.useRef)(null);return(0,Zo.useEffect)(()=>{t&&r.current&&r.current.scrollIntoView({behavior:"smooth"})},[t]),(0,te.jsx)("li",{ref:r,className:R(vt.chatMessage,e.sender==="assistant"&&vt.assistantMessage,e.sender==="user"&&vt.userMessage),id:e.id,"aria-current":t,onClick:o,children:e.sender==="assistant"?(0,te.jsxs)(te.Fragment,{children:[!!e.requestSeconds&&(0,te.jsxs)(m,{variant:f.SMALL,className:vt.requestTime,children:["Thought for ",Math.ceil(e.requestSeconds)," seconds"]}),(0,te.jsx)("div",{children:(0,te.jsx)(m,{children:e.content})})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(m,{className:vt.textContainer,children:e.content}),(0,te.jsx)(mt,{label:"User Name",size:ut.SMALL})]})})}var Ps=s(E(),1);var et={messagesSkeleton:"RY7Yj",message:"xqP71",assistant:"Iyn3Y",user:"rjOB-",card:"Uc3Vm"};var $=s(l(),1);function un(){return(0,$.jsx)("ul",{className:et.messagesSkeleton,children:["assistant","user","assistant","user"].map((e,t)=>(0,$.jsxs)(Ps.Fragment,{children:[e==="assistant"&&(0,$.jsxs)("div",{className:R(et.message,et.assistant),"aria-hidden":!0,children:[(0,$.jsx)(ue,{variant:f.SMALL,color:"secondary",width:132}),(0,$.jsxs)("div",{children:[(0,$.jsx)(ue,{}),(0,$.jsx)(ue,{width:200})]})]}),e==="user"&&(0,$.jsxs)("div",{className:R(et.message,et.user),"aria-hidden":!0,children:[(0,$.jsxs)("div",{className:et.card,children:[(0,$.jsx)(ue,{color:"secondary"}),(0,$.jsx)(ue,{color:"secondary",width:200})]}),(0,$.jsx)(Ci,{size:36,shape:"round"})]})]},`${e}-${t}`))})}var Jo={chatLog:"RgadK",loadingMessage:"Auyzq fg13W",shimmer:"pXdH6",loadingText:"_06fg-"};function Os({event:e,messages:t,activeDescendantId:o,setActiveDescendantId:r}){if(!t||t.length===0)return;let n=o?t.findIndex(a=>a.id===o):-1,i=n;switch(e.key){case"ArrowDown":e.preventDefault(),i=n<0?0:Math.min(n+1,t.length-1);break;case"ArrowUp":e.preventDefault(),i=n<0?t.length-1:Math.max(n-1,0);break;case"Home":e.preventDefault(),i=0;break;case"End":e.preventDefault(),i=t.length-1;break;default:return}i!==n&&t[i]&&r(t[i].id)}var Ve=s(l(),1);function mn({messages:e,isLoadingResponse:t}){let[o,r]=(0,ae.useState)(void 0),n=(0,ae.useRef)(null),i=(0,ae.useCallback)(u=>{Os({event:u,messages:e,activeDescendantId:o,setActiveDescendantId:r})},[e,o]),a=(0,ae.useCallback)(()=>{if(e&&e.length>0){let u=e[e.length-1];r(u.id)}},[e]),p=(0,ae.useCallback)(()=>{r(void 0)},[]),c=(0,ae.useMemo)(()=>e?(0,Ve.jsxs)("ul",{"aria-label":"Chat messages in chronological order",children:[e.map(u=>(0,Ve.jsx)(cn,{message:u,isSelected:u.id===o,onClick:()=>{r(u.id)}},u.id)),t&&(0,Ve.jsx)("li",{className:Jo.loadingMessage,role:"status","aria-live":"polite","aria-label":"Assistant is thinking",children:(0,Ve.jsx)(m,{className:Jo.loadingText,children:"Thinking..."})})]}):(0,Ve.jsx)(un,{}),[e,o,t]);return(0,ae.useEffect)(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]),(0,Ve.jsx)("div",{ref:n,className:Jo.chatLog,"aria-busy":!e,role:"log","aria-live":"polite","aria-atomic":!1,"aria-label":"Conversation history","aria-activedescendant":o,tabIndex:0,onKeyDown:i,onFocus:a,onBlur:p,children:c})}var Ds={emptyState:"FpkCL"};var Ct=s(l(),1);function dn(){return(0,Ct.jsxs)("div",{className:Ds.emptyState,children:[(0,Ct.jsx)(h,{icon:"question-answer-line"}),(0,Ct.jsx)(m,{variant:f.H1_SUB_HEADLINE,as:"span",children:"Ask us anything."}),(0,Ct.jsx)(m,{children:"Our Assistant can answer any question - whether it\u2019s about our Platform, our data, or our research."})]})}var ws=s(E(),1);var $t={messageInput:"VQzuF",inputContainer:"InJGE",submitButton:"dz0X5",disclaimer:"n4F8f"};var tt=s(l(),1),Ms="ai-assistant-chat-panel-disclaimer";function fn({isDisabled:e,onSendMessage:t}){let[o,r]=(0,ws.useState)(""),n=i=>{i.preventDefault(),o.trim()&&!e&&(t(o),r(""))};return(0,tt.jsxs)("div",{className:$t.messageInput,children:[(0,tt.jsxs)("form",{className:$t.inputContainer,onSubmit:n,children:[(0,tt.jsx)(yo,{value:o,onChange:i=>{r(i.target.value)},onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),t(o),r(""))},placeholder:"Type anything...",rows:3,disabled:e,isFullWidth:!0,"aria-describedby":Ms}),(0,tt.jsx)(H,{className:$t.submitButton,type:"submit",icon:"arrow-up-line","aria-label":"Send message",size:j.LARGE,disabled:!o.trim()||e})]}),(0,tt.jsx)(m,{id:Ms,className:$t.disclaimer,variant:f.SMALL,children:"AI responses are not guaranteed to be accurate. Please verify all responses."})]})}var ks={conversationView:"qfoSh"};var xt=s(l(),1);function gn({selectedConversation:e,messages:t,isLoadingResponse:o,onSendMessage:r}){return(0,xt.jsxs)("section",{className:ks.conversationView,"aria-label":"Current chat",children:[e?(0,xt.jsx)(mn,{messages:t,isLoadingResponse:o}):(0,xt.jsx)(dn,{}),(0,xt.jsx)(fn,{isDisabled:o,onSendMessage:r})]})}var bt=s(E(),1);var Us=s(E(),1);var _t={conversationItem:"_8-dvK",conversationCard:"bChZU",header:"_9hML8",timestamp:"MtOrb",summary:"kSVvM"};var we=s(l(),1);function Sn({conversation:e,onSelectConversation:t}){let o=(0,Us.useMemo)(()=>xi(new Date(e.lastUpdated),new Date),[e.lastUpdated]);return(0,we.jsx)("li",{className:_t.conversationItem,children:(0,we.jsx)("button",{onClick:t,children:(0,we.jsxs)(si,{className:_t.conversationCard,variant:ii.INTERACTIVE,bodyPadding:Lo.NONE,children:[(0,we.jsxs)("div",{className:_t.header,children:[(0,we.jsx)(m,{children:e.name}),o&&(0,we.jsx)(m,{className:_t.timestamp,variant:f.SMALL,children:o})]}),(0,we.jsx)(m,{className:_t.summary,variant:f.SMALL,children:e.summary})]})})})}var Gs=s(E(),1);var jo={historyItem:"bHpA8",header:"-ZRaW",text:"_9fKIp"};var Se=s(l(),1);function hn(){return(0,Se.jsx)(Gs.Fragment,{children:Array.from({length:3}).map((e,t)=>(0,Se.jsx)("li",{className:jo.historyItem,"aria-hidden":!0,children:(0,Se.jsxs)(vi,{bodyPadding:Lo.NONE,children:[(0,Se.jsxs)("div",{className:jo.header,children:[(0,Se.jsx)(ue,{color:"heading"}),(0,Se.jsx)(ue,{color:"secondary",variant:f.SMALL,width:100})]}),(0,Se.jsxs)("div",{className:jo.text,children:[(0,Se.jsx)(ue,{variant:f.SMALL}),(0,Se.jsx)(ue,{variant:f.SMALL,width:150})]})]})},`conversation-${t}`))})}var Bs={historyView:"Z7Q2M"};var Zt=s(l(),1);function yn({onSelectConversation:e}){let[t,o]=(0,bt.useState)(void 0),r=!t;(0,bt.useEffect)(()=>{let i=setTimeout(()=>{o(_s)},2e3);return()=>clearTimeout(i)},[]);let n=(0,bt.useMemo)(()=>t?.map(i=>(0,Zt.jsx)(Sn,{conversation:i,onSelectConversation:()=>e(i)},i.id)),[t,e]);return(0,Zt.jsx)("section",{className:Bs.historyView,"aria-label":"Conversation history",children:(0,Zt.jsx)("ul",{role:"list","aria-busy":r,children:r?(0,Zt.jsx)(hn,{}):n})})}var En={header:"_1KsMo",text:"DiPye"};var ot=s(l(),1);function Tn(){let{closeChatPanel:e}=ge();return(0,ot.jsxs)("div",{className:En.header,children:[(0,ot.jsxs)(m,{className:En.text,children:[(0,ot.jsx)(h,{icon:"sparkling-2-line"}),"Censys Assistant",(0,ot.jsx)(_i,{tooltipContent:"This feature is in beta. AI responses are not guaranteed to be accurate."})]}),(0,ot.jsx)(H,{icon:"close-line","aria-label":"Close assistant chat panel","aria-controls":je,variant:N.GHOST,onClick:e})]})}var er={viewNavigation:"rfZ0I",separator:"T-EJT",displayText:"LZsyR"};var Z=s(l(),1),al="New Chat",ll="Chats";function An({view:e,setView:t,chatTitle:o=al}){let{hasChatHistory:r}=ge();return r?(0,Z.jsx)("nav",{className:er.viewNavigation,"aria-label":"Chat navigation",children:(0,Z.jsxs)("ol",{children:[(0,Z.jsx)(Qs,{isActive:e==="chat-history",inactiveAriaLabel:"Switch to view chat history",onSelect:()=>t("chat-history"),children:ll}),(0,Z.jsx)("span",{"aria-hidden":!0,children:(0,Z.jsx)(m,{className:er.separator,variant:f.H2,as:"div",children:"/"})}),(0,Z.jsx)(Qs,{isActive:e==="chat-conversation",inactiveAriaLabel:`Switch to view current chat '${o}'`,onSelect:()=>t("chat-conversation"),children:o})]})}):(0,Z.jsx)(Ln,{children:o})}var Qs=({isActive:e,inactiveAriaLabel:t,onSelect:o,children:r})=>(0,Z.jsx)("li",{"aria-current":e?"page":void 0,children:e?(0,Z.jsx)(Ln,{children:r}):(0,Z.jsx)(Ee,{variant:N.GHOST,"aria-label":t,onClick:o,children:(0,Z.jsx)(Ln,{children:r})})}),Ln=({children:e})=>(0,Z.jsx)(m,{className:er.displayText,variant:f.H2,as:"div",children:e});var tr=s(E(),1);function In(e){let[t,o]=(0,tr.useState)(0);return(0,tr.useEffect)(()=>{e.current&&o(e.current.getBoundingClientRect().top)},[e.current]),{offsetHeightStyle:t?{height:`calc(100dvh - ${t}px)`}:void 0}}var or={chatPanel:"Ymqyv",panelHeader:"tI6ka",navigationContainer:"-O3bU"};var ve=s(l(),1);function rr(){let{isOpen:e,isFeatureEnabled:t}=ge(),o=(0,K.useRef)(null),{offsetHeightStyle:r}=In(o),[n,i]=(0,K.useState)(void 0),[a,p]=(0,K.useState)(void 0),[c,u]=(0,K.useState)(!1),[d,S]=(0,K.useState)("chat-conversation"),L=(0,K.useCallback)(C=>{let y=C.trim();if(!y||c)return;let U={id:`msg-${Date.now()}-user`,sender:"user",content:y};n||i({id:"new-chat",name:"New Chat",summary:"",lastUpdated:""}),p(I=>[...I||[],U]),u(!0),setTimeout(()=>{let I={id:`msg-${Date.now()}-assistant`,sender:"assistant",content:`This is a mock response to: "${C.trim()}"`,requestSeconds:2};p(Q=>[...Q||[],I]),u(!1)},2e3)},[c,a,n]),g=(0,K.useMemo)(()=>(0,ve.jsx)(gn,{selectedConversation:n,messages:a,isLoadingResponse:c,onSendMessage:L}),[n,a,c,L]),T=(0,K.useMemo)(()=>(0,ve.jsx)(yn,{onSelectConversation:C=>{C.id!==n?.id&&p(void 0),i(C),S("chat-conversation")}}),[n]);return(0,K.useEffect)(()=>{let C=setTimeout(()=>{if(!n||n.id==="new-chat")return;let y=bs;n.id==="conv-2"?y=Ns:n.id==="conv-3"&&(y=Rs),p(y)},1e3);return()=>clearTimeout(C)},[n]),(0,K.useEffect)(()=>{e||(p(void 0),i(void 0),u(!1),S("chat-conversation"))},[e]),!e||!t?null:(0,ve.jsxs)("aside",{id:je,role:"complementary","aria-label":"Assistant chat panel",className:or.chatPanel,ref:o,style:r,children:[(0,ve.jsxs)("header",{className:or.panelHeader,children:[(0,ve.jsx)(Tn,{}),(0,ve.jsxs)("div",{className:or.navigationContainer,children:[(0,ve.jsx)(An,{view:d,setView:S,chatTitle:n?.name}),n?(0,ve.jsx)(Ee,{variant:N.GHOST,iconLeft:"question-answer",iconLeftMode:"line",onClick:()=>{p(void 0),i(void 0),S("chat-conversation")},children:"New Chat"}):null]})]}),d==="chat-conversation"?g:null,d==="chat-history"?T:null]})}var Ce=s(E(),1);var Vs=s(l(),1),Hs={isOpen:!1,isFeatureEnabled:!1,openChatPanel:()=>{},closeChatPanel:()=>{},onToggle:()=>{},hasChatHistory:!1},vn=(0,Ce.createContext)(Hs),ge=()=>(0,Ce.useContext)(vn),Cn=({initialIsOpen:e=Hs.isOpen,children:t})=>{let[o,r]=(0,Ce.useState)(e),n=ie("conversational-ai"),i=dt(),a=!!(n&&i),p=(0,Ce.useCallback)(()=>{a&&r(!0)},[a]),c=(0,Ce.useCallback)(()=>{a&&r(!1)},[a]),u=(0,Ce.useCallback)(()=>{a&&r(!o)},[a,o]),d={isOpen:o,isFeatureEnabled:a,openChatPanel:p,closeChatPanel:c,onToggle:u,hasChatHistory:!0};return(0,Vs.jsx)(vn.Provider,{value:d,children:t})};var le=s(E(),1);var Ks=s(l(),1),pl={query:"",updateQuery:()=>{}},Fs=(0,le.createContext)(pl);function Ys(){let e=(0,le.useContext)(Fs);if(!e)throw new Error("useSearchContext must be used within a SearchContextProvider");return e}function qs({initialValue:e="",children:t}){let[o,r]=(0,le.useState)(e);(0,le.useEffect)(()=>{r(e)},[e]);let n=(0,le.useCallback)((a,p=!1)=>{let c=p?Ei(o,a):a;r(c)},[o,r]),i=(0,le.useMemo)(()=>({query:o,updateQuery:n}),[o,n]);return(0,Ks.jsx)(Fs.Provider,{value:i,children:t})}var Jt={topHeaderContainer:"OBrof",contentLeft:"Giwtn",searchBarWrapper:"_6EE3F",headerRight:"tLDAr"};var xe=s(l(),1);function nr({placeholder:e,breadcrumbs:t,children:o,collectionId:r}){let{query:n}=Ys(),i=(0,Ws.useMemo)(()=>t.map(a=>"pathName"in a?{...a,pathName:a.pathName}:a),[t]);return(0,xe.jsxs)("header",{className:Jt.topHeaderContainer,children:[(0,xe.jsxs)("div",{className:Jt.contentLeft,children:[(0,xe.jsx)(ui,{breadcrumbs:i}),(0,xe.jsx)("div",{className:Jt.searchBarWrapper,children:(0,xe.jsx)(an,{q:n,placeholder:e,collectionId:r})}),(0,xe.jsxs)("div",{className:Jt.headerRight,children:[(0,xe.jsx)($o,{}),(0,xe.jsx)(vs,{})]})]}),o]})}var Ot=s(E(),1);var _e=s(E(),1);var zs=s(E(),1);var xn={toggleContainer:"SXZqD",darkMode:"_3vGqO",lightMode:"IeVLg",iconColor:"m4szN"};var jt=s(l(),1),Xs=(0,zs.forwardRef)(function({onAppThemeToggle:t},o){let{theme:r}=vo(),{t:n}=b();return(0,jt.jsxs)("div",{className:xn.toggleContainer,children:[(0,jt.jsx)(h,{icon:r==="theme-default"?"sun-line":"moon-line",className:xn.iconColor,size:"lg"}),(0,jt.jsx)(ri,{initialState:r==="theme-default",leftText:n("Light Mode"),rightText:n("Dark Mode"),onToggle:t,ref:o})]})});var $s=s(E(),1);function Zs(e,t=!1){let{featureFlags:o}=(0,$s.useContext)(di);return Array.isArray(e)?e.every(r=>o[r]??t):o[e]??t}var ml=s(Fa(),1);function _n(e,t){return`${hr(e,"/")}/logout?return_to=${encodeURIComponent(`${t}`)}`}function ir(e){return`${e.firstName}${e.lastName?` ${e.lastName}`:""}`}var Js=s(E(),1);var Nt={dropdownItem:"_3prCG",dropdownItemText:"_7yaZc"};var rt=s(l(),1),dl={},fl={rel:void 0,target:"_self"},Rt=(0,Js.forwardRef)(({iconName:e,href:t,shouldOmitOrg:o=!1,shouldOpenNewWindow:r=!0,text:n},i)=>{let a=r?dl:fl;return(0,rt.jsx)(W,{className:Nt.dropdownItem,ref:i,asChild:!0,children:(0,rt.jsx)(w,{className:Nt.dropdownLink,href:t,isExternal:r,shouldOmitOrg:o,...a,children:(0,rt.jsxs)(m,{className:Nt.dropdownItemText,children:[(0,rt.jsx)(h,{className:Nt.dropdownLinkIcon,name:e,mode:"line",size:"lg"}),n,r&&(0,rt.jsx)(h,{className:Nt.dropdownLinkIcon,name:"external-link",mode:"line",size:"lg"})]})})})});var js=s(E(),1);var eo={dropdownTooltip:"_6WtmI",dropdownTooltipItem:"fdIyH",dropdownItemText:"QzB0U",dropdownLinkIcon:"HWE5u"};var Pt=s(l(),1),bn=(0,js.forwardRef)(({content:e,title:t,icon:o,onClick:r},n)=>(0,Pt.jsx)(wt,{content:e,triggerClassName:eo.dropdownTooltip,children:(0,Pt.jsx)(W,{ref:n,className:eo.dropdownTooltipItem,onClick:r,asChild:!0,children:(0,Pt.jsxs)(m,{className:eo.dropdownItemText,children:[(0,Pt.jsx)(h,{className:eo.dropdownLinkIcon,icon:o,size:"lg"}),t]})})}));var Nn={accountStatus:"_7qEcp",accountStatusText:"ArpOi"};var to=s(l(),1);function Rn({accessState:e}){return(0,to.jsxs)("div",{className:Nn.accountStatus,children:[(0,to.jsx)(mt,{label:e.firstName,size:ut.SMALL}),(0,to.jsx)(m,{className:Nn.accountStatusText,children:ir(e)})]})}var q={dropdownTrigger:"w6x9e",avatarContainer:"mryY8",dropdownContent:"Vqvrx",dropdownGroup:"QAdrJ",dropdownItem:"ir9f7",dropdownItemContainer:"bxkzE",captionHeading:"Gn0Nk",dropdownSeparator:"WTpVA"};var Pn=s(E(),1);function On(e,t){return(0,Pn.useCallback)(o=>{if(!(o.key==="ArrowDown"||o.key==="ArrowUp"))return;o.preventDefault(),o.stopPropagation(),(o.key==="ArrowUp"?e:t).current?.focus()},[e,t])}function Dn(e){return(0,Pn.useCallback)(t=>{(t.key==="ArrowDown"||t.key==="ArrowUp")&&(t.preventDefault(),t.stopPropagation(),e.current?.focus())},[e])}var ea="/api/preferredAppTheme",ta="preferredAppTheme",oa="/language",ra="language";var Mn={toggleContainer:"UypTu",iconColor:"bJ0l2"};var oo=s(l(),1);function wn(){let{t:e,i18n:t}=b(),o=ne({key:ra});return(0,oo.jsxs)("div",{className:Mn.toggleContainer,children:[(0,oo.jsx)(h,{icon:"translate",className:Mn.iconColor,size:"lg"}),(0,oo.jsx)(oi,{value:t.language,onValueChange:r=>{t.changeLanguage(r),o.submit({locale:r},{method:"POST",action:oa})},options:[{label:e("English"),value:"en"},{label:e("Spanish"),value:"es"},{label:e("French"),value:"fr"},{label:e("Italian"),value:"it"},{label:e("German"),value:"de"},{label:e("Swedish"),value:"sv"},{label:e("Portuguese"),value:"pt"},{label:e("Japanese"),value:"ja"}]})]})}var v=s(l(),1);function kn({accessState:e,errorText:t,isLoading:o,onAppThemeToggle:r,onOrganizationChange:n}){let i=(0,_e.useRef)(null),a=(0,_e.useRef)(null),p=(0,_e.useRef)(null),c=(0,_e.useRef)(null),[u,d]=(0,_e.useState)(!1),S=fo(),{t:L}=b(),g=Zs("internationalization"),[T]=gi([14]),y=e?.currentPlanType!=="Free"||T,U=!S.pathname.startsWith("/collections"),I=G("ACCOUNTS_SITE_URL"),Q=G("APP_SITE_URL"),ye=G("ASM_SITE_URL"),oe=(0,_e.useCallback)(x=>{d(x)},[]),Ne=(0,_e.useCallback)(async()=>{try{let x=new URL(window.location.toString());x.searchParams.delete(_o),await bi(x.toString())}catch{}},[]),ke=On(i,p),Re=Dn(a),re=On(a,c),ce=Dn(p);return(0,v.jsxs)(go,{open:u,onOpenChange:oe,children:[(0,v.jsx)(So,{className:q.dropdownTrigger,children:(0,v.jsxs)("div",{className:q.avatarContainer,children:[(0,v.jsx)(mt,{label:ir(e),size:ut.MEDIUM,isActive:u}),(0,v.jsx)(h,{name:u?"arrow-drop-up":"arrow-drop-down",mode:"line",size:"2xl"})]})}),(0,v.jsxs)(ho,{align:"end",className:q.dropdownContent,children:[(0,v.jsxs)(Pe,{className:q.dropdownGroup,children:[(0,v.jsx)(pt,{className:q.captionHeading,asChild:!0,children:(0,v.jsx)(m,{variant:f.H4,as:"span",children:L("Welcome back")})}),(0,v.jsx)(Rn,{accessState:e}),(0,v.jsx)(Ge,{className:q.dropdownSeparator}),(0,v.jsx)(Rt,{iconName:"user",href:`${I}/settings`,text:L("My Account"),shouldOpenNewWindow:!0}),y&&(0,v.jsx)(Rt,{iconName:"exchange-2",href:`${I}/settings/personal-access-tokens`,text:L("API Access"),shouldOpenNewWindow:!0}),U&&(0,v.jsx)(bn,{content:L("Copy a shareable link to your clipboard"),title:L("Share link"),icon:"link",ref:i,onClick:Ne})]}),(0,v.jsx)(Ge,{className:q.dropdownSeparator}),(0,v.jsxs)(Pe,{className:q.dropdownGroup,children:[(0,v.jsx)(W,{className:q.dropdownItemContainer,onKeyDown:ke,onKeyUp:Re,onSelect:x=>{x.preventDefault()},children:(0,v.jsx)(Xs,{onAppThemeToggle:r,ref:a})}),g&&(0,v.jsx)(wn,{})]}),(0,v.jsx)(Ge,{className:q.dropdownSeparator}),(0,v.jsxs)(Pe,{className:q.dropdownGroup,children:[(0,v.jsx)(pt,{children:(0,v.jsx)(m,{className:q.captionHeading,variant:f.H4,as:"span",children:"Switch to..."})}),(0,v.jsx)(W,{className:q.dropdownItemContainer,onKeyDown:re,onKeyUp:ce,onSelect:x=>{x.preventDefault()},children:(0,v.jsx)(Ni,{organization:e.organization,availableOrganizations:e.availableOrganizations,onOrganizationChange:n,errorText:t,isLoading:o,ref:p})}),(0,v.jsx)(Rt,{iconName:"arrow-left-right",href:ye,shouldOmitOrg:!0,text:L("Attack Surface Management"),ref:c})]}),(0,v.jsx)(Ge,{className:q.dropdownSeparator}),(0,v.jsx)(Pe,{className:q.dropdownGroup,children:(0,v.jsx)(Rt,{iconName:"logout-box-r",href:_n(I,Q),shouldOpenNewWindow:!1,text:L("Logout")})})]})]})}var nt=s(E(),1);var ro={buttonContainer:"_4aRFs",panelOffset:"QMnU7",buttonText:"lDv2l",button:"s8VII"};var no=s(l(),1);function Un({containerRef:e}){let[t,o]=(0,nt.useState)(!1),{t:r}=b(),{isOpen:n}=ge(),i=(0,nt.useCallback)(()=>{let p=e?.current;if(!p)return;let c=p.clientHeight;o(p.scrollTop>c)},[e]);(0,nt.useEffect)(()=>{let p=e?.current;if(p)return i(),p.addEventListener("scroll",i,{passive:!0}),()=>{p.removeEventListener("scroll",i)}},[e,i]);let a=(0,nt.useCallback)(p=>{p.preventDefault();let u=window.matchMedia("(prefers-reduced-motion: reduce)").matches?"auto":"smooth";e.current?.scrollTo({top:0,behavior:u})},[e]);return t?(0,no.jsxs)("div",{className:R(ro.buttonContainer,n&&ro.panelOffset),role:"navigation","aria-label":"Scroll to top of page",children:[(0,no.jsx)(H,{iconName:"arrow-up-double",iconMode:"fill",size:j.LARGE,onClick:a,className:ro.button,"aria-label":"Scroll to top of page"}),(0,no.jsx)(m,{variant:f.DEFAULT,className:ro.buttonText,"aria-hidden":"true",children:r("Scroll to top")})]}):null}var pe={appLayout:"CZL5V",sideNav:"IJWvu",rightContainer:"FS5Lm",header:"CRqJm",loginRegisterActions:"pLljX",loginRegisterDivider:"Amv8K",contentContainer:"_3aZJA",sideContent:"nmfiW",actions:"XvXwy",navTabs:"mfo-C",pageContent:"CAkVT"};var it={footerContainer:"oKIZG",innerContainer:"V53bw",helpBlurb:"_5SsQP",footerText:"RYRpQ"};var V=s(l(),1),Gn=4;function sr(){let{t:e}=b(),t=G("PRODUCT_SITE_URL"),o=G("SUPPORT_SITE_URL"),r=new Date().getUTCFullYear();return(0,V.jsxs)("footer",{className:it.footerContainer,children:[(0,V.jsxs)("div",{className:it.innerContainer,children:[(0,V.jsx)(w,{size:"md",href:`${o}`,isExternal:!0,children:e("Resource Hub")}),(0,V.jsx)(z,{variant:"dot",size:Gn}),(0,V.jsx)(w,{size:"md",href:`${t}/attack-surface-management/`,isExternal:!0,children:e("Attack Surface Management")}),(0,V.jsx)(z,{variant:"dot",size:Gn}),(0,V.jsx)(w,{size:"md",href:`${t}/contact-government/`,isExternal:!0,children:e("Government")}),(0,V.jsx)(z,{variant:"dot",size:Gn}),(0,V.jsx)(w,{size:"md",href:`${o}/docs/research-access-to-censys-data#/`,isExternal:!0,children:e("Research Access")})]}),(0,V.jsxs)("div",{className:it.innerContainer,children:[(0,V.jsxs)(m,{className:R(it.helpBlurb,it.footerText),children:[e("Need help?"),"\xA0\xA0",(0,V.jsx)(w,{size:"md",href:o,isExternal:!0,children:e("Help Center")}),"\xA0or\xA0",(0,V.jsx)(w,{size:"md",href:"mailto:support@censys.com",children:"support@censys.com"})]}),(0,V.jsx)(z,{variant:"line--vertical"}),(0,V.jsxs)(m,{className:it.footerText,children:["\xA9",r," Censys"]})]})]})}var _=s(l(),1);function gl({breadcrumbs:e}){return(0,_.jsx)(nr,{breadcrumbs:e,children:(0,_.jsx)(hl,{})})}var Sl=({breadcrumbs:e})=>({searchHeader:(0,_.jsx)(gl,{breadcrumbs:e})});function na({children:e,breadcrumbs:t,initialQuery:o="",slots:r={},navTabClassName:n=""}){r={...Sl({breadcrumbs:t}),...r};let i=(0,Ot.useRef)(null);return(0,_.jsx)(Cn,{children:(0,_.jsx)(qs,{initialValue:o,children:(0,_.jsxs)("div",{className:pe.appLayout,children:[(0,_.jsx)("div",{className:pe.sideNav,children:(0,_.jsx)(yr,{})}),(0,_.jsxs)("div",{className:pe.rightContainer,children:[(0,_.jsx)("div",{className:pe.header,children:r.searchHeader}),(0,_.jsxs)("div",{className:pe.contentContainer,ref:i,id:io,children:[(0,_.jsxs)("main",{children:[r.header&&(0,_.jsx)("header",{children:r.header}),r.actions&&(0,_.jsx)("section",{className:pe.actions,"aria-label":"Page Actions Section",children:r.actions}),r.navTabs&&(0,_.jsx)("div",{className:R(pe.navTabs,n),"aria-label":"Navigation tabs",children:r.navTabs}),(0,_.jsx)("section",{"aria-label":"Page Content",className:pe.pageContent,children:e}),(0,_.jsx)("div",{className:pe.sideContent,children:(0,_.jsx)(rr,{})})]}),(0,_.jsx)(sr,{}),(0,_.jsx)(Un,{containerRef:i})]})]})]})})})}function hl(){let e=G("ACCOUNTS_SITE_URL"),t=yl(),{accessState:o,setAppTheme:r}=vo(),{errorText:n,isLoading:i,onOrganizationChange:a}=Ri(),p=ne({key:ta}),c=(0,Ot.useCallback)(u=>{let d=u?"theme-default":gr.DARK_MODE;p.submit({theme:d},{method:"post",action:ea}),r?.(d)},[p,r]);return o?(0,_.jsx)(kn,{accessState:o,onAppThemeToggle:c,onOrganizationChange:a,errorText:n,isLoading:i}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(pi,{variant:li.PIPE,className:pe.loginRegisterDivider}),(0,_.jsxs)("div",{className:pe.loginRegisterActions,children:[(0,_.jsx)(Te,{link:{to:`${e}/login?return_to=${encodeURIComponent(t)}`},button:{iconLeft:"login-box",iconLeftMode:"line",variant:N.TERTIARY},children:"Log in"}),(0,_.jsx)(Te,{link:{to:`${e}/register`},button:{iconLeft:"lock-star",iconLeftMode:"line",variant:N.PRIMARY},children:"Register"})]})]})}function yl(){let e=fo(),t=G("APP_SITE_URL");return(0,Ot.useMemo)(()=>{let o=new URL(e.pathname,t);return o.search=e.search,o.hash=e.hash,o.toString()},[t,e])}var io="app-main-content-container";function El(){return(0,ia.useCallback)(()=>{let e=document.getElementById(io);if(!e)return;let o=window.matchMedia("(prefers-reduced-motion: reduce)").matches?"auto":"smooth";e.scrollTo({top:0,behavior:o})},[])}var he={expandableInputContainer:"_2leAj",large:"zqHRp",rounded:"L9rab",rightSlots:"_--OlM",expanded:"yTJSC",innerContentContainer:"pxaT5",controlsContainer:"ydkkT",leftSlots:"-RLhH",inputContainer:"_4vVyx",lowerContainer:"siA62"};var Dt=s(E(),1),so=24,Tl=300;function Ll(e,t,o,r,n,i){let a=o.current,p=r.current,c=n.current,u=i.current;!a||!p||!c||(e?(p.style.height=`${t}px`,c.style.height=`${t}px`,u&&(u.style.marginTop=`${Math.max(t,a.clientHeight)}px`)):(p.style.height=`${so}px`,c.style.height=`${so}px`,u&&(u.style.marginTop=`${a.clientHeight}px`)))}function sa(e,t,o){let r=e.current;if(!r)return;r.style.height="auto";let n=r.scrollHeight,i=Math.min(n,Tl);o?r.style.height=`${i}px`:r.style.height=`${so}px`,t(i)}function aa({value:e,isExpanded:t,innerRef:o,inputContainerRef:r,inputRef:n,lowerRef:i}){let[a,p]=(0,Dt.useState)(so);return(0,Dt.useEffect)(()=>{sa(n,p,t)},[n,e,t]),(0,Dt.useEffect)(()=>{let c=n.current;if(!c)return;let u=new ResizeObserver(()=>{sa(n,p,t)});return u.observe(c),()=>{u.disconnect()}},[n,t]),(0,Dt.useEffect)(()=>{Ll(t,a,o,r,n,i)},[t,a]),{isMultiline:!!e&&(a>so||e.includes(`
`))}}function la(e,t,o,r,n){e.key==="Enter"&&!e.shiftKey?(e.preventDefault(),r.current?.blur()):e.key==="Escape"&&t&&o.current?.focus(),n?.(e)}var J=s(l(),1);function Al({size:e="medium",variant:t="default",slots:o,value:r,setValue:n,shouldForceOpen:i,onClickOutside:a,onInput:p,onKeyDown:c,onChange:u,placeholder:d="Enter text here...",className:S,...L},g){let[T,C]=(0,P.useState)(!1),y={inner:(0,P.useRef)(null),inputContainer:(0,P.useRef)(null),input:(0,P.useRef)(null),lower:(0,P.useRef)(null),controls:(0,P.useRef)(null),toggle:(0,P.useRef)(null)},U=Lr();(0,P.useImperativeHandle)(g,()=>y.input.current);let{isMultiline:I}=aa({value:r,isExpanded:T,innerRef:y.inner,inputContainerRef:y.inputContainer,inputRef:y.input,lowerRef:y.lower}),Q=(0,P.useMemo)(()=>({size:e==="medium"?j.SMALL:j.MEDIUM,variant:N.GHOST,shape:ct.SQUARE,type:"button",iconMode:"line"}),[e]),ye=(0,P.useCallback)(()=>{u?.({target:{value:""}}),n(""),y.input.current?.focus()},[n,u]),oe=(0,P.useCallback)(()=>{C(x=>!x)},[]),Ne=(0,P.useCallback)(()=>{I&&C(!0)},[I]),ke=(0,P.useCallback)(()=>{U.shouldSkip()||i||(y.input.current&&(y.input.current.scrollTop=0),C(!1))},[i]),Re=(0,P.useCallback)(x=>{la(x,T,y.toggle,y.input,c)},[T,c]),re=(0,P.useCallback)(x=>{n(x.target.value),u?.(x)},[n,u]),ce=(0,P.useCallback)(()=>{U.suppressOnce()},[]);return(0,P.useEffect)(()=>{i||C(!1)},[i]),(0,P.useEffect)(()=>{(y.input.current&&document.activeElement===y.input.current||i)&&C(I)},[I,i]),(0,P.useEffect)(()=>{let x=Ue=>{!!y.lower.current?.contains(Ue.target)||!!y.input.current?.contains(Ue.target)||!!y.controls.current?.contains(Ue.target)||(a?.(),C(!1))};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[T,a]),(0,J.jsxs)("div",{className:R(S,he.expandableInputContainer,he[e],he[t]),children:[(0,J.jsxs)("div",{className:he.innerContentContainer,ref:y.inner,children:[o?.left&&(0,J.jsx)("div",{className:he.leftSlots,children:o.left}),(0,J.jsx)("div",{className:he.inputContainer,ref:y.inputContainer,children:(0,J.jsx)("textarea",{...L,className:R(T&&he.expanded),ref:y.input,value:r,onChange:re,placeholder:d,rows:1,onKeyDown:Re,onFocus:Ne,onBlur:ke})}),!!r&&(0,J.jsxs)("div",{className:he.controlsContainer,ref:y.controls,children:[(0,J.jsx)(wt,{content:"Clear",tabIndex:-1,children:(0,J.jsx)(H,{...Q,name:"clear","aria-label":"Clear input value",iconName:"close",iconMode:"line",onMouseDown:ce,onClick:ye})}),I&&(0,J.jsx)(wt,{content:T?"Collapse":"Expand",tabIndex:-1,children:(0,J.jsx)(H,{...Q,ref:y.toggle,name:"expand-control","aria-label":`${T?"Collapse":"Expand"} input field`,"aria-expanded":T,iconName:T?"collapse-diagonal":"expand-diagonal",iconMode:"line",onMouseDown:ce,onClick:oe})})]}),o?.right&&(0,J.jsx)("div",{className:he.rightSlots,children:o.right})]}),(0,J.jsx)("div",{ref:y.lower,className:he.lowerContainer,children:o?.bottom})]})}var Bn=(0,P.forwardRef)(Al);var Ia=s(E(),1);var pa={pill:"Fi4VD"};var Qn=s(l(),1);function Hn(){return(0,Qn.jsx)(ai,{className:pa.pill,size:"sm",children:(0,Qn.jsx)(bo,{})})}var ca="This is a regular expression (Regex) query";var Vn={advancedContainer:"Zfc79",header:"iAxfV"};var Fe=s(l(),1);function ua({hasAdvancedQueryAccess:e}){let{t}=b(),o=G("SUPPORT_SITE_URL");return(0,Fe.jsxs)("div",{className:Vn.advancedContainer,children:[(0,Fe.jsxs)("div",{className:Vn.header,children:[(0,Fe.jsx)(m,{variant:f.H3,children:"Advanced Query"}),!e&&(0,Fe.jsx)(Hn,{})]}),(0,Fe.jsx)(m,{variant:f.SMALL,children:ca}),(0,Fe.jsx)(w,{size:"sm",href:`${o}/docs/censys-query-language#/`,isExternal:!0,children:t("Learn more")})]})}var be={indicator:"UuMtG",indicatorWithLabel:"KkT80",legacy:"YYuo1",initial:"cTEK2",invalid:"bpiwh",valid:"P0vLJ",indicatorLabel:"Z6w3M",fadeIn:"xKDpM"};var ao=s(l(),1),ma={["INITIAL"]:{indicatorProps:{["data-testid"]:`indicator-icon_${"INITIAL"}`,role:void 0,["aria-live"]:"off"},iconProps:{className:be.initial,name:"search",mode:"line",["aria-hidden"]:!0}},["INVALID"]:{indicatorProps:{["data-testid"]:`indicator-icon_${"INVALID"}`,role:"status",["aria-live"]:"polite",["aria-label"]:"Syntax error detected. Open for details"},iconProps:{className:be.invalid,name:"close-circle",mode:"fill"}},["VALID"]:{indicatorProps:{["data-testid"]:`indicator-icon_${"VALID"}`,role:"status",["aria-live"]:"polite",["aria-label"]:"No syntax errors detected"},iconProps:{className:be.valid,name:"checkbox-circle",mode:"fill"}},["VALID_ADVANCED"]:{indicatorProps:{["data-testid"]:`indicator-icon_${"VALID_ADVANCED"}`,role:"status",["aria-live"]:"polite",["aria-label"]:"Advanced query with no syntax errors detected"},iconProps:{className:be.valid,name:"checkbox-circle",mode:"fill"}},["INVALID_ADVANCED"]:{indicatorProps:{["data-testid"]:`indicator-icon_${"INVALID_ADVANCED"}`,role:"status",["aria-live"]:"polite",["aria-label"]:"Advanced query with syntax error detected. Open for details"},iconProps:{className:be.invalid,name:"close-circle",mode:"fill"}},["LEGACY_QUERY"]:{indicatorProps:{["data-testid"]:`indicator-icon_${"LEGACY_QUERY"}`,role:"status",["aria-live"]:"polite",["aria-label"]:"Legacy query syntax detected. Open for details"},iconProps:{className:be.legacy,name:"alert",mode:"fill"}}};function Yn({status:e}){let t=e==="INVALID_ADVANCED"||e==="VALID_ADVANCED";return(0,ao.jsxs)("div",{...ma[e].indicatorProps,className:R(be.indicator,t&&be.indicatorWithLabel),children:[(0,ao.jsx)(h,{...ma[e].iconProps,size:"lg"}),t&&(0,ao.jsx)(m,{className:be.indicatorLabel,variant:f.SMALL,children:"Advanced"})]})}var ar=s(E(),1);var M={popover:"_0L8rh",popoverWrapper:"_5lk6X",dismissButton:"qTrPy",container:"XyG-a",content:"n-7Wr",errorContent:"SZivP",validContainer:"wJ35h",validText:"Q0-1-",list:"MrXHX",syntaxErrorList:"jZtZj",syntaxErrorText:"cHu9H",errorLocationList:"bj-Ae",errorLocationListItem:"mqzNP",errorLocationLineNumber:"CI28R",errorLocationMsg:"sC9zW",errorIcon:"BHJx6",learnMoreButton:"zd0W-",messageContent:"_2FjaH"};var st=s(l(),1),da=({errorLines:e})=>(0,st.jsx)("ol",{className:R(M.list,M.errorLocationList),"data-testid":"error-location-list","aria-hidden":!0,children:e.map(({lineNumber:t,hasError:o,line:r})=>(0,st.jsxs)("li",{className:M.errorLocationListItem,"aria-describedby":`syntax-error-${t}`,children:[o&&(0,st.jsx)(h,{name:"close-circle",mode:"fill",className:M.errorIcon}),(0,st.jsx)(m,{className:M.errorLocationLineNumber,children:t}),(0,st.jsx)(m,{className:M.errorLocationMsg,children:r})]},t))});var lo=s(l(),1),fa=({errorLines:e})=>(0,lo.jsx)("ol",{className:R(M.list,M.syntaxErrorList),"data-testid":"syntax-error-list",children:e.filter(({syntaxError:t})=>t).map(({lineNumber:t,syntaxError:o})=>(0,lo.jsx)("li",{children:(0,lo.jsxs)(m,{id:`syntax-error-${t}`,variant:f.SMALL,className:M.syntaxErrorText,"aria-label":`Line ${t} has error ${o}`,children:["Line ",t,": ",o]})},t))});var ga="Query syntax is valid",Sa="Syntax Validation",ha="Syntax Error",ya="Legacy Query Syntax Detected",Ea="https://docs.censys.com/docs/censys-query-language";var po=s(l(),1),Ta=()=>{let{t:e}=b();return(0,po.jsxs)("div",{className:M.validContainer,children:[(0,po.jsx)(h,{name:"checkbox-circle",mode:"fill"}),(0,po.jsx)(m,{className:M.validText,children:e(ga)})]})};var La=(e,t)=>{if(!t.length)return[];let o=t.sort((i,a)=>(i.Position?.offset??0)-(a.Position?.offset??0)),r=0,n=o.reduce((i,{message:a,Position:p})=>{let{offset:c=0,offset_end:u=0}=p??{};return r<c&&i.push({hasError:!1,line:e.slice(r,c).trim(),lineNumber:i.length+1,syntaxError:""}),i.push({hasError:!0,line:e.slice(c,u).trim(),lineNumber:i.length+1,syntaxError:a}),r=u,i},[]);return r<e.length&&n.push({hasError:!1,line:e.slice(r).trim(),lineNumber:n.length+1,syntaxError:""}),n};var O=s(l(),1),Il={popover:M.popover,contentWrapper:M.popoverWrapper,dismissButton:M.dismissButton};function qn({children:e,query:t,statusIndicator:o,syntaxErrors:r,isLegacyQuery:n,onOpenSyntaxPopover:i}){let{t:a}=b(),p=ie("auto-legacy-query-conversion"),[c,u]=(0,ar.useState)(!1),d=(0,ar.useMemo)(()=>n?[]:La(t,r),[t,r,n]),S=T=>{T?(u(!0),i?.()):u(!1)},L,g;return n?(L=ya,g=p?(0,O.jsx)("div",{className:M.messageContent,children:(0,O.jsx)(fr,{variant:dr.INFO,children:(0,O.jsxs)("div",{children:[kt,(0,O.jsx)(m,{variant:f.DEFAULT_SEMIBOLD,children:(0,O.jsx)(Ao,{timestamp:Ut,format:"MMMM DD, YYYY"})}),".",(0,O.jsx)(Je,{to:Gt,isExternal:!0,children:"Learn About Platform Syntax"})]})})}):(0,O.jsx)("div",{className:M.messageContent,children:(0,O.jsx)(fr,{variant:dr.INFO,actions:[(0,O.jsx)(Te,{link:{to:`/home/query-converter?legacyQuery=${encodeURIComponent(t)}`},button:{iconRight:"arrow-right",iconRightMode:"line",onClick:()=>u(!1)},children:a("Query Converter")},"query-converter-link")],children:(0,O.jsxs)("div",{children:["Convert legacy queries to new"," ",(0,O.jsx)(m,{variant:f.DEFAULT_SEMIBOLD,children:"Platform"})," ","syntax"]})})})):(L=d.length?a(ha):a(Sa),d.length===0?g=(0,O.jsx)(Ta,{}):g=(0,O.jsx)(vl,{errorLines:d})),(0,O.jsx)(Io,{contentProps:{align:"start",alignOffset:-11,sideOffset:8.5},modal:!0,isDismissible:!0,side:"bottom",customClassNames:Il,trigger:(0,O.jsx)("div",{children:o}),onOpenChange:S,open:c,children:(0,O.jsxs)("div",{className:M.container,"data-testid":"popover-content",children:[(0,O.jsx)(m,{variant:f.H2,children:L}),(0,O.jsxs)("div",{className:M.content,children:[g,e]})]})})}var vl=({errorLines:e})=>{let{t}=b();return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)("div",{className:M.errorContent,tabIndex:0,children:[(0,O.jsx)(fa,{errorLines:e}),(0,O.jsx)(da,{errorLines:e})]}),(0,O.jsx)(Te,{link:{to:Ea,isExternal:!0},button:{variant:N.TERTIARY,iconRight:"external-link",className:M.learnMoreButton,size:We.SMALL},children:t("Learn about the Censys Query Language")})]})};var Aa=(e,t,o)=>{if(e.length===0)return"INITIAL";let r=o?.isAdvancedQuery||!1;return hi(e)||yi(e)?r?"VALID_ADVANCED":"VALID":o?.isLegacyQuery?"LEGACY_QUERY":t.length>0?r?"INVALID_ADVANCED":"INVALID":r?"VALID_ADVANCED":"VALID"};var lr=s(l(),1);function Kn({hasAdvancedQueryAccess:e,inputQuery:t,queryDetails:o,syntaxErrors:r,onOpenSyntaxPopover:n}){let i=(0,Ia.useMemo)(()=>Aa(t,r,o),[r,t,o]),a=(0,lr.jsx)(Yn,{status:i});return i==="INITIAL"?a:(0,lr.jsx)(qn,{query:t,syntaxErrors:r,statusIndicator:a,onOpenSyntaxPopover:n,isLegacyQuery:o?.isLegacyQuery||!1,children:o?.isAdvancedQuery&&!o?.isLegacyQuery&&(0,lr.jsx)(ua,{hasAdvancedQueryAccess:e})})}var Wn={inputContainer:"n4D0h",withListbox:"L9yX8"};var at=s(E(),1);var va="/api/search-history",Ca="search-history";var xa=()=>{let t=!!Co(),o=ne({key:Ca}),r=(0,at.useCallback)(()=>{t&&o.load(va)},[o.load,t]);(0,at.useEffect)(()=>{r()},[r]);let n=(0,at.useMemo)(()=>(o.data?.recentSearches||[]).map(a=>({...a,shouldCloseListBoxOnSelect:!0})),[o.data?.recentSearches]),i=o.state==="loading";return(0,at.useMemo)(()=>({recentSearches:n,isLoading:i,fetchSearchHistory:r}),[n,i,r])};var lt=s(E(),1);function _a(e){let t=[];e.suggestions.forEach((r,n)=>{let{edit:i,restricted:a,suggested_text:p}=r;if(i){let c={from:i.replace_from,to:i.replace_to,value:i.replacement};t.push({id:`api-response-suggestion-${n}`,isLocked:a,value:p,replacement:c})}});let o;return e.full_document_query&&e.full_document_query!==Tr&&(o={id:Er,value:e.full_document_query,shouldCloseListBoxOnSelect:!0}),{autocomplete:t,errors:e.errors,hasAdvancedQueryAccess:e.hasAdvancedQueryAccess,details:{isAdvancedQuery:e.details?.regex_present||!1,isLegacyQuery:e.legacy_query_detected},exactMatch:o}}function ba({inputValue:e,hasSuggestions:t,hasDefaultSuggestions:o,isLoadingSuggestions:r}){return e?t||r:o}function Na({hasContent:e,isListBoxTriggered:t}){return t&&e}function Ra(e,t,o,r,n,i,a){let p=[...e];a&&p.unshift(...a),i&&p.unshift(i),o&&p.unshift(...o),t&&p.push(t);let c=[];return r&&c.push(...r),n?.queries&&c.push(...n.queries),{listBoxSuggestions:p,listBoxDefaults:c.length?c:void 0}}function Pa(e,t,o,r,n,i){if(e.key==="Escape"||e.key==="Enter"&&!e.shiftKey){e.key==="Enter"&&!e.shiftKey&&i?.(),o(!1);return}if((e.key==="ArrowDown"||e.key==="ArrowUp"||e.key.length===1&&!e.ctrlKey&&!e.metaKey)&&!t){o(!0);return}if(e.key==="ArrowDown"||e.key==="ArrowUp"){r.current?.focus(),n(e.key==="ArrowDown"?0:-1);return}}var Oa=({query:e="",onSelectExactMatch:t})=>{let[o,r]=(0,lt.useState)(`q=${e}`),n=Li(()=>`/api/suggestions?${o}`,[o]),i=(0,lt.useCallback)((L,g)=>{r(new URLSearchParams([["q",L],["cursorPosition",g.toString()]]).toString())},[]),{autocomplete:a=[],errors:p=[],hasAdvancedQueryAccess:c=!0,details:u,exactMatch:d}=(0,lt.useMemo)(()=>{if(n.data){let L=_a(n.data);return t&&L.exactMatch&&(L.exactMatch={...L.exactMatch,onSelect:t}),L}return{}},[n.data?.suggestions,t]),S=n.state===0&&a.length===0&&p.length===0;return(0,lt.useMemo)(()=>({autocomplete:a,errors:p,details:u,exactMatch:d,getSuggestions:i,hasAdvancedQueryAccess:c,isLoading:S}),[a,p,u,c,d,i,S])};var Ye=s(l(),1);function sn({id:e,name:t,inputLabel:o,onEnterKeyDown:r,onChange:n,placeholder:i,size:a,variant:p,rightInputSlot:c,rightContainerSlot:u,initialValue:d="",defaultSuggestions:S,contextSuggestions:L,isLoading:g,onIsValidChange:T}){let C=`${e}-suggestions-listbox`,y=(0,k.useRef)(null),U=(0,k.useRef)(null),[I,Q]=(0,k.useState)(d),{autocomplete:ye=[],errors:oe=[],hasAdvancedQueryAccess:Ne,details:ke,exactMatch:Re,getSuggestions:re,isLoading:ce}=Oa({query:I,onSelectExactMatch:r}),{queryAssistantSuggestion:x,queryAssistantState:Ue,generatedQueryId:Mt}=jr(I,e,!!oe.length,!!ke?.isLegacyQuery),{queryConverterSuggestions:qe,queryConverterState:Ma}=rn(I,e,!!ke?.isLegacyQuery),{recentSearches:pr,isLoading:wa,fetchSearchHistory:zn}=xa(),{listBoxSuggestions:Xn,listBoxDefaults:$n}=(0,k.useMemo)(()=>Ra(ye,Re,L,pr,S,x,qe),[ye,Re,L,pr,S,x,qe]),[cr,ur]=(0,k.useState)(!1),co=(0,k.useCallback)(()=>ur(!1),[]),ka=(0,k.useCallback)(()=>{ur(!0)},[]),Ua=(0,k.useCallback)(Ke=>{Q(Ke??""),n?.({target:{value:Ke},currentTarget:y.current})},[n,Q]),{activeDescendantId:Zn,setActiveDescendantId:Ga,tempInputValue:Ba,setInputValueById:Qa,selectOptionByIndex:Jn}=wo({suggestions:Xn,defaultSuggestions:$n,inputValue:I,setInputValue:Ua,inputRef:y,handleCloseListBox:co}),uo=Si({value:I,delay:250}),mo=Na({hasContent:ba({inputValue:I,hasSuggestions:!!Xn.length,hasDefaultSuggestions:!!$n,isLoadingSuggestions:ce}),isListBoxTriggered:cr}),Ha=(0,k.useCallback)(Ke=>{n?.(Ke);let{value:mr}=Ke.target;Q(mr),mr===""&&(re(mr,0),zn())},[n,Q,re,zn]),jn=(0,k.useCallback)(()=>{r?.()},[r]),Va=(0,k.useCallback)(Ke=>{Pa(Ke,cr,ur,U,Jn,jn)},[cr,U,Jn,jn]);return(0,k.useEffect)(()=>{uo&&y.current&&re(uo,y.current.selectionStart||uo.length)},[uo,re]),(0,k.useEffect)(()=>{Q(d)},[d,Q]),(0,k.useEffect)(()=>{T?.(oe.length===0)},[oe.length,T]),(0,Ye.jsxs)(Ye.Fragment,{children:[(0,Ye.jsx)(Bn,{className:R(Wn.inputContainer,mo&&Wn.withListbox),ref:y,id:e,name:t,"aria-label":o,value:Ba||I,setValue:Q,onChange:Ha,onKeyDown:Va,onClick:ka,size:a,variant:p,"aria-invalid":!!oe.length,role:"combobox","aria-autocomplete":"list",autoComplete:"off",spellCheck:"false","aria-controls":C,"aria-activedescendant":Zn,"aria-expanded":mo,placeholder:i,"aria-busy":g,onClickOutside:co,shouldForceOpen:mo,slots:{left:(0,Ye.jsx)(Kn,{hasAdvancedQueryAccess:Ne,inputQuery:I,queryDetails:ke,syntaxErrors:oe,onOpenSyntaxPopover:co}),right:c,bottom:mo&&(0,Ye.jsx)(nn,{inputId:e,listBoxId:C,inputRef:y,ref:U,autocomplete:ye,exactMatch:Re,inputValue:I,defaults:S,contexts:L,recentSearches:pr,queryAssistantState:Ue,queryAssistantSuggestion:x,generatedQueryId:Mt,queryConverterState:Ma,queryConverterSuggestions:qe,setActiveDescendantId:Ga,selectedOptionId:Zn,onSelectOption:Qa,isLoading:ce,isLoadingRecentSearches:wa,handleCloseListBox:co})}}),u?.({query:I,isValid:oe.length===0})]})}export{qa as a,Ya as b,Oi as c,ld as d,Ss as e,Gt as f,sn as g,Ir as h,Ys as i,nr as j,ir as k,gl as l,na as m,hl as n,El as o};
