import{a as te}from"/censys/build/_shared/chunk-H7Q3B5O5.js";import{a as x}from"/censys/build/_shared/chunk-4533AUAX.js";import{a as se,e as re}from"/censys/build/_shared/chunk-DXLA43JS.js";import{a as ae}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{c as ie}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{a as M}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{b as J,c as Z,d as j,l as ee}from"/censys/build/_shared/chunk-IO4OV3HV.js";import{a as z}from"/censys/build/_shared/chunk-BU2LL35M.js";import{a as Q,c as X}from"/censys/build/_shared/chunk-FP2KPINM.js";import{b as q}from"/censys/build/_shared/chunk-VKYVKQW2.js";import{a as Y}from"/censys/build/_shared/chunk-M5RKE22T.js";import{f as B,j as K}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{$ as U,A as v,B as F,Xa as G,da as O,ea as D,x as $,z as d}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as N}from"/censys/build/_shared/chunk-F5K75D4K.js";import{c as V,g as P}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as m}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as w}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as l}from"/censys/build/_shared/chunk-2TWE7TSA.js";var le=l(w(),1);var oe=l(w(),1);function R(e,t){if(!t)return[];let a=new Map,r=[];for(let i of t){let s=i.protocol,o=i.port,n=i.transport_protocol;if(s&&o!==void 0&&n!==void 0){let h=o===0,u=ee(i),H=`${h?J:o} / ${u}`,g=`${e}#${j(i)}`,y={label:H,href:g};i.vulns?.length>0&&(y.vulns=i.vulns),i.threats?.length>0&&(y.threats=i.threats),a.has(s)?r.push(y):a.set(s,y)}}return[...a.values(),...r]}var T=l(m(),1);function k({services:e=[],baseURL:t,shouldShowCves:a=!1,shouldShowThreats:r=!1,maxVisibleServices:i=10,customClassNames:s}){let o=(0,oe.useMemo)(()=>R(t,e).map(g=>{let y=a&&!!g.vulns?.length,W=r&&(g.threats?.some(pe=>pe.name?.trim()!=="")??!1);return{href:g.href,label:g.label,contentLeft:(y||W)&&(0,T.jsxs)(T.Fragment,{children:[y&&(0,T.jsx)(se,{"aria-label":"Censys found a CVE on this service.",severity:re(g.vulns)}),W&&(0,T.jsx)(ae,{"aria-label":"Censys found a threat on this service."})]})}}),[t,e,a,r]),n=Math.max(0,o.length-i),h=n>0?`Show ${n} more`:"",u="Show less";return o.length?(0,T.jsx)(x,{customClassNames:s,tags:o,maxVisibleRows:i,expandTextOverride:h,collapseTextOverride:u,hasWrappingTrigger:!0}):null}var L={highlightItem:"wGlhw",highlightMatchWithMatchedServices:"ZZzMX",highlightMatchWithoutMatchedServices:"_3z1h2",servicesListWrapper:"cXIgt"};var S=l(m(),1),me=4;function I({highlight:e,targetURL:t,shouldShowCves:a,shouldShowThreats:r}){let i=e.services.length>0;return(0,S.jsxs)("div",{className:L.highlightItem,children:[(0,S.jsx)("dt",{children:(0,S.jsx)(ie,{children:e.field})}),(0,S.jsxs)("dd",{children:[(0,S.jsx)(z,{highlightVariant:e.negative?"negative":"default",typographyVariant:d.SMALL_SOURCE,pre:e.segment?.pre,match:e.segment?.match,post:e.segment?.post,className:$(i?L.highlightMatchWithMatchedServices:L.highlightMatchWithoutMatchedServices)}),(0,S.jsx)(k,{services:e.services,baseURL:t,shouldShowCves:a,shouldShowThreats:r,maxVisibleServices:me,customClassNames:{listWrapper:L.servicesListWrapper}})]})]})}var f={tooltipContent:"pyTFj",tooltipTrigger:"-Ncht",ctaIcon:"pXkFN",highlightListSection:"-Mtxq",headerContainer:"gRgfD",header:"_0C6as",headerText:"BPv3Q",dividerLine:"KgSpn",highlightList:"OmLts",none:"xiRoh"};var de=/^host\.services\[(\d+)\]/;function ne(e,t){if(!e.length)return[];let a=new Map;for(let i of e){let s=`${i.field}-${i.segment?.match}`;a.has(s)||a.set(s,[]),a.get(s)?.push(i)}let r=[];for(let i of a.values()){let s=i[0],o=new Set;for(let n of i){let h=n.json_path?.match(de),u=h?parseInt(h[1],10):null;u!==null&&u<t.length&&!isNaN(u)&&o.add(t[u])}r.push({...s,services:Array.from(o).sort((n,h)=>(n.port||0)-(h.port||0))})}return r}var p=l(m(),1),he="Highlights the exact fields in each result that match your query terms.";function Ze({listKey:e,highlights:t,hasHighlightEntitlement:a,services:r=[],ip:i}){let{t:s}=N(),o=P(),n=o.id?`/collections/${o.id}/hosts/${i}`:`/hosts/${i}`,h=(0,le.useMemo)(()=>ne(t,r),[t,r]),[u,H]=B([5,11]);return typeof a!="boolean"?null:(0,p.jsxs)("div",{className:f.highlightListSection,children:[(0,p.jsxs)("div",{className:f.headerContainer,children:[(0,p.jsxs)(v,{className:f.header,variant:d.H5,as:"span",children:[(0,p.jsx)(Q,{icon:"lightbulb-flash-line",iconLabel:"Matched Fields",content:he,side:"left",contentClassName:f.tooltipContent,triggerClassName:f.tooltipTrigger}),(0,p.jsx)("span",{className:f.headerText,children:s("Matched Fields")}),(0,p.jsx)("span",{className:f.dividerLine})]}),!a&&(0,p.jsx)("span",{className:f.ctaIcon,children:(0,p.jsx)(X,{action:"search"})})]}),a&&(0,p.jsx)("dl",{className:f.highlightList,children:h.length>0?h.map((g,y)=>(0,p.jsx)(I,{highlight:g,targetURL:n,shouldShowCves:u,shouldShowThreats:H},`${e}-${g.field}-${y}`)):(0,p.jsx)(v,{variant:d.DEFAULT_ITALICS,className:f.none,children:s("None")})})]})}var _={resultHeader:"TAmZh",statsGroup:"sO8Lu",suffix:"vtoPM",durationNumber:"RTJVc",gray8:"E-l0f",actionsGroup:"hH0jY",downloadButton:"GTBhI"};var c=l(m(),1);function fe({actions:e,durationMs:t,currentPageSize:a,totalHits:r,onDownloadCsv:i}){let s=te(r),o=(t/1e3).toFixed(2),{t:n}=N();return(0,c.jsxs)("div",{className:_.resultHeader,children:[(0,c.jsxs)("div",{className:_.statsGroup,children:[(0,c.jsx)(v,{"aria-hidden":!0,variant:d.H5,children:n("Results:")}),(0,c.jsx)(v,{variant:d.H4,className:_.gray8,"aria-label":`${s} ${M("result",r)}`,children:s}),(0,c.jsx)(Y,{"aria-hidden":!0,variant:"dot",size:4,spacing:6}),(0,c.jsx)(v,{"aria-hidden":!0,variant:d.H5,children:n("Duration:")}),(0,c.jsxs)(v,{variant:d.H4,className:_.durationNumber,"aria-label":`The query took ${o} seconds to complete`,children:[o,(0,c.jsx)("span",{className:_.suffix,children:"s"})]})]}),(i||e)&&(0,c.jsxs)("div",{className:_.actionsGroup,children:[i&&(0,c.jsx)("div",{className:_.downloadButton,children:(0,c.jsx)(G,{content:"Download the current page of results as a CSV",tabIndex:-1,children:(0,c.jsxs)(U,{iconLeft:"download-2",variant:F.TERTIARY,onClick:i,"data-testid":"download-button",children:["Download CSV (",(0,c.jsx)(D,{value:a})," page"," ",M("result",a),")"]})})}),e]})]})}var ft=e=>!e||!e.certificate?null:{fingerprint_sha256:e.certificate.fingerprint_sha256,parsed:{subject:{common_name:e.certificate.parsed?.subject?.common_name||[]},subject_dn:e.certificate.parsed?.subject_dn,issuer_dn:e.certificate.parsed?.issuer_dn,validity_period:{not_before:e.certificate.parsed?.validity_period?.not_before,not_after:e.certificate.parsed?.validity_period?.not_after},signature:{self_signed:e.certificate.parsed?.signature?.self_signed||!1}},modified_at:e.certificate.modified_at,added_at:e.certificate.added_at,names:e.certificate.names,validation:{chrome:{is_valid:e.certificate.validation?.chrome?.is_valid||!1,ever_valid:e.certificate.validation?.chrome?.ever_valid||!1,type:e.certificate.validation?.chrome?.type||"UNKNOWN"},apple:{is_valid:e.certificate.validation?.apple?.is_valid||!1,ever_valid:e.certificate.validation?.apple?.ever_valid||!1,type:e.certificate.validation?.apple?.type||"UNKNOWN"},microsoft:{is_valid:e.certificate.validation?.microsoft?.is_valid||!1,ever_valid:e.certificate.validation?.microsoft?.ever_valid||!1,type:e.certificate.validation?.microsoft?.type||"UNKNOWN"},nss:{is_valid:e.certificate.validation?.nss?.is_valid||!1,ever_valid:e.certificate.validation?.nss?.ever_valid||!1,type:e.certificate.validation?.nss?.type||"UNKNOWN"}}},ut=e=>!e||!e.host?null:{ip:e.host.ip,labels:e.host.labels?.map(t=>({value:t.value})),location:{city:e.host.location?.city,country:e.host.location?.country,country_code:e.host.location?.country_code,province:e.host.location?.province},autonomous_system:{asn:e.host.autonomous_system?.asn,name:e.host.autonomous_system?.name},dns:{reverse_dns:{names:e.host.dns?.reverse_dns?.names}},operating_system:e.host.operating_system,service_count:e.host.service_count,services:e.host.services?.map(t=>({port:t.port,protocol:t.protocol,scan_time:t.scan_time,transport_protocol:t.transport_protocol,labels:t.labels.map(a=>({value:a.value})),vulns:t.vulns||[],threats:t.threats||[],endpoints:t.endpoints||[],software:t.software||[],banner:t.banner})),hardware:e.host.hardware},gt=e=>!e||!e.web?null:{hostname:e.web.hostname,port:e.web.port,cert:e.web.cert,software:e.web.software,labels:e.web.labels,scan_time:e.web.scan_time,endpoints:e.web.endpoints,vulns:e.web.vulns||[],threats:e.web.threats||[]},vt=e=>e.includes("/collections");function yt(e){let t={asset_id:void 0,asset_type:void 0,date_updated:void 0,display_name:void 0};return e.host?.host?(t.asset_type="host",t.asset_id=e.host.host.ip,t.display_name=t.asset_id,t.date_updated=Z(e.host.host)):e.certificate?.certificate?(t.asset_type="certificate",t.asset_id=e.certificate.certificate.fingerprint_sha256,t.display_name=q(e.certificate.certificate.parsed,t.asset_id),t.date_updated=e.certificate.certificate.modified_at?.toString()):e.web?.web&&(t.asset_type="web property",t.asset_id=`${e.web.web.hostname}:${e.web.web.port}`,t.display_name=t.asset_id,t.date_updated=e.web.web.scan_time?.toString()),t.asset_id&&t.asset_type?t:null}var ce=l(w(),1);function Lt(e){return!!e&&typeof e=="object"&&"code"in e&&K(e.code)}function bt(){let e=V();return(0,ce.useMemo)(()=>({lastSearch:e}),[e])}function ue(e,t){return Temporal.Instant.compare(e,t)<0?t:e}function Ht(e){return ue(Temporal.Instant.from(e),Temporal.Now.instant().subtract({hours:24}).round("hour")).toString()}var C={tagList:"RT4RN",tagListTitle:"nG--r",container:"FkQYJ"};var b=l(m(),1);function E({title:e,children:t}){return(0,b.jsx)("div",{className:C.container,children:(0,b.jsxs)("div",{className:C.tagList,children:[(0,b.jsx)(v,{variant:d.SMALL,className:C.tagListTitle,children:e}),t]})})}var A=l(m(),1);function ge({title:e,tags:t,maxVisibleTags:a,customClassNames:r}){let i=O(t.length),s=Math.max(0,t.length-a),o=s>0?`Show ${s} more`:"",n="Show less";return t.length?(0,A.jsx)(E,{title:`${e} (${i})`,children:(0,A.jsx)(x,{customClassNames:r,tags:t,maxVisibleRows:a,expandTextOverride:o,collapseTextOverride:n,hasWrappingTrigger:!0})}):null}export{k as a,Ze as b,fe as c,ft as d,ut as e,gt as f,vt as g,yt as h,E as i,ge as j,Lt as k,bt as l,Ht as m};
