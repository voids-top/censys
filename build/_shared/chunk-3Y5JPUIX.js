import{a as C,b as Y,c as J,d as Q}from"/censys/build/_shared/chunk-N7NUWUYZ.js";import{a as q}from"/censys/build/_shared/chunk-GZWGB2XV.js";import{a as V}from"/censys/build/_shared/chunk-BVX6X5MK.js";import{a as W}from"/censys/build/_shared/chunk-BUVQHUPU.js";import{a as K}from"/censys/build/_shared/chunk-FROGAFJB.js";import{a as z}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{a as X}from"/censys/build/_shared/chunk-ZN6GT6EF.js";import{a as Z}from"/censys/build/_shared/chunk-IHXQKSC2.js";import{a as er}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as G}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{a as h,c as H}from"/censys/build/_shared/chunk-JLZAPT5W.js";import{b as F,e as k}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import{a as $}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{k as O}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{e as _}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as I}from"/censys/build/_shared/chunk-B7DSLLNE.js";import{A as f,B as n,ua as L,va as T,y as P,z as U}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import{a as x,g as l,k as M,p as N}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as B,c}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as i}from"/censys/build/_shared/chunk-2QEWK57A.js";var E=i(B(),1);var j=i(B(),1);var y={cardBody:"l6oPt",bodyHeader:"yfwcS",pathsTable:"_94q1j",indentedRow:"_6ee7b"};var t=i(c(),1);function A({browser:r,cert:e,graph:o}){let a=l(),m=a.collectionId?`/collections/${a.collectionId}/certificates/${a.id}`:`/certificates/${a.id}`;return(0,t.jsxs)("div",{className:y.cardBody,"data-testid":"trust-card-body",children:[(0,t.jsx)(n,{className:y.bodyHeader,variant:f.H5,children:"Browser Trust"}),(0,t.jsx)(Q,{baseURL:m,browsers:[r],cert:e}),o.paths.length?(0,t.jsx)(or,{paths:o.paths}):null]})}function or({paths:r}){return(0,t.jsxs)("table",{className:y.pathsTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:(0,t.jsx)(n,{variant:f.DEFAULT_SEMIBOLD,children:"Path"})}),(0,t.jsx)("th",{children:(0,t.jsx)(n,{variant:f.DEFAULT_SEMIBOLD,children:"Certificate"})})]})}),(0,t.jsx)("tbody",{children:r.map((e,o)=>(0,t.jsxs)(j.Fragment,{children:[(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:2,children:(0,t.jsxs)(n,{children:["Path ",o+1]})})}),e.map(([a,m])=>(0,t.jsxs)("tr",{className:y.indentedRow,children:[(0,t.jsx)("td",{children:(0,t.jsx)(q,{fingerprint:a})}),(0,t.jsx)("td",{children:(0,t.jsx)(n,{children:m})})]},a))]},`${e[0]?.[0]}-${o}`))})]})}var b=i(c(),1);function D({browser:r,cert:e,graph:o}){return(0,b.jsx)(T,{header:(0,b.jsx)(X,{"data-testid":"trust-card-header",lastUpdatedAt:e.certificate?.validated_at,children:C[r]}),children:(0,b.jsx)(A,{browser:r,cert:e,graph:o})})}var rr=i(B(),1);var p={container:"F4v-w",sidebarHeader:"rkPeD",sidebarEntriesWrapper:"nwAUX",sidebarEntry:"YkC49",active:"oZaA0",inactiveText:"slqj6",sidebarEntryContent:"_3Q-8P",entryIcon:"zHzyo",headerText:"acz1Z",activeText:"MwIAg"};var s=i(c(),1);function S({browser:r,cert:e}){return(0,s.jsxs)(T,{className:p.container,bodyPadding:L.NONE,children:[(0,s.jsx)("div",{className:p.sidebarHeader,children:(0,s.jsx)(n,{className:p.headerText,variant:f.SMALL_NUMERAL,children:"Browsers"})}),(0,s.jsxs)("div",{className:p.sidebarEntriesWrapper,children:[(0,s.jsx)(v,{browser:"chrome",cert:e,isActive:r==="chrome"}),(0,s.jsx)(v,{browser:"edge",cert:e,isActive:r==="edge"}),(0,s.jsx)(v,{browser:"firefox",cert:e,isActive:r==="firefox"}),(0,s.jsx)(v,{browser:"safari",cert:e,isActive:r==="safari"})]})]})}function v({browser:r,cert:e,isActive:o}){let a=l(),[m]=N(),g=a.collectionId?`/collections/${a.collectionId}/certificates/${a.id}`:`/certificates/${a.id}`,u=(0,rr.useMemo)(()=>{if(!e)return null;let w=J(e,r);return H(e?.certificate?.parsed?.signature?.self_signed,w?.type,w?.is_valid,w?.ever_valid)},[r,e]);return(0,s.jsxs)($,{"data-testid":`trust-sidebar-${r}`,href:`${g}/trust/${r}${m?`?${m}`:""}`,className:P(p.sidebarEntry,o&&p.active),prefetch:"intent",children:[(0,s.jsxs)(n,{className:P(p.sidebarEntryContent,o?p.activeText:p.inactiveText),children:[(0,s.jsx)(U,{className:p.entryIcon,name:Y[r],"aria-label":`${r} logo`,mode:"fill",size:"2xl"}),C[r]]}),u&&(0,s.jsx)(Z,{isTrusted:u.isTrusted,status:u.status})]})}var R={container:"oOFJW",errorWrapper:"A5wDs"};var ar=new Set(Object.values(h));function tr(r){return ar.has(r)}var ir=i(er(),1),d=i(c(),1),rt=z("Cert Trust","routes/certificates.$id");function sr(){let{browser:r,graph:e}=V(),{cert:o}=K();return(0,d.jsxs)("div",{className:R.container,children:[(0,d.jsx)(S,{browser:r,cert:o}),(0,d.jsx)(D,{browser:r,cert:o,graph:e})]})}function tt(){let r=M(),e=k(),o=l(),a=tr(o.browser)?o.browser:"chrome";(0,E.useEffect)(()=>{o.browser!==a&&e(`../trust/${a}`)},[]);let m=_(),g=F(m),u=(0,E.useContext)(I);return(0,d.jsxs)("div",{className:R.container,children:[(0,d.jsx)(S,{browser:a}),(0,d.jsx)("div",{className:R.errorWrapper,children:x(r)&&O(r.data)?(0,d.jsx)(W,{errorCode:r.data.code,orgState:g,env:u}):(0,d.jsx)(G,{error:r})})]})}export{rt as a,sr as b,tt as c};
