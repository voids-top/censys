import{a as Q}from"/censys/build/_shared/chunk-QGDPKSYE.js";import{a as Y}from"/censys/build/_shared/chunk-QHRZ4J4F.js";import{b as Z,c as E,d as A,e as q}from"/censys/build/_shared/chunk-IY4F57OS.js";import{e as J}from"/censys/build/_shared/chunk-IO4OV3HV.js";import"/censys/build/_shared/chunk-BS7TM7GR.js";import{a as le}from"/censys/build/_shared/chunk-IC5AY47K.js";import"/censys/build/_shared/chunk-HVTNNTFL.js";import"/censys/build/_shared/chunk-5HYWBZZN.js";import{e as w}from"/censys/build/_shared/chunk-OQUAXVLV.js";import{a as F}from"/censys/build/_shared/chunk-BWODHJE6.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as K}from"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import{a as u}from"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import"/censys/build/_shared/chunk-E7FS2ZQL.js";import{e as G}from"/censys/build/_shared/chunk-ST66DGSY.js";import"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{A as m,B as $,Ka as V,Xa as W,aa as M,ba as U,ca as z,z as d}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import{c as O}from"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{a as _,e as x,i as C,k as B,p as I,z as k}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as p}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as ie}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as l}from"/censys/build/_shared/chunk-2TWE7TSA.js";var T=l(ie(),1);var r={panel:"Ets-O",headerRow:"YcwGK",dateRow:"M-MRm",headerLeft:"mbKl4",rows:"jT5Up",row:"VSGwu",value:"kxElS",label:"_48cU-",divider:"efyyZ",close:"Ksx1R"};var c=l(p(),1);function X({displayName:e,port:t,protocol:o,transportProtocol:a,onClose:i}){return(0,c.jsxs)("div",{className:r.headerRow,children:[(0,c.jsxs)("div",{className:r.headerLeft,children:[(0,c.jsx)(m,{variant:d.H1,children:e}),t!==void 0&&(0,c.jsxs)(m,{variant:d.H1_SUB_HEADLINE,children:[": ",t]}),o&&(0,c.jsxs)(m,{variant:d.H1_SUB_HEADLINE,children:["/ ",o]}),a&&(0,c.jsxs)(m,{variant:d.H1_SUB_HEADLINE,children:["(",a,")"]})]}),(0,c.jsx)(z,{"aria-controls":"details-panel","aria-label":"Close",className:r.close,iconName:"close",iconMode:"line",onClick:i,shape:U.SQUARE,size:M.MEDIUM,type:"button",variant:$.GHOST})]})}var f=l(p(),1);function h({label:e,value:t,shouldTruncate:o}){if(t===void 0||typeof t=="string"&&t.length===0)return null;let a=o?(0,f.jsx)(W,{content:t,side:"top",children:(0,f.jsx)("div",{className:r.value,"data-title":t,children:(0,f.jsx)(m,{children:t})})}):(0,f.jsx)(m,{children:t});return(0,f.jsxs)("div",{className:r.row,children:[(0,f.jsx)(m,{variant:d.SMALL,className:r.label,children:e}),a]})}var j=(e,t,o)=>{switch(e){case"host":return`/hosts/${t}?at_time=${o}`;case"web":return`/web/${t}?at_time=${o}`}},ee=e=>{let t="View Historical",o=e==="host"?"Host":"Web Property";return`${t} ${o}`};var s=l(p(),1);function D({displayName:e,type:t,port:o,protocol:a,transportProtocol:i,onClose:H,timestamp:P,threatCount:b,serviceCount:y,jarm:S,bodyHash:N,bannerHash:ae,network:se}){let ne=j(t,e,P);return(0,s.jsxs)("div",{className:r.panel,"data-testid":"details-panel",children:[(0,s.jsx)(X,{displayName:e,port:o,protocol:a,transportProtocol:i,onClose:H}),(0,s.jsxs)("div",{className:r.rows,children:[(0,s.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,s.jsx)(h,{label:"Date",value:(0,s.jsxs)("div",{className:r.dateRow,children:[(0,s.jsx)(V,{timestamp:P}),(0,s.jsx)(K,{href:ne,target:"_blank",rel:"noopener noreferrer",children:ee(t)})]})}),(0,s.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,s.jsx)(h,{label:"Threats",value:b}),(0,s.jsx)(h,{label:"Services",value:y}),(0,s.jsx)(h,{label:"JARM",value:S,shouldTruncate:!0}),(0,s.jsx)(h,{label:"Body Hash",value:N,shouldTruncate:!0}),(0,s.jsx)(h,{label:"Banner Hash",value:ae,shouldTruncate:!0}),(0,s.jsx)(h,{label:"Network (AS)",value:se}),(0,s.jsx)(u,{variant:"line--horizontal",className:r.divider})]})]})}var n=l(p(),1);function L(){return(0,n.jsxs)("div",{className:r.panel,"data-testid":"details-panel","aria-busy":!0,children:[(0,n.jsx)(w,{width:300,variant:d.H1}),(0,n.jsxs)("div",{className:r.rows,children:[(0,n.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,n.jsx)(g,{width:100}),(0,n.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,n.jsx)(g,{width:150}),(0,n.jsx)(g,{width:200}),(0,n.jsx)(g,{width:180}),(0,n.jsx)(g,{width:140}),(0,n.jsx)(g,{width:100}),(0,n.jsx)(u,{variant:"line--horizontal",className:r.divider})]})]})}var g=({width:e})=>(0,n.jsxs)("div",{className:r.row,children:[(0,n.jsx)("div",{className:r.label,children:(0,n.jsx)(w,{width:e-30})}),(0,n.jsx)(w,{width:e})]});function R(e){return e&&typeof e.then=="function"?e:Promise.resolve(e)}var te=e=>e.services.reduce((t,o)=>t+o.threats.length,0),re=(e,t,o)=>!t||!o?null:e.services.find(a=>a.port===Number(t)&&a.transport_protocol===o);var ce=l(le(),1),v=l(p(),1);function oe(){let e=k(),o=C().state==="loading",a=R(e.host);return(0,v.jsx)(Q,{fallback:(0,v.jsx)(L,{}),isLoading:o,resolve:a,children:i=>(0,v.jsx)(de,{data:{certId:e.certId,timestamp:e.timestamp,host:i}})})}var de=({data:e})=>{let{certId:t,timestamp:o,host:a}=e,[i]=I(),H=x(),P=i.get(E),b=i.get(A),y=(0,T.useMemo)(()=>re(a,P,b),[a,P,b]),S=(0,T.useCallback)(()=>{i.delete(Z),i.delete(E),i.delete(A),i.delete(q);let N=`/certificates/${t}/history?${i}`;H(N)},[i,H,t]);return(0,v.jsx)(D,{displayName:a.ip,type:"host",port:y?.port,protocol:y?.protocol,transportProtocol:y?.transport_protocol,onClose:S,timestamp:o,threatCount:te(a),serviceCount:a.services.length,jarm:y?.jarm?.fingerprint,bannerHash:y?.banner_hash_sha256,network:a.autonomous_system&&`${a.autonomous_system.name} (${a.autonomous_system.asn})`})};function me(){let e=B(),t=G(),o=(0,T.useContext)(O),a=()=>_(e)&&J(e.data)?(0,v.jsx)(Y,{accessState:t,error:e.data,env:o}):(0,v.jsx)(F,{error:e});return(0,v.jsx)("div",{className:r.panel,children:a()})}export{me as ErrorBoundary,oe as default};
