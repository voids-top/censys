import{a as J}from"/censys/build/_shared/chunk-AKZYFWPJ.js";import{a as X}from"/censys/build/_shared/chunk-62I4RDM3.js";import{b as q,c as A,d as E,e as Y}from"/censys/build/_shared/chunk-4J4MYIT3.js";import{e as K}from"/censys/build/_shared/chunk-TUFJ6JAI.js";import"/censys/build/_shared/chunk-BS7TM7GR.js";import{a as pe}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as Z}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import"/censys/build/_shared/chunk-XFF644VA.js";import"/censys/build/_shared/chunk-5B22H335.js";import{e as b}from"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{b as G}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as u}from"/censys/build/_shared/chunk-HG7D3PDC.js";import"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-HLRAT4GD.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as F}from"/censys/build/_shared/chunk-W2GUOEY7.js";import"/censys/build/_shared/chunk-FQAS3FYV.js";import"/censys/build/_shared/chunk-P2FXGQA2.js";import{e as Q}from"/censys/build/_shared/chunk-FH7VNUY3.js";import{c as k}from"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as d,B as m,C as $,Ha as V,Ta as W,ba as z,ca as U,da as M}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as _,e as C,i as x,k as B,p as I,z as O}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as le,c as p}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as l}from"/censys/build/_shared/chunk-2QEWK57A.js";var T=l(le(),1);var r={panel:"-OQdI",headerRow:"fQfPg",dateRow:"y13LT",headerLeft:"_51DA8",rows:"d3nit",row:"p1uwZ",value:"DX5PE",label:"-nUGF",divider:"_-5vQ1",close:"fFKzZ"};var c=l(p(),1);function j({displayName:e,port:t,protocol:o,transportProtocol:a,onClose:i}){return(0,c.jsxs)("div",{className:r.headerRow,children:[(0,c.jsxs)("div",{className:r.headerLeft,children:[(0,c.jsx)(m,{variant:d.H1,children:e}),t!==void 0&&(0,c.jsxs)(m,{variant:d.H1_SUB_HEADLINE,children:[": ",t]}),o&&(0,c.jsxs)(m,{variant:d.H1_SUB_HEADLINE,children:["/ ",o]}),a&&(0,c.jsxs)(m,{variant:d.H1_SUB_HEADLINE,children:["(",a,")"]})]}),(0,c.jsx)(M,{"aria-controls":"details-panel","aria-label":"Close",className:r.close,iconName:"close",iconMode:"line",onClick:i,shape:U.SQUARE,size:z.MEDIUM,type:"button",variant:$.GHOST})]})}var f=l(p(),1);function v({label:e,value:t,shouldTruncate:o}){if(t===void 0||typeof t=="string"&&t.length===0)return null;let a=o?(0,f.jsx)(W,{content:t,side:"top",children:(0,f.jsx)("div",{className:r.value,"data-title":t,children:(0,f.jsx)(m,{children:t})})}):(0,f.jsx)(m,{children:t});return(0,f.jsxs)("div",{className:r.row,children:[(0,f.jsx)(m,{variant:d.SMALL,className:r.label,children:e}),a]})}var ee=(e,t,o)=>{switch(e){case"host":return`/hosts/${t}?at_time=${o}`;case"web":return`/web/${t}?at_time=${o}`}},te=e=>{let t="View Historical",o=e==="host"?"Host":"Web Property";return`${t} ${o}`};var s=l(p(),1);function D({displayName:e,type:t,port:o,protocol:a,transportProtocol:i,onClose:H,timestamp:P,threatCount:S,serviceCount:g,jarm:w,bodyHash:N,bannerHash:se,network:ne}){let ie=ee(t,e,P);return(0,s.jsxs)("div",{className:r.panel,"data-testid":"details-panel",children:[(0,s.jsx)(j,{displayName:e,port:o,protocol:a,transportProtocol:i,onClose:H}),(0,s.jsxs)("div",{className:r.rows,children:[(0,s.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,s.jsx)(v,{label:"Date",value:(0,s.jsxs)("div",{className:r.dateRow,children:[(0,s.jsx)(V,{timestamp:P}),(0,s.jsx)(F,{href:ie,target:"_blank",rel:"noopener noreferrer",children:te(t)})]})}),(0,s.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,s.jsx)(v,{label:"Threats",value:S}),(0,s.jsx)(v,{label:"Services",value:g}),(0,s.jsx)(v,{label:"JARM",value:w,shouldTruncate:!0}),(0,s.jsx)(v,{label:"Body Hash",value:N,shouldTruncate:!0}),(0,s.jsx)(v,{label:"Banner Hash",value:se,shouldTruncate:!0}),(0,s.jsx)(v,{label:"Network (AS)",value:ne}),(0,s.jsx)(u,{variant:"line--horizontal",className:r.divider})]})]})}var n=l(p(),1);function L(){return(0,n.jsxs)("div",{className:r.panel,"data-testid":"details-panel","aria-busy":!0,children:[(0,n.jsx)(b,{width:300,variant:d.H1}),(0,n.jsxs)("div",{className:r.rows,children:[(0,n.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,n.jsx)(y,{width:100}),(0,n.jsx)(u,{variant:"line--horizontal",className:r.divider}),(0,n.jsx)(y,{width:150}),(0,n.jsx)(y,{width:200}),(0,n.jsx)(y,{width:180}),(0,n.jsx)(y,{width:140}),(0,n.jsx)(y,{width:100}),(0,n.jsx)(u,{variant:"line--horizontal",className:r.divider})]})]})}var y=({width:e})=>(0,n.jsxs)("div",{className:r.row,children:[(0,n.jsx)("div",{className:r.label,children:(0,n.jsx)(b,{width:e-30})}),(0,n.jsx)(b,{width:e})]});function R(e){return e&&typeof e.then=="function"?e:Promise.resolve(e)}var re=e=>e.services.reduce((t,o)=>t+o.threats.length,0),oe=(e,t,o)=>!t||!o?null:e.services.find(a=>a.port===Number(t)&&a.transport_protocol===o);var ue=l(pe(),1),h=l(p(),1);function ae(){let e=O(),o=x().state==="loading",a=R(e.host);return(0,h.jsx)(J,{fallback:(0,h.jsx)(L,{}),isLoading:o,resolve:a,children:i=>(0,h.jsx)(me,{data:{certId:e.certId,timestamp:e.timestamp,host:i}})})}var me=({data:e})=>{let{certId:t,timestamp:o,host:a}=e,[i]=I(),H=C(),P=i.get(A),S=i.get(E),g=(0,T.useMemo)(()=>oe(a,P,S),[a,P,S]),w=(0,T.useCallback)(()=>{i.delete(q),i.delete(A),i.delete(E),i.delete(Y);let N=`/certificates/${t}/history?${i}`;H(N)},[i,H,t]);return(0,h.jsx)(D,{displayName:a.ip,type:"host",port:g?.port,protocol:g?.protocol,transportProtocol:g?.transport_protocol,onClose:w,timestamp:o,threatCount:re(a),serviceCount:a.services.length,jarm:g?.jarm?.fingerprint,bannerHash:g?.banner_hash_sha256,network:a.autonomous_system&&`${a.autonomous_system.name} (${a.autonomous_system.asn})`})};function ce(){let e=B(),t=Q(),o=G(t),a=(0,T.useContext)(k),i=()=>_(e)&&K(e.data)?(0,h.jsx)(X,{errorCode:e.data.code,orgState:o,env:a}):(0,h.jsx)(Z,{error:e});return(0,h.jsx)("div",{className:r.panel,children:i()})}export{ce as ErrorBoundary,ae as default};
