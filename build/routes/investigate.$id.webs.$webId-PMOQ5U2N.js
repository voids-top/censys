import{a as q}from"/censys/build/_shared/chunk-5OYDP3WM.js";import{a as N,b as G,d as F,e as J,f as Z}from"/censys/build/_shared/chunk-CRA3TGUV.js";import{a as W,i as z}from"/censys/build/_shared/chunk-XWEFKGC4.js";import"/censys/build/_shared/chunk-CSKRXOFQ.js";import{e as S}from"/censys/build/_shared/chunk-YUXBXUAH.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-SZRPTSUZ.js";import"/censys/build/_shared/chunk-BXMBML5J.js";import{a as V}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as O}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-OFRBI5JW.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as ne}from"/censys/build/_shared/chunk-IC5AY47K.js";import"/censys/build/_shared/chunk-VDD6BNAJ.js";import"/censys/build/_shared/chunk-B5UNN2SO.js";import"/censys/build/_shared/chunk-TUDXVIEL.js";import"/censys/build/_shared/chunk-7C4UGOB7.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-JDWADSGD.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-4WX73TCZ.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-5OP2ERYU.js";import"/censys/build/_shared/chunk-LOKTUJJ3.js";import"/censys/build/_shared/chunk-BU2LL35M.js";import"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-FP2KPINM.js";import"/censys/build/_shared/chunk-VKYVKQW2.js";import"/censys/build/_shared/chunk-OQUAXVLV.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import{c as H,o as $}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as x}from"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import{a as M}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import{f as D}from"/censys/build/_shared/chunk-ST66DGSY.js";import"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{A as r,Xa as C,y as B,z as u}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{a as k,c as w,e as T,g as A,k as E,z as _}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as U}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as se}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as y}from"/censys/build/_shared/chunk-2TWE7TSA.js";var n=y(se(),1);var t={section:"k5xJD",sectionHeader:"vA8tZ",endpoints:"b2wT5",endpointGroup:"o7LGA",groupHeader:"_4lhgh",endpointCount:"_8LYo-",groupList:"wqfeU",endpointItem:"Cme-c",endpointIcon:"xHg4U",endpointTlsVersion:"maJz2",endpointTop:"Jshrc",endpointUri:"VtqB4",endpointMeta:"m843Z",metaRow:"VdtkZ",metaLabel:"pxPTM"};var pe=y(ne(),1),e=y(U(),1);function Y(){let{deleteNodes:c}=z(),l=D(),p=A(),g=w(),b=T(),h=_(),{link:Q="",label:j=""}=W("web",p.webId||""),v=(0,n.useCallback)(()=>{let o=new URLSearchParams(g.search);l?.organizationId&&o.set(M,l.organizationId);let s=`/investigate/${p.id}?${o.toString()}`;b(s)},[g.search,b,p.id,l]),X=(0,n.useCallback)(()=>{let o=$("web",p.webId||"");v(),c([o])},[v,c,p.webId]);if(!h||!("webAggregate"in h)||!h.webAggregate)return null;let{webAggregate:f,atTime:K,id:ee}=h,i=O(f),L=(0,n.useMemo)(()=>(i.labels||[]).map(o=>o.value).sort(),[i.labels]),I=(0,n.useMemo)(()=>(i.threats||[]).map(o=>o.name).filter(Boolean),[i.threats]),te=(0,n.useMemo)(()=>[...I.map(o=>({key:"threat",value:o})),...L.map(o=>({key:"label",value:o}))],[L,I]),oe=(0,n.useMemo)(()=>{let o={};for(let s of i.endpoints||[]){let m=`${s.transport_protocol}/${s.port}`;o[m]||(o[m]=[]),o[m].push(s)}return o},[i.endpoints]);return(0,e.jsxs)(N,{title:"Web Property Node",onClose:v,actions:(0,e.jsxs)(G,{children:[(0,e.jsx)(J,{link:Q,label:j}),(0,e.jsx)(F,{onDelete:X})]}),children:[(0,e.jsx)("div",{className:t.section,children:(0,e.jsx)(Z,{assetType:"web",id:ee,atTime:K,tags:te})}),(0,e.jsx)("div",{className:t.section,children:(0,e.jsx)("div",{className:t.endpoints,children:Object.entries(oe).map(([o,s])=>{let[m,ae]=o.split("/");return(0,e.jsxs)("div",{className:t.endpointGroup,children:[(0,e.jsxs)("div",{className:t.groupHeader,children:[(0,e.jsxs)(r,{variant:u.DEFAULT_SEMIBOLD,children:[m.toUpperCase()," / ",ae]}),(0,e.jsxs)(r,{className:t.endpointCount,children:[s.length," ",V("endpoint",s.length)]}),f?.tls?.version_selected&&(0,e.jsx)(r,{className:t.endpointTlsVersion,children:f.tls.version_selected})]}),(0,e.jsx)("div",{className:t.groupList,children:s.map(a=>{let d=a.http?.status_code,re=d&&d>=300&&d<400,P=a.http?.headers||new Map,R=(P.get("Location")||P.get("location"))?.headers?.[0];return(0,e.jsxs)("div",{className:t.endpointItem,children:[(0,e.jsxs)("div",{className:t.endpointTop,children:[(0,e.jsx)(B,{icon:"mind-map",className:t.endpointIcon}),(0,e.jsx)(r,{variant:u.DEFAULT,className:t.endpointUri,children:(0,e.jsxs)(C,{content:(0,e.jsxs)(e.Fragment,{children:[i.hostname,a.path]}),children:[i.hostname,a.path&&(0,e.jsx)(r,{variant:u.DEFAULT_SEMIBOLD,children:a.path})]})}),d&&(0,e.jsx)(q,{statusCode:d,statusReason:a.http?.status_reason})]}),(0,e.jsx)("div",{className:t.endpointMeta,children:(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"Type"}),(0,e.jsx)(r,{children:a.endpoint_type})]})}),(0,e.jsxs)("div",{className:t.endpointMeta,children:[(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"IP Address"}),(0,e.jsx)(r,{children:a.ip?(0,e.jsx)(x,{href:`/hosts/${a.ip}`,variant:"default",isExternal:!0,children:a.ip}):(0,e.jsx)(S,{})})]}),re&&R&&(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"Redirect URI"}),(0,e.jsx)(r,{children:R})]}),a.http?.html_title&&(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"HTML Title"}),(0,e.jsx)(r,{children:a.http.html_title})]})]})]},`${a.path}-${a.transport_protocol}-${a.endpoint_type}`)})})]},o)})})})]})}function ie(){let c=T(),l=E(),p=k(l)?l.data.message:"Unknown error",g=(0,n.useCallback)(()=>{c(-1)},[c]);return(0,e.jsx)(N,{title:"Web Property Node",onClose:g,children:(0,e.jsx)(H,{iconName:"global",title:p})})}export{ie as ErrorBoundary,Y as default};
