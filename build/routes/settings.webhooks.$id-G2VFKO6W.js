import"/censys/build/_shared/chunk-AEKKJQLA.js";import{b as Re,c as Be,d as we,e as Ve,f as _,g as Fe}from"/censys/build/_shared/chunk-U6E7AUZH.js";import{a as Me}from"/censys/build/_shared/chunk-4NXR4FZK.js";import"/censys/build/_shared/chunk-MLEOAWKQ.js";import{a as oo}from"/censys/build/_shared/chunk-O24ST6IF.js";import{a as Pe}from"/censys/build/_shared/chunk-HSJDTMQA.js";import{a as We}from"/censys/build/_shared/chunk-XNZQSVV6.js";import{a as Ae}from"/censys/build/_shared/chunk-5OYDP3WM.js";import"/censys/build/_shared/chunk-WW7MKZVD.js";import"/censys/build/_shared/chunk-RLL7RAJO.js";import"/censys/build/_shared/chunk-BXMBML5J.js";import{a as xe}from"/censys/build/_shared/chunk-OFRBI5JW.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as eo}from"/censys/build/_shared/chunk-IC5AY47K.js";import{a as De,b as Ne,c as Ie,d as Oe,e as _e}from"/censys/build/_shared/chunk-2C6N3S4L.js";import"/censys/build/_shared/chunk-4NQHWOT6.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import{h as Ee}from"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-BWODHJE6.js";import{y as ke}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as Te}from"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import{a as Ce}from"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import"/censys/build/_shared/chunk-E7FS2ZQL.js";import"/censys/build/_shared/chunk-ST66DGSY.js";import{j as b}from"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{$ as Se,A as O,B as F,G as H,W as ue,X as fe,Y as Z,Z as Q,_ as ge,gb as U,mb as he,nb as ve,ua as ye,wa as Le,xa as be,y as V,z as I}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{C as de,f as pe,p as w,z as me}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as a}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as N}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as t}from"/censys/build/_shared/chunk-2TWE7TSA.js";var Xe=t(N(),1);var J=t(a(),1);function He({webhookName:e}){let r=[{linkElement:(0,J.jsx)(Te,{link:{to:"/settings/webhooks"},button:{iconLeft:"arrow-left",iconLeftMode:"line",variant:F.TERTIARY,size:ge.MEDIUM},children:"Manage Webhooks"})},{pathName:e}];return(0,J.jsx)(ve,{breadcrumbs:r,size:he.MEDIUM})}var M=t(N(),1);var Ye=t(N(),1);var Ue={collection:"a7N3Y"};var x="all",g={success:"success",failure:"failure",all:"all"},Ke=e=>{switch(e){case g.success:case g.failure:return e;default:return g.all}};var C=t(a(),1),to={label:"All related collections",value:x};function X({collectionIds:e,selectedCollectionId:r,onSelectCollection:s}){let{collections:c}=pe(),i=(0,Ye.useMemo)(()=>{let n=c?.filter(o=>e.includes(o.collection_id))||[];return[to].concat(Ee(n,!1))},[c,e]);return(0,C.jsxs)("div",{className:Ue.collection,children:[(0,C.jsx)(H,{options:i,onValueChange:s,value:r,valueProps:{placeholder:"Filter by Collection"},contentLeft:(0,C.jsx)(U,{iconName:"filter-3",iconMode:"line"})}),(0,C.jsx)("input",{hidden:!0,name:"collection",value:r,readOnly:!0})]})}var $e=t(N(),1);var E={expanded:"Hcei6",responseHeader:"LaA6o",container:"Ao4HG",tabsContent:"_6bpTi",tabsList:"gQxs1"};var j=e=>e===b.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_SUCCESS,Ge=(e,r)=>{let s=j(r)?"Delivered":"Not delivered";return`${e} | ${s}`};var l=t(a(),1);function ee({deliveryLog:e}){let{payload:r,error:s,status:c,response:i}=e,n=i?.headers,o=i?.body,u=j(c);return(0,l.jsx)("div",{className:E.expanded,children:(0,l.jsxs)(ue,{defaultValue:"request",children:[(0,l.jsxs)(fe,{className:E.tabsList,children:[(0,l.jsx)(Z,{value:"request",children:"Request"}),(0,l.jsx)(Z,{value:"response",children:(0,l.jsxs)("div",{className:E.responseHeader,children:["Response",(0,l.jsx)(Ae,{statusCode:e.status_code})]})})]}),(0,l.jsx)(Q,{value:"request",className:E.tabsContent,children:(0,l.jsx)(_,{label:"Body",content:r})}),(0,l.jsxs)(Q,{value:"response",className:E.tabsContent,children:[n&&(0,l.jsx)(Ve,{headers:n}),o&&(0,l.jsx)(_,{label:"Body",content:o}),s&&(0,l.jsx)(_,{label:"Error",content:s}),!n&&!o&&!s&&(0,l.jsx)(_,{label:"Body",content:{success:u}})]})]})})}var A={successWrapper:"_1ZDge",errorWrapper:"QHLAZ",success:"g8vuD",error:"rLU7E"};var ze=e=>{switch(e){case b.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_SUCCESS:return{icon:"checkbox-circle-fill",className:A.success,wrapperClassName:A.successWrapper,ariaLabel:"Success"};case b.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_FAILURE:case b.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_UNRECOGNIZED:default:return{icon:"close-circle-fill",className:A.error,wrapperClassName:A.errorWrapper,ariaLabel:"Failure"}}};var oe=t(a(),1);function te({status:e}){let r=ze(e);return(0,oe.jsx)("div",{className:r.wrapperClassName,children:(0,oe.jsx)(V,{icon:r.icon,className:r.className,size:"xl","aria-hidden":"false","aria-label":r.ariaLabel})})}var S={container:"Nz3Mf",accordionHeader:"H2u4V",accordionTrigger:"fQRtC",right:"UiZGw",icons:"mnNjf",triggerIcon:"o31YZ",accordionItem:"fL-Oz"};var p=t(a(),1);function re({webhookName:e,deliveryLog:r}){let[s,c]=(0,$e.useState)(""),i=Ge(e,r.status);return(0,p.jsx)(De,{type:"single",value:s,onValueChange:c,className:S.accordionRoot,collapsible:!0,children:(0,p.jsx)(be,{variant:ye.INTERACTIVE,className:S.container,bodyPadding:Le.NONE,children:(0,p.jsxs)(Ne,{value:"expandedContent",className:S.accordionItem,children:[(0,p.jsx)(Ie,{className:S.accordionHeader,children:(0,p.jsxs)(Oe,{"data-testid":"accordion-trigger",className:S.accordionTrigger,children:[(0,p.jsx)(O,{variant:I.DEFAULT,children:i}),(0,p.jsxs)("div",{className:S.right,children:[(0,p.jsx)(xe,{timestamp:r.timestamp?.value||"",variant:"short",tooltip:"Timestamp at which the Webhook was sent",format:"HH:MM:SS UTC"}),(0,p.jsxs)("div",{className:S.icons,children:[(0,p.jsx)(te,{status:r.status}),(0,p.jsx)(V,{className:S.triggerIcon,"aria-hidden":!0,name:"arrow-up-s",mode:"line"})]})]})]})}),(0,p.jsx)(_e,{children:(0,p.jsx)(ee,{deliveryLog:r})})]})})})}var qe={container:"EhPBV"};var W=t(a(),1);function k({description:e}){return(0,W.jsxs)("div",{className:qe.container,children:[(0,W.jsx)(O,{variant:I.H1_SUB_HEADLINE,children:"No delivery logs to display at this time."}),(0,W.jsx)(O,{variant:I.H3,children:e})]})}var ae={list:"Nkfkc",listItem:"A75bE"};var K=e=>e?"No logs match the selected filters.":"Logs will display once an event is triggered.";var P=t(a(),1);function se({deliveryLogs:e,webhookName:r,isFiltering:s}){return e.length===0?(0,P.jsx)(k,{description:K(s)}):(0,P.jsx)("ul",{className:ae.list,children:e.map((c,i)=>(0,P.jsx)("li",{className:ae.listItem,children:(0,P.jsx)(re,{webhookName:r,deliveryLog:c})},`${c.timestamp}-${i}`))})}var Ze=[{label:"All deliveries",value:g.all},{label:"Successful deliveries",value:g.success},{label:"Failed deliveries",value:g.failure}];var Qe={status:"eXYk2"};var D=t(a(),1);function ie({selectedStatus:e,onSelectStatus:r}){return(0,D.jsxs)("div",{className:Qe.status,children:[(0,D.jsx)(H,{options:Ze,onValueChange:r,value:e,valueProps:{placeholder:"Filter by Status"},contentLeft:(0,D.jsx)(U,{iconName:"filter-3",iconMode:"line"})}),(0,D.jsx)("input",{hidden:!0,name:"status",value:e,readOnly:!0})]})}var h={logsContainer:"_7ESiv",filterBar:"af46S",section:"j24ap",loadMoreButton:"_-0fq1",divider:"_2FwhH"};var ne="logs",d={START:"start",END:"end",COLLECTION:"collection",STATUS:"status",PAGE_TOKEN:"page_token"};var m=t(a(),1);function le({collectionIds:e,nextPageToken:r,deliveryLogs:s,webhookName:c,isFiltering:i,onLoadMore:n}){if(s.length===0&&!i)return(0,m.jsx)(k,{description:K(i)});let[o,u]=w(),f=o.get(d.START)||"",R=o.get(d.END)||"",v=o.get(d.COLLECTION)||x,B=Ke(o.get(d.STATUS)),G=(0,M.useCallback)((L,q)=>{o.set(d.START,L),o.set(d.END,q),u(o)},[]),z=(0,M.useCallback)(L=>{o.set(d.COLLECTION,L),u(o)},[]),$=(0,M.useCallback)(L=>{o.set(d.STATUS,L),u(o)},[]),T=(0,M.useCallback)(()=>{o.delete(d.START),o.delete(d.END),o.set(d.COLLECTION,x),o.set(d.STATUS,g.all),u(o)},[]);return(0,m.jsxs)("div",{className:h.logsContainer,children:[(0,m.jsxs)("div",{className:h.filterBar,children:[(0,m.jsxs)("div",{className:h.section,children:[(0,m.jsx)(ie,{selectedStatus:B,onSelectStatus:$}),(0,m.jsx)(X,{collectionIds:e,selectedCollectionId:v,onSelectCollection:z})]}),(0,m.jsxs)("div",{className:h.section,children:[(0,m.jsx)("div",{className:h.divider,children:(0,m.jsx)(Ce,{variant:"line--vertical",spacing:4})}),(0,m.jsx)(Pe,{startDate:f,endDate:R,onApply:G,isClearable:!1}),i&&(0,m.jsx)(We,{onClick:T,type:"button"})]})]}),(0,m.jsx)(se,{deliveryLogs:s,webhookName:c,isFiltering:i}),r&&(0,m.jsx)(Se,{type:"button",variant:F.TERTIARY,iconRight:"arrow-down",iconRightMode:"line",onClick:n,className:h.loadMoreButton,children:"Load More"})]})}var y=t(N(),1);var Je=t(a(),1);function ce({initialDeliveryLogs:e,webhookName:r,webhookId:s,collectionIds:c,initialNextPageToken:i,initialIsFiltering:n}){let o=de(),[u]=w(),[f,R]=(0,y.useState)(e),[v,B]=(0,y.useState)(i),[G,z]=(0,y.useState)(n);(0,y.useEffect)(()=>{if(o.data){let{nextPageToken:T,deliveryLogs:L}=o.data;R(q=>q.concat(L)),B(T)}},[o.data]),(0,y.useEffect)(()=>{R(e),B(i),z(n)},[e,i,n]);let $=(0,y.useCallback)(()=>{if(v){let T=new URLSearchParams(u);T.set("page_token",v),o.load(`/settings/webhooks/${s}?${T}`)}},[v,o,u,s]);return(0,Je.jsx)(le,{deliveryLogs:f,webhookName:r,collectionIds:c,nextPageToken:v,onLoadMore:$,isFiltering:G})}var ao=t(oo(),1),so=t(eo(),1),Y=t(a(),1),ro=({data:e})=>e?.webhookConfig?[{title:`${e.webhookConfig.display_name} - Webhooks`,description:"Webhook"}]:[{title:"Webhook"}];function je(){let{webhookConfig:e,collections:r,deliveryLogs:s,nextPageToken:c,isFiltering:i}=me(),n=ke(),o=Me(e.name),u=(0,Xe.useMemo)(()=>{let f=n.data;if(!(!f||!("formKey"in f)||f.formKey!==Re))return f.state===0?{response:f.response,errorMessage:null}:f.state===1?{response:null,errorMessage:f.errorMessage??"Unknown Error"}:{response:null,errorMessage:"Unknown error"}},[n.data]);return(0,Y.jsx)(Fe,{title:(0,Y.jsx)(He,{webhookName:e.display_name}),formKey:Be,existingWebhook:e,collections:r,submitTestWebhook:n.submit,testWebhookResponse:u,fetcherState:n.state,additionalTabs:[{label:"Delivery Logs",value:ne,content:(0,Y.jsx)(ce,{initialDeliveryLogs:s,webhookId:o,webhookName:e.display_name,collectionIds:e.collection_ids,initialNextPageToken:c,initialIsFiltering:i})}],initialTab:ne})}export{we as ErrorBoundary,je as default,ro as meta};
