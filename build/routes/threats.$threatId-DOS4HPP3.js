import{a as X,b as xe}from"/censys/build/_shared/chunk-ZVCNKTNW.js";import{b as Pe}from"/censys/build/_shared/chunk-RZGMKYOW.js";import{a as Ce,b as He}from"/censys/build/_shared/chunk-GKHDVOYG.js";import{a as Re,b as V}from"/censys/build/_shared/chunk-ACWHCTH2.js";import{a as be,b as Ee,c as Ie,d as Se}from"/censys/build/_shared/chunk-DJSGSEZB.js";import"/censys/build/_shared/chunk-XLW6D2H7.js";import{a as De}from"/censys/build/_shared/chunk-LCN4BXNE.js";import{a as Le}from"/censys/build/_shared/chunk-3W2VQNCA.js";import{d as Ae}from"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as ke,d as W}from"/censys/build/_shared/chunk-53UREJP4.js";import"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as Ke}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import{a as Ne}from"/censys/build/_shared/chunk-IJLDI467.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as Te}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{c as O,o as G}from"/censys/build/_shared/chunk-22JANVKU.js";import"/censys/build/_shared/chunk-FQTIU6PB.js";import"/censys/build/_shared/chunk-J6D36YFI.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import"/censys/build/_shared/chunk-ATOZ4ARP.js";import"/censys/build/_shared/chunk-DSG73WCA.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{q as ce}from"/censys/build/_shared/chunk-HUE44QRB.js";import"/censys/build/_shared/chunk-Z3PARXZG.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as de}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{a as F}from"/censys/build/_shared/chunk-437XWWKH.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-NUPTSKAJ.js";import{b as fe,h as ue,q as ye,t as ve,v as ge}from"/censys/build/_shared/chunk-YZ2VHXR4.js";import{a as B}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-EYKPJWWG.js";import{a as k}from"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-WJT5ZZXK.js";import{k as he}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import"/censys/build/_shared/chunk-TRPWTN3H.js";import"/censys/build/_shared/chunk-UKMMPQ5X.js";import"/censys/build/_shared/chunk-WJEUPJRQ.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as M}from"/censys/build/_shared/chunk-EZHABQF2.js";import"/censys/build/_shared/chunk-2RV3CGNA.js";import"/censys/build/_shared/chunk-OZE6EA6M.js";import{a as le,b as z}from"/censys/build/_shared/chunk-HNL4CPAB.js";import{f as se,h as ne}from"/censys/build/_shared/chunk-D5QEORL2.js";import{A as me,B as pe}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as a,B as $,va as A,wa as D,y as ie,z as n}from"/censys/build/_shared/chunk-GALQBYYN.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as te,e as re,k as ae,m as oe}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as _,c as y}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as c}from"/censys/build/_shared/chunk-2QEWK57A.js";var U=c(_(),1);var b={threatActivityCard:"q01F3",threatActivityHeader:"vvAWZ",threatActivityChart:"ApsIh",threatActivityLegend:"ocucg",threatActivityLegendItem:"fzlbB",threatActivityLegendItemLine:"wW1Bk"};function we(e,t){let r=X(e),s=X(t);return Math.max(r,s)}function Me(e){return`Past ${e} ${B("Day",e)}`}var T=c(y(),1);function K({hostMetrics:e,webMetrics:t}){let r=(0,U.useMemo)(()=>{let u=(e?.counts??[]).map(L=>({datetime:L.timestamp??"",count:BigInt(L.count)}));return V(u)},[e]),s=(0,U.useMemo)(()=>{let u=(t?.counts??[]).map(L=>({datetime:L.timestamp??"",count:BigInt(L.count)}));return V(u)},[t]),p=(0,U.useMemo)(()=>we(r,s),[r,s]);return(0,T.jsxs)(D,{bodyPadding:A.NONE,className:b.threatActivityCard,children:[(0,T.jsxs)("div",{className:b.threatActivityHeader,children:[(0,T.jsx)(a,{variant:n.H4,children:"Threat Activity"}),(0,T.jsx)(a,{variant:n.SMALL,children:"|"}),(0,T.jsx)(a,{variant:n.H5,children:Me(p)})]}),(0,T.jsx)("div",{className:b.threatActivityChart,children:(0,T.jsx)(Re,{title:"Total Assets",stats:[{title:"Hosts",stats:r},{title:"Web Properties",stats:s}],fillColors:["transparent"],strokeColors:["var(--color-theme-brand-peach)"],strokeDashArrays:["0","4,4"],lineThickness:2})}),(0,T.jsxs)("div",{className:b.threatActivityLegend,children:[(0,T.jsxs)("div",{className:b.threatActivityLegendItem,children:[(0,T.jsx)("svg",{className:b.threatActivityLegendItemLine,viewBox:"0 0 34 4",children:(0,T.jsx)("path",{d:"M 0 2 L 34 2",stroke:"var(--color-theme-brand-peach)",strokeWidth:"2"})}),(0,T.jsx)(a,{variant:n.H5,children:"Hosts"})]}),(0,T.jsxs)("div",{className:b.threatActivityLegendItem,children:[(0,T.jsx)("svg",{className:b.threatActivityLegendItemLine,viewBox:"0 0 34 4",children:(0,T.jsx)("path",{d:"M 0 2 L 34 2",stroke:"var(--color-theme-brand-peach)",strokeWidth:"2",strokeDasharray:"4,4"})}),(0,T.jsx)(a,{variant:n.H5,children:"Web Properties"})]})]})]})}var _e="https://attack.mitre.org/groups/",Oe="https://malpedia.caad.fkie.fraunhofer.de/actor/";var i={threatActorsCard:"SrvcT",cardGroup:"_0crbc",groupSection:"Edu2w",sectionHeader:"xzK1d",actor:"xCjBl",actorLeft:"Wwbch",actorRight:"m0xOk",actorIcon:"-RdkE",actorPrimaryName:"m6ggr",actorAllNames:"_5kKHm",linkList:"a6Csc",actorLink:"uMUqO",actorLinkLabel:"Kes4n",actorLinkLabelText:"lWgfv",actorLinkValue:"iK1NB"};var o=c(y(),1);function Y({threatDetails:e}){return e?.actorInfo.size?(0,o.jsx)(D,{bodyPadding:A.NONE,className:i.threatActorsCard,children:(0,o.jsx)("div",{className:i.cardGroup,children:(0,o.jsxs)("div",{className:i.groupSection,children:[(0,o.jsx)(a,{variant:n.H4,className:i.sectionHeader,children:"Actor Details"}),Array.from(e.actorInfo.entries()).map(([t,r])=>(0,o.jsxs)("div",{className:i.actor,children:[(0,o.jsxs)("div",{className:i.actorLeft,children:[(0,o.jsx)(ie,{className:i.actorIcon,name:"spy",mode:"line"}),(0,o.jsxs)("div",{className:i.actorNames,children:[(0,o.jsx)(a,{className:i.actorPrimaryName,variant:n.H3,children:r?.actor?.primaryName??"Unknown"}),r?.actor?.allNames?.length?(0,o.jsx)(a,{className:i.actorAllNames,children:r?.actor.allNames.join(", ")}):null]})]}),(0,o.jsx)("div",{className:i.actorRight,children:(0,o.jsxs)("div",{className:i.cardGroup,children:[r?.description&&(0,o.jsxs)("div",{className:i.groupSection,children:[(0,o.jsx)(a,{className:i.sectionHeader,variant:n.H5,children:"Description"}),(0,o.jsx)(a,{variant:n.SMALL,children:r?.description})]}),(0,o.jsx)("div",{className:i.groupSection,children:(0,o.jsxs)("ul",{className:i.linkList,children:[r?.actor?.mitreGroupId&&(0,o.jsxs)("li",{className:i.actorLink,children:[(0,o.jsx)("div",{className:i.actorLinkLabel,children:(0,o.jsx)(a,{children:"MITRE"})}),(0,o.jsx)("div",{className:i.actorLinkValue,children:(0,o.jsx)(M,{className:i.relatedLink,href:`${_e}${r?.actor.mitreGroupId}`,isExternal:!0,showExternalIcon:!0,children:r?.actor?.mitreGroupId})})]}),r?.actor?.malpediaGroupId&&(0,o.jsxs)("li",{className:i.actorLink,children:[(0,o.jsx)("div",{className:i.actorLinkLabel,children:(0,o.jsx)(a,{className:i.actorLinkLabelText,children:"Malpedia"})}),(0,o.jsx)("div",{className:i.actorLinkValue,children:(0,o.jsx)(M,{className:i.relatedLink,href:`${Oe}${r?.actor.malpediaGroupId}`,isExternal:!0,showExternalIcon:!0,children:r?.actor?.malpediaGroupId})})]})]})})]})})]},t))]})})}):null}var q=c(_(),1);var R={threatDetailHeader:"jnibv",threatHeaderLeft:"zFsa0",threatHeaderDetails:"aLy1n",threatHeaderDetailsTitle:"_1st6g",threatType:"x1-sH",allNames:"X-E9X",threatHeaderRight:"PA1QX",threatHeaderActions:"-chew"};var d=c(y(),1);function Z({threatTypes:e,threatDetails:t}){let r=(0,q.useMemo)(()=>me(t?.name??""),[t?.name]),s=he({query:r,source:"threat"}),p=(0,q.useMemo)(()=>(t?.malwareInfo?.values()?.next()?.value?.malware?.allNames??[]).filter(u=>u!==t?.name),[t]);return(0,d.jsxs)("div",{className:R.threatDetailHeader,children:[(0,d.jsxs)("div",{className:R.threatHeaderLeft,children:[(0,d.jsx)(Ce,{size:"large"}),(0,d.jsxs)("div",{className:R.threatHeaderDetails,children:[(0,d.jsxs)("div",{className:R.threatHeaderDetailsTitle,children:[(0,d.jsx)(a,{variant:n.H1,children:t?.name??"Unknown"}),Ae(t?.addedAt)?(0,d.jsx)(He,{}):null,(0,d.jsx)(de,{variant:"dot"}),(0,d.jsx)(a,{className:R.threatType,variant:n.H5,children:e.join(", ")})]}),p.length?(0,d.jsxs)("div",{className:R.threatAka,children:[(0,d.jsx)(a,{variant:n.H5,as:"span",children:"AKA:"})," ",(0,d.jsx)(a,{className:R.allNames,children:p.join(", ")})]}):null]})]}),(0,d.jsxs)("div",{className:R.threatHeaderRight,children:[(0,d.jsxs)("div",{className:R.threatHeaderActions,children:[(0,d.jsx)(F,{link:{to:s,["aria-label"]:`Add ${t?.name} to My Collections`,target:"_blank"},button:{variant:$.DEFAULT,iconLeft:"add"},children:"Add to My Collections"}),(0,d.jsx)(F,{link:{to:pe(t?.name??""),["aria-label"]:`Search for ${t?.name}`,target:"_blank"},button:{variant:$.PRIMARY,iconLeft:"search",iconLeftMode:"line"},children:"View All Threat Assets"})]}),t?.addedAt?(0,d.jsx)(Ne,{timestamp:t.addedAt.toString(),labelText:"Created",includeTime:!1,includeTooltip:!1}):null]})]})}var Be=c(_(),1);var Ge="https://malpedia.caad.fkie.fraunhofer.de/details/";var v={threatDetailsCard:"_5nsck",threatDetails:"x2GxP",cardGroup:"S3tlD",groupSection:"_1wfZ9",sectionHeader:"UEn0J",threatDetailsTable:"_7nxtF",rowLabel:"y0ZLY",linkList:"-yEmk"};var m=c(y(),1);function Q({threatDetails:e,threatTypes:t,threatTactics:r}){let s=(0,Be.useMemo)(()=>{let g=Array.from(e?.malwareInfo.values()??[]).filter(f=>!!f.malware?.malpediaId&&!!f.malware?.primaryName).map(f=>({label:`${f.malware?.primaryName} at Malpedia`,href:`${Ge}${f.malware?.malpediaId}`})),L=(e?.references??[]).map(f=>({label:f.link,href:f.link})),I=[...g,...L],S=[],x=new Set;for(let f of I)x.has(f.href)||(x.add(f.href),S.push(f));return S},[e?.references,e?.malwareInfo]);return(0,m.jsx)(D,{bodyPadding:A.NONE,className:v.threatDetailsCard,children:(0,m.jsxs)("div",{className:v.threatDetails,children:[(0,m.jsx)("div",{className:v.cardGroup,children:(0,m.jsxs)("div",{className:v.groupSection,children:[(0,m.jsx)(a,{variant:n.H4,className:v.sectionHeader,children:"Details"}),(0,m.jsx)("div",{className:v.threatDetailsTable,children:(0,m.jsxs)(ke,{children:[(0,m.jsx)(W,{label:"Type",content:t.join(", ")}),r?.length?(0,m.jsx)(W,{label:"Tactic",content:r.join(", ")}):null]})})]})}),(0,m.jsxs)("div",{className:v.cardGroup,children:[(0,m.jsxs)("div",{className:v.groupSection,children:[(0,m.jsx)(a,{variant:n.H4,className:v.sectionHeader,children:"Description"}),(0,m.jsx)(a,{variant:n.SMALL,children:e?.description})]}),s.length?(0,m.jsxs)("div",{"data-testid":"related-links",className:v.groupSection,children:[(0,m.jsx)(a,{variant:n.H4,className:v.sectionHeader,children:"Related Links"}),(0,m.jsx)("div",{className:v.threatDetailsRightReferences,children:(0,m.jsx)("ul",{className:v.linkList,children:s.map(p=>(0,m.jsx)("li",{children:(0,m.jsx)(a,{variant:n.H6,children:(0,m.jsx)(M,{href:p.href,isExternal:!0,showExternalIcon:!0,children:p.label})})},p.href))})})]}):null]})]})})}var j={container:"djS1X",header:"sHywF"};var H=c(y(),1);function J({screenshots:e,threatName:t}){let r=`${t} ${B("Screenshot",e.length)}`;return(0,H.jsx)(D,{bodyPadding:A.NONE,children:(0,H.jsxs)("div",{className:j.container,children:[(0,H.jsx)("div",{className:j.header,children:(0,H.jsxs)(a,{variant:n.H4,children:["Screenshots (",e.length,")"]})}),(0,H.jsx)(Pe,{assetName:r,screenshots:e,width:360})]})})}var E=c(_(),1);function qe({ip:e,port:t,transportProtocol:r}){return`${e} : ${t} / ${r}`}function Ue(e){let[t,r]=e.split(" : "),[s,p]=r.split(" / ");return{ip:t,port:s,transportProtocol:p}}function $e(e){if(!e||!e.sessions||e.sessions.length===0)return{};let t={host:[]};for(let r of e.sessions){let s=new Map(r.keys.map(f=>[f.field,f.value])),p=s.get("ip")||"",g=s.get("port")||"",u=s.get("transport_protocol")||"",L=qe({ip:p,port:g,transportProtocol:u}),I=r.startTime||new Date().toISOString(),S=r.endTime||new Date().toISOString(),x={id:`${p}-${g}-${I}-${S}`,type:"host",name:L,startDate:I,endDate:S};t.host.push(x)}return t}var ze={threatTimeline:"ZoPSz"};var C=c(y(),1);function ee({observationsTimelineResults:e,threatId:t}){let r=(0,E.useRef)(null),s=re(),p=se(),g=$e(e||null),u=e?.sessions||[],L=(0,E.useMemo)(()=>{let h=new Date().toISOString();for(let N of u)N.startTime&&N.startTime<h&&(h=N.startTime);return h},[u]),I=(0,E.useMemo)(()=>{let h=new Date().toISOString();for(let N of u)N.endTime&&N.endTime>h&&(h=N.endTime);return h},[u]),S=(0,E.useMemo)(()=>ue(g),[g]),x=(0,E.useMemo)(()=>S.map(h=>{let N=De(h.name,30,!0);return{name:h.name,displayName:N,subtitle:h.subtitle,opacity:1}}),[S]),f=(0,E.useCallback)(h=>{if(!h)return;let{ip:N,port:We,transportProtocol:Ve}=Ue(h.name),Xe=h.startDate,P=new URLSearchParams;p?.organizationId&&P.set(le,p.organizationId),P.set(be,N),P.set(Ee,We),P.set(Ie,Ve),P.set(Se,Xe),s(`/threats/${t}/host?${P}`)},[s,t,p]);return(0,C.jsx)("div",{ref:r,className:ze.threatTimeline,children:(0,C.jsx)(fe,{onClick:f,children:(0,C.jsxs)(ye,{ref:r,data:g,colors:["#3abaad","#d13f95"],lineThickness:10,axis:{bottom:{showGridLines:!0,strokeWidth:.5,strokeDasharray:"3,3",textAnchor:"start",tickFontSize:12,strokeColor:k.TEXT_DISABLED,tickColor:k.TEXT_PRIMARY}},startDate:L,endDate:I,margin:{top:20,right:20,bottom:40,left:200},border:{right:{strokeColor:k.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"},left:{strokeColor:k.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"},bottom:{strokeColor:k.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"},top:{strokeColor:k.TEXT_DISABLED,strokeWidth:1,strokeDasharray:"none"}},children:[(0,C.jsx)(ge,{range:x,strokeColor:k.BORDERLINE_SECONDARY,textColor:k.TEXT_PRIMARY,selectedColor:k.FEEDBACK_INFO_HOVER}),(0,C.jsx)(ve,{render:({x:h,height:N})=>(0,C.jsx)("line",{x1:h,x2:h,y1:0,y2:N,stroke:k.TEXT_PLACEHOLDER,strokeDasharray:"3,3"})})]})})})}var w={threatMainContent:"pz8Po",topRow:"NzzKM",chartLayout:"i0BFm",threatTimelineCard:"AT54x",threatTimelineTitle:"H3zf6"};var je=c(Ke(),1),l=c(y(),1);function Fe(){let{hostMetrics:e,webMetrics:t,threatId:r,threatDetails:s,threatTypes:p,threatTactics:g,threatScreenshots:u,observationsTimelineResults:L}=Le(),I=ne("threat-history");return(0,l.jsx)(G,{slots:{header:(0,l.jsx)(Z,{threatId:r,threatTypes:p,threatDetails:s})},breadcrumbs:[{linkElement:(0,l.jsx)(z,{to:"/threats",children:"Explore"})},{pathName:s?.name??"Threat Details"}],children:(0,l.jsx)(O,{children:(0,l.jsxs)("div",{className:w.threatMainContent,children:[(0,l.jsxs)("div",{className:w.topRow,children:[(0,l.jsx)(K,{hostMetrics:e,webMetrics:t}),u.length>0&&(0,l.jsx)(J,{threatName:s?.name??"Threat",screenshots:u})]}),(0,l.jsx)(Q,{threatDetails:s,threatTypes:p,threatTactics:g}),(0,l.jsx)(Y,{threatDetails:s}),I&&(0,l.jsxs)(D,{className:w.threatTimelineCard,bodyPadding:A.NONE,children:[(0,l.jsx)(a,{variant:n.H5,className:w.threatTimelineTitle,children:"Hosts with Threat Timeline"}),(0,l.jsxs)("div",{className:w.chartLayout,children:[(0,l.jsx)(ee,{observationsTimelineResults:L,threatId:r}),(0,l.jsx)(oe,{})]})]})]})})})}function Ze(e){return!xe(e)}function Qe(){let e=ae(),t=[{linkElement:(0,l.jsx)(z,{to:"/threats",children:"Threats"})},{pathName:"Threat Details"}];return te(e)?(0,l.jsx)(G,{breadcrumbs:t,children:(0,l.jsx)(O,{children:(0,l.jsx)(ce,{iconName:"alert",title:"Error Loading Threat Data",children:(0,l.jsx)(a,{children:"We encountered a problem while loading the threat details. Please try again later."})})})}):(0,l.jsx)(G,{breadcrumbs:t,children:(0,l.jsx)(O,{children:(0,l.jsx)(Te,{error:e})})})}export{Qe as ErrorBoundary,Fe as default,Ze as shouldRevalidate};
