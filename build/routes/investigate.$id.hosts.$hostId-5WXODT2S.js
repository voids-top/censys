import{a as J}from"/censys/build/_shared/chunk-DPQLMYXH.js";import{a as q}from"/censys/build/_shared/chunk-3IID2F3B.js";import{a as K,e as X}from"/censys/build/_shared/chunk-ZDOHYF7S.js";import"/censys/build/_shared/chunk-P6URTM7C.js";import{d as V,g as $}from"/censys/build/_shared/chunk-TUFJ6JAI.js";import"/censys/build/_shared/chunk-BS7TM7GR.js";import{a as H,b as G,d as W,e as Q,f as Y}from"/censys/build/_shared/chunk-YGYBCBWV.js";import{a as _,i as B}from"/censys/build/_shared/chunk-OM626W5A.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-T4CQEEYS.js";import"/censys/build/_shared/chunk-GMNB7RSU.js";import{a as M}from"/censys/build/_shared/chunk-SNE5KUVT.js";import{a as w,d as s,e as i}from"/censys/build/_shared/chunk-AIDQO3P6.js";import"/censys/build/_shared/chunk-5PS6SCVZ.js";import{a as x}from"/censys/build/_shared/chunk-6PRZAB44.js";import{a as me}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-LQXVLPA4.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import"/censys/build/_shared/chunk-FKAW57YX.js";import"/censys/build/_shared/chunk-XFF644VA.js";import"/censys/build/_shared/chunk-5B22H335.js";import"/censys/build/_shared/chunk-PUNV2EUS.js";import"/censys/build/_shared/chunk-ZMYU5ULY.js";import"/censys/build/_shared/chunk-WMKH6XX3.js";import"/censys/build/_shared/chunk-3JU625ZU.js";import"/censys/build/_shared/chunk-I5BA26X4.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-JLZAPT5W.js";import"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{d as R,l as O,o as U}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-HG7D3PDC.js";import"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as P}from"/censys/build/_shared/chunk-Q3AERUF4.js";import{a as F}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-KIDII43I.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-2G5R6E4Q.js";import"/censys/build/_shared/chunk-6XVOHWMX.js";import"/censys/build/_shared/chunk-HLRAT4GD.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-W2GUOEY7.js";import"/censys/build/_shared/chunk-FQAS3FYV.js";import{a as C}from"/censys/build/_shared/chunk-P2FXGQA2.js";import{f as E}from"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as r,B as n,z as b}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as D,c as N,e as S,g as L,k as z,z as k}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as ce,c as A}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as f}from"/censys/build/_shared/chunk-2QEWK57A.js";var m=f(ce(),1);var l={section:"oL33k",sectionHeader:"-aeOp",locationValue:"vp2Sc",sectionHeaderIcon:"uDboR"};var pe=f(me(),1),e=f(A(),1);function Z(){let{deleteNodes:p}=B(),d=E(),c=L(),h=N(),I=S(),v=k(),{link:g="",label:j=""}=_("host",c.hostId||""),y=(0,m.useCallback)(()=>{let o=new URLSearchParams(h.search);d?.organizationId&&o.set(C,d.organizationId);let T=`/investigate/${c.id}?${o.toString()}`;I(T)},[h.search,I,c.id,d]),ee=(0,m.useCallback)(()=>{let o=U("host",c.hostId||"");y(),p([o])},[y,p,c.hostId]);if(!v||!("host"in v)||!v.host)return null;let{host:oe,atTime:te,id:ae}=v,a=x(oe),t=J(a),re=a.dns?.reverse_dns?.names?.[0],ne=a.dns?.names?.[0],se=a.operating_system?.product,ie=(0,m.useMemo)(()=>O(a),[a]),u=(0,m.useMemo)(()=>!a.services||a.services.length===0?[]:a.services.map(o=>{let T=`${g}#${V(o)}`;return{label:$(o),href:T,hasThreats:o.threats?.some(le=>le.name?.trim()!=="")??!1,hasCves:!!o.vulns?.length,cveSeverity:X(o.vulns)}}),[a.services,g]);return(0,e.jsxs)(H,{title:"Host Node",onClose:y,actions:(0,e.jsxs)(G,{children:[(0,e.jsx)(Q,{link:g,label:j}),(0,e.jsx)(W,{onDelete:ee})]}),children:[(0,e.jsx)("div",{className:l.section,children:(0,e.jsx)(Y,{assetType:"host",id:ae,atTime:te,tags:ie})}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(b,{icon:"file-list-2-line",size:"md",className:l.sectionHeaderIcon}),(0,e.jsx)(n,{variant:r.H3,children:"Summary"})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(s,{label:"Location",content:t.countryCode?(0,e.jsxs)("div",{className:l.locationValue,children:[(0,e.jsx)(P,{countryCode:t.countryCode}),(0,e.jsx)(n,{variant:r.DEFAULT,children:t.location})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:`${u.length} ${F("Service",u.length)}`,content:u.length>0?(0,e.jsx)(q,{tagSize:"sm",tags:u.map(o=>({...o,label:(0,e.jsx)(n,{variant:r.DEFAULT,children:o.label}),contentLeft:(0,e.jsxs)(e.Fragment,{children:[o.hasCves&&o.cveSeverity&&(0,e.jsx)(K,{size:"sm","aria-label":"CVE found on this service",severity:o.cveSeverity}),o.hasThreats&&(0,e.jsx)(M,{size:"sm","aria-label":"Threat found on this service"})]})})),maxVisibleRows:3}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Reverse DNS",content:re||(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Forward DNS",content:ne||(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"OS",content:se||(0,e.jsx)(i,{})})]})]}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(b,{icon:"organization-chart",size:"md"}),(0,e.jsx)(n,{variant:r.H3,children:"Network"})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(s,{label:"WHOIS Network",content:t.whois.network.name?(0,e.jsxs)("div",{children:[(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.network.name}),t.whois.network.handle&&(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.network.handle})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"WHOIS Organization",content:t.whois.organization.name?(0,e.jsxs)("div",{children:[(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.organization.name}),t.whois.organization.handle&&(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.organization.handle})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Autonomous System",content:t.autonomousSystem||(0,e.jsx)(i,{})})]})]})]})}function de(){let p=S(),d=z(),c=D(d)?d.data.message:"Unknown error",h=(0,m.useCallback)(()=>{p(-1)},[p]);return(0,e.jsx)(H,{title:"Host Node",onClose:h,children:(0,e.jsx)(R,{iconName:"server",title:c})})}export{de as ErrorBoundary,Z as default};
