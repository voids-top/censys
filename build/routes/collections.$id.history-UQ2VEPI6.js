import{a as ae}from"/censys/build/_shared/chunk-AGLMH5N7.js";import{b as oe}from"/censys/build/_shared/chunk-MKHNE654.js";import{b as ne}from"/censys/build/_shared/chunk-KCNATP3M.js";import{a as te}from"/censys/build/_shared/chunk-GZWGB2XV.js";import{a as Z}from"/censys/build/_shared/chunk-ULGJ3ZYU.js";import{a as ye}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import{a as ee}from"/censys/build/_shared/chunk-LQXVLPA4.js";import{a as j}from"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as X}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{b as z,c as G}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import"/censys/build/_shared/chunk-WMKH6XX3.js";import"/censys/build/_shared/chunk-3JU625ZU.js";import"/censys/build/_shared/chunk-I5BA26X4.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-JLZAPT5W.js";import"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as Q}from"/censys/build/_shared/chunk-HG7D3PDC.js";import"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-KIDII43I.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-2G5R6E4Q.js";import"/censys/build/_shared/chunk-6XVOHWMX.js";import"/censys/build/_shared/chunk-HLRAT4GD.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as F}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{k as K}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{b as J}from"/censys/build/_shared/chunk-P2FXGQA2.js";import"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import{g as _}from"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as r,B as a,C as W,F as $,Ha as V,Wa as Y,aa as A,bb as q,ua as I,va as O,y as T}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as x,k as B,p as S,t as k,z as H}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as M,c as m}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as l}from"/censys/build/_shared/chunk-2QEWK57A.js";var de=l(M(),1);var re=l(M(),1);var n={eventTable:"RaobD",cellWithoutBorder:"OxAJ-",emptyStateRow:"PNEO1",eventRowSelected:"igOz0",cellSpaceWidth:"qnH89",cellTimeline:"RuBeW",timelineHead:"vSocN",timelineLine:"XC2VG",timelineSelected:"A2-nb",cellWidth20:"mH3IQ",cellSelection:"_0i-AE",headerRow:"h0kET",headerSpacingRow:"-P6qp",descriptionCell:"mNhrR"};var t=l(m(),1);function R(e,o){return o&&e.eventTime?o.includes(e.eventTime):!1}function P({events:e,selectedEventTimestamps:o,onSelectedEventTimestampsChange:i,slots:{DetailLinkComponent:c,DescriptionComponent:v,DetailComponent:E},headers:u}){let b=(0,re.useCallback)(p=>h=>{let w=p.eventTime;!w||!i||!o||(h?o.length<2?i(L=>[...L,w]):i(L=>[L[1],w]):i(L=>L.filter(ue=>ue!==w)))},[o]);return(0,t.jsx)("table",{className:n.eventTable,children:(0,t.jsxs)("tbody",{children:[u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:n.headerRow,children:[(0,t.jsx)("td",{"aria-hidden":!0,className:T(n.cellTimeline,n.cellWithoutBorder,n.cellSelection)}),(0,t.jsx)("td",{"aria-hidden":!0,className:T(n.cellWithoutBorder,n.cellSpaceWidth)}),(0,t.jsx)("th",{className:n.cellWidth20,children:(0,t.jsx)(a,{variant:r.DEFAULT_SEMIBOLD,children:u.dateTimeHeader})}),(0,t.jsx)("td",{"aria-hidden":!0,className:T(n.cellWithoutBorder,n.cellWidth20)}),(0,t.jsx)("th",{className:n.cellWidth20,children:(0,t.jsx)(a,{variant:r.DEFAULT_SEMIBOLD,children:u.eventHeader})}),(0,t.jsx)("th",{className:n.descriptionCell,children:(0,t.jsx)(a,{variant:r.DEFAULT_SEMIBOLD,children:u.descriptionHeader})})]}),(0,t.jsx)("tr",{className:n.headerSpacingRow})]}),e.length===0&&(0,t.jsx)("tr",{className:n.emptyStateRow,children:(0,t.jsx)("td",{colSpan:6,children:"No events match your filters"})}),e.map((p,h)=>(0,t.jsxs)("tr",{className:T(R(p,o)&&n.eventRowSelected,n.eventRow),"data-testid":"host-event-instance","aria-selected":R(p,o),children:[(0,t.jsxs)("td",{className:T(n.cellTimeline,n.cellWithoutBorder,n.cellSelection),children:[o&&(0,t.jsx)(Y,{"data-testid":"event-timestamp-checkbox","aria-label":`Select event at ${p.eventTime}`,checked:R(p,o),onCheckedChange:b(p)}),(0,t.jsx)(fe,{isSelected:R(p,o),isLast:h===e.length-1})]}),(0,t.jsx)("td",{className:T(n.cellWithoutBorder,n.cellSpaceWidth)}),(0,t.jsx)("td",{className:n.cellWidth20,children:(0,t.jsx)(Te,{event:p})}),(0,t.jsx)("td",{className:n.cellWidth20,children:(0,t.jsx)(c,{event:p,isLatest:h===0})}),(0,t.jsx)("td",{className:n.cellWidth20,children:(0,t.jsx)(v,{event:p,isLatest:h===0})}),(0,t.jsx)("td",{className:n.descriptionCell,children:(0,t.jsx)(E,{event:p,isLatest:h===0})})]},`${p.eventTime}-${h}`))]})})}function fe({isSelected:e,isLast:o}){return e?(0,t.jsx)("div",{className:n.timelineSelected}):(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:n.timelineHead}),!o&&(0,t.jsx)("div",{className:n.timelineLine})]})}function Te({event:e}){return(0,t.jsx)("div",{className:n.cellTimestamp,children:e.eventTime?(0,t.jsx)(ee,{timestamp:e.eventTime,variant:"short"}):j})}var d=l(m(),1),U=e=>e.cert?(0,d.jsx)(te,{fingerprint:e.cert.sha256}):e.host?(0,d.jsx)(F,{href:`/hosts/${e.host.ip}`,breakWord:!0,children:e.host.ip}):e.web?(0,d.jsxs)(F,{href:`/web/${e.web.hostname}:${e.web.port}`,breakWord:!0,children:[e.web.hostname,":",e.web.port]}):(0,d.jsx)(a,{variant:r.DEFAULT,children:"Unknown"});function ie({event:e}){return e.asset_change_event?e.asset_change_event.change_type===_.AssetChangeEvent_ChangeType.ADDED?(0,d.jsxs)(a,{variant:r.DEFAULT,children:[U(e.asset_change_event)," was added"]}):e.asset_change_event.change_type===_.AssetChangeEvent_ChangeType.REMOVED?(0,d.jsxs)(a,{variant:r.DEFAULT,children:[U(e.asset_change_event)," was removed"]}):e.asset_change_event.change_type===_.AssetChangeEvent_ChangeType.CHANGE_TYPE_UNSPECIFIED?(0,d.jsxs)(a,{variant:r.DEFAULT,children:[U(e.asset_change_event)," was changed"]}):(0,d.jsx)(a,{variant:r.DEFAULT,children:"Unknown event"}):e.collection_status_change_event?(0,d.jsx)(a,{variant:r.DEFAULT,children:"Collection status was changed"}):(0,d.jsx)(a,{variant:r.DEFAULT,children:"Unknown event"})}var y={cellContentLink:"ni7J3",gray6:"_1nEJR",navLink:"ztLei",systemBlue:"KlbRZ",detailContainer:"UT-7I",breakWord:"a49zy"};var C=l(m(),1),se=e=>{if(!e.asset_change_event)return"Unknown";let o=ge(e.asset_change_event),i=e.asset_change_event.event_time&&(0,C.jsx)(V,{timestamp:e.asset_change_event.event_time,format:"MMM DD, YYYY UTC"}),c="was added to the collection",v="because it matched the query";return e.asset_change_event.change_type===_.AssetChangeEvent_ChangeType.REMOVED&&(c="was removed from the collection",v="because it no longer matched the query"),(0,C.jsxs)("span",{children:[(0,C.jsx)("span",{"data-testid":"asset-name",children:o})," ",c," on"," ",i," ",(0,C.jsx)("span",{"data-testid":"change-reason",children:v})]})},ge=e=>e?.host?e.host.ip:e?.cert?e.cert.sha256:e?.web?`${e.web.hostname}:${e.web.port}`:"The asset";var g=l(m(),1);function le({event:e}){return e.asset_change_event?(0,g.jsx)(a,{variant:r.DEFAULT,className:y.breakWord,children:se(e)}):e.collection_status_change_event?(0,g.jsxs)("div",{className:y.detailContainer,children:[(0,g.jsxs)(a,{variant:r.DEFAULT,className:y.breakWord,children:["Status changed from"," ",e.collection_status_change_event.old_status||"NO STATUS"," to"," ",e.collection_status_change_event.new_status||"NO STATUS"]}),(0,g.jsx)(a,{variant:r.DEFAULT,className:y.breakWord,children:e.collection_status_change_event.reason})]}):(0,g.jsx)(a,{variant:r.DEFAULT,children:"Unknown"})}var D=l(m(),1),Ee=e=>{if(e?.web)return"website";if(e?.host)return"host";if(e?.cert)return"certificate";throw new Error("Unknown hit type")},_e=e=>{if(e?.web)return`/web/${e.web.hostname}:${e.web.port}`;if(e?.host)return`/hosts/${e.host.ip}`;if(e?.cert)return`/certificates/${e.cert.sha256}`;throw new Error("Unknown hit type")};function pe({event:{eventTime:e,...o}}){let{asset_change_event:i}=o;if(!i||i.cert||i.web)return null;let c=`${_e(i)}?at_time=${e}`;return(0,D.jsx)("div",{className:y.cellContentLink,children:(0,D.jsx)(J,{className:y.navLink,to:c,children:(0,D.jsxs)(a,{className:y.systemBlue,children:["View historical ",Ee(i)]})})})}var ce={formContainer:"UJghc"};var f=l(m(),1);function me({action:e,startDate:o,endDate:i}){let[c,v]=S(),E=c.get("event_type")||"all",u=b=>{c.set("event_type",b),v(c)};return(0,f.jsxs)(k,{action:e,method:"get",className:ce.formContainer,children:[(0,f.jsx)($,{name:"event_type",contentLeft:(0,f.jsx)(q,{iconName:"filter-3",label:"Filter"}),valueProps:{placeholder:"All events"},value:E,onValueChange:u,options:[{label:"All events",value:"all"},{label:"Asset added",value:"asset_added"},{label:"Asset removed",value:"asset_removed"},{label:"Status active",value:"status_active"},{label:"Status paused",value:"status_paused"},{label:"Status populating",value:"status_populating"}]}),(0,f.jsx)(Q,{variant:"line--vertical",spacing:4}),(0,f.jsx)(ne,{startDate:o,endDate:i,withoutButton:!0}),(0,f.jsx)(A,{type:"submit","aria-description":"Filters events to a particular date range and event type",children:"Apply"})]})}var N={title:"TCv4U",container:"KKp5i",paddedContainer:"UNN3w",loadMoreForm:"_8xCKA"};var Le=l(ye(),1),s=l(m(),1),Ce=Z("Collections History","routes/collections.$id");function he({children:e}){return(0,s.jsx)(G,{children:e})}function ve(){let e=H(),o=oe(),[i]=S(),c=i.get("end")||"",v=i.get("start")||"",E=i.get("event_type")||"",{data:u,hasNextPage:b}=z({currentData:e.history.events,nextPageToken:e.history.next_page_token,filters:{start:v,end:c,eventType:E}}),p=(0,de.useMemo)(()=>u.map(h=>({...h,eventTime:h.asset_change_event?.event_time||h.collection_status_change_event?.event_time||""})),[u]);return(0,s.jsx)(he,{children:(0,s.jsxs)(O,{title:"Collection Timeline",className:N.container,bodyPadding:I.NONE,children:[(0,s.jsxs)("div",{className:N.paddedContainer,children:[(0,s.jsx)(a,{variant:r.H2,className:N.title,children:"Collection Timeline"}),(0,s.jsx)(me,{action:`/collections/${o.collection_id}/history`,startDate:v,endDate:c})]}),(0,s.jsx)(P,{events:p,slots:{DescriptionComponent:ie,DetailComponent:le,DetailLinkComponent:pe},headers:{dateTimeHeader:"Date | Time",eventHeader:"Event",descriptionHeader:"Description"}}),(0,s.jsxs)(k,{method:"get",action:`/collections/${o.collection_id}/history`,className:N.loadMoreForm,children:[(0,s.jsx)("input",{type:"hidden",name:"page_token",value:e.history.next_page_token}),(0,s.jsx)("input",{type:"hidden",name:"event_type",value:E}),(0,s.jsx)("input",{type:"hidden",name:"start",value:v}),(0,s.jsx)("input",{type:"hidden",name:"end",value:c}),b&&(0,s.jsx)(A,{type:"submit",variant:W.TERTIARY,iconRight:"arrow-down",iconRightMode:"line",children:"Load More"})]})]})})}function be(){let e=B();return(0,s.jsx)(he,{children:x(e)&&K(e.data)?(0,s.jsx)(ae,{errorCode:e.data.code}):(0,s.jsx)(X,{error:e})})}export{be as ErrorBoundary,ve as default,Ce as meta};
