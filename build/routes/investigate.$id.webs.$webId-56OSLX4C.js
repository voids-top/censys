import{a as q}from"/censys/build/_shared/chunk-XOYFCC6C.js";import{a as N,b as G,d as F,e as J,f as Z}from"/censys/build/_shared/chunk-YGYBCBWV.js";import{a as W,i as z}from"/censys/build/_shared/chunk-OM626W5A.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-T4CQEEYS.js";import"/censys/build/_shared/chunk-GMNB7RSU.js";import"/censys/build/_shared/chunk-SNE5KUVT.js";import{e as S}from"/censys/build/_shared/chunk-AIDQO3P6.js";import"/censys/build/_shared/chunk-5PS6SCVZ.js";import{a as O}from"/censys/build/_shared/chunk-6PRZAB44.js";import{a as ne}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-LQXVLPA4.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import"/censys/build/_shared/chunk-PUNV2EUS.js";import"/censys/build/_shared/chunk-ZMYU5ULY.js";import"/censys/build/_shared/chunk-WMKH6XX3.js";import"/censys/build/_shared/chunk-3JU625ZU.js";import"/censys/build/_shared/chunk-I5BA26X4.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-JLZAPT5W.js";import"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{d as H,o as $}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-HG7D3PDC.js";import"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as V}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-KIDII43I.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-2G5R6E4Q.js";import"/censys/build/_shared/chunk-6XVOHWMX.js";import"/censys/build/_shared/chunk-HLRAT4GD.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as x}from"/censys/build/_shared/chunk-W2GUOEY7.js";import"/censys/build/_shared/chunk-FQAS3FYV.js";import{a as M}from"/censys/build/_shared/chunk-P2FXGQA2.js";import{f as D}from"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as u,B as r,Ta as C,z as B}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as k,c as w,e as T,g as A,k as E,z as _}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as se,c as U}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as y}from"/censys/build/_shared/chunk-2QEWK57A.js";var n=y(se(),1);var t={section:"k5xJD",sectionHeader:"vA8tZ",endpoints:"b2wT5",endpointGroup:"o7LGA",groupHeader:"_4lhgh",endpointCount:"_8LYo-",groupList:"wqfeU",endpointItem:"Cme-c",endpointIcon:"xHg4U",endpointTlsVersion:"maJz2",endpointTop:"Jshrc",endpointUri:"VtqB4",endpointMeta:"m843Z",metaRow:"VdtkZ",metaLabel:"pxPTM"};var pe=y(ne(),1),e=y(U(),1);function Y(){let{deleteNodes:c}=z(),l=D(),p=A(),g=w(),b=T(),h=_(),{link:Q="",label:j=""}=W("web",p.webId||""),v=(0,n.useCallback)(()=>{let o=new URLSearchParams(g.search);l?.organizationId&&o.set(M,l.organizationId);let s=`/investigate/${p.id}?${o.toString()}`;b(s)},[g.search,b,p.id,l]),X=(0,n.useCallback)(()=>{let o=$("web",p.webId||"");v(),c([o])},[v,c,p.webId]);if(!h||!("webAggregate"in h)||!h.webAggregate)return null;let{webAggregate:f,atTime:K,id:ee}=h,i=O(f),L=(0,n.useMemo)(()=>(i.labels||[]).map(o=>o.value).sort(),[i.labels]),I=(0,n.useMemo)(()=>(i.threats||[]).map(o=>o.name).filter(Boolean),[i.threats]),te=(0,n.useMemo)(()=>[...I.map(o=>({key:"threat",value:o})),...L.map(o=>({key:"label",value:o}))],[L,I]),oe=(0,n.useMemo)(()=>{let o={};for(let s of i.endpoints||[]){let m=`${s.transport_protocol}/${s.port}`;o[m]||(o[m]=[]),o[m].push(s)}return o},[i.endpoints]);return(0,e.jsxs)(N,{title:"Web Property Node",onClose:v,actions:(0,e.jsxs)(G,{children:[(0,e.jsx)(J,{link:Q,label:j}),(0,e.jsx)(F,{onDelete:X})]}),children:[(0,e.jsx)("div",{className:t.section,children:(0,e.jsx)(Z,{assetType:"web",id:ee,atTime:K,tags:te})}),(0,e.jsx)("div",{className:t.section,children:(0,e.jsx)("div",{className:t.endpoints,children:Object.entries(oe).map(([o,s])=>{let[m,ae]=o.split("/");return(0,e.jsxs)("div",{className:t.endpointGroup,children:[(0,e.jsxs)("div",{className:t.groupHeader,children:[(0,e.jsxs)(r,{variant:u.DEFAULT_SEMIBOLD,children:[m.toUpperCase()," / ",ae]}),(0,e.jsxs)(r,{className:t.endpointCount,children:[s.length," ",V("endpoint",s.length)]}),f?.tls?.version_selected&&(0,e.jsx)(r,{className:t.endpointTlsVersion,children:f.tls.version_selected})]}),(0,e.jsx)("div",{className:t.groupList,children:s.map(a=>{let d=a.http?.status_code,re=d&&d>=300&&d<400,P=a.http?.headers||new Map,R=(P.get("Location")||P.get("location"))?.headers?.[0];return(0,e.jsxs)("div",{className:t.endpointItem,children:[(0,e.jsxs)("div",{className:t.endpointTop,children:[(0,e.jsx)(B,{icon:"mind-map",className:t.endpointIcon}),(0,e.jsx)(r,{variant:u.DEFAULT,className:t.endpointUri,children:(0,e.jsxs)(C,{content:(0,e.jsxs)(e.Fragment,{children:[i.hostname,a.path]}),children:[i.hostname,a.path&&(0,e.jsx)(r,{variant:u.DEFAULT_SEMIBOLD,children:a.path})]})}),d&&(0,e.jsx)(q,{statusCode:d,statusReason:a.http?.status_reason})]}),(0,e.jsx)("div",{className:t.endpointMeta,children:(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"Type"}),(0,e.jsx)(r,{children:a.endpoint_type})]})}),(0,e.jsxs)("div",{className:t.endpointMeta,children:[(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"IP Address"}),(0,e.jsx)(r,{children:a.ip?(0,e.jsx)(x,{href:`/hosts/${a.ip}`,variant:"default",isExternal:!0,children:a.ip}):(0,e.jsx)(S,{})})]}),re&&R&&(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"Redirect URI"}),(0,e.jsx)(r,{children:R})]}),a.http?.html_title&&(0,e.jsxs)("div",{className:t.metaRow,children:[(0,e.jsx)(r,{className:t.metaLabel,children:"HTML Title"}),(0,e.jsx)(r,{children:a.http.html_title})]})]})]},`${a.path}-${a.transport_protocol}-${a.endpoint_type}`)})})]},o)})})})]})}function ie(){let c=T(),l=E(),p=k(l)?l.data.message:"Unknown error",g=(0,n.useCallback)(()=>{c(-1)},[c]);return(0,e.jsx)(N,{title:"Web Property Node",onClose:g,children:(0,e.jsx)(H,{iconName:"global",title:p})})}export{ie as ErrorBoundary,Y as default};
