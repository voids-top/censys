import{a as ye,b as Se,c as We,d as Oe}from"/censys/build/_shared/chunk-AWLKSJ4B.js";import"/censys/build/_shared/chunk-AEKKJQLA.js";import{d as Le}from"/censys/build/_shared/chunk-U6E7AUZH.js";import{a as Ee}from"/censys/build/_shared/chunk-Y3T57EQU.js";import{a as F}from"/censys/build/_shared/chunk-4NXR4FZK.js";import"/censys/build/_shared/chunk-MLEOAWKQ.js";import{a as Ge}from"/censys/build/_shared/chunk-O24ST6IF.js";import"/censys/build/_shared/chunk-5OYDP3WM.js";import{a as _e}from"/censys/build/_shared/chunk-YTHNDA7O.js";import"/censys/build/_shared/chunk-WW7MKZVD.js";import"/censys/build/_shared/chunk-RLL7RAJO.js";import"/censys/build/_shared/chunk-BXMBML5J.js";import"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as He}from"/censys/build/_shared/chunk-IC5AY47K.js";import{a as ke}from"/censys/build/_shared/chunk-JDWADSGD.js";import{c as v}from"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-BWODHJE6.js";import"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as w}from"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as D}from"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import{a as Te}from"/censys/build/_shared/chunk-M5RKE22T.js";import{b as Ce,h as O}from"/censys/build/_shared/chunk-ZP3FOFQD.js";import{b as ge}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import{c as ue}from"/censys/build/_shared/chunk-ST66DGSY.js";import{j as B}from"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{$ as K,A as c,B as _,Ka as ce,Ma as he,Sa as Y,Ta as fe,Xa as W,aa as se,ca as M,ia as $,ja as me,ka as pe,oa as de,ra as S,tb as be,x as le,y as ie,z as I}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{C as ne,f as ae,t as re}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as m}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as x}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as a}from"/censys/build/_shared/chunk-2TWE7TSA.js";var Me=a(x(),1);var L=a(x(),1);var H=a(x(),1);var Ae="delete-webhook-form";var P="name",Ne="org",xe="test-webhook-row-form";var p=a(m(),1);function z({webhook:o,onClose:e}){let{accessState:t}=(0,H.useContext)(ue),l=(0,H.useCallback)(d=>{d||e()},[e]);return(0,p.jsx)(de,{open:!!o,onOpenChange:l,header:(0,p.jsxs)(c,{variant:I.H2,children:["Are you sure you want to delete"," ",o?.display_name||"this Webhook","?"]}),footerActions:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(K,{variant:_.DEFAULT,onClick:e,children:"No, keep it"}),(0,p.jsxs)(re,{method:"post",onSubmit:e,children:[(0,p.jsx)("input",{hidden:!0,name:P,value:o?.name,readOnly:!0}),(0,p.jsx)("input",{hidden:!0,name:Ne,value:t?.organization?.organizationId,readOnly:!0}),(0,p.jsx)("input",{hidden:!0,name:"fetcherKey",value:Ae,readOnly:!0}),(0,p.jsx)(v,{}),(0,p.jsx)(K,{variant:_.ALERT,children:"Yes, delete it"})]})]}),children:(0,p.jsx)(c,{"data-testid":"delete-webhook-modal-body",children:"This action is permanent and you will lose all data associated with this webhook."})})}var j=a(x(),1);var n={tableCell:"_4hxL4",alignLeft:"-tgJw",nameColumn:"r1500",actionColumn:"Ro5yE",subtleText:"CGw8W",date:"J51f5",expandedLink:"kHXjs",linkContent:"GDyq9",divider:"_4pea-"};var f=a(m(),1),Z=({timestamp:o,includeTime:e=!0})=>(0,f.jsxs)(c,{className:n.date,children:[(0,f.jsx)(ce,{timestamp:o}),e&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:n.divider,children:(0,f.jsx)(Te,{variant:"line--vertical"})}),(0,f.jsx)("div",{children:(0,f.jsx)(he,{timestamp:o,format:"HH:MM UTC"})})]})]});var q=a(m(),1),J=({count:o})=>(0,q.jsx)(W,{content:o===0?"Add Collection":"Awaiting Trigger",children:(0,q.jsx)(c,{className:n.subtleText,children:"N/A"})});function De(o){switch(o){case B.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_SUCCESS:return{variant:Y.FEEDBACK_POSITIVE_ICON,text:"Success"};case B.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_FAILURE:return{variant:Y.FEEDBACK_NEGATIVE_ICON,text:"Failure"};case B.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_UNRECOGNIZED:default:return null}}var C=a(x(),1);var G=a(m(),1);function X({isVisible:o,statusCode:e,editHref:t,webhookDisplayName:l,onOpenChange:d,isSuccess:s}){if(!o)return null;let T=s?`${l} Test was Successful`:`${l} Test Returned an Error`,h=s?$.SUCCESS:$.CAUTION,b=e?`The test returned a ${e} response.`:"The webhook test failed to complete.";return(0,G.jsx)(pe,{title:T,variant:h,behavior:me.DISMISSIVE,onOpenChange:d,action:{node:(0,G.jsx)(ge,{to:t,children:"Webhook Configuration"}),altText:"View Webhook Configuration"},children:(0,G.jsx)(c,{variant:I.DEFAULT,children:b})})}var Q={actionsMenuButton:"_1ZxWY",deleteButton:"HT5X6"};var i=a(m(),1);function Ue({webhook:o,onDeleteWebhook:e}){let{name:t,display_name:l}=o,d=F(t),s=ne(),[T,h]=(0,C.useState)(!1),b=(0,C.useRef)(null);(0,C.useEffect)(()=>{s.data&&h(!0)},[s.data]);let g=s.data?.state===0?s.data?.statusCode:null,k=g!==null&&g>=200&&g<300,U=(0,C.useCallback)(R=>{R||h(!1)},[]),V=(0,C.useCallback)(()=>e(o),[o,e]),A=(0,C.useCallback)(()=>{h(!1),b.current?.requestSubmit()},[b,h]),N=`/settings/webhooks/${d}?tab=${"configuration"}`;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.Form,{method:"post",ref:b,children:[(0,i.jsx)("input",{type:"hidden",name:"fetcherKey",value:xe}),(0,i.jsx)("input",{type:"hidden",name:P,value:o.name}),(0,i.jsx)(v,{})]}),(0,i.jsxs)(be,{trigger:(0,i.jsx)(M,{"aria-label":`Actions for ${l}`,className:Q.actionsMenuButton,iconName:"more-2",iconMode:"fill",size:se.LARGE,variant:_.GHOST}),children:[(0,i.jsx)(W,{content:"Configure Webhook",children:(0,i.jsx)(w,{link:{to:N},iconButton:{iconName:"pencil",iconMode:"line",variant:_.GHOST,["aria-label"]:`Configure ${l}`}})}),(0,i.jsx)(W,{content:"Test Webhook",children:(0,i.jsx)(M,{"aria-label":`Test webhook ${l}`,"data-testid":"test-webhook",iconName:"flashlight",iconMode:"line",variant:_.GHOST,onClick:A})}),(0,i.jsx)(W,{content:"Remove Webhook",children:(0,i.jsx)(M,{"aria-label":`Remove ${l}`,"data-testid":"remove-webhook",iconName:"delete-bin-6",iconMode:"line",className:Q.deleteButton,variant:_.ALERT,onClick:V})})]}),(0,i.jsx)(X,{isVisible:T,statusCode:g,editHref:N,webhookDisplayName:o.display_name,onOpenChange:U,isSuccess:k})]})}var r=a(m(),1);function ee({webhook:o,onDeleteWebhook:e}){let{display_name:t,status:l,name:d,collection_id_count:s,collection_ids:T,created_by:h,created_at:b,last_triggered:g}=o,{users:k}=O(),{collections:U}=ae(),V=F(d),A=De(l),N=k.get(h),R=N&&ke(N.identity),te=(0,j.useMemo)(()=>U.filter(u=>T.includes(u.collection_id)),[U,T]),Be=s>0,Fe=(0,r.jsx)(D,{href:`/settings/webhooks/${V}`,onClick:u=>u.stopPropagation(),children:t||"Unnamed Webhook"}),Pe=(0,j.useMemo)(()=>te.map(u=>(0,r.jsx)(D,{href:`/collections/${u.collection_id}`,className:n.expandedLink,isExternal:!0,children:(0,r.jsxs)("div",{className:n.linkContent,children:[(0,r.jsx)(ie,{name:"stack",mode:"line",size:"md"}),u.name," | ",u.collection_id]})},u.collection_id)),[te]);return(0,r.jsxs)(Se,{isExpandable:Be,testId:`webhook-${d}`,expandedContent:Pe,expandedContentColSpan:7,children:[(0,r.jsx)(We,{className:n.nameColumn,children:Fe}),(0,r.jsx)(S.Cell,{className:le(n.tableCell,n.alignLeft),children:R&&(0,r.jsx)(c,{children:R})}),(0,r.jsx)(S.Cell,{className:n.tableCell,children:b&&(0,r.jsx)(Z,{timestamp:b.toString(),includeTime:!1})}),(0,r.jsx)(S.Cell,{className:n.tableCell,children:(0,r.jsx)(c,{className:s===0?n.subtleText:"",children:s})}),(0,r.jsx)(S.Cell,{className:n.tableCell,children:g?(0,r.jsx)(Z,{timestamp:g.toString()}):(0,r.jsx)(J,{count:s})}),(0,r.jsx)(S.Cell,{className:n.tableCell,children:A?(0,r.jsx)(fe,{variant:A.variant,size:"sm",children:A.text}):(0,r.jsx)(J,{count:s})}),(0,r.jsx)(S.Cell,{className:n.actionColumn,onClick:u=>u.stopPropagation(),children:(0,r.jsx)(Ue,{webhook:o,onDeleteWebhook:e})})]})}var Re=[{id:"display_name",label:"Webhook Name",sortable:!0,className:"flexStartPadded"},{id:"created_by",label:"Creator",sortable:!0,className:"flexStart"},{id:"created_at",label:"Created",sortable:!0},{id:"collection_id_count",label:"Total Collections",sortable:!0},{id:"last_triggered",label:"Last Triggered",sortable:!0},{id:"status",label:"Last Delivered",sortable:!0},{id:"actions",label:"",sortable:!1,className:"actionColumn"}];function ve(o){return{display_name:{internalSort:(e,t)=>e.display_name.localeCompare(t.display_name)},created_at:{internalSort:(e,t)=>e.created_at?t.created_at?Temporal.Instant.compare(e.created_at,t.created_at):-1:1},created_by:{internalSort:(e,t)=>{let l=o.get(e.created_by),d=o.get(t.created_by);return!l||!l.identity.lastName?1:!d||!d.identity.lastName?-1:l.identity.lastName.localeCompare(d.identity.lastName)}},collection_id_count:{internalSort:(e,t)=>e.collection_id_count-t.collection_id_count},last_triggered:{internalSort:(e,t)=>e.last_triggered?t.last_triggered?Temporal.Instant.compare(e.last_triggered,t.last_triggered):-1:1},status:{internalSort:(e,t)=>e.status?t.status?e.status.localeCompare(t.status):-1:1}}}var E=a(m(),1);function oe({data:o}){let{users:e}=O(),[t,l]=(0,L.useState)(null),{sortedData:d,sortSettings:s,getSortCallback:T}=Oe(o,ve(e)),h=(0,L.useCallback)(k=>l(k),[]),b=(0,L.useCallback)(()=>l(null),[]),g=(0,L.useCallback)(k=>(0,E.jsx)(ee,{webhook:k,onDeleteWebhook:h},k.name),[h]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(ye,{columns:Re,data:d,renderRow:g,sortSettings:s,onSort:T,testId:"webhooks-table",headerCellClassName:n.tableCell}),t&&(0,E.jsx)(z,{webhook:t,onClose:b})]})}var Ie={container:"UcbIQ"};var Ve=a(Ge(),1),Ke=a(He(),1),y=a(m(),1);function we(){let{webhooks:o}=_e(),{loadUsers:e}=O(),t=Ce("SUPPORT_SITE_URL");return(0,Me.useEffect)(()=>{e()},[]),(0,y.jsxs)("div",{className:Ie.container,children:[(0,y.jsx)(Ee,{title:"Manage Webhooks",iconName:"webhooks",rightSlot:(0,y.jsx)(w,{link:{to:"/settings/webhooks/new"},children:"Create Webhook"}),children:(0,y.jsxs)(c,{children:["Use webhooks to receive automated updates whenever assets are added to or removed from your collections. This lets you send Censys data directly to other applications so you can monitor events and automate workflows. Learn how to"," ",(0,y.jsx)(D,{href:`${t}/docs/platform-collections-webhooks`,isExternal:!0,children:"use and create webhooks"}),"."]})}),o.length&&(0,y.jsx)(oe,{data:o})]})}export{Le as ErrorBoundary,we as default};
