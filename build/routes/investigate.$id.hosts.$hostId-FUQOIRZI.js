import{a as J}from"/censys/build/_shared/chunk-DPQLMYXH.js";import{a as q}from"/censys/build/_shared/chunk-ISPS5TGZ.js";import{a as K,e as X}from"/censys/build/_shared/chunk-OIVUAPPH.js";import"/censys/build/_shared/chunk-QAUM4UBV.js";import{d as V,g as $}from"/censys/build/_shared/chunk-6D64NL5L.js";import"/censys/build/_shared/chunk-BS7TM7GR.js";import{a as H,b as G,d as W,e as Q,f as Y}from"/censys/build/_shared/chunk-M5FP2YGK.js";import{a as _,i as B}from"/censys/build/_shared/chunk-MFWEXTHX.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-7REQVUFL.js";import{a as M}from"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as w,d as s,e as i}from"/censys/build/_shared/chunk-53UREJP4.js";import"/censys/build/_shared/chunk-5PS6SCVZ.js";import{a as x}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as me}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-IJLDI467.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import"/censys/build/_shared/chunk-V6B4SHZ4.js";import"/censys/build/_shared/chunk-2HEEQCOO.js";import"/censys/build/_shared/chunk-ELSFEUI2.js";import"/censys/build/_shared/chunk-LHWSXD62.js";import"/censys/build/_shared/chunk-22JANVKU.js";import"/censys/build/_shared/chunk-FQTIU6PB.js";import"/censys/build/_shared/chunk-J6D36YFI.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import"/censys/build/_shared/chunk-ATOZ4ARP.js";import"/censys/build/_shared/chunk-DSG73WCA.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{g as R,j as O,q as U}from"/censys/build/_shared/chunk-HUE44QRB.js";import"/censys/build/_shared/chunk-Z3PARXZG.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-NJXUBBUP.js";import"/censys/build/_shared/chunk-437XWWKH.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as P}from"/censys/build/_shared/chunk-BI4XKJZW.js";import{a as F}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-EYKPJWWG.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-WJT5ZZXK.js";import"/censys/build/_shared/chunk-ZI7DUXMR.js";import"/censys/build/_shared/chunk-TRPWTN3H.js";import"/censys/build/_shared/chunk-UKMMPQ5X.js";import"/censys/build/_shared/chunk-WJEUPJRQ.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-EZHABQF2.js";import"/censys/build/_shared/chunk-2RV3CGNA.js";import"/censys/build/_shared/chunk-OZE6EA6M.js";import{a as C}from"/censys/build/_shared/chunk-HNL4CPAB.js";import{f as E}from"/censys/build/_shared/chunk-D5QEORL2.js";import"/censys/build/_shared/chunk-VQ4M4AGG.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as n,y as b,z as r}from"/censys/build/_shared/chunk-GALQBYYN.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as D,c as N,e as S,g as L,k as z,z as k}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as ce,c as A}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as f}from"/censys/build/_shared/chunk-2QEWK57A.js";var m=f(ce(),1);var l={section:"oL33k",sectionHeader:"-aeOp",locationValue:"vp2Sc",sectionHeaderIcon:"uDboR"};var pe=f(me(),1),e=f(A(),1);function Z(){let{deleteNodes:p}=B(),d=E(),c=L(),h=N(),I=S(),v=k(),{link:g="",label:j=""}=_("host",c.hostId||""),y=(0,m.useCallback)(()=>{let o=new URLSearchParams(h.search);d?.organizationId&&o.set(C,d.organizationId);let T=`/investigate/${c.id}?${o.toString()}`;I(T)},[h.search,I,c.id,d]),ee=(0,m.useCallback)(()=>{let o=O("host",c.hostId||"");y(),p([o])},[y,p,c.hostId]);if(!v||!("host"in v)||!v.host)return null;let{host:oe,atTime:te,id:ae}=v,a=x(oe),t=J(a),re=a.dns?.reverse_dns?.names?.[0],ne=a.dns?.names?.[0],se=a.operating_system?.product,ie=(0,m.useMemo)(()=>R(a),[a]),u=(0,m.useMemo)(()=>!a.services||a.services.length===0?[]:a.services.map(o=>{let T=`${g}#${V(o)}`;return{label:$(o),href:T,hasThreats:o.threats?.some(le=>le.name?.trim()!=="")??!1,hasCves:!!o.vulns?.length,cveSeverity:X(o.vulns)}}),[a.services,g]);return(0,e.jsxs)(H,{title:"Host Node",onClose:y,actions:(0,e.jsxs)(G,{children:[(0,e.jsx)(Q,{link:g,label:j}),(0,e.jsx)(W,{onDelete:ee})]}),children:[(0,e.jsx)("div",{className:l.section,children:(0,e.jsx)(Y,{assetType:"host",id:ae,atTime:te,tags:ie})}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(b,{icon:"file-list-2-line",size:"md",className:l.sectionHeaderIcon}),(0,e.jsx)(n,{variant:r.H3,children:"Summary"})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(s,{label:"Location",content:t.countryCode?(0,e.jsxs)("div",{className:l.locationValue,children:[(0,e.jsx)(P,{countryCode:t.countryCode}),(0,e.jsx)(n,{variant:r.DEFAULT,children:t.location})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:`${u.length} ${F("Service",u.length)}`,content:u.length>0?(0,e.jsx)(q,{tagSize:"sm",tags:u.map(o=>({...o,label:(0,e.jsx)(n,{variant:r.DEFAULT,children:o.label}),contentLeft:(0,e.jsxs)(e.Fragment,{children:[o.hasCves&&o.cveSeverity&&(0,e.jsx)(K,{size:"sm","aria-label":"CVE found on this service",severity:o.cveSeverity}),o.hasThreats&&(0,e.jsx)(M,{size:"sm","aria-label":"Threat found on this service"})]})})),maxVisibleRows:3}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Reverse DNS",content:re||(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Forward DNS",content:ne||(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"OS",content:se||(0,e.jsx)(i,{})})]})]}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(b,{icon:"organization-chart",size:"md"}),(0,e.jsx)(n,{variant:r.H3,children:"Network"})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(s,{label:"WHOIS Network",content:t.whois.network.name?(0,e.jsxs)("div",{children:[(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.network.name}),t.whois.network.handle&&(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.network.handle})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"WHOIS Organization",content:t.whois.organization.name?(0,e.jsxs)("div",{children:[(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.organization.name}),t.whois.organization.handle&&(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.organization.handle})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Autonomous System",content:t.autonomousSystem||(0,e.jsx)(i,{})})]})]})]})}function de(){let p=S(),d=z(),c=D(d)?d.data.message:"Unknown error",h=(0,m.useCallback)(()=>{p(-1)},[p]);return(0,e.jsx)(H,{title:"Host Node",onClose:h,children:(0,e.jsx)(U,{iconName:"server",title:c})})}export{de as ErrorBoundary,Z as default};
