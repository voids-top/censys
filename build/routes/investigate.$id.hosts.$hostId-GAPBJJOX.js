import{a as J}from"/censys/build/_shared/chunk-DPQLMYXH.js";import{a as q}from"/censys/build/_shared/chunk-4533AUAX.js";import{a as K,e as X}from"/censys/build/_shared/chunk-DXLA43JS.js";import"/censys/build/_shared/chunk-XNAXVUO4.js";import{a as H,b as G,d as W,e as Q,f as Y}from"/censys/build/_shared/chunk-CRA3TGUV.js";import{a as _,i as B}from"/censys/build/_shared/chunk-XWEFKGC4.js";import{a as M}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as w,d as s,e as i}from"/censys/build/_shared/chunk-YUXBXUAH.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-SZRPTSUZ.js";import"/censys/build/_shared/chunk-BXMBML5J.js";import{a as P}from"/censys/build/_shared/chunk-AEM63NKL.js";import{a as F}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as x}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-OFRBI5JW.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{d as V,g as $}from"/censys/build/_shared/chunk-IO4OV3HV.js";import"/censys/build/_shared/chunk-BS7TM7GR.js";import{a as me}from"/censys/build/_shared/chunk-IC5AY47K.js";import"/censys/build/_shared/chunk-4NQHWOT6.js";import"/censys/build/_shared/chunk-VDD6BNAJ.js";import"/censys/build/_shared/chunk-B5UNN2SO.js";import"/censys/build/_shared/chunk-TUDXVIEL.js";import"/censys/build/_shared/chunk-7C4UGOB7.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-JDWADSGD.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-4WX73TCZ.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-5OP2ERYU.js";import"/censys/build/_shared/chunk-LOKTUJJ3.js";import"/censys/build/_shared/chunk-BU2LL35M.js";import"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-FP2KPINM.js";import"/censys/build/_shared/chunk-VKYVKQW2.js";import"/censys/build/_shared/chunk-HVTNNTFL.js";import"/censys/build/_shared/chunk-5HYWBZZN.js";import"/censys/build/_shared/chunk-OQUAXVLV.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import{c as R,l as O,o as U}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import{a as C}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import{f as E}from"/censys/build/_shared/chunk-ST66DGSY.js";import"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{A as n,y as b,z as r}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{a as D,c as N,e as S,g as L,k as z,z as k}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as A}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as ce}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as f}from"/censys/build/_shared/chunk-2TWE7TSA.js";var m=f(ce(),1);var l={section:"oL33k",sectionHeader:"-aeOp",locationValue:"vp2Sc",sectionHeaderIcon:"uDboR"};var pe=f(me(),1),e=f(A(),1);function Z(){let{deleteNodes:p}=B(),d=E(),c=L(),h=N(),I=S(),v=k(),{link:g="",label:j=""}=_("host",c.hostId||""),y=(0,m.useCallback)(()=>{let o=new URLSearchParams(h.search);d?.organizationId&&o.set(C,d.organizationId);let T=`/investigate/${c.id}?${o.toString()}`;I(T)},[h.search,I,c.id,d]),ee=(0,m.useCallback)(()=>{let o=U("host",c.hostId||"");y(),p([o])},[y,p,c.hostId]);if(!v||!("host"in v)||!v.host)return null;let{host:oe,atTime:te,id:ae}=v,a=x(oe),t=J(a),re=a.dns?.reverse_dns?.names?.[0],ne=a.dns?.names?.[0],se=a.operating_system?.product,ie=(0,m.useMemo)(()=>O(a),[a]),u=(0,m.useMemo)(()=>!a.services||a.services.length===0?[]:a.services.map(o=>{let T=`${g}#${V(o)}`;return{label:$(o),href:T,hasThreats:o.threats?.some(le=>le.name?.trim()!=="")??!1,hasCves:!!o.vulns?.length,cveSeverity:X(o.vulns)}}),[a.services,g]);return(0,e.jsxs)(H,{title:"Host Node",onClose:y,actions:(0,e.jsxs)(G,{children:[(0,e.jsx)(Q,{link:g,label:j}),(0,e.jsx)(W,{onDelete:ee})]}),children:[(0,e.jsx)("div",{className:l.section,children:(0,e.jsx)(Y,{assetType:"host",id:ae,atTime:te,tags:ie})}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(b,{icon:"file-list-2-line",size:"md",className:l.sectionHeaderIcon}),(0,e.jsx)(n,{variant:r.H3,children:"Summary"})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(s,{label:"Location",content:t.countryCode?(0,e.jsxs)("div",{className:l.locationValue,children:[(0,e.jsx)(P,{countryCode:t.countryCode}),(0,e.jsx)(n,{variant:r.DEFAULT,children:t.location})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:`${u.length} ${F("Service",u.length)}`,content:u.length>0?(0,e.jsx)(q,{tagSize:"sm",tags:u.map(o=>({...o,label:(0,e.jsx)(n,{variant:r.DEFAULT,children:o.label}),contentLeft:(0,e.jsxs)(e.Fragment,{children:[o.hasCves&&o.cveSeverity&&(0,e.jsx)(K,{size:"sm","aria-label":"CVE found on this service",severity:o.cveSeverity}),o.hasThreats&&(0,e.jsx)(M,{size:"sm","aria-label":"Threat found on this service"})]})})),maxVisibleRows:3}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Reverse DNS",content:re||(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Forward DNS",content:ne||(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"OS",content:se||(0,e.jsx)(i,{})})]})]}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(b,{icon:"organization-chart",size:"md"}),(0,e.jsx)(n,{variant:r.H3,children:"Network"})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(s,{label:"WHOIS Network",content:t.whois.network.name?(0,e.jsxs)("div",{children:[(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.network.name}),t.whois.network.handle&&(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.network.handle})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"WHOIS Organization",content:t.whois.organization.name?(0,e.jsxs)("div",{children:[(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.organization.name}),t.whois.organization.handle&&(0,e.jsx)(n,{variant:r.DEFAULT,children:t.whois.organization.handle})]}):(0,e.jsx)(i,{})}),(0,e.jsx)(s,{label:"Autonomous System",content:t.autonomousSystem||(0,e.jsx)(i,{})})]})]})]})}function de(){let p=S(),d=z(),c=D(d)?d.data.message:"Unknown error",h=(0,m.useCallback)(()=>{p(-1)},[p]);return(0,e.jsx)(H,{title:"Host Node",onClose:h,children:(0,e.jsx)(R,{iconName:"server",title:c})})}export{de as ErrorBoundary,Z as default};
