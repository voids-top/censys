import{a as gt}from"/censys/build/_shared/chunk-JBYFDD3C.js";import{a as ht}from"/censys/build/_shared/chunk-O3F6VABR.js";import{a as Mt,b as Pt}from"/censys/build/_shared/chunk-VJO7D5U3.js";import{d as ut}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{b as It}from"/censys/build/_shared/chunk-OGHUWDRA.js";import"/censys/build/_shared/chunk-XSZMCSJH.js";import"/censys/build/_shared/chunk-4KKS33MW.js";import"/censys/build/_shared/chunk-IUMSQHOS.js";import"/censys/build/_shared/chunk-AEM63NKL.js";import{a as St}from"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as le}from"/censys/build/_shared/chunk-IC5AY47K.js";import{c as V,r as H}from"/censys/build/_shared/chunk-B5UNN2SO.js";import"/censys/build/_shared/chunk-TUDXVIEL.js";import"/censys/build/_shared/chunk-7C4UGOB7.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-JDWADSGD.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-4WX73TCZ.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-5OP2ERYU.js";import"/censys/build/_shared/chunk-LOKTUJJ3.js";import"/censys/build/_shared/chunk-BU2LL35M.js";import"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-FP2KPINM.js";import"/censys/build/_shared/chunk-VKYVKQW2.js";import"/censys/build/_shared/chunk-OQUAXVLV.js";import{a as mt}from"/censys/build/_shared/chunk-BWODHJE6.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import{c as b,d as Ct}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-XTODG4BZ.js";import{s as $}from"/censys/build/_shared/chunk-426SZY5O.js";import{a as dt}from"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import{b as K}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import"/censys/build/_shared/chunk-ST66DGSY.js";import{B as Lt,F as Ot,x as g}from"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{$ as At,A as O,B as Rt,E as lt,G as U,ea as ct,gb as I,ta as w,ua as pt,wa as Nt,xa as _t,y as Tt,z as d}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{a as ot,i as st,k as nt,p as it,z as Et}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as L}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as at}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{c as Re,e as A}from"/censys/build/_shared/chunk-2TWE7TSA.js";var Vt=Re(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.TacticType_Value=_.ThreatType_Value=_.OperatingSystemAttributeType_Value=_.HardwareAttributeType_Value=_.SoftwareAttributeType_Value=void 0;_.SoftwareAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",BOTNET_SERVER:"BOTNET_SERVER",WEB_SERVER:"WEB_SERVER",WEB_UI:"WEB_UI",HOSTING_WEB_UI:"HOSTING_WEB_UI",WEB_TECHNOLOGY:"WEB_TECHNOLOGY",SCADA:"SCADA",CRYPTOCURRENCY:"CRYPTOCURRENCY",DATABASE:"DATABASE",HONEYPOT:"HONEYPOT",HYPERVISOR:"HYPERVISOR",OUT_OF_BOUND_MANAGEMENT:"OUT_OF_BOUND_MANAGEMENT",PROXY_SERVER:"PROXY_SERVER",VOIP:"VOIP",MEDICAL:"MEDICAL",WAF:"WAF",BUILDING_AUTOMATION:"BUILDING_AUTOMATION",P2P_SHARING:"P2P_SHARING",REMOTE_ACCESS:"REMOTE_ACCESS",IOT:"IOT",EMAIL:"EMAIL",MESSAGE_BROKER:"MESSAGE_BROKER",VPN:"VPN",FILE_SHARING:"FILE_SHARING",MEDIA_SERVER:"MEDIA_SERVER",CMS:"CMS",LOAD_BALANCER:"LOAD_BALANCER",LMS:"LMS",GAME_SERVER:"GAME_SERVER",REMOTE_DESKTOP:"REMOTE_DESKTOP",EMR:"EMR",AI:"AI",PRINT_SERVER:"PRINT_SERVER",KVM:"KVM",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.HardwareAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",SOHO:"SOHO",VPN:"VPN",FIREWALL:"FIREWALL",CAMERA:"CAMERA",MEDICAL_DEVICE:"MEDICAL_DEVICE",NETWORK:"NETWORK",PROCESSOR:"PROCESSOR",SERVER:"SERVER",ICS:"ICS",ROUTER:"ROUTER",SERIAL_GATEWAY:"SERIAL_GATEWAY",SWITCH:"SWITCH",LOAD_BALANCER:"LOAD_BALANCER",NAS:"NAS",CELLULAR_MODEM:"CELLULAR_MODEM",HMI:"HMI",SENSOR:"SENSOR",PRINTER:"PRINTER",BUILDING_AUTOMATION:"BUILDING_AUTOMATION",HVAC:"HVAC",ACCESS_CONTROL:"ACCESS_CONTROL",SECURITY_ALARM:"SECURITY_ALARM",FIRE_ALARM:"FIRE_ALARM",PLC:"PLC",MEDICAL:"MEDICAL",RADIO:"RADIO",IMAGING:"IMAGING",ELECTRICAL:"ELECTRICAL",POWER_METER:"POWER_METER",POWER_TRANSFORMER:"POWER_TRANSFORMER",POWER_RELAY:"POWER_RELAY",POWER_PLANT_CONTROLLER:"POWER_PLANT_CONTROLLER",POWER_DISTRIBUTION_UNIT:"POWER_DISTRIBUTION_UNIT",UPS:"UPS",EV_CHARGER:"EV_CHARGER",OIL_AND_GAS:"OIL_AND_GAS",OIL_WELL:"OIL_WELL",GAS_WELL:"GAS_WELL",PIPELINE:"PIPELINE",PUMP:"PUMP",FLOW_METER:"FLOW_METER",VALVE:"VALVE",TANK:"TANK",WATER:"WATER",WATER_PUMP:"WATER_PUMP",WATER_TREATMENT_PLANT_CONTROLLER:"WATER_TREATMENT_PLANT_CONTROLLER",TELECOM:"TELECOM",BASE_STATION:"BASE_STATION",SATELLITE_EQUIPMENT:"SATELLITE_EQUIPMENT",ANTENNA_CONTROLLER:"ANTENNA_CONTROLLER",NVR:"NVR",FINANCIAL:"FINANCIAL",AGRICULTURE:"AGRICULTURE",AUTOMOTIVE_AND_TRANSPORTATION:"AUTOMOTIVE_AND_TRANSPORTATION",FLEET_MANAGEMENT_CONTROLLER:"FLEET_MANAGEMENT_CONTROLLER",IOT:"IOT",SMART_HOME_CONTROLLER:"SMART_HOME_CONTROLLER",POLICE_AND_LAW:"POLICE_AND_LAW",POLICE_SCANNERS:"POLICE_SCANNERS",LAWFUL_INTERCEPT:"LAWFUL_INTERCEPT",ALPR:"ALPR",SCADA:"SCADA",OIL_WELL_CONTROLLER:"OIL_WELL_CONTROLLER",GAS_WELL_CONTROLLER:"GAS_WELL_CONTROLLER",GAS_STATION_CONTROLLER:"GAS_STATION_CONTROLLER",PUMP_CONTROLLER:"PUMP_CONTROLLER",PLANT_CONTROLLER:"PLANT_CONTROLLER",REFRIGERATION:"REFRIGERATION",WIND_TURBINE_CONTROLLER:"WIND_TURBINE_CONTROLLER",SOLAR_INVERTER:"SOLAR_INVERTER",CPE:"CPE",KVM:"KVM",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.OperatingSystemAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",NAS:"NAS",FIREWALL:"FIREWALL",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.ThreatType_Value={UNSPECIFIED:"UNSPECIFIED",C2_SERVER:"C2_SERVER",DECEPTIVE_SERVER:"DECEPTIVE_SERVER",PHISHING_SERVER:"PHISHING_SERVER",BOTNET_SERVER:"BOTNET_SERVER",SECURITY_TOOL:"SECURITY_TOOL",WEBSHELL:"WEBSHELL",CRYPTOMINING:"CRYPTOMINING",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.TacticType_Value={UNSPECIFIED:"UNSPECIFIED",RECONNAISSANCE:"RECONNAISSANCE",RESOURCE_DEVELOPMENT:"RESOURCE_DEVELOPMENT",INITIAL_ACCESS:"INITIAL_ACCESS",EXECUTION:"EXECUTION",PERSISTENCE:"PERSISTENCE",PRIVILEGE_ESCALATION:"PRIVILEGE_ESCALATION",DEFENSE_EVASION:"DEFENSE_EVASION",CREDENTIAL_ACCESS:"CREDENTIAL_ACCESS",DISCOVERY:"DISCOVERY",LATERAL_MOVEMENT:"LATERAL_MOVEMENT",COLLECTION:"COLLECTION",COMMAND_AND_CONTROL:"COMMAND_AND_CONTROL",EXFILTRATION:"EXFILTRATION",IMPACT:"IMPACT",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"}});var T=A(at(),1);var yt={threatList:"VSBv2"};var ft=A(at(),1);var F={noWrap:"F5J8A",container:"QlSZx",chart:"e519b"};var u=A(L(),1);function Dt({threat:t}){let a=t.counts||[];if(a.length<2)return null;let o=a.map(i=>({datetime:i.timestamp||"",count:BigInt(i.count)})),R=(0,ft.useMemo)(()=>ht(o),[o]),s=`${R} ${St("Day",R)}`;return(0,u.jsxs)("div",{className:F.container,"data-testid":"sparkline-container",children:[(0,u.jsx)("div",{className:F.chart,children:(0,u.jsx)(gt,{title:t.name,stats:o,colors:["var(--color-theme-brand-peach)"]})}),(0,u.jsxs)(O,{variant:d.H6,className:F.noWrap,"data-testid":"sparkline-H6",children:["Trend | ",s]})]})}var p={bodyContainer:"KaQbs",contentLeft:"k-Y0M",threatName:"oqTPS",contentRight:"_3WDEf",contentColumn:"jINDA",contentColumnTitle:"_81Lkz",description:"_0Nlu3",trendColumn:"ZQ-p5",countColumn:"E8ptc",countContainer:"NW2ox",countLink:"i29sf"};var E=A(L(),1);function vt({threat:t}){let a=t.counts?.length>0?t.counts[t.counts.length-1].count:0,o=Ot(t.name);return(0,E.jsx)(_t,{variant:pt.INTERACTIVE,bodyPadding:Nt.NONE,"data-testid":"threat-card",children:(0,E.jsxs)("div",{className:p.bodyContainer,children:[(0,E.jsxs)(K,{"aria-label":`Navigate to ${t.name}`,to:`/explore/threats/${t.id}`,className:p.contentLeft,children:[(0,E.jsx)("div",{className:p.iconColumn,children:(0,E.jsx)(Pt,{})}),(0,E.jsxs)("div",{className:p.contentColumn,children:[(0,E.jsxs)("div",{className:p.contentColumnTitle,children:[(0,E.jsx)(O,{variant:d.H2,className:p.threatName,"data-testid":"threat-H2",children:$(t.name,100)}),ut(t.addedAt)?(0,E.jsx)(Mt,{}):null]}),t.description&&(0,E.jsx)(O,{variant:d.SMALL,className:p.description,"data-testid":"threat-DEFAULT",children:$(t.description,205)})]})]}),(0,E.jsxs)("div",{className:p.contentRight,children:[(0,E.jsx)("div",{className:p.trendColumn,children:(0,E.jsx)(Dt,{threat:t})}),(0,E.jsxs)("div",{className:p.countColumn,children:[(0,E.jsx)("div",{className:p.countContainer,children:(0,E.jsx)(K,{"data-testid":"threat-count",className:p.countLink,to:o,target:"_blank",rel:"noopener noreferrer",children:a.toLocaleString()})}),(0,E.jsx)(O,{variant:d.H6,children:"Asset Count"})]})]})]})},t.id)}var Ut={empty:"OVim-"};var q=A(L(),1);function Q(){return(0,q.jsx)("div",{className:Ut.empty,"data-testid":"threats-no-results",children:(0,q.jsx)(b,{iconName:"bug",iconMode:"line",title:"There are no threats to display",children:"Try adjusting your search and try again."})})}var G=A(L(),1);function X({threats:t,isLoading:a}){return(0,G.jsx)("div",{className:yt.threatList,"data-testid":"threats-list",children:t.length>0?t.map(o=>(0,G.jsx)(vt,{isLoading:a,threat:o},o.id)):(0,G.jsx)(Q,{})})}var bt=A(Vt(),1),Ht=bt.ThreatType_Value;var C="ALL_THREATS",S="threatType",h="threatActors",M="threatNames",Gt={light:"#FFFFFF",dark:"#000000"},Ft=["#FDF4F3","#FFE9E9","#F7D2D1","#F2BBBA","#FC5A54","#F54A47","#E53430","#D51D18","#A5130E","#760804"],Wt={light:["#c1c5cb",...Ft],dark:["#343a40",...Ft]},Bt="rgba(71, 5, 2, 0.5)",W="threatTime";function pe(t){return t.split("_").map(a=>a.toLocaleLowerCase()).map(dt).join(" ")}var xt=Object.values({...Ht,[C]:C}).filter(t=>t!=="UNRECOGNIZED_ENUM_KEY").sort((t,a)=>t.localeCompare(a)).map(t=>({value:t,label:pe(t)})),B=Object.values(["7","14"]).map(t=>({value:t,label:`Last ${t} Days`})),Z="asc",j="desc",z="addedAtDesc",Yt=[{value:z,label:"Recently created first"},{value:j,label:"Asset Count (Highest First)"},{value:Z,label:"Asset Count (Lowest First)"}];var c={threatsByCountry:"_57qme",cardSubHeader:"p5e3l",mapFilterHeader:"Rm-ys",mapFilterContainer:"quCXo",threatTypeSelectContainer:"_69unf",threatActorsSelectContainer:"o-dLJ",threatNamesSelectContainer:"CuLqn",threatsListContainer:"RI1Oo",threatsListActions:"_5w74a",threatsListFilters:"uh57B",sortSelect:"gasSt"};function Ne(t,a,o,R=[]){let s=[],i=t==="host"?"host.services":"web";return(!a||a===C)&&!o.length&&!R.length&&s.push(`${i}.threats.name: *`),a&&a!==C&&s.push(g({kind:0,field:`${i}.threats.type`,value:a})),o.length>0&&s.push(g({kind:4,field:`${i}.threats.actors.primary_name`,values:o})),R.length>0&&s.push(g({kind:4,field:`${i}.threats.name`,values:R})),s}function kt(t,a,o=[],R){let s=Ne("host",t,a,o);return R&&s.unshift(g({kind:0,field:"host.location.country_code",value:R})),s.reduce((i,N)=>Lt(i,N),"")}function wt({threats:t,searchQuery:a,sortBy:o}){let R=[...t];if(a){let s=a.toLowerCase();R=R.filter(i=>i.name.toLowerCase().includes(s)||i.description?.toLowerCase().includes(s))}return o===z?R.sort((s,i)=>{let N=s.addedAt?new Date(s.addedAt).getTime():-1/0;return(i.addedAt?new Date(i.addedAt).getTime():-1/0)-N}):R.sort((s,i)=>{let N=s.counts[s.counts.length-1]?.count??0,l=i.counts[i.counts.length-1]?.count??0;return o===Z?N-l:l-N}),R}var Le=A(le(),1),e=A(L(),1),y="/explore/threats";function Kt(){let{countsByCountry:t,otherCount:a,actors:o,names:R,threats:s}=Et(),{state:i}=st(),N=Ct(),[l]=it(),[f,J]=(0,T.useState)([]),[D,tt]=(0,T.useState)([]),[P,et]=(0,T.useState)(l.get(S)||C),[$t,qt]=(0,T.useState)(B.find(r=>r.value===l.get(W))?.value||B[0].value),[Qt,Xt]=(0,T.useState)(!1),[x,Zt]=(0,T.useState)(""),[Y,jt]=(0,T.useState)(j);(0,T.useEffect)(()=>{Xt(!0)},[]);let zt=(0,T.useMemo)(()=>o.map(r=>({value:r,label:r})),[o]),Jt=(0,T.useMemo)(()=>R.map(r=>({value:r,label:r})),[R]);(0,T.useEffect)(()=>{let r=l.get(h)?.split(",").filter(Boolean)||[];J(r.map(n=>({value:n,label:n})))},[l]),(0,T.useEffect)(()=>{let r=l.get(M)?.split(",").filter(Boolean)||[];tt(r.map(n=>({value:n,label:n})))},[l]),(0,T.useEffect)(()=>{et(l.get(S)||C)},[l]);let rt=(0,T.useMemo)(()=>wt({threats:s,searchQuery:x,sortBy:Y}),[s,x,Y]),te=r=>{let n=new URLSearchParams(l);r&&r!==C?n.set(S,r):n.delete(S),et(r),N(`${y}?${n.toString()}`)},ee=r=>{let n=new URLSearchParams(l);r.length>0?n.set(h,r.map(v=>v.value).join(",")):n.delete(h),J(r),N(`${y}?${n.toString()}`)},re=r=>{let n=new URLSearchParams(l);r.length>0?n.set(M,r.map(v=>v.value).join(",")):n.delete(M),tt(r),N(`${y}?${n.toString()}`)},ae=r=>{let n=new URLSearchParams(l);n.set(W,r),qt(r),N(`${y}?${n.toString()}`)},oe=()=>{let r=new URLSearchParams(l);r.delete(S),r.delete(h),r.delete(M),N(`${y}?${r.toString()}`)},se=r=>{Zt(r.target.value)},ne=r=>{jt(r)},m=i==="loading",ie=P&&P!==C||f.length>0||D.length>0,Ee=(0,T.useCallback)(r=>{let n=kt(P,f.map(k=>k.value),D.map(k=>k.value),r);return`/censys?q=${encodeURIComponent(n)}`},[P,f,D]),Te=Object.keys(t).length;return(0,e.jsx)(H,{breadcrumbs:[{pathName:"Explore"}],children:(0,e.jsxs)(V,{children:[(0,e.jsx)("div",{"data-testid":"threats-filter-controls",children:(0,e.jsxs)("div",{className:c.mapFilterHeader,children:[(0,e.jsx)(O,{variant:d.H1,children:"Threats"}),(0,e.jsxs)("div",{className:c.mapFilterContainer,children:[(0,e.jsx)("div",{className:c.threatTypeSelectContainer,children:(0,e.jsx)(U,{"data-testid":"threat-type-select",valueProps:{placeholder:"Threat Type"},contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Type"}),name:S,disabled:m,options:xt,value:P,onValueChange:te})}),(0,e.jsx)("div",{className:c.threatNamesSelectContainer,children:(0,e.jsx)(w,{"data-testid":"threat-names-select",name:M,disabled:m,options:Jt,selectedOptions:D,onChange:re,contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Name"}),className:c.multiselect})}),(0,e.jsx)("div",{className:c.threatActorsSelectContainer,children:(0,e.jsx)(w,{"data-testid":"threat-actors-select",name:h,disabled:m,options:zt,selectedOptions:f,onChange:ee,contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Group"}),className:c.multiselect})}),ie&&(0,e.jsx)(At,{"data-testid":"clear-filters-button",variant:Rt.TERTIARY,onClick:oe,disabled:m,children:"Clear Filters"})]})]})}),(0,e.jsx)(It,{countsByCountryCode:t,strokeColor:Gt,colorRange:Wt,dotColor:Bt,getUrlForCountry:Ee,renderMap:Qt,label:"Hosts with Threat",bucketCount:Te,mapTitle:"Hosts with Threats by Country",tableTitle:"Hosts with Threats by Country",otherCount:a,shouldDisplayOtherCount:!1}),(0,e.jsxs)("div",{className:c.threatsListContainer,children:[(0,e.jsxs)("div",{className:c.threatsListActions,children:[(0,e.jsx)("div",{className:c.results,children:(0,e.jsxs)(O,{variant:d.H2,children:["Threat Results:"," ",(0,e.jsx)(ct,{value:rt.length})]})}),(0,e.jsxs)("div",{className:c.threatsListFilters,children:[(0,e.jsx)("div",{children:(0,e.jsx)(lt,{type:"search","data-testid":"threats-search-input",placeholder:"Search threats...",value:x,onChange:se,className:c.searchInput,disabled:m,contentLeft:(0,e.jsx)(Tt,{name:"search",mode:"line"}),isFullWidth:!0})}),(0,e.jsx)("div",{className:c.sortSelect,children:(0,e.jsx)(U,{"data-testid":"threat-sort-select",contentLeft:(0,e.jsx)(I,{icon:"sort-desc"}),name:"sort",disabled:m,options:Yt,value:Y,onValueChange:ne})}),(0,e.jsx)("div",{children:(0,e.jsx)(U,{valueProps:{placeholder:"Time Period"},contentLeft:(0,e.jsx)(I,{iconName:"time",iconMode:"line",label:"Time Period"}),name:W,disabled:m,options:B,value:$t,onValueChange:ae})})]})]}),(0,e.jsx)(X,{threats:rt,isLoading:m})]})]})})}function _e(){let t=nt(),a=[{pathName:"Investigate"}],o="Error Loading Threat Data";return ot(t)?(t.status===400&&(o="Invalid Request"),(0,e.jsx)(H,{breadcrumbs:a,children:(0,e.jsx)(V,{children:(0,e.jsx)(b,{iconName:"alert",title:o,children:(0,e.jsx)(O,{children:"We encountered a problem while loading the threat information. Please try again later."})})})})):(0,e.jsx)(H,{breadcrumbs:a,children:(0,e.jsx)(V,{children:(0,e.jsx)(mt,{error:t})})})}export{_e as ErrorBoundary,Kt as default};
