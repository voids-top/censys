import{a as L,b as _,c as I,d as b,e as N}from"/censys/build/_shared/chunk-FNYWC6WO.js";import{a as S}from"/censys/build/_shared/chunk-AKZYFWPJ.js";import{a as x,b as p,c,d as O}from"/censys/build/_shared/chunk-IE2JXLET.js";import"/censys/build/_shared/chunk-QNALHZER.js";import{a as A}from"/censys/build/_shared/chunk-JC22C2KM.js";import{e as R}from"/censys/build/_shared/chunk-6D64NL5L.js";import"/censys/build/_shared/chunk-BS7TM7GR.js";import{a as M}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-2HEEQCOO.js";import"/censys/build/_shared/chunk-ELSFEUI2.js";import{a as H}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import"/censys/build/_shared/chunk-DSG73WCA.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import"/censys/build/_shared/chunk-HUE44QRB.js";import"/censys/build/_shared/chunk-Z3PARXZG.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-NJXUBBUP.js";import"/censys/build/_shared/chunk-437XWWKH.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-WJEUPJRQ.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-EZHABQF2.js";import"/censys/build/_shared/chunk-2RV3CGNA.js";import"/censys/build/_shared/chunk-OZE6EA6M.js";import"/censys/build/_shared/chunk-HNL4CPAB.js";import{e as D}from"/censys/build/_shared/chunk-D5QEORL2.js";import"/censys/build/_shared/chunk-VQ4M4AGG.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import"/censys/build/_shared/chunk-GALQBYYN.js";import{c as E}from"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as P,e as g,i as h,k as v,p as y,z as T}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as w,c as C}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as m}from"/censys/build/_shared/chunk-2QEWK57A.js";var s=m(w(),1);function l(o){return o&&typeof o.then=="function"?o:Promise.resolve(o)}var q=m(M(),1),r=m(C(),1);function $(){let o=T(),n=h().state==="loading",t=l(o.host);return(0,r.jsx)(S,{fallback:(0,r.jsx)(I,{}),isLoading:n,resolve:t,children:e=>(0,r.jsx)(U,{data:{certId:o.certId,timestamp:o.timestamp,host:e}})})}var U=({data:o})=>{let{certId:a,timestamp:n,host:t}=o,[e]=y(),d=g(),u=e.get(p),f=e.get(c),i=(0,s.useMemo)(()=>N(t,u,f),[t,u,f]),k=(0,s.useCallback)(()=>{e.delete(x),e.delete(p),e.delete(c),e.delete(O);let B=`/certificates/${a}/history?${e}`;d(B)},[e,d,a]);return(0,r.jsx)(_,{displayName:t.ip,type:"host",port:i?.port,protocol:i?.protocol,transportProtocol:i?.transport_protocol,onClose:k,timestamp:n,threatCount:b(t),serviceCount:t.services.length,jarm:i?.jarm?.fingerprint,bannerHash:i?.banner_hash_sha256,network:t.autonomous_system&&`${t.autonomous_system.name} (${t.autonomous_system.asn})`})};function j(){let o=v(),a=D(),n=(0,s.useContext)(E),t=()=>P(o)&&R(o.data)?(0,r.jsx)(A,{accessState:a,errorCode:o.data.code,env:n}):(0,r.jsx)(H,{error:o});return(0,r.jsx)("div",{className:L.panel,children:t()})}export{j as ErrorBoundary,$ as default};
