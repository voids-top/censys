import{a as ue}from"/censys/build/_shared/chunk-XZG736LL.js";import"/censys/build/_shared/chunk-77LARZVO.js";import{a as be}from"/censys/build/_shared/chunk-ZIRXA77W.js";import{a as Ae}from"/censys/build/_shared/chunk-PIXRIREJ.js";import{a as Me}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-6GD6JLZ2.js";import{c as F}from"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as fe}from"/censys/build/_shared/chunk-HG7D3PDC.js";import{a as H}from"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-HLRAT4GD.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as he}from"/censys/build/_shared/chunk-W2GUOEY7.js";import{h as D}from"/censys/build/_shared/chunk-FQAS3FYV.js";import{b as me}from"/censys/build/_shared/chunk-P2FXGQA2.js";import{c as ce}from"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import{h as U}from"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as S,B as h,C as W,Ha as se,Ja as le,Oa as z,Pa as de,Ta as A,aa as Y,ba as te,da as B,ha as $,ia as re,ja as ae,mb as pe,na as ne,oa as k,pa as ie,qa as g,y as w}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{C as oe,t as j,z as ee}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as L,c as u}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as n}from"/censys/build/_shared/chunk-2QEWK57A.js";var Ne=n(L(),1);var v=n(L(),1);var O=n(L(),1);function ge(o,r){let[s,c]=(0,O.useState)({}),[T,m]=(0,O.useState)([]),_=(0,O.useCallback)(a=>()=>{c(e=>{let t=e[a],i={...e};return t===k.ASCENDING?i[a]=k.DESCENDING:t===k.DESCENDING?delete i[a]:i[a]=k.ASCENDING,i}),m(e=>{let t=e.filter(i=>i!==a);return a in s&&s[a]!==k.NONE?[a,...t]:[a,...e]})},[s]);return{sortedData:(0,O.useMemo)(()=>[...o].sort((a,e)=>{for(let t of T)if(t in s&&r[t]){let i=r[t].internalSort(a,e);if(i!==0)return s[t]===k.ASCENDING?i:-i}return 0}),[o,T,s,r]),sortSettings:s,getSortCallback:_}}var P=n(L(),1);var Te="delete-webhook-form";var G="name",Ce="org",Ee="test-webhook-row-form";var f=n(u(),1);function _e({webhook:o,onClose:r}){let{accessState:s}=(0,P.useContext)(ce),c=(0,P.useCallback)(T=>{T||r()},[r]);return(0,f.jsx)(ne,{open:!!o,onOpenChange:c,header:(0,f.jsxs)(h,{variant:S.H2,children:["Are you sure you want to delete"," ",o?.display_name||"this Webhook","?"]}),footerActions:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Y,{variant:W.DEFAULT,onClick:r,children:"No, keep it"}),(0,f.jsxs)(j,{method:"post",onSubmit:r,children:[(0,f.jsx)("input",{hidden:!0,name:G,value:o?.name,readOnly:!0}),(0,f.jsx)("input",{hidden:!0,name:Ce,value:s?.organization?.organizationId,readOnly:!0}),(0,f.jsx)("input",{hidden:!0,name:"fetcherKey",value:Te,readOnly:!0}),(0,f.jsx)(F,{}),(0,f.jsx)(Y,{variant:W.ALERT,children:"Yes, delete it"})]})]}),children:(0,f.jsx)(h,{"data-testid":"delete-webhook-modal-body",children:"This action is permanent and you will lose all data associated with this webhook."})})}var R=o=>o.substring(o.lastIndexOf("/")+1);var l={tableCell:"_4hxL4",headerContent:"_5d-wk",flexStart:"TeJ1t",nameColumn:"r1500",actionColumn:"Ro5yE",subtleText:"CGw8W",date:"J51f5",divider:"_4pea-"};var N=n(u(),1),ke=({timestamp:o})=>(0,N.jsxs)(h,{className:l.date,children:[(0,N.jsx)(se,{timestamp:o}),(0,N.jsx)("div",{className:l.divider,children:(0,N.jsx)(fe,{variant:"line--vertical"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)(le,{timestamp:o,format:"HH:MM UTC"})," UTC"]})]});function ye(o){switch(o){case U.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_SUCCESS:return{variant:z.FEEDBACK_POSITIVE_ICON,text:"Success"};case U.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_FAILURE:return{variant:z.FEEDBACK_NEGATIVE_ICON,text:"Failure"};case U.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_UNRECOGNIZED:default:return null}}var E=n(L(),1);var V=n(u(),1);function Z({isVisible:o,statusCode:r,editHref:s,webhookDisplayName:c,onOpenChange:T,isSuccess:m}){if(!o)return null;let _=m?`${c} Test was Successful`:`${c} Test Returned an Error`,C=m?$.SUCCESS:$.CAUTION,a=r?`The test returned a ${r} response.`:"The webhook test failed to complete.";return(0,V.jsx)(ae,{title:_,variant:C,behavior:re.DISMISSIVE,onOpenChange:T,action:{node:(0,V.jsx)(me,{to:s,children:"Webhook Configuration"}),altText:"View Webhook Configuration"},children:(0,V.jsx)(h,{variant:S.DEFAULT,children:a})})}var q={actionsMenuButton:"_1ZxWY",deleteButton:"HT5X6"};var d=n(u(),1);function Se({webhook:o,onDeleteWebhook:r}){let{name:s,display_name:c}=o,T=R(s),m=oe(),[_,C]=(0,E.useState)(!1),a=(0,E.useRef)(null);(0,E.useEffect)(()=>{m.data&&C(!0)},[m.data]);let e=m.data?.state===0?m.data?.statusCode:null,t=e!==null&&e>=200&&e<300,i=(0,E.useCallback)(I=>{I||C(!1)},[]),y=(0,E.useCallback)(()=>r(o),[o,r]),x=(0,E.useCallback)(()=>{C(!1),a.current?.requestSubmit()},[a,C]),K=`/settings/webhooks/${T}/edit`;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(m.Form,{method:"post",ref:a,children:[(0,d.jsx)("input",{type:"hidden",name:"fetcherKey",value:Ee}),(0,d.jsx)("input",{type:"hidden",name:G,value:o.name}),(0,d.jsx)(F,{})]}),(0,d.jsxs)(pe,{trigger:(0,d.jsx)(B,{"aria-label":`Actions for ${c}`,className:q.actionsMenuButton,iconName:"more-2",iconMode:"fill",size:te.LARGE,variant:W.GHOST}),children:[(0,d.jsx)(A,{content:"Configure webhook",children:(0,d.jsx)(H,{link:{to:K},iconButton:{iconName:"pencil",iconMode:"line",variant:W.GHOST,["aria-label"]:`Configure ${c}`}})}),(0,d.jsx)(A,{content:"Test webhook",children:(0,d.jsx)(B,{"aria-label":`Test webhook ${c}`,"data-testid":"test-webhook",iconName:"flashlight",iconMode:"line",variant:W.GHOST,onClick:x})}),(0,d.jsx)(A,{content:"Remove webhook",children:(0,d.jsx)(B,{"aria-label":`Remove ${c}`,"data-testid":"remove-webhook",iconName:"delete-bin-6",iconMode:"line",className:q.deleteButton,variant:W.ALERT,onClick:y})})]}),(0,d.jsx)(Z,{isVisible:_,statusCode:e,editHref:K,webhookDisplayName:o.display_name,onOpenChange:i,isSuccess:t})]})}var p=n(u(),1);function J({webhook:o,onDeleteWebhook:r}){let{display_name:s,status:c,name:T,collection_id_count:m,created_by:_,last_triggered:C}=o,{users:a}=D(),t=`/settings/webhooks/${R(T)}/logs`,i=ye(c),y=a.get(_),x=y&&ue(y),I=(0,p.jsx)(A,{content:m===0?"Add Collection":"Awaiting Trigger",children:(0,p.jsx)(h,{className:l.subtleText,children:"N/A"})});return(0,p.jsxs)(g.Row,{className:l.tableRow,"data-testid":`webhook-${T}`,children:[(0,p.jsx)(g.Cell,{className:l.nameColumn,children:(0,p.jsx)(he,{href:t,children:s||"Unnamed Webhook"})}),(0,p.jsx)(g.Cell,{className:w(l.tableCell,l.flexStart),children:x&&(0,p.jsx)(h,{children:x})}),(0,p.jsx)(g.Cell,{className:l.tableCell,children:(0,p.jsx)(h,{className:m===0?l.subtleText:"",children:m})}),(0,p.jsx)(g.Cell,{className:l.tableCell,children:C?(0,p.jsx)(ke,{timestamp:C}):I}),(0,p.jsx)(g.Cell,{className:l.tableCell,children:i?(0,p.jsx)(de,{variant:i.variant,size:"sm",children:i.text}):I}),(0,p.jsx)(g.Cell,{className:l.actionColumn,children:(0,p.jsx)(Se,{webhook:o,onDeleteWebhook:r})})]})}var We=[{id:"display_name",label:"Webhook Name",type:"text",className:"flexStart"},{id:"created_by",label:"Creator",type:"text",className:"flexStart"},{id:"collection_id_count",label:"Total Collections",type:"text"},{id:"last_triggered",label:"Last Triggered",type:"text"},{id:"status",label:"Last Delivered",type:"text"},{id:"actions",label:"",type:"actions",className:"actionColumn"}];var b=n(u(),1);function Q({data:o}){let{users:r}=D(),[s,c]=(0,v.useState)(null),{sortedData:T,sortSettings:m,getSortCallback:_}=ge(o,{display_name:{internalSort:(e,t)=>e.display_name.localeCompare(t.display_name)},created_at:{internalSort:(e,t)=>e.created_at?t.created_at?e.created_at.localeCompare(t.created_at):-1:1},created_by:{internalSort:(e,t)=>{let i=r.get(e.created_by),y=r.get(t.created_by);return!i||!i.identity.lastName?1:!y||!y.identity.lastName?-1:i.identity.lastName.localeCompare(y.identity.lastName)}},collection_id_count:{internalSort:(e,t)=>e.collection_id_count-t.collection_id_count},last_triggered:{internalSort:(e,t)=>e.last_triggered?t.last_triggered?e.last_triggered.localeCompare(t.last_triggered):-1:1},status:{internalSort:(e,t)=>e.status?t.status?e.status.localeCompare(t.status):-1:1}}),C=(0,v.useCallback)(e=>c(e),[]),a=(0,v.useCallback)(()=>c(null),[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Root,{"data-testid":"webhooks-table",children:[(0,b.jsx)(g.Header,{children:(0,b.jsx)(g.HeaderRow,{children:We.map(e=>(0,b.jsx)(g.HeaderCell,{className:l.tableCell,children:(0,b.jsxs)("div",{className:w(l.headerContent,e.className?l[e.className]:""),children:[(0,b.jsx)(h,{variant:S.DEFAULT_SEMIBOLD,children:e.label}),e.id!=="actions"&&(0,b.jsx)(ie,{value:m[e.id]||k.NONE,onChange:_(e.id),"data-testid":`sort-${e.id}`})]})},e.id))})}),(0,b.jsx)(g.Body,{children:T.map(e=>(0,b.jsx)(J,{webhook:e,onDeleteWebhook:C},e.name))})]}),s&&(0,b.jsx)(_e,{webhook:s,onClose:a})]})}var X={container:"UcbIQ",header:"HT0mq"};var De=n(Ae(),1),Le=n(Me(),1),M=n(u(),1);function Oe(){let{webhooks:o}=ee(),{loadUsers:r}=D();return(0,Ne.useEffect)(()=>{r()},[]),(0,M.jsxs)("div",{className:X.container,children:[(0,M.jsxs)("div",{className:X.header,children:[(0,M.jsx)(h,{variant:S.H2,children:"Manage Webhooks"}),(0,M.jsx)(H,{link:{to:"/settings/webhooks/new"},children:"Create Webhook"})]}),o.length&&(0,M.jsx)(Q,{data:o})]})}export{be as ErrorBoundary,Oe as default};
