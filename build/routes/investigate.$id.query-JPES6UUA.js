import{a as Ae}from"/censys/build/_shared/chunk-6X4NEB7P.js";import"/censys/build/_shared/chunk-CI7LDTJM.js";import{a as B,b as me,c as ye,d as fe,e as ge}from"/censys/build/_shared/chunk-CRA3TGUV.js";import{b as I,c as Q,d as de,i as ue,x as M}from"/censys/build/_shared/chunk-XWEFKGC4.js";import"/censys/build/_shared/chunk-CSKRXOFQ.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import{a as le}from"/censys/build/_shared/chunk-SZRPTSUZ.js";import"/censys/build/_shared/chunk-BXMBML5J.js";import"/censys/build/_shared/chunk-XSZMCSJH.js";import"/censys/build/_shared/chunk-AEM63NKL.js";import"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-OFRBI5JW.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as Re}from"/censys/build/_shared/chunk-IC5AY47K.js";import"/censys/build/_shared/chunk-2C6N3S4L.js";import"/censys/build/_shared/chunk-4NQHWOT6.js";import"/censys/build/_shared/chunk-VDD6BNAJ.js";import"/censys/build/_shared/chunk-B5UNN2SO.js";import"/censys/build/_shared/chunk-TUDXVIEL.js";import"/censys/build/_shared/chunk-7C4UGOB7.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-JDWADSGD.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-4WX73TCZ.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-5OP2ERYU.js";import"/censys/build/_shared/chunk-LOKTUJJ3.js";import"/censys/build/_shared/chunk-BU2LL35M.js";import{l as ie,m as ae}from"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-FP2KPINM.js";import"/censys/build/_shared/chunk-VKYVKQW2.js";import{e as H}from"/censys/build/_shared/chunk-OQUAXVLV.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import{c as ce}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as re}from"/censys/build/_shared/chunk-XTODG4BZ.js";import{n as pe}from"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import{a as oe}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import{f as te}from"/censys/build/_shared/chunk-ST66DGSY.js";import{B as ne,x as se}from"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{A as _,B as q,Xa as v,aa as w,ca as ee,z as S}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import{c as Z}from"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{a as j,c as V,e as x,g as K,k as Y,p as $,w as G,z as W}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as c}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as C}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as r}from"/censys/build/_shared/chunk-2TWE7TSA.js";var g=r(C(),1);var O=r(C(),1);var Le=r(C(),1);var f={queryNode:"WiG1l",header:"MKnSH",titleContainer:"Pw0Qd",countText:"g-9wd",fieldName:"x9ZNK",tooltip:"_0ix32"};var z={"host.services.threats.name":"Threats","host.services.labels.value":"Labels","host.services.protocol":"Protocols","host.services.port":"Ports","host.autonomous_system.name":"Autonomous Systems","host.location.country":"Countries","host.services.jarm.fingerprint":"JARM Fingerprints","host.services.tls.ja3s":"JA3S","host.services.tls.ja4s":"JA4S","host.services.ja4tscan.fingerprint":"JA4TScan Fingerprints","web.threats.name":"Threats","web.labels.value":"Labels","web.endpoints.port":"Ports","web.software.product":"Software Products","web.endpoints.http.html_title":"Page Titles","web.endpoints.endpoint_type":"Applications","web.jarm.fingerprint":"JARM Fingerprints","web.tls.ja3s":"JA3S","web.tls.ja4s":"JA4S","cert.parsed.issuer_dn":"Issuer","cert.parsed.subject_dn":"Subject","cert.labels":"Labels","cert.ever_seen_in_scan":"Ever Seen in Scan","cert.parsed.ja4x":"JA4X"},R=Object.keys(z);var p=r(c(),1);function k({node:t}){let{query:e}=t,{count:s,pairs:o,assetType:n}=e,l=o[0]?.field??"Query",u=o[0]?.value??e.query,a=I(l,60),N=I(u,60),m=(0,Le.useMemo)(()=>{let d=parseInt(s.value,10);return isNaN(d)?0:d},[s]),h=Q({assetType:n,isCapitalized:!0,isPlural:!0,count:m});return(0,p.jsx)("div",{className:f.queryNode,children:(0,p.jsxs)("div",{className:f.header,children:[(0,p.jsx)(le,{assetType:n,size:"lg"}),(0,p.jsxs)("div",{className:f.titleContainer,children:[m>0&&(0,p.jsxs)(_,{variant:S.SMALL_NUMERAL,className:f.countText,children:[pe(m)," ",h]}),(0,p.jsx)(_,{className:f.fieldName,children:(0,p.jsxs)(v,{content:l,triggerClassName:f.tooltip,children:[a,":"]})}),(0,p.jsx)(_,{children:(0,p.jsx)(v,{content:u,triggerClassName:f.tooltip,children:(0,p.jsx)("span",{children:N})})})]})]})})}var E=r(C(),1);var Ne=(t,e,s)=>{let o=D(t,e,s);return`/censys?q=${encodeURIComponent(o)}`},D=(t,e,s)=>{if(typeof e=="string"&&R.includes(e)){let o=se({kind:0,field:e,value:s});return ne(t,o,"and")}return""};var y=r(c(),1);function b({label:t,field:e,query:s,onAddFilter:o}){let{t:n}=Z(),l=(0,E.useMemo)(()=>s&&e&&t&&Ne(s,e,t),[s,e,t]),u=(0,E.useCallback)(()=>t&&o?.(t),[t,o]);return(0,y.jsxs)(y.Fragment,{children:[l&&(0,y.jsx)(v,{content:n("Search"),children:(0,y.jsx)(re,{link:{to:l,isExternal:!0},iconButton:{iconName:"search",iconMode:"line",variant:q.DEFAULT,size:w.SMALL,"aria-label":n("Search")}})}),o&&(0,y.jsx)(v,{content:n("Add Node",{ns:"investigation"}),children:(0,y.jsx)(ee,{iconName:"add",iconMode:"line","aria-label":n("Add Node",{ns:"investigation"}),onClick:u,variant:q.PRIMARY,size:w.SMALL})})]})}var T={loading:"tJPQ6",loadingRow:"zVU9C",loadingSection:"zzMbw"};var L=r(c(),1);function he(){return(0,L.jsx)("div",{className:T.loadingSection,children:Array.from({length:3}).map((t,e)=>(0,L.jsxs)("div",{className:T.loadingRow,children:[(0,L.jsx)(H,{variant:S.H5,width:300}),(0,L.jsx)(H,{variant:S.H5,width:40})]},e))})}var U=r(c(),1);function J(){return(0,U.jsx)("div",{role:"menu","aria-busy":!0,className:T.loading,children:Array.from({length:6}).map((t,e)=>(0,U.jsx)(he,{},e))})}var Se={category:"fyaWR"};var A=r(c(),1);function F({node:t,filters:e,isLoading:s}){let{addQueryNode:o}=M(),n=t.query.query,l=(0,O.useCallback)((a,N)=>{let m=D(n,a,N);o(m)},[o,n]),u=(0,O.useCallback)(a=>e?.[a]?.buckets.length?(0,A.jsx)("div",{className:Se.category,children:(0,A.jsx)(Ae,{field:a,buckets:e[a].buckets,title:z[a],onApplyFilter:l,slots:{actions:b},slotProps:{actions:{field:a,query:t.query.query}}})},a):null,[e,l,t.query.query]);return(0,A.jsxs)("div",{children:[(0,A.jsx)(k,{node:t}),s?(0,A.jsx)(J,{}):R.map(u)]})}var Ee=r(Re(),1),i=r(c(),1);function Te(){let[t]=$(),{deleteNodes:e,nodesById:s}=ue(),o=te(),n=K(),l=V(),u=x(),{filters:a}=W(),N=ae(),m=(0,g.useCallback)(()=>{let P=new URLSearchParams(l.search);o?.organizationId&&P.set(oe,o.organizationId);let _e=`/investigate/${n.id}?${P.toString()}`;u(_e)},[l.search,u,n.id,o]),h=t.get("node_id")??"",d=s[h],Pe=(0,g.useCallback)(async()=>{m(),e([h])},[m,e,h]),Ce=(0,g.useMemo)(()=>`/censys?q=${d?.query?.query}`,[d?.query?.query]),X=N?ie({query:d?.query?.query,source:"investigation"}):void 0;return!d||!de(d)?null:(0,i.jsx)(B,{title:"Query Node",onClose:m,actions:(0,i.jsxs)(me,{children:[X&&(0,i.jsx)(ye,{createCollectionLink:X}),(0,i.jsx)(ge,{link:Ce,label:"See Full Search Results"}),(0,i.jsx)(fe,{onDelete:Pe})]}),children:(0,i.jsx)(g.Suspense,{fallback:(0,i.jsx)(F,{node:d,filters:void 0,isLoading:!0}),children:(0,i.jsx)(G,{resolve:a,children:P=>(0,i.jsx)(F,{node:d,filters:P,isLoading:!1})})})})}function ke(){let t=x(),e=Y(),s=j(e)?e.data.message:"Unknown error",o=(0,g.useCallback)(()=>{t(-1)},[t]);return(0,i.jsx)(B,{title:"Query Node",onClose:o,children:(0,i.jsx)(ce,{iconName:"server",title:s})})}export{ke as ErrorBoundary,Te as default};
