import{a as We}from"/censys/build/_shared/chunk-XZG736LL.js";import"/censys/build/_shared/chunk-AEKKJQLA.js";import{d as Oe}from"/censys/build/_shared/chunk-ZDY6C43A.js";import{a as Ne}from"/censys/build/_shared/chunk-Y5QAV372.js";import{a as K}from"/censys/build/_shared/chunk-4NXR4FZK.js";import"/censys/build/_shared/chunk-BCFPRQGQ.js";import"/censys/build/_shared/chunk-UWRUBCCK.js";import{a as Ve}from"/censys/build/_shared/chunk-PIXRIREJ.js";import"/censys/build/_shared/chunk-FWMMBP3Z.js";import{a as Se}from"/censys/build/_shared/chunk-3W2VQNCA.js";import"/censys/build/_shared/chunk-5PS6SCVZ.js";import"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as Ge}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-Y7NKNUZC.js";import{c as P}from"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-HUE44QRB.js";import"/censys/build/_shared/chunk-Z3PARXZG.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as ye}from"/censys/build/_shared/chunk-NJXUBBUP.js";import{a as V}from"/censys/build/_shared/chunk-437XWWKH.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-ZI7DUXMR.js";import"/censys/build/_shared/chunk-TRPWTN3H.js";import"/censys/build/_shared/chunk-WJEUPJRQ.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as M}from"/censys/build/_shared/chunk-EZHABQF2.js";import"/censys/build/_shared/chunk-2RV3CGNA.js";import{b as ke,h as w}from"/censys/build/_shared/chunk-OZE6EA6M.js";import{b as _e}from"/censys/build/_shared/chunk-HNL4CPAB.js";import{c as Ee}from"/censys/build/_shared/chunk-D5QEORL2.js";import{m as G}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as h,B as N,Ja as ue,La as Ce,Qa as Q,Ra as ge,Va as R,aa as X,ba as pe,da as H,ha as Z,ia as ce,ja as fe,na as he,oa as S,ob as Te,pa as be,qa as c,x as A,y as J,z as D}from"/censys/build/_shared/chunk-GALQBYYN.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{C as me,f as le,t as de}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as L,c as f}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as i}from"/censys/build/_shared/chunk-2QEWK57A.js";var Be=i(L(),1);var B=i(L(),1);var x=i(L(),1);function xe(t,e){let[o,l]=(0,x.useState)({}),[p,d]=(0,x.useState)([]),k=(0,x.useCallback)(s=>()=>{l(a=>{let g=a[s],b={...a};return g===S.ASCENDING?b[s]=S.DESCENDING:g===S.DESCENDING?delete b[s]:b[s]=S.ASCENDING,b}),d(a=>{let g=a.filter(b=>b!==s);return s in o&&o[s]!==S.NONE?[s,...g]:[s,...a]})},[o]);return{sortedData:(0,x.useMemo)(()=>[...t].sort((s,a)=>{for(let g of p)if(g in o&&e[g]){let b=e[g].internalSort(s,a);if(b!==0)return o[g]===S.ASCENDING?b:-b}return 0}),[t,p,o,e]),sortSettings:o,getSortCallback:k}}var Y=i(L(),1);var Le="delete-webhook-form";var $="name",Ae="org",De="test-webhook-row-form";var u=i(f(),1);function Re({webhook:t,onClose:e}){let{accessState:o}=(0,Y.useContext)(Ee),l=(0,Y.useCallback)(p=>{p||e()},[e]);return(0,u.jsx)(he,{open:!!t,onOpenChange:l,header:(0,u.jsxs)(h,{variant:D.H2,children:["Are you sure you want to delete"," ",t?.display_name||"this Webhook","?"]}),footerActions:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(X,{variant:N.DEFAULT,onClick:e,children:"No, keep it"}),(0,u.jsxs)(de,{method:"post",onSubmit:e,children:[(0,u.jsx)("input",{hidden:!0,name:$,value:t?.name,readOnly:!0}),(0,u.jsx)("input",{hidden:!0,name:Ae,value:o?.organization?.organizationId,readOnly:!0}),(0,u.jsx)("input",{hidden:!0,name:"fetcherKey",value:Le,readOnly:!0}),(0,u.jsx)(P,{}),(0,u.jsx)(X,{variant:N.ALERT,children:"Yes, delete it"})]})]}),children:(0,u.jsx)(h,{"data-testid":"delete-webhook-modal-body",children:"This action is permanent and you will lose all data associated with this webhook."})})}var I=i(L(),1);var r={tableRow:"LsALy",expandableRow:"ES-h0",tableCell:"_4hxL4",headerContent:"_5d-wk",flexStart:"TeJ1t",alignLeft:"-tgJw",nameColumn:"r1500",actionColumn:"Ro5yE",subtleText:"CGw8W",date:"J51f5",expandIcon:"rmGHC",expandedRow:"iF0mc",expandedCell:"ICXGg",expandedCellContent:"yy2wR",expandedLink:"kHXjs",leftPadding:"LKo9q",linkContent:"GDyq9",divider:"_4pea-"};var E=i(f(),1),j=({timestamp:t,includeTime:e=!0})=>(0,E.jsxs)(h,{className:r.date,children:[(0,E.jsx)(ue,{timestamp:t}),e&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:r.divider,children:(0,E.jsx)(ye,{variant:"line--vertical"})}),(0,E.jsx)("div",{children:(0,E.jsx)(Ce,{timestamp:t,format:"HH:MM UTC"})})]})]});var ee=i(f(),1),oe=({count:t})=>(0,ee.jsx)(R,{content:t===0?"Add Collection":"Awaiting Trigger",children:(0,ee.jsx)(h,{className:r.subtleText,children:"N/A"})});function we(t){switch(t){case G.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_SUCCESS:return{variant:Q.FEEDBACK_POSITIVE_ICON,text:"Success"};case G.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_FAILURE:return{variant:Q.FEEDBACK_NEGATIVE_ICON,text:"Failure"};case G.WebhookDeliveryLogStatus.WEBHOOK_DELIVERY_LOG_STATUS_UNRECOGNIZED:default:return null}}var y=i(L(),1);var z=i(f(),1);function te({isVisible:t,statusCode:e,editHref:o,webhookDisplayName:l,onOpenChange:p,isSuccess:d}){if(!t)return null;let k=d?`${l} Test was Successful`:`${l} Test Returned an Error`,T=d?Z.SUCCESS:Z.CAUTION,s=e?`The test returned a ${e} response.`:"The webhook test failed to complete.";return(0,z.jsx)(fe,{title:k,variant:T,behavior:ce.DISMISSIVE,onOpenChange:p,action:{node:(0,z.jsx)(_e,{to:o,children:"Webhook Configuration"}),altText:"View Webhook Configuration"},children:(0,z.jsx)(h,{variant:D.DEFAULT,children:s})})}var ae={actionsMenuButton:"_1ZxWY",deleteButton:"HT5X6"};var m=i(f(),1);function Ie({webhook:t,onDeleteWebhook:e}){let{name:o,display_name:l}=t,p=K(o),d=me(),[k,T]=(0,y.useState)(!1),s=(0,y.useRef)(null);(0,y.useEffect)(()=>{d.data&&T(!0)},[d.data]);let a=d.data?.state===0?d.data?.statusCode:null,g=a!==null&&a>=200&&a<300,b=(0,y.useCallback)(v=>{v||T(!1)},[]),O=(0,y.useCallback)(()=>e(t),[t,e]),q=(0,y.useCallback)(()=>{T(!1),s.current?.requestSubmit()},[s,T]),F=`/settings/webhooks/${p}?tab=${"configuration"}`;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(d.Form,{method:"post",ref:s,children:[(0,m.jsx)("input",{type:"hidden",name:"fetcherKey",value:De}),(0,m.jsx)("input",{type:"hidden",name:$,value:t.name}),(0,m.jsx)(P,{})]}),(0,m.jsxs)(Te,{trigger:(0,m.jsx)(H,{"aria-label":`Actions for ${l}`,className:ae.actionsMenuButton,iconName:"more-2",iconMode:"fill",size:pe.LARGE,variant:N.GHOST}),children:[(0,m.jsx)(R,{content:"Configure Webhook",children:(0,m.jsx)(V,{link:{to:F},iconButton:{iconName:"pencil",iconMode:"line",variant:N.GHOST,["aria-label"]:`Configure ${l}`}})}),(0,m.jsx)(R,{content:"Test Webhook",children:(0,m.jsx)(H,{"aria-label":`Test webhook ${l}`,"data-testid":"test-webhook",iconName:"flashlight",iconMode:"line",variant:N.GHOST,onClick:q})}),(0,m.jsx)(R,{content:"Remove Webhook",children:(0,m.jsx)(H,{"aria-label":`Remove ${l}`,"data-testid":"remove-webhook",iconName:"delete-bin-6",iconMode:"line",className:ae.deleteButton,variant:N.ALERT,onClick:O})})]}),(0,m.jsx)(te,{isVisible:k,statusCode:a,editHref:F,webhookDisplayName:t.display_name,onOpenChange:b,isSuccess:g})]})}var n=i(f(),1);function re({webhook:t,onDeleteWebhook:e}){let{display_name:o,status:l,name:p,collection_id_count:d,collection_ids:k,created_by:T,created_at:s,last_triggered:a}=t,{users:g}=w(),{collections:b}=le(),[O,q]=(0,I.useState)(!1),F=K(p),v=we(l),ie=g.get(T),se=ie&&We(ie),He=(0,I.useMemo)(()=>b.filter(_=>k.includes(_.collection_id)),[b,k]),U=d>0,Pe=(0,I.useCallback)(()=>{U&&q(!O)},[U,O]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.Row,{className:A(r.tableRow,U&&r.expandableRow,O&&r.expandedRow),"data-testid":`webhook-${p}`,onClick:Pe,children:[(0,n.jsxs)(c.Cell,{className:A(r.nameColumn,!U&&r.leftPadding),children:[U&&(0,n.jsx)(J,{name:O?"arrow-drop-up":"arrow-drop-down",mode:"line",size:"xl",className:r.expandIcon}),(0,n.jsx)(M,{href:`/settings/webhooks/${F}`,onClick:_=>_.stopPropagation(),children:o||"Unnamed Webhook"})]}),(0,n.jsx)(c.Cell,{className:A(r.tableCell,r.alignLeft),children:se&&(0,n.jsx)(h,{children:se})}),(0,n.jsx)(c.Cell,{className:r.tableCell,children:s&&(0,n.jsx)(j,{timestamp:s.toString(),includeTime:!1})}),(0,n.jsx)(c.Cell,{className:r.tableCell,children:(0,n.jsx)(h,{className:d===0?r.subtleText:"",children:d})}),(0,n.jsx)(c.Cell,{className:r.tableCell,children:a?(0,n.jsx)(j,{timestamp:a.toString()}):(0,n.jsx)(oe,{count:d})}),(0,n.jsx)(c.Cell,{className:r.tableCell,children:v?(0,n.jsx)(ge,{variant:v.variant,size:"sm",children:v.text}):(0,n.jsx)(oe,{count:d})}),(0,n.jsx)(c.Cell,{className:r.actionColumn,onClick:_=>_.stopPropagation(),children:(0,n.jsx)(Ie,{webhook:t,onDeleteWebhook:e})})]}),O&&(0,n.jsx)(c.Row,{className:r.expandedRow,children:(0,n.jsx)(c.Cell,{className:r.expandedCell,colSpan:6,children:(0,n.jsx)("div",{className:r.expandedCellContent,children:He.map(_=>(0,n.jsx)(M,{href:`/collections/${_.collection_id}`,className:r.expandedLink,isExternal:!0,children:(0,n.jsxs)("div",{className:r.linkContent,children:[(0,n.jsx)(J,{name:"stack",mode:"line",size:"md"}),_.name," | ",_.collection_id]})},_.collection_id))})})})]})}var ve=[{id:"display_name",label:"Webhook Name",type:"text",className:"flexStart"},{id:"created_by",label:"Creator",type:"text",className:"flexStart"},{id:"created_at",label:"Created",type:"text"},{id:"collection_id_count",label:"Total Collections",type:"text"},{id:"last_triggered",label:"Last Triggered",type:"text"},{id:"status",label:"Last Delivered",type:"text"},{id:"actions",label:"",type:"actions",className:"actionColumn"}];function Ue(t){return{display_name:{internalSort:(e,o)=>e.display_name.localeCompare(o.display_name)},created_at:{internalSort:(e,o)=>e.created_at?o.created_at?Temporal.Instant.compare(e.created_at,o.created_at):-1:1},created_by:{internalSort:(e,o)=>{let l=t.get(e.created_by),p=t.get(o.created_by);return!l||!l.identity.lastName?1:!p||!p.identity.lastName?-1:l.identity.lastName.localeCompare(p.identity.lastName)}},collection_id_count:{internalSort:(e,o)=>e.collection_id_count-o.collection_id_count},last_triggered:{internalSort:(e,o)=>e.last_triggered?o.last_triggered?Temporal.Instant.compare(e.last_triggered,o.last_triggered):-1:1},status:{internalSort:(e,o)=>e.status?o.status?e.status.localeCompare(o.status):-1:1}}}var C=i(f(),1);function ne({data:t}){let{users:e}=w(),[o,l]=(0,B.useState)(null),{sortedData:p,sortSettings:d,getSortCallback:k}=xe(t,Ue(e)),T=(0,B.useCallback)(a=>l(a),[]),s=(0,B.useCallback)(()=>l(null),[]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(c.Root,{"data-testid":"webhooks-table",children:[(0,C.jsx)(c.Header,{children:(0,C.jsx)(c.HeaderRow,{children:ve.map(a=>(0,C.jsx)(c.HeaderCell,{className:r.tableCell,children:(0,C.jsxs)("div",{className:A(r.headerContent,a.className?r[a.className]:""),children:[(0,C.jsx)(h,{variant:D.DEFAULT_SEMIBOLD,children:a.label}),a.id!=="actions"&&(0,C.jsx)(be,{value:d[a.id]||S.NONE,onChange:k(a.id),"data-testid":`sort-${a.id}`})]})},a.id))})}),(0,C.jsx)(c.Body,{children:p.map(a=>(0,C.jsx)(re,{webhook:a,onDeleteWebhook:T},a.name))})]}),o&&(0,C.jsx)(Re,{webhook:o,onClose:s})]})}var Me={container:"UcbIQ"};var Ke=i(Ve(),1),$e=i(Ge(),1),W=i(f(),1);function Fe(){let{webhooks:t}=Se(),{loadUsers:e}=w(),o=ke("SUPPORT_SITE_URL");return(0,Be.useEffect)(()=>{e()},[]),(0,W.jsxs)("div",{className:Me.container,children:[(0,W.jsx)(Ne,{title:"Manage Webhooks",iconName:"webhooks",rightSlot:(0,W.jsx)(V,{link:{to:"/settings/webhooks/new"},children:"Create Webhook"}),children:(0,W.jsxs)(h,{children:["Use webhooks to receive automated updates whenever assets are added to or removed from your collections. This lets you send Censys data directly to other applications so you can monitor events and automate workflows. Learn how to"," ",(0,W.jsx)(M,{href:`${o}/docs/platform-collections-webhooks`,isExternal:!0,children:"use and create webhooks"}),"."]})}),t.length&&(0,W.jsx)(ne,{data:t})]})}export{Oe as ErrorBoundary,Fe as default};
