import{a as v,b as V,d as F,e as G,f as Y}from"/censys/build/_shared/chunk-CRA3TGUV.js";import{a as O,i as U}from"/censys/build/_shared/chunk-XWEFKGC4.js";import"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as M,d as r,e as s}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{b as z}from"/censys/build/_shared/chunk-XMNCU3E4.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-SZRPTSUZ.js";import"/censys/build/_shared/chunk-BXMBML5J.js";import"/censys/build/_shared/chunk-WNJFRA3F.js";import{a as j}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-OFRBI5JW.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as oe}from"/censys/build/_shared/chunk-IC5AY47K.js";import"/censys/build/_shared/chunk-VDD6BNAJ.js";import"/censys/build/_shared/chunk-B5UNN2SO.js";import"/censys/build/_shared/chunk-TUDXVIEL.js";import"/censys/build/_shared/chunk-7C4UGOB7.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-JDWADSGD.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-4WX73TCZ.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-5OP2ERYU.js";import"/censys/build/_shared/chunk-LOKTUJJ3.js";import"/censys/build/_shared/chunk-BU2LL35M.js";import"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-FP2KPINM.js";import{g as x}from"/censys/build/_shared/chunk-VKYVKQW2.js";import"/censys/build/_shared/chunk-OQUAXVLV.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import{c as B,o as L}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import{a as w}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import{f as H}from"/censys/build/_shared/chunk-ST66DGSY.js";import"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{A as y,Ka as N,y as k,z as A}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{a as R,c as S,e as b,g as _,k as C,z as P}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as E}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as te}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as f}from"/censys/build/_shared/chunk-2TWE7TSA.js";var a=f(te(),1);var l={section:"nNe8T",sectionHeader:"_0m5-j",sectionHeaderIcon:"REFMT"};var ae=f(oe(),1),e=f(E(),1);function $(){let{deleteNodes:i}=U(),n=H(),o=_(),d=S(),T=b(),m=P(),{link:Q="",label:q=""}=O("cert",o.certId||""),u=(0,a.useCallback)(()=>{let c=new URLSearchParams(d.search);n?.organizationId&&c.set(w,n.organizationId);let g=`/investigate/${o.id}?${c.toString()}`;T(g)},[d.search,T,o.id,n]),J=(0,a.useCallback)(()=>{let c=L("cert",o.certId||"");u(),i([c])},[u,i,o.certId]);if(!m||!("cert"in m)||!m.cert)return null;let{cert:K,id:W}=m,t=j(K),X=(0,a.useMemo)(()=>(t.labels||[]).map(g=>({key:"label",value:g})),[t]),Z=t.certificate?.parsed?.subject_dn,ee=t.certificate?.parsed?.issuer_dn,p=t.certificate?.parsed?.validity_period,I=t.certificate?.names,h=t.certificate?.ever_seen_in_scan,D=(0,a.useMemo)(()=>x([t.certificate])?.aggregatedStatus,[t.certificate]);return(0,e.jsxs)(v,{title:"Certificate Node",onClose:u,actions:(0,e.jsxs)(V,{children:[(0,e.jsx)(G,{link:Q,label:q}),(0,e.jsx)(F,{onDelete:J})]}),children:[(0,e.jsx)("div",{className:l.section,children:(0,e.jsx)(Y,{assetType:"cert",id:W,tags:X})}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(k,{icon:"file-list-2-line",size:"md",className:l.sectionHeaderIcon}),(0,e.jsx)(y,{variant:A.H3,children:"Summary"})]}),(0,e.jsxs)(M,{children:[(0,e.jsx)(r,{label:"Issuer DN",content:ee||(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"Subject DN",content:Z||(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"Browser Trust",content:D&&(0,e.jsx)(z,{aggregatedStatus:D})}),(0,e.jsx)(r,{label:"Validity Period",content:p?.not_before&&p?.not_after?(0,e.jsxs)(y,{children:[(0,e.jsx)(N,{timestamp:p.not_before.toString()})," -"," ",(0,e.jsx)(N,{timestamp:p.not_after.toString()})]}):(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"All Names",content:I?.length?I.join(", "):(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"Seen in Scan",content:h!==void 0?h?"Yes":"No":(0,e.jsx)(s,{})})]})]})]})}function re(){let i=b(),n=C(),o=R(n)?n.data.message:"Unknown error",d=(0,a.useCallback)(()=>{i(-1)},[i]);return(0,e.jsx)(v,{title:"Certificate Node",onClose:d,children:(0,e.jsx)(B,{iconName:"safe-2",title:o})})}export{re as ErrorBoundary,$ as default};
