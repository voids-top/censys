import{a as ht}from"/censys/build/_shared/chunk-2RBWCKKD.js";import{a as It}from"/censys/build/_shared/chunk-37QSTPVF.js";import{a as St}from"/censys/build/_shared/chunk-GIECLT6I.js";import"/censys/build/_shared/chunk-SNE5KUVT.js";import{a as Ee}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as Ct}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{c as v,m as b}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import"/censys/build/_shared/chunk-WMKH6XX3.js";import"/censys/build/_shared/chunk-3JU625ZU.js";import"/censys/build/_shared/chunk-I5BA26X4.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-JLZAPT5W.js";import"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{d as V,e as Ot}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-HG7D3PDC.js";import"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as mt}from"/censys/build/_shared/chunk-RDE3WSKD.js";import"/censys/build/_shared/chunk-XSZMCSJH.js";import"/censys/build/_shared/chunk-V6YEAJYZ.js";import"/censys/build/_shared/chunk-YZ2VHXR4.js";import"/censys/build/_shared/chunk-Q3AERUF4.js";import{a as dt}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-KIDII43I.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-2G5R6E4Q.js";import"/censys/build/_shared/chunk-6XVOHWMX.js";import{u as w}from"/censys/build/_shared/chunk-HLRAT4GD.js";import{a as _t}from"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-W2GUOEY7.js";import"/censys/build/_shared/chunk-FQAS3FYV.js";import{b as K}from"/censys/build/_shared/chunk-P2FXGQA2.js";import"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import{C as Lt,v as g,y as Nt}from"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as d,B as _,C as it,D as Tt,F as U,_ as Rt,aa as lt,bb as I,ra as k,sa as ct,ua as At,va as pt,z as Et}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as rt,i as at,k as ot,p as st,z as nt}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as et,c as O}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{c as ne,d as c}from"/censys/build/_shared/chunk-2QEWK57A.js";var ft=ne(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.TacticType_Value=N.ThreatType_Value=N.OperatingSystemAttributeType_Value=N.HardwareAttributeType_Value=N.SoftwareAttributeType_Value=void 0;N.SoftwareAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",BOTNET_SERVER:"BOTNET_SERVER",WEB_SERVER:"WEB_SERVER",WEB_UI:"WEB_UI",HOSTING_WEB_UI:"HOSTING_WEB_UI",WEB_TECHNOLOGY:"WEB_TECHNOLOGY",SCADA:"SCADA",CRYPTOCURRENCY:"CRYPTOCURRENCY",DATABASE:"DATABASE",HONEYPOT:"HONEYPOT",HYPERVISOR:"HYPERVISOR",OUT_OF_BOUND_MANAGEMENT:"OUT_OF_BOUND_MANAGEMENT",PROXY_SERVER:"PROXY_SERVER",VOIP:"VOIP",MEDICAL:"MEDICAL",WAF:"WAF",BUILDING_AUTOMATION:"BUILDING_AUTOMATION",P2P_SHARING:"P2P_SHARING",REMOTE_ACCESS:"REMOTE_ACCESS",IOT:"IOT",EMAIL:"EMAIL",MESSAGE_BROKER:"MESSAGE_BROKER",VPN:"VPN",FILE_SHARING:"FILE_SHARING",MEDIA_SERVER:"MEDIA_SERVER",CMS:"CMS",LOAD_BALANCER:"LOAD_BALANCER",LMS:"LMS",GAME_SERVER:"GAME_SERVER",REMOTE_DESKTOP:"REMOTE_DESKTOP",EMR:"EMR",AI:"AI",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};N.HardwareAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",SOHO:"SOHO",VPN:"VPN",FIREWALL:"FIREWALL",CAMERA:"CAMERA",MEDICAL_DEVICE:"MEDICAL_DEVICE",NETWORK:"NETWORK",PROCESSOR:"PROCESSOR",SERVER:"SERVER",ICS:"ICS",ROUTER:"ROUTER",SERIAL_GATEWAY:"SERIAL_GATEWAY",SWITCH:"SWITCH",LOAD_BALANCER:"LOAD_BALANCER",NAS:"NAS",CELLULAR_MODEM:"CELLULAR_MODEM",HMI:"HMI",SENSOR:"SENSOR",PRINTER:"PRINTER",BUILDING_AUTOMATION:"BUILDING_AUTOMATION",HVAC:"HVAC",ACCESS_CONTROL:"ACCESS_CONTROL",SECURITY_ALARM:"SECURITY_ALARM",FIRE_ALARM:"FIRE_ALARM",PLC:"PLC",MEDICAL:"MEDICAL",RADIO:"RADIO",IMAGING:"IMAGING",ELECTRICAL:"ELECTRICAL",POWER_METER:"POWER_METER",POWER_TRANSFORMER:"POWER_TRANSFORMER",POWER_RELAY:"POWER_RELAY",POWER_PLANT_CONTROLLER:"POWER_PLANT_CONTROLLER",POWER_DISTRIBUTION_UNIT:"POWER_DISTRIBUTION_UNIT",UPS:"UPS",EV_CHARGER:"EV_CHARGER",OIL_AND_GAS:"OIL_AND_GAS",OIL_WELL:"OIL_WELL",GAS_WELL:"GAS_WELL",PIPELINE:"PIPELINE",PUMP:"PUMP",FLOW_METER:"FLOW_METER",VALVE:"VALVE",TANK:"TANK",WATER:"WATER",WATER_PUMP:"WATER_PUMP",WATER_TREATMENT_PLANT_CONTROLLER:"WATER_TREATMENT_PLANT_CONTROLLER",TELECOM:"TELECOM",BASE_STATION:"BASE_STATION",SATELLITE_EQUIPMENT:"SATELLITE_EQUIPMENT",ANTENNA_CONTROLLER:"ANTENNA_CONTROLLER",NVR:"NVR",FINANCIAL:"FINANCIAL",AGRICULTURE:"AGRICULTURE",AUTOMOTIVE_AND_TRANSPORTATION:"AUTOMOTIVE_AND_TRANSPORTATION",FLEET_MANAGEMENT_CONTROLLER:"FLEET_MANAGEMENT_CONTROLLER",IOT:"IOT",SMART_HOME_CONTROLLER:"SMART_HOME_CONTROLLER",POLICE_AND_LAW:"POLICE_AND_LAW",POLICE_SCANNERS:"POLICE_SCANNERS",LAWFUL_INTERCEPT:"LAWFUL_INTERCEPT",ALPR:"ALPR",SCADA:"SCADA",OIL_WELL_CONTROLLER:"OIL_WELL_CONTROLLER",GAS_WELL_CONTROLLER:"GAS_WELL_CONTROLLER",GAS_STATION_CONTROLLER:"GAS_STATION_CONTROLLER",PUMP_CONTROLLER:"PUMP_CONTROLLER",PLANT_CONTROLLER:"PLANT_CONTROLLER",REFRIGERATION:"REFRIGERATION",WIND_TURBINE_CONTROLLER:"WIND_TURBINE_CONTROLLER",SOLAR_INVERTER:"SOLAR_INVERTER",CPE:"CPE",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};N.OperatingSystemAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",NAS:"NAS",FIREWALL:"FIREWALL",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};N.ThreatType_Value={UNSPECIFIED:"UNSPECIFIED",C2_SERVER:"C2_SERVER",DECEPTIVE_SERVER:"DECEPTIVE_SERVER",PHISHING_SERVER:"PHISHING_SERVER",BOTNET_SERVER:"BOTNET_SERVER",SECURITY_TOOL:"SECURITY_TOOL",WEBSHELL:"WEBSHELL",CRYPTOMINING:"CRYPTOMINING",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};N.TacticType_Value={UNSPECIFIED:"UNSPECIFIED",RECONNAISSANCE:"RECONNAISSANCE",RESOURCE_DEVELOPMENT:"RESOURCE_DEVELOPMENT",INITIAL_ACCESS:"INITIAL_ACCESS",EXECUTION:"EXECUTION",PERSISTENCE:"PERSISTENCE",PRIVILEGE_ESCALATION:"PRIVILEGE_ESCALATION",DEFENSE_EVASION:"DEFENSE_EVASION",CREDENTIAL_ACCESS:"CREDENTIAL_ACCESS",DISCOVERY:"DISCOVERY",LATERAL_MOVEMENT:"LATERAL_MOVEMENT",COLLECTION:"COLLECTION",COMMAND_AND_CONTROL:"COMMAND_AND_CONTROL",EXFILTRATION:"EXFILTRATION",IMPACT:"IMPACT",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"}});var E=c(et(),1);var ut={threatList:"GqCb-"};var Mt=c(et(),1);var H={noWrap:"NLUS-",container:"LZKFg",chart:"_0Q0c5"};var h=c(O(),1);function Pt({threat:t}){let a=t.counts||[];if(a.length<2)return null;let o=a.map(T=>({datetime:T.timestamp||"",count:BigInt(T.count)})),i=(0,Mt.useMemo)(()=>ht(o),[o]),n=`${i} ${dt("Day",i)}`;return(0,h.jsxs)("div",{className:H.container,"data-testid":"sparkline-container",children:[(0,h.jsx)("div",{className:H.chart,children:(0,h.jsx)(St,{title:t.name,stats:o,colors:["var(--color-theme-brand-peach)"],verticalExtentRatio:1})}),(0,h.jsxs)(_,{variant:d.H6,className:H.noWrap,"data-testid":"sparkline-H6",children:["Trend | ",n]})]})}var p={bodyContainer:"_2UIff",contentLeft:"fwUiF",threatName:"AM6-i",contentRight:"Lu3cQ",contentColumn:"KH53w",description:"xmhW7",trendColumn:"COiPz",countColumn:"DDBhB",countContainer:"_5OQtJ",countLink:"_20-fi"};var R=c(O(),1);function gt({threat:t}){let a=t.counts?.length>0?t.counts[t.counts.length-1].count:0,o=Lt(t.name);return(0,R.jsx)(pt,{variant:ct.INTERACTIVE,bodyPadding:At.NONE,"data-testid":"threat-card",children:(0,R.jsxs)("div",{className:p.bodyContainer,children:[(0,R.jsxs)(K,{"aria-label":`Navigate to ${t.name}`,to:`/threats/${t.id}`,className:p.contentLeft,children:[(0,R.jsx)("div",{className:p.iconColumn,children:(0,R.jsx)(It,{})}),(0,R.jsxs)("div",{className:p.contentColumn,children:[(0,R.jsx)(_,{variant:d.H2,className:p.threatName,"data-testid":"threat-H2",children:w(t.name,100)}),t.description&&(0,R.jsx)(_,{variant:d.SMALL,className:p.description,"data-testid":"threat-DEFAULT",children:w(t.description,205)})]})]}),(0,R.jsxs)("div",{className:p.contentRight,children:[(0,R.jsx)("div",{className:p.trendColumn,children:(0,R.jsx)(Pt,{threat:t})}),(0,R.jsxs)("div",{className:p.countColumn,children:[(0,R.jsx)("div",{className:p.countContainer,children:(0,R.jsx)(K,{"data-testid":"threat-count",className:p.countLink,to:o,target:"_blank",rel:"noopener noreferrer",children:a.toLocaleString()})}),(0,R.jsx)(_,{variant:d.H6,children:"Asset Count"})]})]})]})},t.id)}var yt={empty:"iPRKN"};var $=c(O(),1);function Q(){return(0,$.jsx)("div",{className:yt.empty,"data-testid":"threats-no-results",children:(0,$.jsx)(V,{iconName:"bug",iconMode:"line",title:"There are no threats to display",children:"Try adjusting your search and try again."})})}var F=c(O(),1);function X({threats:t,isLoading:a}){return(0,F.jsx)("div",{className:ut.threatList,"data-testid":"threats-list",children:t.length>0?t.map(o=>(0,F.jsx)(gt,{isLoading:a,threat:o},o.id)):(0,F.jsx)(Q,{})})}var Dt=c(ft(),1),Ut=Dt.ThreatType_Value;var C="ALL_THREATS",S="threatType",u="threatActors",M="threatNames",Vt={light:"#FFFFFF",dark:"#000000"},vt=["#FDF4F3","#FFE9E9","#F7D2D1","#F2BBBA","#FC5A54","#F54A47","#E53430","#D51D18","#A5130E","#760804"],bt={light:["#c1c5cb",...vt],dark:["#343a40",...vt]},Ht="rgba(71, 5, 2, 0.5)",G="threatTime";function Re(t){return t.split("_").map(a=>a.toLocaleLowerCase()).map(_t).join(" ")}var Ft=Object.values({...Ut,[C]:C}).filter(t=>t!=="UNRECOGNIZED_ENUM_KEY").sort((t,a)=>t.localeCompare(a)).map(t=>({value:t,label:Re(t)})),W=Object.values(["7","14"]).map(t=>({value:t,label:`Last ${t} Days`})),Z="asc",q="desc",Gt=[{value:Z,label:"Ascending"},{value:q,label:"Descending"}];var A={threatsByCountry:"csW5p",cardSubHeader:"d8PLS",mapFilterHeader:"F8Kpz",mapFilterContainer:"_567Yr",threatTypeSelectContainer:"_7R0uz",threatActorsSelectContainer:"FumS2",threatNamesSelectContainer:"smVpG",threatsListContainer:"aeW7E",threatsListActions:"aAhGg",threatsListFilters:"I2xjI"};function le(t,a,o,i=[]){let n=[],T=t==="host"?"host.services":"web";return(!a||a===C)&&!o.length&&!i.length&&n.push(`${T}.threats.name: *`),a&&a!==C&&n.push(g({kind:0,field:`${T}.threats.type`,value:a})),o.length>0&&n.push(g({kind:4,field:`${T}.threats.actors.primary_name`,values:o})),i.length>0&&n.push(g({kind:4,field:`${T}.threats.name`,values:i})),n}function Wt(t,a,o=[],i){let n=le("host",t,a,o);return i&&n.unshift(g({kind:0,field:"host.location.country_code",value:i})),n.reduce((T,L)=>Nt(T,L),"")}function Bt({threats:t,searchQuery:a,sortBy:o}){let i=[...t];if(a){let n=a.toLowerCase();i=i.filter(T=>T.name.toLowerCase().includes(n)||T.description?.toLowerCase().includes(n))}return i.sort((n,T)=>{let L=n.counts[n.counts.length-1]?.count??0,l=T.counts[T.counts.length-1]?.count??0;return o===Z?L-l:l-L}),i}var Ae=c(Ee(),1),e=c(O(),1);function xt(){let{countsByCountry:t,otherCount:a,actors:o,names:i,threats:n}=nt(),{state:T}=at(),L=Ot(),[l]=st(),[y,z]=(0,E.useState)([]),[f,j]=(0,E.useState)([]),[P,J]=(0,E.useState)(l.get(S)||C),[Yt,kt]=(0,E.useState)(W.find(r=>r.value===l.get(G))?.value||W[0].value),[Kt,wt]=(0,E.useState)(!1),[B,$t]=(0,E.useState)(""),[x,Qt]=(0,E.useState)(q);(0,E.useEffect)(()=>{wt(!0)},[]);let Xt=(0,E.useMemo)(()=>o.map(r=>({value:r,label:r})),[o]),Zt=(0,E.useMemo)(()=>i.map(r=>({value:r,label:r})),[i]);(0,E.useEffect)(()=>{let r=l.get(u)?.split(",").filter(Boolean)||[];z(r.map(s=>({value:s,label:s})))},[l]),(0,E.useEffect)(()=>{let r=l.get(M)?.split(",").filter(Boolean)||[];j(r.map(s=>({value:s,label:s})))},[l]),(0,E.useEffect)(()=>{J(l.get(S)||C)},[l]);let tt=(0,E.useMemo)(()=>Bt({threats:n,searchQuery:B,sortBy:x}),[n,B,x]),qt=r=>{let s=new URLSearchParams(l);r&&r!==C?s.set(S,r):s.delete(S),J(r),L(`threats?${s.toString()}`)},zt=r=>{let s=new URLSearchParams(l);r.length>0?s.set(u,r.map(D=>D.value).join(",")):s.delete(u),z(r),L(`threats?${s.toString()}`)},jt=r=>{let s=new URLSearchParams(l);r.length>0?s.set(M,r.map(D=>D.value).join(",")):s.delete(M),j(r),L(`threats?${s.toString()}`)},Jt=r=>{let s=new URLSearchParams(l);s.set(G,r),kt(r),L(`threats?${s.toString()}`)},te=()=>{let r=new URLSearchParams(l);r.delete(S),r.delete(u),r.delete(M),L(`threats?${r.toString()}`)},ee=r=>{$t(r.target.value)},re=r=>{Qt(r)},m=T==="loading",ae=P&&P!==C||y.length>0||f.length>0,oe=(0,E.useCallback)(r=>{let s=Wt(P,y.map(Y=>Y.value),f.map(Y=>Y.value),r);return`/search?q=${encodeURIComponent(s)}`},[P,y,f]),se=Object.keys(t).length;return(0,e.jsx)(b,{breadcrumbs:[{pathName:"Explore"}],children:(0,e.jsxs)(v,{children:[(0,e.jsx)("div",{"data-testid":"threats-filter-controls",children:(0,e.jsxs)("div",{className:A.mapFilterHeader,children:[(0,e.jsx)(_,{variant:d.H1,children:"Threats"}),(0,e.jsxs)("div",{className:A.mapFilterContainer,children:[(0,e.jsx)("div",{className:A.threatTypeSelectContainer,children:(0,e.jsx)(U,{"data-testid":"threat-type-select",valueProps:{placeholder:"Threat Type"},contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Type"}),name:S,disabled:m,options:Ft,value:P,onValueChange:qt})}),(0,e.jsx)("div",{className:A.threatNamesSelectContainer,children:(0,e.jsx)(k,{"data-testid":"threat-names-select",name:M,disabled:m,options:Zt,selectedOptions:f,onChange:jt,contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Name"}),className:A.multiselect})}),(0,e.jsx)("div",{className:A.threatActorsSelectContainer,children:(0,e.jsx)(k,{"data-testid":"threat-actors-select",name:u,disabled:m,options:Xt,selectedOptions:y,onChange:zt,contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Group"}),className:A.multiselect})}),ae&&(0,e.jsx)(lt,{"data-testid":"clear-filters-button",variant:it.TERTIARY,onClick:te,disabled:m,children:"Clear Filters"})]})]})}),(0,e.jsx)(mt,{countsByCountryCode:t,strokeColor:Vt,colorRange:bt,dotColor:Ht,getUrlForCountry:oe,renderMap:Kt,label:"Hosts with Threat",bucketCount:se,mapTitle:"Hosts with Threats by Country",tableTitle:"Hosts with Threats by Country",otherCount:a,shouldDisplayOtherCount:!1}),(0,e.jsxs)("div",{className:A.threatsListContainer,children:[(0,e.jsxs)("div",{className:A.threatsListActions,children:[(0,e.jsx)("div",{className:A.results,children:(0,e.jsxs)(_,{variant:d.H2,children:["Threat Results:"," ",(0,e.jsx)(Rt,{value:tt.length})]})}),(0,e.jsxs)("div",{className:A.threatsListFilters,children:[(0,e.jsx)("div",{children:(0,e.jsx)(Tt,{type:"search","data-testid":"threats-search-input",placeholder:"Search threats...",value:B,onChange:ee,className:A.searchInput,disabled:m,contentLeft:(0,e.jsx)(Et,{name:"search",mode:"line"}),isFullWidth:!0})}),(0,e.jsx)("div",{children:(0,e.jsx)(U,{"data-testid":"threat-sort-select",valueProps:{placeholder:"By Count"},contentLeft:(0,e.jsx)(I,{icon:"sort-desc",label:"By Count"}),name:"sort",disabled:m,options:Gt,value:x,onValueChange:re})}),(0,e.jsx)("div",{children:(0,e.jsx)(U,{valueProps:{placeholder:"Time Period"},contentLeft:(0,e.jsx)(I,{iconName:"time",iconMode:"line",label:"Time Period"}),name:G,disabled:m,options:W,value:Yt,onValueChange:Jt})})]})]}),(0,e.jsx)(X,{threats:tt,isLoading:m})]})]})})}function ce(){let t=ot(),a=[{pathName:"Investigate"}],o="Error Loading Threat Data";return rt(t)?(t.status===400&&(o="Invalid Request"),(0,e.jsx)(b,{breadcrumbs:a,children:(0,e.jsx)(v,{children:(0,e.jsx)(V,{iconName:"alert",title:o,children:(0,e.jsx)(_,{children:"We encountered a problem while loading the threat information. Please try again later."})})})})):(0,e.jsx)(b,{breadcrumbs:a,children:(0,e.jsx)(v,{children:(0,e.jsx)(Ct,{error:t})})})}export{ce as ErrorBoundary,xt as default};
