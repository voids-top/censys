import{a as Pt}from"/censys/build/_shared/chunk-ZVCNKTNW.js";import{a as ht,b as Mt}from"/censys/build/_shared/chunk-GKHDVOYG.js";import{a as ut}from"/censys/build/_shared/chunk-3PUYXBPH.js";import{d as It}from"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as Re}from"/censys/build/_shared/chunk-EAJKCKTG.js";import{a as dt}from"/censys/build/_shared/chunk-Y7NKNUZC.js";import{c as V,o as b}from"/censys/build/_shared/chunk-22JANVKU.js";import"/censys/build/_shared/chunk-FQTIU6PB.js";import"/censys/build/_shared/chunk-J6D36YFI.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import"/censys/build/_shared/chunk-ATOZ4ARP.js";import"/censys/build/_shared/chunk-DSG73WCA.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{q as v,r as Ct}from"/censys/build/_shared/chunk-HUE44QRB.js";import"/censys/build/_shared/chunk-Z3PARXZG.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-NJXUBBUP.js";import"/censys/build/_shared/chunk-437XWWKH.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import{a as St}from"/censys/build/_shared/chunk-QT4LTT5X.js";import"/censys/build/_shared/chunk-XSZMCSJH.js";import"/censys/build/_shared/chunk-NUPTSKAJ.js";import"/censys/build/_shared/chunk-YZ2VHXR4.js";import"/censys/build/_shared/chunk-BI4XKJZW.js";import{a as mt}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-EYKPJWWG.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-WJT5ZZXK.js";import"/censys/build/_shared/chunk-ZI7DUXMR.js";import"/censys/build/_shared/chunk-TRPWTN3H.js";import"/censys/build/_shared/chunk-UKMMPQ5X.js";import{r as w}from"/censys/build/_shared/chunk-WJEUPJRQ.js";import{a as Ot}from"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-EZHABQF2.js";import"/censys/build/_shared/chunk-2RV3CGNA.js";import"/censys/build/_shared/chunk-OZE6EA6M.js";import{b as K}from"/censys/build/_shared/chunk-HNL4CPAB.js";import"/censys/build/_shared/chunk-D5QEORL2.js";import{B as Lt,u as g,x as _t}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as O,B as Tt,C as Rt,E as U,_ as lt,aa as At,db as I,sa as k,ta as ct,va as pt,wa as Nt,y as Et,z as d}from"/censys/build/_shared/chunk-GALQBYYN.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as at,i as ot,k as st,p as nt,z as it}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as rt,c as L}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{c as Te,d as A}from"/censys/build/_shared/chunk-2QEWK57A.js";var vt=Te(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.TacticType_Value=_.ThreatType_Value=_.OperatingSystemAttributeType_Value=_.HardwareAttributeType_Value=_.SoftwareAttributeType_Value=void 0;_.SoftwareAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",BOTNET_SERVER:"BOTNET_SERVER",WEB_SERVER:"WEB_SERVER",WEB_UI:"WEB_UI",HOSTING_WEB_UI:"HOSTING_WEB_UI",WEB_TECHNOLOGY:"WEB_TECHNOLOGY",SCADA:"SCADA",CRYPTOCURRENCY:"CRYPTOCURRENCY",DATABASE:"DATABASE",HONEYPOT:"HONEYPOT",HYPERVISOR:"HYPERVISOR",OUT_OF_BOUND_MANAGEMENT:"OUT_OF_BOUND_MANAGEMENT",PROXY_SERVER:"PROXY_SERVER",VOIP:"VOIP",MEDICAL:"MEDICAL",WAF:"WAF",BUILDING_AUTOMATION:"BUILDING_AUTOMATION",P2P_SHARING:"P2P_SHARING",REMOTE_ACCESS:"REMOTE_ACCESS",IOT:"IOT",EMAIL:"EMAIL",MESSAGE_BROKER:"MESSAGE_BROKER",VPN:"VPN",FILE_SHARING:"FILE_SHARING",MEDIA_SERVER:"MEDIA_SERVER",CMS:"CMS",LOAD_BALANCER:"LOAD_BALANCER",LMS:"LMS",GAME_SERVER:"GAME_SERVER",REMOTE_DESKTOP:"REMOTE_DESKTOP",EMR:"EMR",AI:"AI",PRINT_SERVER:"PRINT_SERVER",KVM:"KVM",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.HardwareAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",SOHO:"SOHO",VPN:"VPN",FIREWALL:"FIREWALL",CAMERA:"CAMERA",MEDICAL_DEVICE:"MEDICAL_DEVICE",NETWORK:"NETWORK",PROCESSOR:"PROCESSOR",SERVER:"SERVER",ICS:"ICS",ROUTER:"ROUTER",SERIAL_GATEWAY:"SERIAL_GATEWAY",SWITCH:"SWITCH",LOAD_BALANCER:"LOAD_BALANCER",NAS:"NAS",CELLULAR_MODEM:"CELLULAR_MODEM",HMI:"HMI",SENSOR:"SENSOR",PRINTER:"PRINTER",BUILDING_AUTOMATION:"BUILDING_AUTOMATION",HVAC:"HVAC",ACCESS_CONTROL:"ACCESS_CONTROL",SECURITY_ALARM:"SECURITY_ALARM",FIRE_ALARM:"FIRE_ALARM",PLC:"PLC",MEDICAL:"MEDICAL",RADIO:"RADIO",IMAGING:"IMAGING",ELECTRICAL:"ELECTRICAL",POWER_METER:"POWER_METER",POWER_TRANSFORMER:"POWER_TRANSFORMER",POWER_RELAY:"POWER_RELAY",POWER_PLANT_CONTROLLER:"POWER_PLANT_CONTROLLER",POWER_DISTRIBUTION_UNIT:"POWER_DISTRIBUTION_UNIT",UPS:"UPS",EV_CHARGER:"EV_CHARGER",OIL_AND_GAS:"OIL_AND_GAS",OIL_WELL:"OIL_WELL",GAS_WELL:"GAS_WELL",PIPELINE:"PIPELINE",PUMP:"PUMP",FLOW_METER:"FLOW_METER",VALVE:"VALVE",TANK:"TANK",WATER:"WATER",WATER_PUMP:"WATER_PUMP",WATER_TREATMENT_PLANT_CONTROLLER:"WATER_TREATMENT_PLANT_CONTROLLER",TELECOM:"TELECOM",BASE_STATION:"BASE_STATION",SATELLITE_EQUIPMENT:"SATELLITE_EQUIPMENT",ANTENNA_CONTROLLER:"ANTENNA_CONTROLLER",NVR:"NVR",FINANCIAL:"FINANCIAL",AGRICULTURE:"AGRICULTURE",AUTOMOTIVE_AND_TRANSPORTATION:"AUTOMOTIVE_AND_TRANSPORTATION",FLEET_MANAGEMENT_CONTROLLER:"FLEET_MANAGEMENT_CONTROLLER",IOT:"IOT",SMART_HOME_CONTROLLER:"SMART_HOME_CONTROLLER",POLICE_AND_LAW:"POLICE_AND_LAW",POLICE_SCANNERS:"POLICE_SCANNERS",LAWFUL_INTERCEPT:"LAWFUL_INTERCEPT",ALPR:"ALPR",SCADA:"SCADA",OIL_WELL_CONTROLLER:"OIL_WELL_CONTROLLER",GAS_WELL_CONTROLLER:"GAS_WELL_CONTROLLER",GAS_STATION_CONTROLLER:"GAS_STATION_CONTROLLER",PUMP_CONTROLLER:"PUMP_CONTROLLER",PLANT_CONTROLLER:"PLANT_CONTROLLER",REFRIGERATION:"REFRIGERATION",WIND_TURBINE_CONTROLLER:"WIND_TURBINE_CONTROLLER",SOLAR_INVERTER:"SOLAR_INVERTER",CPE:"CPE",KVM:"KVM",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.OperatingSystemAttributeType_Value={UNSPECIFIED:"UNSPECIFIED",NAS:"NAS",FIREWALL:"FIREWALL",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.ThreatType_Value={UNSPECIFIED:"UNSPECIFIED",C2_SERVER:"C2_SERVER",DECEPTIVE_SERVER:"DECEPTIVE_SERVER",PHISHING_SERVER:"PHISHING_SERVER",BOTNET_SERVER:"BOTNET_SERVER",SECURITY_TOOL:"SECURITY_TOOL",WEBSHELL:"WEBSHELL",CRYPTOMINING:"CRYPTOMINING",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"};_.TacticType_Value={UNSPECIFIED:"UNSPECIFIED",RECONNAISSANCE:"RECONNAISSANCE",RESOURCE_DEVELOPMENT:"RESOURCE_DEVELOPMENT",INITIAL_ACCESS:"INITIAL_ACCESS",EXECUTION:"EXECUTION",PERSISTENCE:"PERSISTENCE",PRIVILEGE_ESCALATION:"PRIVILEGE_ESCALATION",DEFENSE_EVASION:"DEFENSE_EVASION",CREDENTIAL_ACCESS:"CREDENTIAL_ACCESS",DISCOVERY:"DISCOVERY",LATERAL_MOVEMENT:"LATERAL_MOVEMENT",COLLECTION:"COLLECTION",COMMAND_AND_CONTROL:"COMMAND_AND_CONTROL",EXFILTRATION:"EXFILTRATION",IMPACT:"IMPACT",UNRECOGNIZED_ENUM_KEY:"UNRECOGNIZED_ENUM_KEY"}});var T=A(rt(),1);var gt={threatList:"GqCb-"};var ft=A(rt(),1);var H={noWrap:"NLUS-",container:"LZKFg",chart:"_0Q0c5"};var u=A(L(),1);function yt({threat:t}){let a=t.counts||[];if(a.length<2)return null;let o=a.map(i=>({datetime:i.timestamp||"",count:BigInt(i.count)})),R=(0,ft.useMemo)(()=>Pt(o),[o]),s=`${R} ${mt("Day",R)}`;return(0,u.jsxs)("div",{className:H.container,"data-testid":"sparkline-container",children:[(0,u.jsx)("div",{className:H.chart,children:(0,u.jsx)(ut,{title:t.name,stats:o,colors:["var(--color-theme-brand-peach)"],verticalExtentRatio:1})}),(0,u.jsxs)(O,{variant:d.H6,className:H.noWrap,"data-testid":"sparkline-H6",children:["Trend | ",s]})]})}var p={bodyContainer:"_2UIff",contentLeft:"fwUiF",threatName:"AM6-i",contentRight:"Lu3cQ",contentColumn:"KH53w",contentColumnTitle:"Vu87B",description:"xmhW7",trendColumn:"COiPz",countColumn:"DDBhB",countContainer:"_5OQtJ",countLink:"_20-fi"};var E=A(L(),1);function Dt({threat:t}){let a=t.counts?.length>0?t.counts[t.counts.length-1].count:0,o=Lt(t.name);return(0,E.jsx)(Nt,{variant:ct.INTERACTIVE,bodyPadding:pt.NONE,"data-testid":"threat-card",children:(0,E.jsxs)("div",{className:p.bodyContainer,children:[(0,E.jsxs)(K,{"aria-label":`Navigate to ${t.name}`,to:`/threats/${t.id}`,className:p.contentLeft,children:[(0,E.jsx)("div",{className:p.iconColumn,children:(0,E.jsx)(ht,{})}),(0,E.jsxs)("div",{className:p.contentColumn,children:[(0,E.jsxs)("div",{className:p.contentColumnTitle,children:[(0,E.jsx)(O,{variant:d.H2,className:p.threatName,"data-testid":"threat-H2",children:w(t.name,100)}),It(t.addedAt)?(0,E.jsx)(Mt,{}):null]}),t.description&&(0,E.jsx)(O,{variant:d.SMALL,className:p.description,"data-testid":"threat-DEFAULT",children:w(t.description,205)})]})]}),(0,E.jsxs)("div",{className:p.contentRight,children:[(0,E.jsx)("div",{className:p.trendColumn,children:(0,E.jsx)(yt,{threat:t})}),(0,E.jsxs)("div",{className:p.countColumn,children:[(0,E.jsx)("div",{className:p.countContainer,children:(0,E.jsx)(K,{"data-testid":"threat-count",className:p.countLink,to:o,target:"_blank",rel:"noopener noreferrer",children:a.toLocaleString()})}),(0,E.jsx)(O,{variant:d.H6,children:"Asset Count"})]})]})]})},t.id)}var Ut={empty:"iPRKN"};var $=A(L(),1);function Q(){return(0,$.jsx)("div",{className:Ut.empty,"data-testid":"threats-no-results",children:(0,$.jsx)(v,{iconName:"bug",iconMode:"line",title:"There are no threats to display",children:"Try adjusting your search and try again."})})}var F=A(L(),1);function X({threats:t,isLoading:a}){return(0,F.jsx)("div",{className:gt.threatList,"data-testid":"threats-list",children:t.length>0?t.map(o=>(0,F.jsx)(Dt,{isLoading:a,threat:o},o.id)):(0,F.jsx)(Q,{})})}var Vt=A(vt(),1),bt=Vt.ThreatType_Value;var C="ALL_THREATS",S="threatType",h="threatActors",M="threatNames",Ft={light:"#FFFFFF",dark:"#000000"},Ht=["#FDF4F3","#FFE9E9","#F7D2D1","#F2BBBA","#FC5A54","#F54A47","#E53430","#D51D18","#A5130E","#760804"],Gt={light:["#c1c5cb",...Ht],dark:["#343a40",...Ht]},Wt="rgba(71, 5, 2, 0.5)",G="threatTime";function ce(t){return t.split("_").map(a=>a.toLocaleLowerCase()).map(Ot).join(" ")}var Bt=Object.values({...bt,[C]:C}).filter(t=>t!=="UNRECOGNIZED_ENUM_KEY").sort((t,a)=>t.localeCompare(a)).map(t=>({value:t,label:ce(t)})),W=Object.values(["7","14"]).map(t=>({value:t,label:`Last ${t} Days`})),Z="asc",q="desc",j="addedAtDesc",xt=[{value:j,label:"Recently created first"},{value:q,label:"Asset Count (Highest First)"},{value:Z,label:"Asset Count (Lowest First)"}];var c={threatsByCountry:"csW5p",cardSubHeader:"d8PLS",mapFilterHeader:"F8Kpz",mapFilterContainer:"_567Yr",threatTypeSelectContainer:"_7R0uz",threatActorsSelectContainer:"FumS2",threatNamesSelectContainer:"smVpG",threatsListContainer:"aeW7E",threatsListActions:"aAhGg",threatsListFilters:"I2xjI",sortSelect:"RMrjw"};function pe(t,a,o,R=[]){let s=[],i=t==="host"?"host.services":"web";return(!a||a===C)&&!o.length&&!R.length&&s.push(`${i}.threats.name: *`),a&&a!==C&&s.push(g({kind:0,field:`${i}.threats.type`,value:a})),o.length>0&&s.push(g({kind:4,field:`${i}.threats.actors.primary_name`,values:o})),R.length>0&&s.push(g({kind:4,field:`${i}.threats.name`,values:R})),s}function Yt(t,a,o=[],R){let s=pe("host",t,a,o);return R&&s.unshift(g({kind:0,field:"host.location.country_code",value:R})),s.reduce((i,N)=>_t(i,N),"")}function kt({threats:t,searchQuery:a,sortBy:o}){let R=[...t];if(a){let s=a.toLowerCase();R=R.filter(i=>i.name.toLowerCase().includes(s)||i.description?.toLowerCase().includes(s))}return o===j?R.sort((s,i)=>{let N=s.addedAt?new Date(s.addedAt).getTime():-1/0;return(i.addedAt?new Date(i.addedAt).getTime():-1/0)-N}):R.sort((s,i)=>{let N=s.counts[s.counts.length-1]?.count??0,l=i.counts[i.counts.length-1]?.count??0;return o===Z?N-l:l-N}),R}var _e=A(Re(),1),e=A(L(),1);function Kt(){let{countsByCountry:t,otherCount:a,actors:o,names:R,threats:s}=it(),{state:i}=ot(),N=Ct(),[l]=nt(),[f,z]=(0,T.useState)([]),[y,J]=(0,T.useState)([]),[P,tt]=(0,T.useState)(l.get(S)||C),[wt,$t]=(0,T.useState)(W.find(r=>r.value===l.get(G))?.value||W[0].value),[Qt,Xt]=(0,T.useState)(!1),[B,Zt]=(0,T.useState)(""),[x,qt]=(0,T.useState)(q);(0,T.useEffect)(()=>{Xt(!0)},[]);let jt=(0,T.useMemo)(()=>o.map(r=>({value:r,label:r})),[o]),zt=(0,T.useMemo)(()=>R.map(r=>({value:r,label:r})),[R]);(0,T.useEffect)(()=>{let r=l.get(h)?.split(",").filter(Boolean)||[];z(r.map(n=>({value:n,label:n})))},[l]),(0,T.useEffect)(()=>{let r=l.get(M)?.split(",").filter(Boolean)||[];J(r.map(n=>({value:n,label:n})))},[l]),(0,T.useEffect)(()=>{tt(l.get(S)||C)},[l]);let et=(0,T.useMemo)(()=>kt({threats:s,searchQuery:B,sortBy:x}),[s,B,x]),Jt=r=>{let n=new URLSearchParams(l);r&&r!==C?n.set(S,r):n.delete(S),tt(r),N(`threats?${n.toString()}`)},te=r=>{let n=new URLSearchParams(l);r.length>0?n.set(h,r.map(D=>D.value).join(",")):n.delete(h),z(r),N(`threats?${n.toString()}`)},ee=r=>{let n=new URLSearchParams(l);r.length>0?n.set(M,r.map(D=>D.value).join(",")):n.delete(M),J(r),N(`threats?${n.toString()}`)},re=r=>{let n=new URLSearchParams(l);n.set(G,r),$t(r),N(`threats?${n.toString()}`)},ae=()=>{let r=new URLSearchParams(l);r.delete(S),r.delete(h),r.delete(M),N(`threats?${r.toString()}`)},oe=r=>{Zt(r.target.value)},se=r=>{qt(r)},m=i==="loading",ne=P&&P!==C||f.length>0||y.length>0,ie=(0,T.useCallback)(r=>{let n=Yt(P,f.map(Y=>Y.value),y.map(Y=>Y.value),r);return`/censys?q=${encodeURIComponent(n)}`},[P,f,y]),Ee=Object.keys(t).length;return(0,e.jsx)(b,{breadcrumbs:[{pathName:"Explore"}],children:(0,e.jsxs)(V,{children:[(0,e.jsx)("div",{"data-testid":"threats-filter-controls",children:(0,e.jsxs)("div",{className:c.mapFilterHeader,children:[(0,e.jsx)(O,{variant:d.H1,children:"Threats"}),(0,e.jsxs)("div",{className:c.mapFilterContainer,children:[(0,e.jsx)("div",{className:c.threatTypeSelectContainer,children:(0,e.jsx)(U,{"data-testid":"threat-type-select",valueProps:{placeholder:"Threat Type"},contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Type"}),name:S,disabled:m,options:Bt,value:P,onValueChange:Jt})}),(0,e.jsx)("div",{className:c.threatNamesSelectContainer,children:(0,e.jsx)(k,{"data-testid":"threat-names-select",name:M,disabled:m,options:zt,selectedOptions:y,onChange:ee,contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Name"}),className:c.multiselect})}),(0,e.jsx)("div",{className:c.threatActorsSelectContainer,children:(0,e.jsx)(k,{"data-testid":"threat-actors-select",name:h,disabled:m,options:jt,selectedOptions:f,onChange:te,contentLeft:(0,e.jsx)(I,{iconName:"filter-3",label:"Threat Group"}),className:c.multiselect})}),ne&&(0,e.jsx)(At,{"data-testid":"clear-filters-button",variant:Tt.TERTIARY,onClick:ae,disabled:m,children:"Clear Filters"})]})]})}),(0,e.jsx)(St,{countsByCountryCode:t,strokeColor:Ft,colorRange:Gt,dotColor:Wt,getUrlForCountry:ie,renderMap:Qt,label:"Hosts with Threat",bucketCount:Ee,mapTitle:"Hosts with Threats by Country",tableTitle:"Hosts with Threats by Country",otherCount:a,shouldDisplayOtherCount:!1}),(0,e.jsxs)("div",{className:c.threatsListContainer,children:[(0,e.jsxs)("div",{className:c.threatsListActions,children:[(0,e.jsx)("div",{className:c.results,children:(0,e.jsxs)(O,{variant:d.H2,children:["Threat Results:"," ",(0,e.jsx)(lt,{value:et.length})]})}),(0,e.jsxs)("div",{className:c.threatsListFilters,children:[(0,e.jsx)("div",{children:(0,e.jsx)(Rt,{type:"search","data-testid":"threats-search-input",placeholder:"Search threats...",value:B,onChange:oe,className:c.searchInput,disabled:m,contentLeft:(0,e.jsx)(Et,{name:"search",mode:"line"}),isFullWidth:!0})}),(0,e.jsx)("div",{className:c.sortSelect,children:(0,e.jsx)(U,{"data-testid":"threat-sort-select",contentLeft:(0,e.jsx)(I,{icon:"sort-desc"}),name:"sort",disabled:m,options:xt,value:x,onValueChange:se})}),(0,e.jsx)("div",{children:(0,e.jsx)(U,{valueProps:{placeholder:"Time Period"},contentLeft:(0,e.jsx)(I,{iconName:"time",iconMode:"line",label:"Time Period"}),name:G,disabled:m,options:W,value:wt,onValueChange:re})})]})]}),(0,e.jsx)(X,{threats:et,isLoading:m})]})]})})}function Ne(){let t=st(),a=[{pathName:"Investigate"}],o="Error Loading Threat Data";return at(t)?(t.status===400&&(o="Invalid Request"),(0,e.jsx)(b,{breadcrumbs:a,children:(0,e.jsx)(V,{children:(0,e.jsx)(v,{iconName:"alert",title:o,children:(0,e.jsx)(O,{children:"We encountered a problem while loading the threat information. Please try again later."})})})})):(0,e.jsx)(b,{breadcrumbs:a,children:(0,e.jsx)(V,{children:(0,e.jsx)(dt,{error:t})})})}export{Ne as ErrorBoundary,Kt as default};
