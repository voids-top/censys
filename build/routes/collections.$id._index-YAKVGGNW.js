import{a as P}from"/censys/build/_shared/chunk-QXFRAZKJ.js";import"/censys/build/_shared/chunk-YIKZ74W3.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import{a as Mt}from"/censys/build/_shared/chunk-OOWGGRVL.js";import{a as Dt}from"/censys/build/_shared/chunk-6BMUL27E.js";import"/censys/build/_shared/chunk-XLW6D2H7.js";import"/censys/build/_shared/chunk-4KKS33MW.js";import"/censys/build/_shared/chunk-IUMSQHOS.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import{a as W}from"/censys/build/_shared/chunk-OFRBI5JW.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as At,b as St,c as Lt,d as _t,e as Et}from"/censys/build/_shared/chunk-2C6N3S4L.js";import"/censys/build/_shared/chunk-4NQHWOT6.js";import{c as gt}from"/censys/build/_shared/chunk-B5UNN2SO.js";import"/censys/build/_shared/chunk-TUDXVIEL.js";import"/censys/build/_shared/chunk-7C4UGOB7.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import{a as Nt}from"/censys/build/_shared/chunk-JDWADSGD.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-4WX73TCZ.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-5OP2ERYU.js";import"/censys/build/_shared/chunk-LOKTUJJ3.js";import"/censys/build/_shared/chunk-BU2LL35M.js";import{i as ht,j as vt}from"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-FP2KPINM.js";import"/censys/build/_shared/chunk-VKYVKQW2.js";import"/censys/build/_shared/chunk-OQUAXVLV.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import{j as Tt}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import{a as It}from"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import{a as w}from"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import"/censys/build/_shared/chunk-E7FS2ZQL.js";import{e as yt,h as ft}from"/censys/build/_shared/chunk-ST66DGSY.js";import{i as Ct}from"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{$ as O,A as o,Ja as dt,Ka as mt,La as ct,Ma as pt,Sa as H,Ta as ut,ga as st,ha as lt,va as f,wa as N,x as R,xa as g,y as v,z as r}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{C as nt,f as T,g as ot,p as it}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as l}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as M}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as s}from"/censys/build/_shared/chunk-2TWE7TSA.js";var Y=s(M(),1);var Gt=s(l(),1);function $(){let{collection:t}=T(),n=t.collection_id,i=t.added_assets_24_hours.value,c=(0,Y.useMemo)(()=>Temporal.Now.zonedDateTimeISO().toPlainDate().toString(),[]),d=(0,Y.useMemo)(()=>{let p=new Date;return p.setDate(p.getDate()-1),p.toISOString().split("T")[0]},[]);return(0,Gt.jsx)(P,{value:i,href:`/collections/${n}/history?event_type=${"asset_added"}&start=${d}&end=${c}`,label:"Assets Added | Last 24 Hrs"})}var bt=s(M(),1);var I={container:"bKz66",headerContainer:"mVdCM",headerContainerLeft:"_2G-g1",headerContainerRight:"ySdzI",collectionName:"tIJgy",body:"scBHL",left:"AwljX",content:"d29XQ",icon:"D-Y10"};var m=s(l(),1);function xt({collection:t}){let n=(0,bt.useMemo)(()=>{let i=t.createdByUser;return i?Nt(i):"Unknown"},[t.createdByUser]);return(0,m.jsxs)("div",{className:I.headerContainer,children:[(0,m.jsxs)("div",{className:I.headerContainerLeft,children:[(0,m.jsx)(o,{variant:r.H2,className:I.collectionName,children:t.name}),t.category!==Ct.Category.CATEGORY_UNSPECIFIED&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(w,{variant:"dot"}),(0,m.jsx)(o,{variant:r.H5,children:t.category.replaceAll("_"," ")})]}),(0,m.jsx)(Mt,{collection:t})]}),(0,m.jsxs)("div",{className:I.headerContainerRight,children:[(0,m.jsx)(o,{variant:r.SMALL,children:"Creator:"}),(0,m.jsx)(o,{variant:r.SMALL,children:n}),t.create_time&&(0,m.jsx)(W,{labelText:"",timestamp:t.create_time.value,variant:"short",includeTooltip:!1,includeTime:!1}),t.update_time&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(w,{variant:"dot"}),(0,m.jsx)(W,{labelText:"Last Update",timestamp:t.update_time.value,variant:"long",includeTooltip:!1})]})]})]})}var A=s(l(),1);function k({collection:t}){return(0,A.jsx)(g,{header:(0,A.jsx)(xt,{collection:t}),className:I.container,borderVariant:f.LIGHT,children:(0,A.jsxs)("div",{className:I.body,children:[(0,A.jsxs)("div",{className:I.left,children:[t.description&&(0,A.jsx)(o,{variant:r.DEFAULT,className:I.content,children:t.description}),(0,A.jsx)(o,{variant:r.SMALL_SOURCE,className:I.content,children:t.query})]}),t.query&&(0,A.jsx)(Tt,{query:t.query,investigationName:`${t.name} Collection Investigation`})]})})}var b=s(M(),1);var V={intelliGuardCard:"RXCb6",errorState:"R8fDX",errorIcon:"_3tt2A",errorText:"OvJkM",retryButton:"at3VC"};var _=s(l(),1);function K({error:t,isLoading:n,onRetry:i}){return(0,_.jsx)(g,{className:V.intelliGuardCard,bodyPadding:N.DEFAULT,borderVariant:f.LIGHT,children:(0,_.jsxs)("div",{className:V.errorState,children:[(0,_.jsx)(v,{name:"alert",mode:"line",className:V.errorIcon}),(0,_.jsx)(o,{variant:r.H5,children:"Failed to analyze collection"}),(0,_.jsx)(o,{variant:r.DEFAULT,className:V.errorText,children:t}),(0,_.jsx)(O,{onClick:i,disabled:n,isLoading:n,className:V.retryButton,"aria-label":"Try again","data-testid":"retry-intelliguard-button",children:n?"Analyzing...":"Try Again"})]})})}var G={intelliGuardCard:"i0-xE",header:"DzlJr",titleSection:"-fCdj",headerIcon:"H639l",introState:"K4cgy",introContent:"hQL-A"};var C=s(l(),1);function q({isLoading:t,onRunIntelliGuard:n}){return(0,C.jsx)(g,{className:G.intelliGuardCard,bodyPadding:N.NONE,borderVariant:f.LIGHT,children:(0,C.jsxs)("div",{className:G.introState,children:[(0,C.jsxs)("div",{className:G.titleSection,children:[(0,C.jsx)(o,{variant:r.H5,children:"IntelliGuard Insights"}),(0,C.jsx)(v,{name:"shield",mode:"line",className:G.headerIcon})]}),(0,C.jsxs)("div",{className:G.introContent,children:[(0,C.jsx)(o,{variant:r.DEFAULT,children:"IntelliGuard analyzes your collection for security insights and potential threats."}),(0,C.jsx)("div",{className:G.messageContainer,children:(0,C.jsx)(lt,{variant:st.HINT,children:"Analysis may take up to a minute to complete."})}),(0,C.jsx)(O,{onClick:n,disabled:t,isLoading:t,"data-testid":"run-intelliguard-button","aria-label":"Run IntelliGuard analysis",children:t?"Analyzing...":"Run Security Analysis"})]})]})})}var Ht=s(M(),1);var a={intelliGuardCard:"-YNUT",intelliGuardContent:"ckdH-",header:"_6ojoe",titleSection:"gNtUJ",headerIcon:"VOM3s",insightCount:"oDtm-",summaryStats:"HPZwm",statItem:"N8vLw",statValue:"gsCLK",statLabel:"p3FZI",completedDate:"_7I-n3",dateText:"_6tCCA",accordionItem:"gM5y6",accordionHeader:"eBgrU",accordionHeaderOpen:"cI8ix",trigger:"pRDPg",triggerContent:"tLbxQ",nameAndArrow:"RCj9q",insightTitle:"Yn-2J",expandIcon:"p-Z-T",accordionContent:"VBMOz",accordionContentOpen:"_4tiuF",insightDetails:"-RQWF",insightSection:"q09Mn",sectionLabel:"Zx0a5",sectionContent:"CuI3r",timestamp:"vhM-m",timestampText:"iFkOU",emptyState:"_4qRTC",emptyIcon:"r4tj7",emptyText:"P7gG1",rerunButton:"_7aeQV"};var Rt={high:H.FEEDBACK_NEGATIVE_ICON,medium:H.FEEDBACK_CAUTION_ICON,low:H.FEEDBACK_POSITIVE_ICON},Ot={high:"error-warning",medium:"alert",low:"information"};var e=s(l(),1);function X({insights:t,isLoading:n,onRunIntelliGuard:i,formattedDate:c}){let[d,p]=(0,Ht.useState)([]);return t.final_insights.length===0?(0,e.jsx)(g,{className:a.intelliGuardCard,bodyPadding:N.NONE,borderVariant:f.LIGHT,children:(0,e.jsxs)("div",{className:a.emptyState,children:[(0,e.jsx)(v,{name:"shield-check",mode:"line",className:a.emptyIcon}),(0,e.jsx)(o,{variant:r.H5,children:"No security insights found"}),(0,e.jsx)(o,{variant:r.DEFAULT,className:a.emptyText,children:"No security issues were identified in your collection."}),(0,e.jsx)(O,{onClick:i,disabled:n,isLoading:n,className:a.rerunButton,"aria-label":"Run IntelliGuard analysis",children:n?"Analyzing...":"Run Again"})]})}):(0,e.jsx)(g,{className:a.intelliGuardCard,bodyPadding:N.NONE,borderVariant:f.LIGHT,children:(0,e.jsxs)("div",{className:a.intelliGuardContent,children:[(0,e.jsxs)("div",{className:a.header,children:[(0,e.jsxs)("div",{className:a.titleSection,children:[(0,e.jsx)(o,{variant:r.H5,children:"IntelliGuard Insights"}),(0,e.jsx)(v,{name:"shield",mode:"line",className:a.headerIcon})]}),(0,e.jsxs)(o,{variant:r.H5,className:a.insightCount,children:["(",t.final_insights.length,")"]})]}),(0,e.jsxs)("div",{className:a.summaryStats,children:[(0,e.jsxs)("div",{className:a.statItem,children:[(0,e.jsx)(o,{variant:r.H6,className:a.statValue,children:t.summary_stats.total_insights_generated}),(0,e.jsx)(o,{variant:r.SMALL,className:a.statLabel,children:"Insights Generated"})]}),(0,e.jsxs)("div",{className:a.statItem,children:[(0,e.jsx)(o,{variant:r.H6,className:a.statValue,children:t.summary_stats.hosts_investigated}),(0,e.jsx)(o,{variant:r.SMALL,className:a.statLabel,children:"Hosts Investigated"})]}),(0,e.jsxs)("div",{className:a.statItem,children:[(0,e.jsx)(o,{variant:r.H6,className:a.statValue,children:t.summary_stats.timeline_events_analyzed}),(0,e.jsx)(o,{variant:r.SMALL,className:a.statLabel,children:"Events Analyzed"})]})]}),(0,e.jsx)(At,{type:"multiple",value:d,onValueChange:p,children:t.final_insights.map((u,h)=>{let L=`insight-${h}`,D=d.includes(L),x=u.priority,z=Rt[x]||H.FEEDBACK_NEUTRAL_ICON,B=It(u.priority);return(0,e.jsxs)(St,{value:L,className:a.accordionItem,children:[(0,e.jsx)(Lt,{className:D?a.accordionHeaderOpen:"",children:(0,e.jsx)(_t,{className:a.trigger,children:(0,e.jsxs)("div",{className:a.triggerContent,children:[(0,e.jsx)(ut,{variant:z,size:"sm",contentLeft:(0,e.jsx)(v,{name:Ot[x],mode:"line",size:"sm"}),children:B}),(0,e.jsxs)("div",{className:a.nameAndArrow,children:[(0,e.jsx)(o,{variant:r.DEFAULT_SEMIBOLD,className:a.insightTitle,children:u.title}),(0,e.jsx)(v,{name:D?"arrow-up-s":"arrow-down-s",mode:"line",className:a.expandIcon})]})]})})}),(0,e.jsx)(Et,{className:R(a.accordionContent,D&&a.accordionContentOpen),children:(0,e.jsxs)("div",{className:a.insightDetails,children:[(0,e.jsxs)("div",{className:a.insightSection,children:[(0,e.jsx)(o,{variant:r.SMALL_SEMIBOLD,className:a.sectionLabel,children:"Insight"}),(0,e.jsx)(o,{variant:r.DEFAULT,className:a.sectionContent,children:u.insight})]}),(0,e.jsxs)("div",{className:a.insightSection,children:[(0,e.jsx)(o,{variant:r.SMALL_SEMIBOLD,className:a.sectionLabel,children:"Recommended Action"}),(0,e.jsx)(o,{variant:r.DEFAULT,className:a.sectionContent,children:u.action})]}),u.timestamp&&(0,e.jsx)("div",{className:a.timestamp,children:(0,e.jsxs)(o,{variant:r.SMALL,className:a.timestampText,children:[(0,e.jsx)(mt,{timestamp:u.timestamp,format:"MMM DD, YYYY"})," ","at"," ",(0,e.jsx)(pt,{timestamp:u.timestamp,format:"H:MM A UTC"})]})})]})})]},L)})}),c&&(0,e.jsx)("div",{className:a.completedDate,children:(0,e.jsxs)(o,{variant:r.SMALL,className:a.dateText,children:["Analysis completed at: ",c]})})]})})}var F=s(l(),1);function wt(t){if(!t)return;let n=parseInt(t,10);if(!isNaN(n))return Math.max(1,Math.min(100,n))}function Wt(t){if(t)return t!=="false"}function Yt(t){switch(t.code){case 15e4:return"Collection ID is required to run IntelliGuard analysis";case 150001:return"Organization not found";case 150002:return"IntelliGuard access not enabled for your organization";default:return"Failed to analyze collection"}}function $t(){let[t]=it();return(0,b.useMemo)(()=>{let n=Wt(t.get("run_censeye")),i=wt(t.get("page_size"));return{runCenseye:n,pageSize:i}},[t])}function kt(t){let n=nt(),i=$t();return{runIntelliGuard:(0,b.useCallback)(d=>{let p=new URLSearchParams;p.set("collectionId",t);let u=d?.runCenseye??i.runCenseye,h=d?.pageSize??i.pageSize;u!==void 0&&p.set("run_censeye",u.toString()),h!==void 0&&p.set("page_size",h.toString()),n.load(`/api/intelliguard/getCollectionsInsights?${p.toString()}`)},[n.load,t,i]),isLoading:n.state!=="idle",data:n.data,urlParams:i}}function Z(){let n=ot().id||"",{runIntelliGuard:i,isLoading:c,data:d,urlParams:p}=kt(n),u=d?.intelliGuardInsights??null,h=d?.intelliGuardError??null;!h&&d&&"code"in d&&(h=Yt(d)),(0,b.useEffect)(()=>{(p.runCenseye!==void 0||p.pageSize!==void 0)&&(!u&&!h&&!c)&&i()},[p,u,h,c,i]);let L=u?.summary_stats.investigation_completed_at,{formattedDate:D}=dt(L||"","MMM DD, YYYY"),{formattedTime:x}=ct(L||"","H:MM A UTC"),z=(0,b.useMemo)(()=>!L||!D||!x?null:`${D} at ${x}`,[L,D,x]);return h?(0,F.jsx)(K,{error:h,isLoading:c,onRetry:i}):u?(0,F.jsx)(X,{insights:u,isLoading:c,onRunIntelliGuard:i,formattedDate:z}):(0,F.jsx)(q,{isLoading:c,onRunIntelliGuard:i})}var J={SHARED_WITH_ORG:"Shared with organization",NOT_SHARED_WITH_ORG:"Not shared with organization"};var U={card:"A49jb",content:"ZH7h4",title:"i-K36",icon:"H4Sf9"};var E=s(l(),1);function Q({isSharedWithOrg:t}){return(0,E.jsx)(g,{bodyPadding:N.NONE,className:U.card,borderVariant:f.LIGHT,children:(0,E.jsxs)("div",{className:U.content,children:[(0,E.jsx)(o,{variant:r.H5,children:(0,E.jsxs)("div",{className:U.title,children:["Sharing",(0,E.jsx)(v,{"aria-hidden":!0,name:"group",mode:"line",size:"md","data-testid":"group-icon",className:U.icon})]})}),(0,E.jsx)(o,{variant:r.DEFAULT,children:t?J.SHARED_WITH_ORG:J.NOT_SHARED_WITH_ORG})]})})}var j=s(M(),1);var Pt=s(l(),1);function tt(){let{collection:t}=T(),n=t.collection_id,i=t.removed_assets_24_hours.value,c=(0,j.useMemo)(()=>Temporal.Now.zonedDateTimeISO().toPlainDate().toString(),[]),d=(0,j.useMemo)(()=>{let p=new Date;return p.setDate(p.getDate()-1),p.toISOString().split("T")[0]},[]);return(0,Pt.jsx)(P,{value:i,href:`/collections/${n}/history?event_type=${"asset_removed"}&start=${d}&end=${c}`,label:"Assets Removed | Last 24 Hrs"})}var Vt=s(M(),1);var Ut=s(l(),1);function et(){let{collection:t}=T(),n=t.collection_id,i=(0,Vt.useMemo)(()=>vt(t),[t.status]);return(0,Ut.jsx)(P,{value:i,href:`/collections/${n}/results`,label:"Total Assets"})}var Ft=s(M(),1);var at=s(l(),1);function rt(){let{collection:t}=T(),i=(t.size_metrics||[]).map(ht),c=(0,Ft.useMemo)(()=>{if(i.length===1){let d=i[0];return[d,{...d,datetime:Temporal.Instant.from(d.datetime).add({minutes:1}).toString()}]}return i},[i]);return(0,at.jsx)(g,{borderVariant:f.LIGHT,children:(0,at.jsx)(Dt,{title:"Max Assets Per Day",bottomTitle:"Past Month",emptyStateMessage:"No data available at this time",stats:[{title:"Max Assets Per Day",stats:c.map(d=>({...d,datetime:d.datetime.toString()}))}]})})}var S={container:"XH0Ab",topRow:"YKanZ",fullWidth:"kKXs-",secondRow:"S3UYL",right:"_17Fgc",intelliGuard:"xoilf"};var y=s(l(),1);function zt(){let{collection:t}=T(),i=yt()?.currentPlanType==="Free",c=!i&&ft("ai-collection-insights");return(0,y.jsxs)(gt,{children:[(0,y.jsx)(k,{collection:t}),(0,y.jsxs)("div",{className:S.container,children:[(0,y.jsxs)("div",{className:R(S.topRow,i&&S.fullWidth),children:[(0,y.jsx)(et,{}),(0,y.jsx)($,{}),(0,y.jsx)(tt,{}),!i&&(0,y.jsx)("div",{className:S.right,children:(0,y.jsx)(Q,{isSharedWithOrg:t.shared_with_org})})]}),(0,y.jsxs)("div",{className:R(S.secondRow,!c&&S.fullWidth),children:[(0,y.jsx)(rt,{}),c&&(0,y.jsx)("div",{className:R(S.right,S.intelliGuard),children:(0,y.jsx)(Z,{})})]})]})]})}export{zt as default};
