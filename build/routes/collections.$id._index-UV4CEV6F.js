import{a as H}from"/censys/build/_shared/chunk-GBTG3X5R.js";import"/censys/build/_shared/chunk-6JZTKLEX.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import{a as Et}from"/censys/build/_shared/chunk-5O6NP3HX.js";import"/censys/build/_shared/chunk-XLW6D2H7.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import{a as Y}from"/censys/build/_shared/chunk-LQXVLPA4.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as Nt,b as At,c as St,d as Lt,e as _t}from"/censys/build/_shared/chunk-MBWLTMZZ.js";import"/censys/build/_shared/chunk-FKAW57YX.js";import{c as gt,k as vt}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import"/censys/build/_shared/chunk-WMKH6XX3.js";import"/censys/build/_shared/chunk-3JU625ZU.js";import"/censys/build/_shared/chunk-I5BA26X4.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-JLZAPT5W.js";import"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{j as Tt}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as B}from"/censys/build/_shared/chunk-HG7D3PDC.js";import"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-V6YEAJYZ.js";import"/censys/build/_shared/chunk-YZ2VHXR4.js";import"/censys/build/_shared/chunk-KIDII43I.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-2G5R6E4Q.js";import"/censys/build/_shared/chunk-6XVOHWMX.js";import{l as Ct,m as ht}from"/censys/build/_shared/chunk-HLRAT4GD.js";import{a as It}from"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-W2GUOEY7.js";import"/censys/build/_shared/chunk-FQAS3FYV.js";import"/censys/build/_shared/chunk-P2FXGQA2.js";import{h as yt}from"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import{g as ft}from"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as r,B as o,Ga as dt,Ha as mt,Ia as ct,Ja as pt,Oa as R,Pa as ut,aa as O,fa as st,ga as lt,ta as f,ua as N,va as C,y as U,z as g}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{C as nt,f as T,g as ot,p as it}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as D,c as l}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as n}from"/censys/build/_shared/chunk-2QEWK57A.js";var $=n(D(),1);var Dt=n(l(),1);function k(){let{collection:t}=T(),i=t.collection_id,s=t.added_assets_24_hours.value,u=(0,$.useMemo)(()=>new Date().toISOString().split("T")[0],[]),c=(0,$.useMemo)(()=>{let m=new Date;return m.setDate(m.getDate()-1),m.toISOString().split("T")[0]},[]);return(0,Dt.jsx)(H,{value:s,href:`/collections/${i}/history?event_type=${"asset_added"}&start=${c}&end=${u}`,label:"Assets Added | Last 24 Hrs"})}var Mt=n(D(),1);var h={container:"bKz66",headerContainer:"mVdCM",headerContainerLeft:"_2G-g1",headerContainerRight:"ySdzI",collectionName:"tIJgy",body:"scBHL",left:"AwljX",content:"d29XQ",icon:"D-Y10"};var d=n(l(),1);function Gt({collection:t}){let i=(0,Mt.useMemo)(()=>{let s=t.createdByUser;return s?vt(s):"Unknown"},[t.createdByUser]);return(0,d.jsxs)("div",{className:h.headerContainer,children:[(0,d.jsxs)("div",{className:h.headerContainerLeft,children:[(0,d.jsx)(o,{variant:r.H2,className:h.collectionName,children:t.name}),t.category!==ft.Category.CATEGORY_UNSPECIFIED&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(B,{variant:"dot"}),(0,d.jsx)(o,{variant:r.H5,children:t.category.replaceAll("_"," ")})]}),t.shared_with_org&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(B,{variant:"dot"}),(0,d.jsx)(g,{"aria-hidden":!0,name:"group",mode:"line",size:"xl","data-testid":"group-icon",className:h.icon})]})]}),(0,d.jsxs)("div",{className:h.headerContainerRight,children:[(0,d.jsx)(o,{variant:r.SMALL,children:"Creator:"}),(0,d.jsx)(o,{variant:r.SMALL,children:i}),t.create_time&&(0,d.jsx)(Y,{labelText:"",timestamp:t.create_time,variant:"short",includeTooltip:!1,includeTime:!1}),t.update_time&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(B,{variant:"dot"}),(0,d.jsx)(Y,{labelText:"Last Update",timestamp:t.update_time,variant:"long",includeTooltip:!1})]})]})]})}var A=n(l(),1);function W({collection:t}){return(0,A.jsx)(C,{header:(0,A.jsx)(Gt,{collection:t}),className:h.container,borderVariant:f.LIGHT,children:(0,A.jsxs)("div",{className:h.body,children:[(0,A.jsxs)("div",{className:h.left,children:[t.description&&(0,A.jsx)(o,{variant:r.DEFAULT,className:h.content,children:t.description}),(0,A.jsx)(o,{variant:r.SMALL_SOURCE,className:h.content,children:t.query})]}),t.query&&(0,A.jsx)(Tt,{query:t.query,investigationName:`${t.name} Collection Investigation`})]})})}var G=n(D(),1);var P={intelliGuardCard:"RXCb6",errorState:"R8fDX",errorIcon:"_3tt2A",errorText:"OvJkM",retryButton:"at3VC"};var L=n(l(),1);function K({error:t,isLoading:i,onRetry:s}){return(0,L.jsx)(C,{className:P.intelliGuardCard,bodyPadding:N.DEFAULT,borderVariant:f.LIGHT,children:(0,L.jsxs)("div",{className:P.errorState,children:[(0,L.jsx)(g,{name:"alert",mode:"line",className:P.errorIcon}),(0,L.jsx)(o,{variant:r.H5,children:"Failed to analyze collection"}),(0,L.jsx)(o,{variant:r.DEFAULT,className:P.errorText,children:t}),(0,L.jsx)(O,{onClick:s,disabled:i,isLoading:i,className:P.retryButton,"aria-label":"Try again","data-testid":"retry-intelliguard-button",children:i?"Analyzing...":"Try Again"})]})})}var M={intelliGuardCard:"i0-xE",header:"DzlJr",titleSection:"-fCdj",headerIcon:"H639l",introState:"K4cgy",introContent:"hQL-A"};var v=n(l(),1);function q({isLoading:t,onRunIntelliGuard:i}){return(0,v.jsx)(C,{className:M.intelliGuardCard,bodyPadding:N.NONE,borderVariant:f.LIGHT,children:(0,v.jsxs)("div",{className:M.introState,children:[(0,v.jsxs)("div",{className:M.titleSection,children:[(0,v.jsx)(o,{variant:r.H5,children:"IntelliGuard Insights"}),(0,v.jsx)(g,{name:"shield",mode:"line",className:M.headerIcon})]}),(0,v.jsxs)("div",{className:M.introContent,children:[(0,v.jsx)(o,{variant:r.DEFAULT,children:"IntelliGuard analyzes your collection for security insights and potential threats."}),(0,v.jsx)("div",{className:M.messageContainer,children:(0,v.jsx)(lt,{variant:st.HINT,children:"Analysis may take up to a minute to complete."})}),(0,v.jsx)(O,{onClick:i,disabled:t,isLoading:t,"data-testid":"run-intelliguard-button","aria-label":"Run IntelliGuard analysis",children:t?"Analyzing...":"Run Security Analysis"})]})]})})}var Ot=n(D(),1);var a={intelliGuardCard:"-YNUT",intelliGuardContent:"ckdH-",header:"_6ojoe",titleSection:"gNtUJ",headerIcon:"VOM3s",insightCount:"oDtm-",summaryStats:"HPZwm",statItem:"N8vLw",statValue:"gsCLK",statLabel:"p3FZI",completedDate:"_7I-n3",dateText:"_6tCCA",accordionItem:"gM5y6",accordionHeader:"eBgrU",accordionHeaderOpen:"cI8ix",trigger:"pRDPg",triggerContent:"tLbxQ",nameAndArrow:"RCj9q",insightTitle:"Yn-2J",expandIcon:"p-Z-T",accordionContent:"VBMOz",accordionContentOpen:"_4tiuF",insightDetails:"-RQWF",insightSection:"q09Mn",sectionLabel:"Zx0a5",sectionContent:"CuI3r",timestamp:"vhM-m",timestampText:"iFkOU",emptyState:"_4qRTC",emptyIcon:"r4tj7",emptyText:"P7gG1",rerunButton:"_7aeQV"};var bt={high:R.FEEDBACK_NEGATIVE_ICON,medium:R.FEEDBACK_CAUTION_ICON,low:R.FEEDBACK_POSITIVE_ICON},xt={high:"error-warning",medium:"alert",low:"information"};var e=n(l(),1);function X({insights:t,isLoading:i,onRunIntelliGuard:s,formattedDate:u}){let[c,m]=(0,Ot.useState)([]);return t.final_insights.length===0?(0,e.jsx)(C,{className:a.intelliGuardCard,bodyPadding:N.NONE,borderVariant:f.LIGHT,children:(0,e.jsxs)("div",{className:a.emptyState,children:[(0,e.jsx)(g,{name:"shield-check",mode:"line",className:a.emptyIcon}),(0,e.jsx)(o,{variant:r.H5,children:"No security insights found"}),(0,e.jsx)(o,{variant:r.DEFAULT,className:a.emptyText,children:"No security issues were identified in your collection."}),(0,e.jsx)(O,{onClick:s,disabled:i,isLoading:i,className:a.rerunButton,"aria-label":"Run IntelliGuard analysis",children:i?"Analyzing...":"Run Again"})]})}):(0,e.jsx)(C,{className:a.intelliGuardCard,bodyPadding:N.NONE,borderVariant:f.LIGHT,children:(0,e.jsxs)("div",{className:a.intelliGuardContent,children:[(0,e.jsxs)("div",{className:a.header,children:[(0,e.jsxs)("div",{className:a.titleSection,children:[(0,e.jsx)(o,{variant:r.H5,children:"IntelliGuard Insights"}),(0,e.jsx)(g,{name:"shield",mode:"line",className:a.headerIcon})]}),(0,e.jsxs)(o,{variant:r.H5,className:a.insightCount,children:["(",t.final_insights.length,")"]})]}),(0,e.jsxs)("div",{className:a.summaryStats,children:[(0,e.jsxs)("div",{className:a.statItem,children:[(0,e.jsx)(o,{variant:r.H6,className:a.statValue,children:t.summary_stats.total_insights_generated}),(0,e.jsx)(o,{variant:r.SMALL,className:a.statLabel,children:"Insights Generated"})]}),(0,e.jsxs)("div",{className:a.statItem,children:[(0,e.jsx)(o,{variant:r.H6,className:a.statValue,children:t.summary_stats.hosts_investigated}),(0,e.jsx)(o,{variant:r.SMALL,className:a.statLabel,children:"Hosts Investigated"})]}),(0,e.jsxs)("div",{className:a.statItem,children:[(0,e.jsx)(o,{variant:r.H6,className:a.statValue,children:t.summary_stats.timeline_events_analyzed}),(0,e.jsx)(o,{variant:r.SMALL,className:a.statLabel,children:"Events Analyzed"})]})]}),(0,e.jsx)(Nt,{type:"multiple",value:c,onValueChange:m,children:t.final_insights.map((p,I)=>{let S=`insight-${I}`,E=c.includes(S),x=p.priority,F=bt[x]||R.FEEDBACK_NEUTRAL_ICON,w=It(p.priority);return(0,e.jsxs)(At,{value:S,className:a.accordionItem,children:[(0,e.jsx)(St,{className:E?a.accordionHeaderOpen:"",children:(0,e.jsx)(Lt,{className:a.trigger,children:(0,e.jsxs)("div",{className:a.triggerContent,children:[(0,e.jsx)(ut,{variant:F,size:"sm",contentLeft:(0,e.jsx)(g,{name:xt[x],mode:"line",size:"sm"}),children:w}),(0,e.jsxs)("div",{className:a.nameAndArrow,children:[(0,e.jsx)(o,{variant:r.DEFAULT_SEMIBOLD,className:a.insightTitle,children:p.title}),(0,e.jsx)(g,{name:E?"arrow-up-s":"arrow-down-s",mode:"line",className:a.expandIcon})]})]})})}),(0,e.jsx)(_t,{className:U(a.accordionContent,E&&a.accordionContentOpen),children:(0,e.jsxs)("div",{className:a.insightDetails,children:[(0,e.jsxs)("div",{className:a.insightSection,children:[(0,e.jsx)(o,{variant:r.SMALL_SEMIBOLD,className:a.sectionLabel,children:"Insight"}),(0,e.jsx)(o,{variant:r.DEFAULT,className:a.sectionContent,children:p.insight})]}),(0,e.jsxs)("div",{className:a.insightSection,children:[(0,e.jsx)(o,{variant:r.SMALL_SEMIBOLD,className:a.sectionLabel,children:"Recommended Action"}),(0,e.jsx)(o,{variant:r.DEFAULT,className:a.sectionContent,children:p.action})]}),p.timestamp&&(0,e.jsx)("div",{className:a.timestamp,children:(0,e.jsxs)(o,{variant:r.SMALL,className:a.timestampText,children:[(0,e.jsx)(mt,{timestamp:p.timestamp,format:"MMM DD, YYYY"})," ","at"," ",(0,e.jsx)(pt,{timestamp:p.timestamp,format:"H:MM A UTC"})]})})]})})]},S)})}),u&&(0,e.jsx)("div",{className:a.completedDate,children:(0,e.jsxs)(o,{variant:r.SMALL,className:a.dateText,children:["Analysis completed at: ",u]})})]})})}var z=n(l(),1);function zt(t){if(!t)return;let i=parseInt(t,10);if(!isNaN(i))return Math.max(1,Math.min(100,i))}function Ft(t){if(t)return t!=="false"}function wt(t){switch(t.code){case 15e4:return"Collection ID is required to run IntelliGuard analysis";case 150001:return"Organization not found";case 150002:return"IntelliGuard access not enabled for your organization";default:return"Failed to analyze collection"}}function Yt(){let[t]=it();return(0,G.useMemo)(()=>{let i=Ft(t.get("run_censeye")),s=zt(t.get("page_size"));return{runCenseye:i,pageSize:s}},[t])}function $t(t){let i=nt(),s=Yt();return{runIntelliGuard:(0,G.useCallback)(c=>{let m=new URLSearchParams;m.set("collectionId",t);let p=c?.runCenseye??s.runCenseye,I=c?.pageSize??s.pageSize;p!==void 0&&m.set("run_censeye",p.toString()),I!==void 0&&m.set("page_size",I.toString()),i.load(`/api/intelliguard/getCollectionsInsights?${m.toString()}`)},[i.load,t,s]),isLoading:i.state!=="idle",data:i.data,urlParams:s}}function Z(){let i=ot().id||"",{runIntelliGuard:s,isLoading:u,data:c,urlParams:m}=$t(i),p=c?.intelliGuardInsights??null,I=c?.intelliGuardError??null;!I&&c&&"code"in c&&(I=wt(c)),(0,G.useEffect)(()=>{(m.runCenseye!==void 0||m.pageSize!==void 0)&&(!p&&!I&&!u)&&s()},[m,p,I,u,s]);let S=p?.summary_stats.investigation_completed_at,{formattedDate:E}=dt(S||"","MMM DD, YYYY"),{formattedTime:x}=ct(S||"","H:MM A UTC"),F=(0,G.useMemo)(()=>!S||!E||!x?null:`${E} at ${x}`,[S,E,x]);return I?(0,z.jsx)(K,{error:I,isLoading:u,onRetry:s}):p?(0,z.jsx)(X,{insights:p,isLoading:u,onRunIntelliGuard:s,formattedDate:F}):(0,z.jsx)(q,{isLoading:u,onRunIntelliGuard:s})}var J={SHARED_WITH_ORG:"Shared with organization",NOT_SHARED_WITH_ORG:"Not shared with organization"};var V={card:"A49jb",content:"ZH7h4",title:"i-K36",icon:"H4Sf9"};var _=n(l(),1);function Q({isSharedWithOrg:t}){return(0,_.jsx)(C,{bodyPadding:N.NONE,className:V.card,borderVariant:f.LIGHT,children:(0,_.jsxs)("div",{className:V.content,children:[(0,_.jsx)(o,{variant:r.H5,children:(0,_.jsxs)("div",{className:V.title,children:["Sharing",(0,_.jsx)(g,{"aria-hidden":!0,name:"group",mode:"line",size:"md","data-testid":"group-icon",className:V.icon})]})}),(0,_.jsx)(o,{variant:r.DEFAULT,children:t?J.SHARED_WITH_ORG:J.NOT_SHARED_WITH_ORG})]})})}var j=n(D(),1);var Rt=n(l(),1);function tt(){let{collection:t}=T(),i=t.collection_id,s=t.removed_assets_24_hours.value,u=(0,j.useMemo)(()=>new Date().toISOString().split("T")[0],[]),c=(0,j.useMemo)(()=>{let m=new Date;return m.setDate(m.getDate()-1),m.toISOString().split("T")[0]},[]);return(0,Rt.jsx)(H,{value:s,href:`/collections/${i}/history?event_type=${"asset_removed"}&start=${c}&end=${u}`,label:"Assets Removed | Last 24 Hrs"})}var Ht=n(D(),1);var Pt=n(l(),1);function et(){let{collection:t}=T(),i=t.collection_id,s=(0,Ht.useMemo)(()=>ht(t),[t.status]);return(0,Pt.jsx)(H,{value:s,href:`/collections/${i}/results`,label:"Total Assets"})}var Vt=n(D(),1);var at=n(l(),1);function rt(){let{collection:t}=T(),s=(t.size_metrics||[]).map(Ct),u=(0,Vt.useMemo)(()=>{if(s.length===1){let c=s[0],m=new Date(c.datetime);return[c,{...c,datetime:new Date(m.getTime()+60*1e3).toISOString()}]}return s},[s]);return(0,at.jsx)(C,{borderVariant:f.LIGHT,children:(0,at.jsx)(Et,{title:"Max Assets Per Day",bottomTitle:"Past Month",emptyStateMessage:"No data available at this time",stats:[{title:"Max Assets Per Day",stats:u}]})})}var b={container:"XH0Ab",topRow:"YKanZ",secondRow:"S3UYL",right:"_17Fgc",intelliGuard:"xoilf"};var y=n(l(),1);function Ut(){let{collection:t}=T(),i=yt("ai-collection-insights");return(0,y.jsxs)(gt,{children:[(0,y.jsx)(W,{collection:t}),(0,y.jsxs)("div",{className:b.container,children:[(0,y.jsxs)("div",{className:b.topRow,children:[(0,y.jsx)(et,{}),(0,y.jsx)(k,{}),(0,y.jsx)(tt,{}),(0,y.jsx)("div",{className:b.right,children:(0,y.jsx)(Q,{isSharedWithOrg:t.shared_with_org})})]}),(0,y.jsxs)("div",{className:b.secondRow,children:[(0,y.jsx)(rt,{}),i&&(0,y.jsx)("div",{className:U(b.right,b.intelliGuard),children:(0,y.jsx)(Z,{})})]})]})]})}export{Ut as default};
