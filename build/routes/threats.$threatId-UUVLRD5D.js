import{a as _}from"/censys/build/_shared/chunk-2RBWCKKD.js";import{b as ne}from"/censys/build/_shared/chunk-J5TBCVJG.js";import{a as se}from"/censys/build/_shared/chunk-37QSTPVF.js";import{a as ie,b as P}from"/censys/build/_shared/chunk-5O6NP3HX.js";import"/censys/build/_shared/chunk-XLW6D2H7.js";import{a as re}from"/censys/build/_shared/chunk-BVX6X5MK.js";import"/censys/build/_shared/chunk-SNE5KUVT.js";import{a as oe,d as M}from"/censys/build/_shared/chunk-AIDQO3P6.js";import"/censys/build/_shared/chunk-6PRZAB44.js";import{a as fe}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as te}from"/censys/build/_shared/chunk-6GD6JLZ2.js";import{c as H,m as I}from"/censys/build/_shared/chunk-ZMYU5ULY.js";import{b as ee}from"/censys/build/_shared/chunk-WMKH6XX3.js";import"/censys/build/_shared/chunk-3JU625ZU.js";import"/censys/build/_shared/chunk-I5BA26X4.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-JLZAPT5W.js";import"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{d as ae}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as Y}from"/censys/build/_shared/chunk-HG7D3PDC.js";import{a as w}from"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-EYKPJWWG.js";import"/censys/build/_shared/chunk-V6YEAJYZ.js";import"/censys/build/_shared/chunk-YZ2VHXR4.js";import{a as R}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-KIDII43I.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-2G5R6E4Q.js";import"/censys/build/_shared/chunk-6XVOHWMX.js";import{o as J}from"/censys/build/_shared/chunk-HLRAT4GD.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as D}from"/censys/build/_shared/chunk-W2GUOEY7.js";import"/censys/build/_shared/chunk-FQAS3FYV.js";import{b as E}from"/censys/build/_shared/chunk-P2FXGQA2.js";import"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import{B as j,C as Q}from"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as s,B as e,C,ua as N,va as L,z as X}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as K,k as Z}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as x,c as f}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as m}from"/censys/build/_shared/chunk-2QEWK57A.js";var S=m(x(),1);var T={threatActivityCard:"q01F3",threatActivityHeader:"vvAWZ",threatActivityChart:"ApsIh",threatActivityLegend:"ocucg",threatActivityLegendItem:"fzlbB",threatActivityLegendItemLine:"wW1Bk"};function le(t,i){let r=_(t),p=_(i);return Math.max(r,p)}function ce(t){return`Past ${t} ${R("Day",t)}`}var c=m(f(),1);function U({hostMetrics:t,webMetrics:i}){let r=(0,S.useMemo)(()=>{let u=(t?.counts??[]).map(k=>({datetime:k.timestamp??"",count:BigInt(k.count)}));return P(u)},[t]),p=(0,S.useMemo)(()=>{let u=(i?.counts??[]).map(k=>({datetime:k.timestamp??"",count:BigInt(k.count)}));return P(u)},[i]),y=(0,S.useMemo)(()=>le(r,p),[r,p]);return(0,c.jsxs)(L,{bodyPadding:N.NONE,className:T.threatActivityCard,children:[(0,c.jsxs)("div",{className:T.threatActivityHeader,children:[(0,c.jsx)(e,{variant:s.H4,children:"Threat Activity"}),(0,c.jsx)(e,{variant:s.SMALL,children:"|"}),(0,c.jsx)(e,{variant:s.H5,children:ce(y)})]}),(0,c.jsx)("div",{className:T.threatActivityChart,children:(0,c.jsx)(ie,{title:"Total Assets",stats:[{title:"Hosts",stats:r},{title:"Web Properties",stats:p}],fillColors:["transparent"],strokeColors:["var(--color-theme-brand-peach)"],strokeDashArrays:["0","4,4"],lineThickness:2})}),(0,c.jsxs)("div",{className:T.threatActivityLegend,children:[(0,c.jsxs)("div",{className:T.threatActivityLegendItem,children:[(0,c.jsx)("svg",{className:T.threatActivityLegendItemLine,viewBox:"0 0 34 4",children:(0,c.jsx)("path",{d:"M 0 2 L 34 2",stroke:"var(--color-theme-brand-peach)",strokeWidth:"2"})}),(0,c.jsx)(e,{variant:s.H5,children:"Hosts"})]}),(0,c.jsxs)("div",{className:T.threatActivityLegendItem,children:[(0,c.jsx)("svg",{className:T.threatActivityLegendItemLine,viewBox:"0 0 34 4",children:(0,c.jsx)("path",{d:"M 0 2 L 34 2",stroke:"var(--color-theme-brand-peach)",strokeWidth:"2",strokeDasharray:"4,4"})}),(0,c.jsx)(e,{variant:s.H5,children:"Web Properties"})]})]})]})}var pe="https://attack.mitre.org/groups/",me="https://malpedia.caad.fkie.fraunhofer.de/actor/";var o={threatActorsCard:"SrvcT",cardGroup:"_0crbc",groupSection:"Edu2w",sectionHeader:"xzK1d",actor:"xCjBl",actorLeft:"Wwbch",actorRight:"m0xOk",actorIcon:"-RdkE",actorPrimaryName:"m6ggr",actorAllNames:"_5kKHm",linkList:"a6Csc",actorLink:"uMUqO",actorLinkLabel:"Kes4n",actorLinkLabelText:"lWgfv",actorLinkValue:"iK1NB"};var a=m(f(),1);function G({threatDetails:t}){return t?.actorInfo.size?(0,a.jsx)(L,{bodyPadding:N.NONE,className:o.threatActorsCard,children:(0,a.jsx)("div",{className:o.cardGroup,children:(0,a.jsxs)("div",{className:o.groupSection,children:[(0,a.jsx)(e,{variant:s.H4,className:o.sectionHeader,children:"Actor Details"}),Array.from(t.actorInfo.entries()).map(([i,r])=>(0,a.jsxs)("div",{className:o.actor,children:[(0,a.jsxs)("div",{className:o.actorLeft,children:[(0,a.jsx)(X,{className:o.actorIcon,name:"spy",mode:"line"}),(0,a.jsxs)("div",{className:o.actorNames,children:[(0,a.jsx)(e,{className:o.actorPrimaryName,variant:s.H3,children:r?.actor?.primaryName??"Unknown"}),r?.actor?.allNames?.length?(0,a.jsx)(e,{className:o.actorAllNames,children:r?.actor.allNames.join(", ")}):null]})]}),(0,a.jsx)("div",{className:o.actorRight,children:(0,a.jsxs)("div",{className:o.cardGroup,children:[r?.description&&(0,a.jsxs)("div",{className:o.groupSection,children:[(0,a.jsx)(e,{className:o.sectionHeader,variant:s.H5,children:"Description"}),(0,a.jsx)(e,{variant:s.SMALL,children:r?.description})]}),(0,a.jsx)("div",{className:o.groupSection,children:(0,a.jsxs)("ul",{className:o.linkList,children:[r?.actor?.mitreGroupId&&(0,a.jsxs)("li",{className:o.actorLink,children:[(0,a.jsx)("div",{className:o.actorLinkLabel,children:(0,a.jsx)(e,{children:"MITRE"})}),(0,a.jsx)("div",{className:o.actorLinkValue,children:(0,a.jsx)(D,{className:o.relatedLink,href:`${pe}${r?.actor.mitreGroupId}`,isExternal:!0,showExternalIcon:!0,children:r?.actor?.mitreGroupId})})]}),r?.actor?.malpediaGroupId&&(0,a.jsxs)("li",{className:o.actorLink,children:[(0,a.jsx)("div",{className:o.actorLinkLabel,children:(0,a.jsx)(e,{className:o.actorLinkLabelText,children:"Malpedia"})}),(0,a.jsx)("div",{className:o.actorLinkValue,children:(0,a.jsx)(D,{className:o.relatedLink,href:`${me}${r?.actor.malpediaGroupId}`,isExternal:!0,showExternalIcon:!0,children:r?.actor?.malpediaGroupId})})]})]})})]})})]},i))]})})}):null}var B=m(x(),1);var g={threatDetailHeader:"jnibv",threatHeaderLeft:"zFsa0",threatHeaderDetails:"aLy1n",threatHeaderDetailsTitle:"_1st6g",threatType:"x1-sH",allNames:"X-E9X",threatHeaderActions:"-chew"};var d=m(f(),1);function $({threatTypes:t,threatDetails:i}){let r=(0,B.useMemo)(()=>j(i?.name??""),[i?.name]),p=J({query:r,source:"threat"}),y=(0,B.useMemo)(()=>(i?.malwareInfo?.values()?.next()?.value?.malware?.allNames??[]).filter(u=>u!==i?.name),[i]);return(0,d.jsxs)("div",{className:g.threatDetailHeader,children:[(0,d.jsxs)("div",{className:g.threatHeaderLeft,children:[(0,d.jsx)(se,{size:"large"}),(0,d.jsxs)("div",{className:g.threatHeaderDetails,children:[(0,d.jsxs)("div",{className:g.threatHeaderDetailsTitle,children:[(0,d.jsx)(e,{variant:s.H1,children:i?.name??"Unknown"}),(0,d.jsx)(Y,{variant:"dot"}),(0,d.jsx)(e,{className:g.threatType,variant:s.H5,children:t.join(", ")})]}),y.length?(0,d.jsxs)("div",{className:g.threatAka,children:[(0,d.jsx)(e,{variant:s.H5,as:"span",children:"AKA:"})," ",(0,d.jsx)(e,{className:g.allNames,children:y.join(", ")})]}):null]})]}),(0,d.jsxs)("div",{className:g.threatHeaderActions,children:[(0,d.jsx)(w,{link:{to:p,["aria-label"]:`Add ${i?.name} to My Collections`,target:"_blank"},button:{variant:C.DEFAULT,iconLeft:"add"},children:"Add to My Collections"}),(0,d.jsx)(w,{link:{to:Q(i?.name??""),["aria-label"]:`Search for ${i?.name}`,target:"_blank"},button:{variant:C.PRIMARY,iconLeft:"search",iconLeftMode:"line"},children:"View All Threat Assets"})]})]})}var he=m(x(),1);var de="https://malpedia.caad.fkie.fraunhofer.de/details/";var h={threatDetailsCard:"_5nsck",threatDetails:"x2GxP",cardGroup:"S3tlD",groupSection:"_1wfZ9",sectionHeader:"UEn0J",threatDetailsTable:"_7nxtF",rowLabel:"y0ZLY",linkList:"-yEmk"};var n=m(f(),1);function O({threatDetails:t,threatTypes:i,threatTactics:r}){let p=(0,he.useMemo)(()=>{let b=Array.from(t?.malwareInfo.values()??[]).filter(v=>!!v.malware?.malpediaId&&!!v.malware?.primaryName).map(v=>({label:`${v.malware?.primaryName} at Malpedia`,href:`${de}${v.malware?.malpediaId}`})),k=(t?.references??[]).map(v=>({label:v.link,href:v.link})),ve=[...b,...k],q=[],F=new Set;for(let v of ve)F.has(v.href)||(F.add(v.href),q.push(v));return q},[t?.references,t?.malwareInfo]);return(0,n.jsx)(L,{bodyPadding:N.NONE,className:h.threatDetailsCard,children:(0,n.jsxs)("div",{className:h.threatDetails,children:[(0,n.jsx)("div",{className:h.cardGroup,children:(0,n.jsxs)("div",{className:h.groupSection,children:[(0,n.jsx)(e,{variant:s.H4,className:h.sectionHeader,children:"Details"}),(0,n.jsx)("div",{className:h.threatDetailsTable,children:(0,n.jsxs)(oe,{children:[(0,n.jsx)(M,{label:"Type",content:i.join(", ")}),r?.length?(0,n.jsx)(M,{label:"Tactic",content:r.join(", ")}):null]})})]})}),(0,n.jsxs)("div",{className:h.cardGroup,children:[(0,n.jsxs)("div",{className:h.groupSection,children:[(0,n.jsx)(e,{variant:s.H4,className:h.sectionHeader,children:"Description"}),(0,n.jsx)(e,{variant:s.SMALL,children:t?.description})]}),p.length?(0,n.jsxs)("div",{"data-testid":"related-links",className:h.groupSection,children:[(0,n.jsx)(e,{variant:s.H4,className:h.sectionHeader,children:"Related Links"}),(0,n.jsx)("div",{className:h.threatDetailsRightReferences,children:(0,n.jsx)("ul",{className:h.linkList,children:p.map(y=>(0,n.jsx)("li",{children:(0,n.jsx)(e,{variant:s.H6,children:(0,n.jsx)(D,{href:y.href,isExternal:!0,showExternalIcon:!0,children:y.label})})},y.href))})})]}):null]})]})})}var z={container:"djS1X",header:"sHywF"};var A=m(f(),1);function W({screenshots:t,threatName:i}){let r=`${i} ${R("Screenshot",t.length)}`;return(0,A.jsx)(L,{bodyPadding:N.NONE,children:(0,A.jsxs)("div",{className:z.container,children:[(0,A.jsxs)("div",{className:z.header,children:[(0,A.jsxs)(e,{variant:s.H4,children:["Screenshots (",t.length,")"]}),(0,A.jsx)(ee,{})]}),(0,A.jsx)(ne,{assetName:r,screenshots:t,width:360})]})})}var V={threatMainContent:"pz8Po",topRow:"NzzKM"};var ge=m(fe(),1),l=m(f(),1);function ye(){let{hostMetrics:t,webMetrics:i,threatId:r,threatDetails:p,threatTypes:y,threatTactics:b,threatScreenshots:u}=re();return(0,l.jsx)(I,{slots:{header:(0,l.jsx)($,{threatId:r,threatTypes:y,threatDetails:p})},breadcrumbs:[{linkElement:(0,l.jsx)(E,{to:"/threats",children:"Explore"})},{pathName:p?.name??"Threat Details"}],children:(0,l.jsx)(H,{children:(0,l.jsxs)("div",{className:V.threatMainContent,children:[(0,l.jsxs)("div",{className:V.topRow,children:[(0,l.jsx)(U,{hostMetrics:t,webMetrics:i}),u.length>0&&(0,l.jsx)(W,{threatName:p?.name??"Threat",screenshots:u})]}),(0,l.jsx)(O,{threatDetails:p,threatTypes:y,threatTactics:b}),(0,l.jsx)(G,{threatDetails:p})]})})})}function Te(){let t=Z(),i=[{linkElement:(0,l.jsx)(E,{to:"/threats",children:"Threats"})},{pathName:"Threat Details"}];return K(t)?(0,l.jsx)(I,{breadcrumbs:i,children:(0,l.jsx)(H,{children:(0,l.jsx)(ae,{iconName:"alert",title:"Error Loading Threat Data",children:(0,l.jsx)(e,{children:"We encountered a problem while loading the threat details. Please try again later."})})})}):(0,l.jsx)(I,{breadcrumbs:i,children:(0,l.jsx)(H,{children:(0,l.jsx)(te,{error:t})})})}export{Te as ErrorBoundary,ye as default};
