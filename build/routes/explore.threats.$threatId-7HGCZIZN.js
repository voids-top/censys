import{a as le,b as U}from"/censys/build/_shared/chunk-6BMUL27E.js";import{a as P,b as ne}from"/censys/build/_shared/chunk-O3F6VABR.js";import{a as ce,b as me}from"/censys/build/_shared/chunk-VJO7D5U3.js";import"/censys/build/_shared/chunk-XLW6D2H7.js";import{d as se}from"/censys/build/_shared/chunk-CSKRXOFQ.js";import{a as ie,d as w}from"/censys/build/_shared/chunk-YUXBXUAH.js";import{a as ae}from"/censys/build/_shared/chunk-YTHNDA7O.js";import{d as oe}from"/censys/build/_shared/chunk-Y2IQJ4EL.js";import"/censys/build/_shared/chunk-4KKS33MW.js";import"/censys/build/_shared/chunk-IUMSQHOS.js";import{a as H}from"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-JAEJ7XSF.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import{a as re}from"/censys/build/_shared/chunk-OFRBI5JW.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import{a as ge}from"/censys/build/_shared/chunk-IC5AY47K.js";import{c as D,r as S}from"/censys/build/_shared/chunk-B5UNN2SO.js";import"/censys/build/_shared/chunk-TUDXVIEL.js";import"/censys/build/_shared/chunk-7C4UGOB7.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-JDWADSGD.js";import"/censys/build/_shared/chunk-EMHGEENV.js";import"/censys/build/_shared/chunk-4WX73TCZ.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-5OP2ERYU.js";import"/censys/build/_shared/chunk-LOKTUJJ3.js";import"/censys/build/_shared/chunk-BU2LL35M.js";import{l as j}from"/censys/build/_shared/chunk-IRHQADG7.js";import"/censys/build/_shared/chunk-KSE2ZBRQ.js";import"/censys/build/_shared/chunk-FP2KPINM.js";import"/censys/build/_shared/chunk-VKYVKQW2.js";import"/censys/build/_shared/chunk-OQUAXVLV.js";import{a as te}from"/censys/build/_shared/chunk-BWODHJE6.js";import"/censys/build/_shared/chunk-RWVGPSU7.js";import{c as ee}from"/censys/build/_shared/chunk-4DOFQKLI.js";import"/censys/build/_shared/chunk-MB47ZWHU.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import{a as M}from"/censys/build/_shared/chunk-XTODG4BZ.js";import"/censys/build/_shared/chunk-426SZY5O.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import{a as R}from"/censys/build/_shared/chunk-TTVDHAYB.js";import"/censys/build/_shared/chunk-6EMU7K4F.js";import{a as J}from"/censys/build/_shared/chunk-M5RKE22T.js";import"/censys/build/_shared/chunk-ZP3FOFQD.js";import{b as E}from"/censys/build/_shared/chunk-E7FS2ZQL.js";import"/censys/build/_shared/chunk-ST66DGSY.js";import{E as K,F as Y}from"/censys/build/_shared/chunk-QJVHIZ52.js";import"/censys/build/_shared/chunk-N7X32FEJ.js";import{A as t,B as C,wa as N,xa as L,y as Q,z as s}from"/censys/build/_shared/chunk-DN2SN5ZC.js";import"/censys/build/_shared/chunk-F5K75D4K.js";import"/censys/build/_shared/chunk-44DVAK2X.js";import"/censys/build/_shared/chunk-OLCKCRUU.js";import{a as X,k as F}from"/censys/build/_shared/chunk-JMZ2MZXD.js";import{b as f}from"/censys/build/_shared/chunk-ZST4CTCB.js";import{a as x}from"/censys/build/_shared/chunk-MOHCJWAV.js";import{e as d}from"/censys/build/_shared/chunk-2TWE7TSA.js";var I=d(x(),1);var g={threatActivityCard:"OZCXS",threatActivityHeader:"GRTUr",threatActivityChart:"sLeSJ",threatActivityLegend:"XvmVx",threatActivityLegendItem:"esMga",threatActivityLegendItemLine:"cV42b"};function pe(e,r){let o=P(e),p=P(r);return Math.max(o,p)}function de(e){return`Past ${e} ${H("Day",e)}`}var m=d(f(),1);function _({hostMetrics:e,webMetrics:r}){let o=(0,I.useMemo)(()=>{let T=(e?.counts??[]).map(A=>({datetime:A.timestamp??"",count:BigInt(A.count)}));return U(T)},[e]),p=(0,I.useMemo)(()=>{let T=(r?.counts??[]).map(A=>({datetime:A.timestamp??"",count:BigInt(A.count)}));return U(T)},[r]),y=(0,I.useMemo)(()=>pe(o,p),[o,p]);return(0,m.jsxs)(L,{bodyPadding:N.NONE,className:g.threatActivityCard,children:[(0,m.jsxs)("div",{className:g.threatActivityHeader,children:[(0,m.jsx)(t,{variant:s.H4,children:"Threat Activity"}),(0,m.jsx)(t,{variant:s.SMALL,children:"|"}),(0,m.jsx)(t,{variant:s.H5,children:de(y)})]}),(0,m.jsx)("div",{className:g.threatActivityChart,children:(0,m.jsx)(le,{title:"Total Assets",stats:[{title:"Hosts",stats:o},{title:"Web Properties",stats:p}],fillColors:["transparent"],strokeColors:["var(--color-theme-brand-peach)"],strokeDashArrays:["0","4,4"],lineThickness:2})}),(0,m.jsxs)("div",{className:g.threatActivityLegend,children:[(0,m.jsxs)("div",{className:g.threatActivityLegendItem,children:[(0,m.jsx)("svg",{className:g.threatActivityLegendItemLine,viewBox:"0 0 34 4",children:(0,m.jsx)("path",{d:"M 0 2 L 34 2",stroke:"var(--color-theme-brand-peach)",strokeWidth:"2"})}),(0,m.jsx)(t,{variant:s.H5,children:"Hosts"})]}),(0,m.jsxs)("div",{className:g.threatActivityLegendItem,children:[(0,m.jsx)("svg",{className:g.threatActivityLegendItemLine,viewBox:"0 0 34 4",children:(0,m.jsx)("path",{d:"M 0 2 L 34 2",stroke:"var(--color-theme-brand-peach)",strokeWidth:"2",strokeDasharray:"4,4"})}),(0,m.jsx)(t,{variant:s.H5,children:"Web Properties"})]})]})]})}var he="https://attack.mitre.org/groups/",ye="https://malpedia.caad.fkie.fraunhofer.de/actor/";var i={threatActorsCard:"ypMir",cardGroup:"ekYnU",groupSection:"d7DW4",sectionHeader:"ep6L2",actor:"UvYzr",actorLeft:"XGZcX",actorRight:"prq-L",actorIcon:"AL3Sb",actorPrimaryName:"xKi-q",actorAllNames:"GSZ4p",linkList:"QDZ5v",actorLink:"V0PI4",actorLinkLabel:"R-xdK",actorLinkLabelText:"-MvZl",actorLinkValue:"VVoWa"};var a=d(f(),1);function G({threatDetails:e}){return e?.actorInfo.size?(0,a.jsx)(L,{bodyPadding:N.NONE,className:i.threatActorsCard,children:(0,a.jsx)("div",{className:i.cardGroup,children:(0,a.jsxs)("div",{className:i.groupSection,children:[(0,a.jsx)(t,{variant:s.H4,className:i.sectionHeader,children:"Actor Details"}),Array.from(e.actorInfo.entries()).map(([r,o])=>(0,a.jsxs)("div",{className:i.actor,children:[(0,a.jsxs)("div",{className:i.actorLeft,children:[(0,a.jsx)(Q,{className:i.actorIcon,name:"spy",mode:"line"}),(0,a.jsxs)("div",{className:i.actorNames,children:[(0,a.jsx)(t,{className:i.actorPrimaryName,variant:s.H3,children:o?.actor?.primaryName??"Unknown"}),o?.actor?.allNames?.length?(0,a.jsx)(t,{className:i.actorAllNames,children:o?.actor.allNames.join(", ")}):null]})]}),(0,a.jsx)("div",{className:i.actorRight,children:(0,a.jsxs)("div",{className:i.cardGroup,children:[o?.description&&(0,a.jsxs)("div",{className:i.groupSection,children:[(0,a.jsx)(t,{className:i.sectionHeader,variant:s.H5,children:"Description"}),(0,a.jsx)(t,{variant:s.SMALL,children:o?.description})]}),(0,a.jsx)("div",{className:i.groupSection,children:(0,a.jsxs)("ul",{className:i.linkList,children:[o?.actor?.mitreGroupId&&(0,a.jsxs)("li",{className:i.actorLink,children:[(0,a.jsx)("div",{className:i.actorLinkLabel,children:(0,a.jsx)(t,{children:"MITRE"})}),(0,a.jsx)("div",{className:i.actorLinkValue,children:(0,a.jsx)(R,{className:i.relatedLink,href:`${he}${o?.actor.mitreGroupId}`,isExternal:!0,showExternalIcon:!0,children:o?.actor?.mitreGroupId})})]}),o?.actor?.malpediaGroupId&&(0,a.jsxs)("li",{className:i.actorLink,children:[(0,a.jsx)("div",{className:i.actorLinkLabel,children:(0,a.jsx)(t,{className:i.actorLinkLabelText,children:"Malpedia"})}),(0,a.jsx)("div",{className:i.actorLinkValue,children:(0,a.jsx)(R,{className:i.relatedLink,href:`${ye}${o?.actor.malpediaGroupId}`,isExternal:!0,showExternalIcon:!0,children:o?.actor?.malpediaGroupId})})]})]})})]})})]},r))]})})}):null}var V=d(x(),1);var u={threatDetailHeader:"vwWE2",threatHeaderLeft:"_0VLb9",threatHeaderDetails:"ZxvV3",threatHeaderDetailsTitle:"g7LQs",threatType:"ftBSm",allNames:"G50ey",threatHeaderRight:"_6wyHh",threatHeaderActions:"N6BsW"};var c=d(f(),1);function B({threatTypes:e,threatDetails:r}){let o=(0,V.useMemo)(()=>K(r?.name??""),[r?.name]),p=j({query:o,source:"threat"}),y=(0,V.useMemo)(()=>(r?.malwareInfo?.values()?.next()?.value?.malware?.allNames??[]).filter(T=>T!==r?.name),[r]);return(0,c.jsxs)("div",{className:u.threatDetailHeader,children:[(0,c.jsxs)("div",{className:u.threatHeaderLeft,children:[(0,c.jsx)(me,{size:"large"}),(0,c.jsxs)("div",{className:u.threatHeaderDetails,children:[(0,c.jsxs)("div",{className:u.threatHeaderDetailsTitle,children:[(0,c.jsx)(t,{variant:s.H1,children:r?.name??"Unknown"}),se(r?.addedAt)?(0,c.jsx)(ce,{}):null,(0,c.jsx)(J,{variant:"dot"}),(0,c.jsx)(t,{className:u.threatType,variant:s.H5,children:e.join(", ")})]}),y.length?(0,c.jsxs)("div",{className:u.threatAka,children:[(0,c.jsx)(t,{variant:s.H5,as:"span",children:"AKA:"})," ",(0,c.jsx)(t,{className:u.allNames,children:y.join(", ")})]}):null]})]}),(0,c.jsxs)("div",{className:u.threatHeaderRight,children:[(0,c.jsxs)("div",{className:u.threatHeaderActions,children:[(0,c.jsx)(M,{link:{to:p,["aria-label"]:`Add ${r?.name} to My Collections`,target:"_blank"},button:{variant:C.DEFAULT,iconLeft:"add"},children:"Add to My Collections"}),(0,c.jsx)(M,{link:{to:Y(r?.name??""),["aria-label"]:`Search for ${r?.name}`,target:"_blank"},button:{variant:C.PRIMARY,iconLeft:"search",iconLeftMode:"line"},children:"View All Threat Assets"})]}),r?.addedAt?(0,c.jsx)(re,{timestamp:r.addedAt.toString(),labelText:"Created",includeTime:!1,includeTooltip:!1}):null]})]})}var fe=d(x(),1);var ve="https://malpedia.caad.fkie.fraunhofer.de/details/";var h={threatDetailsCard:"hlmOE",threatDetails:"a1mNT",cardGroup:"bT7i6",groupSection:"kZEhA",sectionHeader:"AcmrC",threatDetailsTable:"udhfP",rowLabel:"TnfyC",linkList:"ssi9x"};var n=d(f(),1);function $({threatDetails:e,threatTypes:r,threatTactics:o}){let p=(0,fe.useMemo)(()=>{let b=Array.from(e?.malwareInfo.values()??[]).filter(v=>!!v.malware?.malpediaId&&!!v.malware?.primaryName).map(v=>({label:`${v.malware?.primaryName} at Malpedia`,href:`${ve}${v.malware?.malpediaId}`})),A=(e?.references??[]).map(v=>({label:v.link,href:v.link})),Te=[...b,...A],q=[],z=new Set;for(let v of Te)z.has(v.href)||(z.add(v.href),q.push(v));return q},[e?.references,e?.malwareInfo]);return(0,n.jsx)(L,{bodyPadding:N.NONE,className:h.threatDetailsCard,children:(0,n.jsxs)("div",{className:h.threatDetails,children:[(0,n.jsx)("div",{className:h.cardGroup,children:(0,n.jsxs)("div",{className:h.groupSection,children:[(0,n.jsx)(t,{variant:s.H4,className:h.sectionHeader,children:"Details"}),(0,n.jsx)("div",{className:h.threatDetailsTable,children:(0,n.jsxs)(ie,{children:[(0,n.jsx)(w,{label:"Type",content:r.join(", ")}),o?.length?(0,n.jsx)(w,{label:"Tactic",content:o.join(", ")}):null]})})]})}),(0,n.jsxs)("div",{className:h.cardGroup,children:[(0,n.jsxs)("div",{className:h.groupSection,children:[(0,n.jsx)(t,{variant:s.H4,className:h.sectionHeader,children:"Description"}),(0,n.jsx)(t,{variant:s.SMALL,children:e?.description})]}),p.length?(0,n.jsxs)("div",{"data-testid":"related-links",className:h.groupSection,children:[(0,n.jsx)(t,{variant:s.H4,className:h.sectionHeader,children:"Related Links"}),(0,n.jsx)("div",{className:h.threatDetailsRightReferences,children:(0,n.jsx)("ul",{className:h.linkList,children:p.map(y=>(0,n.jsx)("li",{children:(0,n.jsx)(t,{variant:s.H6,children:(0,n.jsx)(R,{href:y.href,isExternal:!0,showExternalIcon:!0,children:y.label})})},y.href))})})]}):null]})]})})}var O={container:"XflZX",header:"_6UD8m"};var k=d(f(),1);function W({screenshots:e,threatName:r}){let o=`${r} ${H("Screenshot",e.length)}`;return(0,k.jsx)(L,{bodyPadding:N.NONE,children:(0,k.jsxs)("div",{className:O.container,children:[(0,k.jsx)("div",{className:O.header,children:(0,k.jsxs)(t,{variant:s.H4,children:["Screenshots (",e.length,")"]})}),(0,k.jsx)(oe,{assetName:o,screenshots:e,width:360})]})})}var Z={threatMainContent:"_9d6xv",topRow:"lgSeL",chartLayout:"Z-k3B"};var ke=d(ge(),1),l=d(f(),1);function ue(){let{hostMetrics:e,webMetrics:r,threatId:o,threatDetails:p,threatTypes:y,threatTactics:b,threatScreenshots:T}=ae();return(0,l.jsx)(S,{slots:{header:(0,l.jsx)(B,{threatId:o,threatTypes:y,threatDetails:p})},breadcrumbs:[{linkElement:(0,l.jsx)(E,{to:"/explore/threats",children:"Explore"})},{pathName:p?.name??"Threat Details"}],children:(0,l.jsx)(D,{children:(0,l.jsxs)("div",{className:Z.threatMainContent,children:[(0,l.jsxs)("div",{className:Z.topRow,children:[(0,l.jsx)(_,{hostMetrics:e,webMetrics:r}),T.length>0&&(0,l.jsx)(W,{threatName:p?.name??"Threat",screenshots:T})]}),(0,l.jsx)($,{threatDetails:p,threatTypes:y,threatTactics:b}),(0,l.jsx)(G,{threatDetails:p})]})})})}function Le(e){return!ne(e)}function Ae(){let e=F(),r=[{linkElement:(0,l.jsx)(E,{to:"/explore/threats",children:"Threats"})},{pathName:"Threat Details"}];return X(e)?(0,l.jsx)(S,{breadcrumbs:r,children:(0,l.jsx)(D,{children:(0,l.jsx)(ee,{iconName:"alert",title:"Error Loading Threat Data",children:(0,l.jsx)(t,{children:"We encountered a problem while loading the threat details. Please try again later."})})})}):(0,l.jsx)(S,{breadcrumbs:r,children:(0,l.jsx)(D,{children:(0,l.jsx)(te,{error:e})})})}export{Ae as ErrorBoundary,ue as default,Le as shouldRevalidate};
