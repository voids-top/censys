import{a as Ae}from"/censys/build/_shared/chunk-X4CXZ5YA.js";import"/censys/build/_shared/chunk-4M65MUEL.js";import{a as B,b as me,c as ye,d as fe,e as ge}from"/censys/build/_shared/chunk-M5FP2YGK.js";import{b as I,c as Q,d as le,i as de,x as M}from"/censys/build/_shared/chunk-MFWEXTHX.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import{a as ue}from"/censys/build/_shared/chunk-7REQVUFL.js";import"/censys/build/_shared/chunk-FNNZHS7Z.js";import"/censys/build/_shared/chunk-5PS6SCVZ.js";import{a as Re}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-IJLDI467.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import"/censys/build/_shared/chunk-PAYW5E74.js";import"/censys/build/_shared/chunk-V6B4SHZ4.js";import"/censys/build/_shared/chunk-LHWSXD62.js";import"/censys/build/_shared/chunk-22JANVKU.js";import"/censys/build/_shared/chunk-FQTIU6PB.js";import"/censys/build/_shared/chunk-J6D36YFI.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import"/censys/build/_shared/chunk-ATOZ4ARP.js";import{e as H}from"/censys/build/_shared/chunk-DSG73WCA.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{q as ie}from"/censys/build/_shared/chunk-HUE44QRB.js";import"/censys/build/_shared/chunk-Z3PARXZG.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-NJXUBBUP.js";import{a as ae}from"/censys/build/_shared/chunk-437XWWKH.js";import{c as Z}from"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-XSZMCSJH.js";import"/censys/build/_shared/chunk-BI4XKJZW.js";import"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-EYKPJWWG.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-WJT5ZZXK.js";import{k as ce,l as pe}from"/censys/build/_shared/chunk-ZI7DUXMR.js";import"/censys/build/_shared/chunk-TRPWTN3H.js";import"/censys/build/_shared/chunk-UKMMPQ5X.js";import{m as ne}from"/censys/build/_shared/chunk-WJEUPJRQ.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-EZHABQF2.js";import"/censys/build/_shared/chunk-2RV3CGNA.js";import"/censys/build/_shared/chunk-OZE6EA6M.js";import{a as oe}from"/censys/build/_shared/chunk-HNL4CPAB.js";import{f as te}from"/censys/build/_shared/chunk-D5QEORL2.js";import{u as re,x as se}from"/censys/build/_shared/chunk-VQ4M4AGG.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as _,B as q,Va as v,ba as w,da as ee,z as S}from"/censys/build/_shared/chunk-GALQBYYN.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as j,c as V,e as x,g as K,k as Y,p as $,w as G,z as W}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as C,c}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as r}from"/censys/build/_shared/chunk-2QEWK57A.js";var g=r(C(),1);var O=r(C(),1);var Le=r(C(),1);var f={queryNode:"WiG1l",header:"MKnSH",titleContainer:"Pw0Qd",countText:"g-9wd",fieldName:"x9ZNK",tooltip:"_0ix32"};var z={"host.services.threats.name":"Threats","host.services.labels.value":"Labels","host.services.protocol":"Protocols","host.services.port":"Ports","host.autonomous_system.name":"Autonomous Systems","host.location.country":"Countries","host.services.jarm.fingerprint":"JARM Fingerprints","host.services.tls.ja3s":"JA3S","host.services.tls.ja4s":"JA4S","host.services.ja4tscan.fingerprint":"JA4TScan Fingerprints","web.threats.name":"Threats","web.labels.value":"Labels","web.endpoints.port":"Ports","web.software.product":"Software Products","web.endpoints.http.html_title":"Page Titles","web.endpoints.endpoint_type":"Applications","web.jarm.fingerprint":"JARM Fingerprints","web.tls.ja3s":"JA3S","web.tls.ja4s":"JA4S","cert.parsed.issuer_dn":"Issuer","cert.parsed.subject_dn":"Subject","cert.labels":"Labels","cert.ever_seen_in_scan":"Ever Seen in Scan","cert.parsed.ja4x":"JA4X"},R=Object.keys(z);var p=r(c(),1);function k({node:t}){let{query:e}=t,{count:s,pairs:o,assetType:n}=e,l=o[0]?.field??"Query",u=o[0]?.value??e.query,a=I(l,60),N=I(u,60),m=(0,Le.useMemo)(()=>{let d=parseInt(s.value,10);return isNaN(d)?0:d},[s]),h=Q({assetType:n,isCapitalized:!0,isPlural:!0,count:m});return(0,p.jsx)("div",{className:f.queryNode,children:(0,p.jsxs)("div",{className:f.header,children:[(0,p.jsx)(ue,{assetType:n,size:"lg"}),(0,p.jsxs)("div",{className:f.titleContainer,children:[m>0&&(0,p.jsxs)(_,{variant:S.SMALL_NUMERAL,className:f.countText,children:[ne(m)," ",h]}),(0,p.jsx)(_,{className:f.fieldName,children:(0,p.jsxs)(v,{content:l,triggerClassName:f.tooltip,children:[a,":"]})}),(0,p.jsx)(_,{children:(0,p.jsx)(v,{content:u,triggerClassName:f.tooltip,children:(0,p.jsx)("span",{children:N})})})]})]})})}var E=r(C(),1);var Ne=(t,e,s)=>{let o=D(t,e,s);return`/censys?q=${encodeURIComponent(o)}`},D=(t,e,s)=>{if(typeof e=="string"&&R.includes(e)){let o=re({kind:0,field:e,value:s});return se(t,o,"and")}return""};var y=r(c(),1);function b({label:t,field:e,query:s,onAddFilter:o}){let{t:n}=Z(),l=(0,E.useMemo)(()=>s&&e&&t&&Ne(s,e,t),[s,e,t]),u=(0,E.useCallback)(()=>t&&o?.(t),[t,o]);return(0,y.jsxs)(y.Fragment,{children:[l&&(0,y.jsx)(v,{content:n("Search"),children:(0,y.jsx)(ae,{link:{to:l,isExternal:!0},iconButton:{iconName:"search",iconMode:"line",variant:q.DEFAULT,size:w.SMALL,"aria-label":n("Search")}})}),o&&(0,y.jsx)(v,{content:n("Add Node",{ns:"investigation"}),children:(0,y.jsx)(ee,{iconName:"add",iconMode:"line","aria-label":n("Add Node",{ns:"investigation"}),onClick:u,variant:q.PRIMARY,size:w.SMALL})})]})}var T={loading:"tJPQ6",loadingRow:"zVU9C",loadingSection:"zzMbw"};var L=r(c(),1);function he(){return(0,L.jsx)("div",{className:T.loadingSection,children:Array.from({length:3}).map((t,e)=>(0,L.jsxs)("div",{className:T.loadingRow,children:[(0,L.jsx)(H,{variant:S.H5,width:300}),(0,L.jsx)(H,{variant:S.H5,width:40})]},e))})}var U=r(c(),1);function J(){return(0,U.jsx)("div",{role:"menu","aria-busy":!0,className:T.loading,children:Array.from({length:6}).map((t,e)=>(0,U.jsx)(he,{},e))})}var Se={category:"fyaWR"};var A=r(c(),1);function F({node:t,filters:e,isLoading:s}){let{addQueryNode:o}=M(),n=t.query.query,l=(0,O.useCallback)((a,N)=>{let m=D(n,a,N);o(m)},[o,n]),u=(0,O.useCallback)(a=>e?.[a]?.buckets.length?(0,A.jsx)("div",{className:Se.category,children:(0,A.jsx)(Ae,{field:a,buckets:e[a].buckets,title:z[a],onApplyFilter:l,slots:{actions:b},slotProps:{actions:{field:a,query:t.query.query}}})},a):null,[e,l,t.query.query]);return(0,A.jsxs)("div",{children:[(0,A.jsx)(k,{node:t}),s?(0,A.jsx)(J,{}):R.map(u)]})}var Ee=r(Re(),1),i=r(c(),1);function Te(){let[t]=$(),{deleteNodes:e,nodesById:s}=de(),o=te(),n=K(),l=V(),u=x(),{filters:a}=W(),N=pe(),m=(0,g.useCallback)(()=>{let P=new URLSearchParams(l.search);o?.organizationId&&P.set(oe,o.organizationId);let _e=`/investigate/${n.id}?${P.toString()}`;u(_e)},[l.search,u,n.id,o]),h=t.get("node_id")??"",d=s[h],Pe=(0,g.useCallback)(async()=>{m(),e([h])},[m,e,h]),Ce=(0,g.useMemo)(()=>`/censys?q=${d?.query?.query}`,[d?.query?.query]),X=N?ce({query:d?.query?.query,source:"investigation"}):void 0;return!d||!le(d)?null:(0,i.jsx)(B,{title:"Query Node",onClose:m,actions:(0,i.jsxs)(me,{children:[X&&(0,i.jsx)(ye,{createCollectionLink:X}),(0,i.jsx)(ge,{link:Ce,label:"See Full Search Results"}),(0,i.jsx)(fe,{onDelete:Pe})]}),children:(0,i.jsx)(g.Suspense,{fallback:(0,i.jsx)(F,{node:d,filters:void 0,isLoading:!0}),children:(0,i.jsx)(G,{resolve:a,children:P=>(0,i.jsx)(F,{node:d,filters:P,isLoading:!1})})})})}function ke(){let t=x(),e=Y(),s=j(e)?e.data.message:"Unknown error",o=(0,g.useCallback)(()=>{t(-1)},[t]);return(0,i.jsx)(B,{title:"Query Node",onClose:o,children:(0,i.jsx)(ie,{iconName:"server",title:s})})}export{ke as ErrorBoundary,Te as default};
