import{a as v,b as V,d as F,e as G,f as Y}from"/censys/build/_shared/chunk-M5FP2YGK.js";import{a as O,i as U}from"/censys/build/_shared/chunk-MFWEXTHX.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-7REQVUFL.js";import"/censys/build/_shared/chunk-FNNZHS7Z.js";import{a as M,d as r,e as s}from"/censys/build/_shared/chunk-53UREJP4.js";import"/censys/build/_shared/chunk-5PS6SCVZ.js";import{b as z}from"/censys/build/_shared/chunk-NEH6M55V.js";import{a as j}from"/censys/build/_shared/chunk-JAEJ7XSF.js";import{a as oe}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-IJLDI467.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import"/censys/build/_shared/chunk-LHWSXD62.js";import"/censys/build/_shared/chunk-22JANVKU.js";import"/censys/build/_shared/chunk-FQTIU6PB.js";import"/censys/build/_shared/chunk-J6D36YFI.js";import"/censys/build/_shared/chunk-EI6HYVQX.js";import"/censys/build/_shared/chunk-J22KWXE5.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import{g as L}from"/censys/build/_shared/chunk-ATOZ4ARP.js";import"/censys/build/_shared/chunk-DSG73WCA.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{j as x,q as B}from"/censys/build/_shared/chunk-HUE44QRB.js";import"/censys/build/_shared/chunk-Z3PARXZG.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-NJXUBBUP.js";import"/censys/build/_shared/chunk-437XWWKH.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-EYKPJWWG.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-WJT5ZZXK.js";import"/censys/build/_shared/chunk-ZI7DUXMR.js";import"/censys/build/_shared/chunk-TRPWTN3H.js";import"/censys/build/_shared/chunk-UKMMPQ5X.js";import"/censys/build/_shared/chunk-WJEUPJRQ.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-EZHABQF2.js";import"/censys/build/_shared/chunk-2RV3CGNA.js";import"/censys/build/_shared/chunk-OZE6EA6M.js";import{a as w}from"/censys/build/_shared/chunk-HNL4CPAB.js";import{f as H}from"/censys/build/_shared/chunk-D5QEORL2.js";import"/censys/build/_shared/chunk-VQ4M4AGG.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A as y,Ja as N,y as k,z as A}from"/censys/build/_shared/chunk-GALQBYYN.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as R,c as S,e as b,g as _,k as C,z as P}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as te,c as E}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as f}from"/censys/build/_shared/chunk-2QEWK57A.js";var a=f(te(),1);var l={section:"nNe8T",sectionHeader:"_0m5-j",sectionHeaderIcon:"REFMT"};var ae=f(oe(),1),e=f(E(),1);function $(){let{deleteNodes:i}=U(),n=H(),o=_(),d=S(),T=b(),m=P(),{link:Q="",label:q=""}=O("cert",o.certId||""),u=(0,a.useCallback)(()=>{let c=new URLSearchParams(d.search);n?.organizationId&&c.set(w,n.organizationId);let g=`/investigate/${o.id}?${c.toString()}`;T(g)},[d.search,T,o.id,n]),J=(0,a.useCallback)(()=>{let c=x("cert",o.certId||"");u(),i([c])},[u,i,o.certId]);if(!m||!("cert"in m)||!m.cert)return null;let{cert:K,id:W}=m,t=j(K),X=(0,a.useMemo)(()=>(t.labels||[]).map(g=>({key:"label",value:g})),[t]),Z=t.certificate?.parsed?.subject_dn,ee=t.certificate?.parsed?.issuer_dn,p=t.certificate?.parsed?.validity_period,I=t.certificate?.names,h=t.certificate?.ever_seen_in_scan,D=(0,a.useMemo)(()=>L([t.certificate])?.aggregatedStatus,[t.certificate]);return(0,e.jsxs)(v,{title:"Certificate Node",onClose:u,actions:(0,e.jsxs)(V,{children:[(0,e.jsx)(G,{link:Q,label:q}),(0,e.jsx)(F,{onDelete:J})]}),children:[(0,e.jsx)("div",{className:l.section,children:(0,e.jsx)(Y,{assetType:"cert",id:W,tags:X})}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(k,{icon:"file-list-2-line",size:"md",className:l.sectionHeaderIcon}),(0,e.jsx)(y,{variant:A.H3,children:"Summary"})]}),(0,e.jsxs)(M,{children:[(0,e.jsx)(r,{label:"Issuer DN",content:ee||(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"Subject DN",content:Z||(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"Browser Trust",content:D&&(0,e.jsx)(z,{aggregatedStatus:D})}),(0,e.jsx)(r,{label:"Validity Period",content:p?.not_before&&p?.not_after?(0,e.jsxs)(y,{children:[(0,e.jsx)(N,{timestamp:p.not_before.toString()})," -"," ",(0,e.jsx)(N,{timestamp:p.not_after.toString()})]}):(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"All Names",content:I?.length?I.join(", "):(0,e.jsx)(s,{})}),(0,e.jsx)(r,{label:"Seen in Scan",content:h!==void 0?h?"Yes":"No":(0,e.jsx)(s,{})})]})]})]})}function re(){let i=b(),n=C(),o=R(n)?n.data.message:"Unknown error",d=(0,a.useCallback)(()=>{i(-1)},[i]);return(0,e.jsx)(v,{title:"Certificate Node",onClose:d,children:(0,e.jsx)(B,{iconName:"safe-2",title:o})})}export{re as ErrorBoundary,$ as default};
