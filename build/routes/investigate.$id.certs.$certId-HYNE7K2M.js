import{b as z}from"/censys/build/_shared/chunk-IHXQKSC2.js";import{a as v,b as V,d as F,e as G,f as Y}from"/censys/build/_shared/chunk-YGYBCBWV.js";import{a as O,i as U}from"/censys/build/_shared/chunk-OM626W5A.js";import"/censys/build/_shared/chunk-MB2LZLPU.js";import"/censys/build/_shared/chunk-T4CQEEYS.js";import"/censys/build/_shared/chunk-GMNB7RSU.js";import"/censys/build/_shared/chunk-SNE5KUVT.js";import{a as M,d as a,e as s}from"/censys/build/_shared/chunk-AIDQO3P6.js";import"/censys/build/_shared/chunk-5PS6SCVZ.js";import{a as j}from"/censys/build/_shared/chunk-6PRZAB44.js";import{a as oe}from"/censys/build/_shared/chunk-EAJKCKTG.js";import"/censys/build/_shared/chunk-FYP76FCX.js";import"/censys/build/_shared/chunk-LQXVLPA4.js";import"/censys/build/_shared/chunk-OKZWZKQL.js";import"/censys/build/_shared/chunk-PUNV2EUS.js";import"/censys/build/_shared/chunk-ZMYU5ULY.js";import"/censys/build/_shared/chunk-WMKH6XX3.js";import"/censys/build/_shared/chunk-3JU625ZU.js";import"/censys/build/_shared/chunk-I5BA26X4.js";import"/censys/build/_shared/chunk-RAMDI2JB.js";import"/censys/build/_shared/chunk-O3SGPCPK.js";import"/censys/build/_shared/chunk-CJIEOTRC.js";import{g as x}from"/censys/build/_shared/chunk-JLZAPT5W.js";import"/censys/build/_shared/chunk-FSKKJDZY.js";import"/censys/build/_shared/chunk-M7IO6GB7.js";import{d as B,o as L}from"/censys/build/_shared/chunk-W5Y6TOHF.js";import"/censys/build/_shared/chunk-AEP7YWHE.js";import"/censys/build/_shared/chunk-URNZPFSF.js";import"/censys/build/_shared/chunk-WK35ORSL.js";import"/censys/build/_shared/chunk-HG7D3PDC.js";import"/censys/build/_shared/chunk-ZKAH2G64.js";import"/censys/build/_shared/chunk-G6DKMBFA.js";import"/censys/build/_shared/chunk-WNJFRA3F.js";import"/censys/build/_shared/chunk-KIDII43I.js";import"/censys/build/_shared/chunk-RPAGMMSK.js";import"/censys/build/_shared/chunk-2G5R6E4Q.js";import"/censys/build/_shared/chunk-6XVOHWMX.js";import"/censys/build/_shared/chunk-HLRAT4GD.js";import"/censys/build/_shared/chunk-HPK4AUA3.js";import"/censys/build/_shared/chunk-W2GUOEY7.js";import"/censys/build/_shared/chunk-FQAS3FYV.js";import{a as w}from"/censys/build/_shared/chunk-P2FXGQA2.js";import{f as H}from"/censys/build/_shared/chunk-FH7VNUY3.js";import"/censys/build/_shared/chunk-B7DSLLNE.js";import"/censys/build/_shared/chunk-GYDCO7LL.js";import"/censys/build/_shared/chunk-KMD3IRPL.js";import"/censys/build/_shared/chunk-Y7XN4DST.js";import{A,B as y,Ha as N,z as k}from"/censys/build/_shared/chunk-UYH4GQ7Z.js";import"/censys/build/_shared/chunk-6URBRDCL.js";import{a as R,c as _,e as b,g as C,k as P,z as S}from"/censys/build/_shared/chunk-Q6RLBVJI.js";import{a as te,c as E}from"/censys/build/_shared/chunk-XJAPXWKX.js";import{d as f}from"/censys/build/_shared/chunk-2QEWK57A.js";var r=f(te(),1);var l={section:"nNe8T",sectionHeader:"_0m5-j",sectionHeaderIcon:"REFMT"};var re=f(oe(),1),e=f(E(),1);function $(){let{deleteNodes:i}=U(),n=H(),o=C(),d=_(),T=b(),m=S(),{link:Q="",label:q=""}=O("cert",o.certId||""),u=(0,r.useCallback)(()=>{let c=new URLSearchParams(d.search);n?.organizationId&&c.set(w,n.organizationId);let g=`/investigate/${o.id}?${c.toString()}`;T(g)},[d.search,T,o.id,n]),J=(0,r.useCallback)(()=>{let c=L("cert",o.certId||"");u(),i([c])},[u,i,o.certId]);if(!m||!("cert"in m)||!m.cert)return null;let{cert:K,id:W}=m,t=j(K),X=(0,r.useMemo)(()=>(t.labels||[]).map(g=>({key:"label",value:g})),[t]),Z=t.certificate?.parsed?.subject_dn,ee=t.certificate?.parsed?.issuer_dn,p=t.certificate?.parsed?.validity_period,I=t.certificate?.names,h=t.certificate?.ever_seen_in_scan,D=(0,r.useMemo)(()=>x([t.certificate])?.aggregatedStatus,[t.certificate]);return(0,e.jsxs)(v,{title:"Certificate Node",onClose:u,actions:(0,e.jsxs)(V,{children:[(0,e.jsx)(G,{link:Q,label:q}),(0,e.jsx)(F,{onDelete:J})]}),children:[(0,e.jsx)("div",{className:l.section,children:(0,e.jsx)(Y,{assetType:"cert",id:W,tags:X})}),(0,e.jsxs)("div",{className:l.section,children:[(0,e.jsxs)("div",{className:l.sectionHeader,children:[(0,e.jsx)(k,{icon:"file-list-2-line",size:"md",className:l.sectionHeaderIcon}),(0,e.jsx)(y,{variant:A.H3,children:"Summary"})]}),(0,e.jsxs)(M,{children:[(0,e.jsx)(a,{label:"Issuer DN",content:ee||(0,e.jsx)(s,{})}),(0,e.jsx)(a,{label:"Subject DN",content:Z||(0,e.jsx)(s,{})}),(0,e.jsx)(a,{label:"Browser Trust",content:D&&(0,e.jsx)(z,{aggregatedStatus:D})}),(0,e.jsx)(a,{label:"Validity Period",content:p?.not_before&&p?.not_after?(0,e.jsxs)(y,{children:[(0,e.jsx)(N,{timestamp:p.not_before})," -"," ",(0,e.jsx)(N,{timestamp:p.not_after})]}):(0,e.jsx)(s,{})}),(0,e.jsx)(a,{label:"All Names",content:I?.length?I.join(", "):(0,e.jsx)(s,{})}),(0,e.jsx)(a,{label:"Seen in Scan",content:h!==void 0?h?"Yes":"No":(0,e.jsx)(s,{})})]})]})]})}function ae(){let i=b(),n=P(),o=R(n)?n.data.message:"Unknown error",d=(0,r.useCallback)(()=>{i(-1)},[i]);return(0,e.jsx)(v,{title:"Certificate Node",onClose:d,children:(0,e.jsx)(B,{iconName:"safe-2",title:o})})}export{ae as ErrorBoundary,$ as default};
